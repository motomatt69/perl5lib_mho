<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>Wiki: PerlDesignPatterns</title></head><body>
  <a href="http://www.perldesignpatterns.com/?HomePage"><img src="perldesignpatterns-Dateien/back1.png" width="64" border="0" height="64"></a>
  <font size="+2">TinyWiki</font><br>

  <br>PerlDesignPatterns and all of its attached nodes. Note! This is a snapshot of a work in 
  progress. 
  This is the recommended format for browsing or reading through.
  For the latest content, hyperlinked interface, and the ability to 
  make corrections and additions, go to http://wiki.slowass.net/?PerlDesignPatterns.
  <br><br>
 
<br><br>
 <font size="+2"><b>Perl Design Patterns</b></font><br><br><i>or, Chicken Bones for the Voodoo Programmer Soul</i> 
<br><br>
 <a href="#PerlDesignPatterns"><b></b></a><b><a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a></b> is a free on-line book and forum. For information about this project and links to download the entire book, see <a href="#HomePage"><b></b></a><b><a href="#HomePage"><b>Home Page</b></a></b>, or just click <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=assemble.cgi?PerlDesignPatterns">TinyCGI:assemble.cgi?PerlDesignPatterns</a> - Downloading is highly recommended unless you're contributing to the project. Wget users - fetch <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyWiki&amp;word=download.cgi">TinyWiki:download.cgi</a> or <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyWiki&amp;word=perldesignpatterns.zip">TinyWiki:perldesignpatterns.zip</a> instead, and see <a href="#HomePage"><b></b></a><b><a href="#HomePage"><b>Home Page</b></a></b> for more info. Novices, intermediate programmers:  "Object Nuts and Bolts" is for you. Scroll down. 
<br><br>
 <font size="+2"><b>Introduction</b></font><br><br><li> <a href="#SoftwareQualityLevels"><b></b></a><b><a href="#SoftwareQualityLevels"><b>Software Quality Levels</b></a></b> </li><li> <a href="#AboutObjects"><b></b></a><b><a href="#AboutObjects"><b>About Objects</b></a></b> </li><li> <a href="#AboutPatterns"><b></b></a><b><a href="#AboutPatterns"><b>About Patterns</b></a></b> </li><li> <a href="#AboutFlack"><b></b></a><b><a href="#AboutFlack"><b>About Flack</b></a></b> </li><li> <a href="#AboutPerl"><b></b></a><b><a href="#AboutPerl"><b>About Perl</b></a></b> 
<br><br>
 <font size="+2"><b>Object Nuts and Bolts</b></font><br><br>You may want to skip this section. 
<br><br>
 </li><li> <a href="#BasicPerlOOSyntax"><b></b></a><b><a href="#BasicPerlOOSyntax"><b>Basic Perl OOSyntax</b></a></b> </li><li> <a href="#InstanceVariables"><b></b></a><b><a href="#InstanceVariables"><b>Instance Variables</b></a></b> </li><li> <a href="#ShortHandInstanceVariables"><b></b></a><b><a href="#ShortHandInstanceVariables"><b>Short Hand Instance Variables</b></a></b> </li><li> <a href="#StaticVariables"><b></b></a><b><a href="#StaticVariables"><b>Static Variables</b></a></b> </li><li> <a href="#StaticMethods"><b></b></a><b><a href="#StaticMethods"><b>Static Methods</b></a></b> </li><li> <a href="#AccessorPattern"><b></b></a><b><a href="#AccessorPattern"><b>Accessor Pattern</b></a></b> </li><li> <a href="#PrivateFunctions"><b></b></a><b><a href="#PrivateFunctions"><b>Private Functions</b></a></b> 
<br><br>
 <font size="+2"><b>Object Adapter Design Patterns</b></font><br><br></li><li> <a href="#ResultObject"><b></b></a><b><a href="#ResultObject"><b>Result Object</b></a></b> </li><li> <a href="#CommandObject"><b></b></a><b><a href="#CommandObject"><b>Command Object</b></a></b> </li><li> <a href="#PassingPattern"><b></b></a><b><a href="#PassingPattern"><b>Passing Pattern</b></a></b>, <a href="#PassingState"><b></b></a><b><a href="#PassingState"><b>Passing State</b></a></b> </li><li> <a href="#ProxyPattern"><b></b></a><b><a href="#ProxyPattern"><b>Proxy Pattern</b></a></b> </li><li> <a href="#AdapterPattern"><b></b></a><b><a href="#AdapterPattern"><b>Adapter Pattern</b></a></b> </li><li> <a href="#FacadePattern"><b></b></a><b><a href="#FacadePattern"><b>Facade Pattern</b></a></b> </li><li> <a href="#InnerClasses"><b></b></a><b><a href="#InnerClasses"><b>Inner Classes</b></a></b> </li><li> <a href="#TypeSafety"><b></b></a><b><a href="#TypeSafety"><b>Type Safety</b></a></b>, <a href="#TypedVariables"><b></b></a><b><a href="#TypedVariables"><b>Typed Variables</b></a></b> 
<br><br>
 <font size="+2"><b>Delegation-Composition Patterns</b></font><br><br></li><li> <a href="#CompositePattern"><b></b></a><b><a href="#CompositePattern"><b>Composite Pattern</b></a></b> </li><li> <a href="#DecoratorPattern"><b></b></a><b><a href="#DecoratorPattern"><b>Decorator Pattern</b></a></b> </li><li> <a href="#AggregatePattern"><b></b></a><b><a href="#AggregatePattern"><b>Aggregate Pattern</b></a></b>, <a href="#ContainerPattern"><b></b></a><b><a href="#ContainerPattern"><b>Container Pattern</b></a></b> </li><li> <a href="#VisitorPattern"><b></b></a><b><a href="#VisitorPattern"><b>Visitor Pattern</b></a></b> </li><li> <a href="#IteratorInterface"><b></b></a><b><a href="#IteratorInterface"><b>Iterator Interface</b></a></b> </li><li> <a href="#ConstraintSystem"><b></b></a><b><a href="#ConstraintSystem"><b>Constraint System</b></a></b> 
<br><br>
 <font size="+2"><b>Inheritance Structure Patterns</b></font><br><br></li><li> <a href="#AboutInheritance"><b></b></a><b><a href="#AboutInheritance"><b>About Inheritance</b></a></b> </li><li> <a href="#ImportPattern"><b></b></a><b><a href="#ImportPattern"><b>Import Pattern</b></a></b> </li><li> <a href="#AbstractClass"><b></b></a><b><a href="#AbstractClass"><b>Abstract Class</b></a></b> </li><li> <a href="#TemplateMethod"><b></b></a><b><a href="#TemplateMethod"><b>Template Method</b></a></b> </li><li> <a href="#StateVsClass"><b></b></a><b><a href="#StateVsClass"><b>State Vs Class</b></a></b> 
<br><br>
 <font size="+2"><b>Object Creational Patterns</b></font><br><br></li><li> <a href="#ChainOfConstructors"><b></b></a><b><a href="#ChainOfConstructors"><b>Chain Of Constructors</b></a></b> </li><li> <a href="#SingletonPattern"><b></b></a><b><a href="#SingletonPattern"><b>Singleton Pattern</b></a></b> </li><li> <a href="#CurryingConcept"><b></b></a><b><a href="#CurryingConcept"><b>Currying Concept</b></a></b> </li><li> <a href="#FactoryObject"><b></b></a><b><a href="#FactoryObject"><b>Factory Object</b></a></b> </li><li> <a href="#NewObjectFromExisting"><b></b></a><b><a href="#NewObjectFromExisting"><b>New Object From Existing</b></a></b>, <a href="#CloningPattern"><b></b></a><b><a href="#CloningPattern"><b>Cloning Pattern</b></a></b> </li><li> <a href="#ClonePrototypicalObjects"><b></b></a><b><a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a></b> </li><li> <a href="#FlyweightPattern"><b></b></a><b><a href="#FlyweightPattern"><b>Flyweight Pattern</b></a></b>, <a href="#ImmutableObject"><b></b></a><b><a href="#ImmutableObject"><b>Immutable Object</b></a></b> </li><li> <a href="#AbstractFactory"><b></b></a><b><a href="#AbstractFactory"><b>Abstract Factory</b></a></b> 
<br><br>
 <font size="+2"><b>Object Creation Syntax Patterns</b></font><br><br></li><li> <a href="#PseudoHash"><b></b></a><b><a href="#PseudoHash"><b>Pseudo Hash</b></a></b> </li><li> <a href="#InlineObjects"><b></b></a><b><a href="#InlineObjects"><b>Inline Objects</b></a></b> </li><li> <a href="#ExportingPattern"><b></b></a><b><a href="#ExportingPattern"><b>Exporting Pattern</b></a></b> </li><li> <a href="#WrapperModule"><b></b></a><b><a href="#WrapperModule"><b>Wrapper Module</b></a></b> </li><li> <a href="#RevisitingNamespaces"><b></b></a><b><a href="#RevisitingNamespaces"><b>Revisiting Namespaces</b></a></b> </li><li> <a href="#AnonymousSubroutineObjects"><b></b></a><b><a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a></b> </li><li> <a href="#OverloadOperators"><b></b></a><b><a href="#OverloadOperators"><b>Overload Operators</b></a></b> 
<br><br>
 <font size="+2"><b>Object State Patterns</b></font><br><br></li><li> <a href="#ClassAsTypeCode"><b></b></a><b><a href="#ClassAsTypeCode"><b>Class As Type Code</b></a></b> </li><li> <a href="#StatePattern"><b></b></a><b><a href="#StatePattern"><b>State Pattern</b></a></b> </li><li> <a href="#MomentoPattern"><b></b></a><b><a href="#MomentoPattern"><b>Momento Pattern</b></a></b> </li><li> <a href="#RunAndReturnSuccessor"><b></b></a><b><a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a></b> 
<br><br>
 <font size="+2"><b>Relational Data Patterns</b></font><br><br></li><li> <a href="#ObjectsAndRelationalDatabaseSystems"><b></b></a><b><a href="#ObjectsAndRelationalDatabaseSystems"><b>Objects And Relational Database Systems</b></a></b> </li><li> <a href="#SelfJoiningData"><b></b></a><b><a href="#SelfJoiningData"><b>Self Joining Data</b></a></b> </li><li> <a href="#ManyToManyRelationship"><b></b></a><b><a href="#ManyToManyRelationship"><b>Many To Many Relationship</b></a></b> </li><li> <a href="#OneToOneRelationshipsTurnIntoOneToManyRelationships"><b></b></a><b><a href="#OneToOneRelationshipsTurnIntoOneToManyRelationships"><b>One To One Relationships Turn Into One To Many Relationships</b></a></b> </li><li> <a href="#BiDirectionalRelationshipToUnidirectional"><b></b></a><b><a href="#BiDirectionalRelationshipToUnidirectional"><b>Bi Directional Relationship To Unidirectional</b></a></b> 
<br><br>
 <font size="+2"><b>Non-Object Patterns</b></font><br><br></li><li> <a href="#NamedArguments"><b></b></a><b><a href="#NamedArguments"><b>Named Arguments</b></a></b> </li><li> <a href="#FunctionTemplating"><b></b></a><b><a href="#FunctionTemplating"><b>Function Templating</b></a></b> </li><li> <a href="#ReturnYourself"><b></b></a><b><a href="#ReturnYourself"><b>Return Yourself</b></a></b> </li><li> <a href="#AssertPattern"><b></b></a><b><a href="#AssertPattern"><b>Assert Pattern</b></a></b> </li><li> <a href="#CodeAsData"><b></b></a><b><a href="#CodeAsData"><b>Code As Data</b></a></b> </li><li> <a href="#NonReenterable"><b></b></a><b><a href="#NonReenterable"><b>Non Reenterable</b></a></b> </li><li> <a href="#SelectPollPattern"><b></b></a><b><a href="#SelectPollPattern"><b>Select Poll Pattern</b></a></b> </li><li> <a href="#JournalingPattern"><b></b></a><b><a href="#JournalingPattern"><b>Journaling Pattern</b></a></b> </li><li> <a href="#ApplicationGenerator"><b></b></a><b><a href="#ApplicationGenerator"><b>Application Generator</b></a></b> </li><li> <a href="#MinimizeBlockNesting"><b></b></a><b><a href="#MinimizeBlockNesting"><b>Minimize Block Nesting</b></a></b> 
<br><br>
 <font size="+2"><b>Application Features</b></font><br><br>Web: 
<br><br>
 </li><li> <a href="#WebAuthentication"><b></b></a><b><a href="#WebAuthentication"><b>Web Authentication</b></a></b> </li><li> <a href="#FileUpload"><b></b></a><b><a href="#FileUpload"><b>File Upload</b></a></b> </li><li> <a href="#WebScraping"><b></b></a><b><a href="#WebScraping"><b>Web Scraping</b></a></b> 
<br><br>
 General: 
<br><br>
 </li><li> <a href="#ReadingAFile"><b></b></a><b><a href="#ReadingAFile"><b>Reading AFile</b></a></b> </li><li> <a href="#ConfigFile"><b></b></a><b><a href="#ConfigFile"><b>Config File</b></a></b> </li><li> <a href="#ErrorHandling"><b></b></a><b><a href="#ErrorHandling"><b>Error Handling</b></a></b> </li><li> <a href="#ErrorReporting"><b></b></a><b><a href="#ErrorReporting"><b>Error Reporting</b></a></b> </li><li> <a href="#ExtensibilityPattern"><b></b></a><b><a href="#ExtensibilityPattern"><b>Extensibility Pattern</b></a></b> 
<br><br>
 <font size="+2"><b>Anti-Patterns</b></font><br><br></li><li> <a href="#CutAndPasteProgramming"><b></b></a><b><a href="#CutAndPasteProgramming"><b>Cut And Paste Programming</b></a></b> </li><li> <a href="#PrematureOptimization"><b></b></a><b><a href="#PrematureOptimization"><b>Premature Optimization</b></a></b> </li><li> <a href="#BlindFaith"><b></b></a><b><a href="#BlindFaith"><b>Blind Faith</b></a></b> </li><li> <a href="#BigBallOfMud"><b></b></a><b><a href="#BigBallOfMud"><b>Big Ball Of Mud</b></a></b> </li><li> <a href="#SpaghettiCode"><b></b></a><b><a href="#SpaghettiCode"><b>Spaghetti Code</b></a></b> </li><li> <a href="#LavaFlow"><b></b></a><b><a href="#LavaFlow"><b>Lava Flow</b></a></b> </li><li> <a href="#BoatAnchor"><b></b></a><b><a href="#BoatAnchor"><b>Boat Anchor</b></a></b> </li><li> <a href="#BusySpin"><b></b></a><b><a href="#BusySpin"><b>Busy Spin</b></a></b> </li><li> <a href="#RaceCondition"><b></b></a><b><a href="#RaceCondition"><b>Race Condition</b></a></b> </li><li> <a href="#GodObject"><b></b></a><b><a href="#GodObject"><b>God Object</b></a></b> </li><li> <a href="#ObjectOrgy"><b></b></a><b><a href="#ObjectOrgy"><b>Object Orgy</b></a></b> </li><li> <a href="#FeatureEnvy"><b></b></a><b><a href="#FeatureEnvy"><b>Feature Envy</b></a></b> </li><li> <a href="#EmptySubclassFailure"><b></b></a><b><a href="#EmptySubclassFailure"><b>Empty Subclass Failure</b></a></b> </li><li> <a href="#CheckingTypeInsteadOfMembership"><b></b></a><b><a href="#CheckingTypeInsteadOfMembership"><b>Checking Type Instead Of Membership</b></a></b> </li><li> <a href="#ExplicitTypeCaseAnalysis"><b></b></a><b><a href="#ExplicitTypeCaseAnalysis"><b>Explicit Type Case Analysis</b></a></b> </li><li> <a href="#AccumulateAndFire"><b></b></a><b><a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a></b> </li><li> <a href="#ActionAtADistance"><b></b></a><b><a href="#ActionAtADistance"><b>Action At ADistance</b></a></b> </li><li> <a href="#InterfaceBloat"><b></b></a><b><a href="#InterfaceBloat"><b>Interface Bloat</b></a></b> </li><li> <a href="#FatCommands"><b></b></a><b><a href="#FatCommands"><b>Fat Commands</b></a></b> </li><li> <a href="#HardcodesAreEvil"><b></b></a><b><a href="#HardcodesAreEvil"><b>Hardcodes Are Evil</b></a></b> </li><li> <a href="#CachingFailure"><b></b></a><b><a href="#CachingFailure"><b>Caching Failure</b></a></b> </li><li> <a href="#NoSexUntilMarriage"><b></b></a><b><a href="#NoSexUntilMarriage"><b>No Sex Until Marriage</b></a></b> </li><li> <a href="#AbstractionInversion"><b></b></a><b><a href="#AbstractionInversion"><b>Abstraction Inversion</b></a></b> </li><li> <a href="#DllHell"><b></b></a><b><a href="#DllHell"><b>Dll Hell</b></a></b> </li><li> <a href="#CreepingFeaturism"><b></b></a><b><a href="#CreepingFeaturism"><b>Creeping Featurism</b></a></b> 
<br><br>
 <font size="+2"><b>Refactoring</b></font><br><br></li><li> <a href="#AboutRefactoring"><b></b></a><b><a href="#AboutRefactoring"><b>About Refactoring</b></a></b> </li><li> <a href="#RefactoringPattern"><b></b></a><b><a href="#RefactoringPattern"><b>Refactoring Pattern</b></a></b> </li><li> <a href="#PlanningIsNpComplete"><b></b></a><b><a href="#PlanningIsNpComplete"><b>Planning Is Np Complete</b></a></b> </li><li> <a href="#GeneralizePattern"><b></b></a><b><a href="#GeneralizePattern"><b>Generalize Pattern</b></a></b> </li><li> <a href="#ExpressionsBecomeFunctions"><b></b></a><b><a href="#ExpressionsBecomeFunctions"><b>Expressions Become Functions</b></a></b> </li><li> <a href="#BreakDownLargeFunctions"><b></b></a><b><a href="#BreakDownLargeFunctions"><b>Break Down Large Functions</b></a></b> </li><li> <a href="#ReusableFunctions"><b></b></a><b><a href="#ReusableFunctions"><b>Reusable Functions</b></a></b> </li><li> <a href="#LocalVariablesReplaceGlobalVariables"><b></b></a><b><a href="#LocalVariablesReplaceGlobalVariables"><b>Local Variables Replace Global Variables</b></a></b> </li><li> <a href="#SoftrefsToHash"><b></b></a><b><a href="#SoftrefsToHash"><b>Softrefs To Hash</b></a></b> </li><li> <a href="#GlobalToLexical"><b></b></a><b><a href="#GlobalToLexical"><b>Global To Lexical</b></a></b> </li><li> <a href="#EvalToClosure"><b></b></a><b><a href="#EvalToClosure"><b>Eval To Closure</b></a></b> </li><li> <a href="#TooManyVariables"><b></b></a><b><a href="#TooManyVariables"><b>Too Many Variables</b></a></b> </li><li> <a href="#TooManyArguments"><b></b></a><b><a href="#TooManyArguments"><b>Too Many Arguments</b></a></b> </li><li> <a href="#MoveLargeDatastructuresToContainers"><b></b></a><b><a href="#MoveLargeDatastructuresToContainers"><b>Move Large Datastructures To Containers</b></a></b> </li><li> <a href="#MoveCollectionsOfFunctionsToObjects"><b></b></a><b><a href="#MoveCollectionsOfFunctionsToObjects"><b>Move Collections Of Functions To Objects</b></a></b> </li><li> <a href="#SuperClassAbstraction"><b></b></a><b><a href="#SuperClassAbstraction"><b>Super Class Abstraction</b></a></b> </li><li> <a href="#ThinWrappers"><b></b></a><b><a href="#ThinWrappers"><b>Thin Wrappers</b></a></b> </li><li> <a href="#IntroduceNullObject"><b></b></a><b><a href="#IntroduceNullObject"><b>Introduce Null Object</b></a></b> </li><li> <a href="#AbstractRootClasses"><b></b></a><b><a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a></b> </li><li> <a href="#BiDirectionalRelationshipToUnidirectional"><b></b></a><b><a href="#BiDirectionalRelationshipToUnidirectional"><b>Bi Directional Relationship To Unidirectional</b></a></b> 
<br><br>
 <font size="+2"><b>Concepts</b></font><br><br></li><li> <a href="#LooseCoupling"><b></b></a><b><a href="#LooseCoupling"><b>Loose Coupling</b></a></b> </li><li> <a href="#TypeSafety"><b></b></a><b><a href="#TypeSafety"><b>Type Safety</b></a></b> </li><li> <a href="#DesignContract"><b></b></a><b><a href="#DesignContract"><b>Design Contract</b></a></b> </li><li> <a href="#LayeringPattern"><b></b></a><b><a href="#LayeringPattern"><b>Layering Pattern</b></a></b> </li><li> <a href="#FunctionalProgramming"><b></b></a><b><a href="#FunctionalProgramming"><b>Functional Programming</b></a></b> </li><li> <a href="#LazyEvaluation"><b></b></a><b><a href="#LazyEvaluation"><b>Lazy Evaluation</b></a></b> </li><li> <a href="#CurryingConcept"><b></b></a><b><a href="#CurryingConcept"><b>Currying Concept</b></a></b> </li><li> <a href="#ManyToManyRelationship"><b></b></a><b><a href="#ManyToManyRelationship"><b>Many To Many Relationship</b></a></b> </li><li> <a href="#LawOfDemeter"><b></b></a><b><a href="#LawOfDemeter"><b>Law Of Demeter</b></a></b> </li><li> <a href="#LiterateProgramming"><b></b></a><b><a href="#LiterateProgramming"><b>Literate Programming</b></a></b> 
<br><br>
 <font size="+2"><b>Appendices</b></font><br><br></li><li> <a href="#OtherStructuredSystems"><b></b></a><b><a href="#OtherStructuredSystems"><b>Other Structured Systems</b></a></b> </li><li> <a href="#DebuggingPattern"><b></b></a><b><a href="#DebuggingPattern"><b>Debugging Pattern</b></a></b> </li><li> <a href="#SelectCPANModules"><b></b></a><b><a href="#SelectCPANModules"><b>Select CPANModules</b></a></b> </li><li> <a href="#HowDoesPerlStackUp"><b></b></a><b><a href="#HowDoesPerlStackUp"><b>How Does Perl Stack Up</b></a></b> </li><li> <a href="#PerlDoc"><b></b></a><b><a href="#PerlDoc"><b>Perl Doc</b></a></b> </li><li> <a href="#DocBook"><b></b></a><b><a href="#DocBook"><b>Doc Book</b></a></b> </li><li> <a href="#CvsQuickRef"><b></b></a><b><a href="#CvsQuickRef"><b>Cvs Quick Ref</b></a></b> </li><li> <a href="#ClassNaming"><b></b></a><b><a href="#ClassNaming"><b>Class Naming</b></a></b> </li><li> <a href="#ReferencesMeta"><b></b></a><b><a href="#ReferencesMeta"><b>References Meta</b></a></b> </li><li> <a href="#CreatingCPANModules"><b></b></a><b><a href="#CreatingCPANModules"><b>Creating CPANModules</b></a></b> </li><li> <a href="#PlanToThrowOneAway"><b></b></a><b><a href="#PlanToThrowOneAway"><b>Plan To Throw One Away</b></a></b> </li><li> <a href="#HowPerlDiffersFromC"><b></b></a><b><a href="#HowPerlDiffersFromC"><b>How Perl Differs From C</b></a></b> 
<br><br>
 <font size="+2"><b>Meta</b></font><br><br></li><li> <a href="#PerlPatternsResources"><b></b></a><b><a href="#PerlPatternsResources"><b>Perl Patterns Resources</b></a></b> </li><li> <a href="#ReferencesMeta"><b></b></a><b><a href="#ReferencesMeta"><b>References Meta</b></a></b> </li><li> <a href="#GuestLog"><b></b></a><b><a href="#GuestLog"><b>Guest Log</b></a></b> </li><li> <a href="#AboutPerlPatternsProject"><b></b></a><b><a href="#AboutPerlPatternsProject"><b>About Perl Patterns Project</b></a></b> </li><li> <a href="#YetAnotherIntroduction"><b></b></a><b><a href="#YetAnotherIntroduction"><b>Yet Another Introduction</b></a></b> </li><li> <a href="#AboutTheAuthor"><b></b></a><b><a href="#AboutTheAuthor"><b>About The Author</b></a></b> 
<br><br>
 All content on this server is copyright 2002, 2003 by <a href="#ScottWalters"><b></b></a><b><a href="#ScottWalters"><b>Scott Walters</b></a></b>,
unless otherwise noted. Content credited otherwise is copyright its
original author and has been generously made available by them under
the same terms as the rest of the project, the <a href="#GnuFreeDocumentationLicense"><b></b></a><b><a href="#GnuFreeDocumentationLicense"><b>Gnu Free Documentation License</b></a></b>. Member of <a href="#CategoryBook"><b></b></a><b><a href="#CategoryBook"><b>Category Book</b></a></b>. 
<br><br>
 <img src="perldesignpatterns-Dateien/counter.gif"> hits since Wed Oct 9 00:20:05 PDT 2002 
<br><br>
 <!-- no user comments --> 
<br><br>
 $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Id&amp;word=%20%3Ca">Id: </a><a></a> href="#PerlDesignPatterns"&gt;<b><a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a></b>,v 1.264 2003/08/26 18:14:29 phaedrus Exp $ 
<br><br>
 External Pages Linking to This Page - this is generated automatically - thanks to everyone linking here: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b><a href="#PagesLinkingHere"><b>Pages Linking Here</b></a></b></a> --> </li><li> <a href="http://c2.com/cgi-bin/wiki?PerlPatternsRepository">http://c2.com/cgi-bin/wiki?PerlPatternsRepository</a> </li><li> <a href="http://www.livejournal.com/community/edinburgers/friends?skip=25">http://www.livejournal.com/community/edinburgers/friends?skip=25</a> </li><li> <a href="http://c2.com/cgi/wiki?PerlPatternsRepository">http://c2.com/cgi/wiki?PerlPatternsRepository</a> </li><li> <a href="http://c2.com/cgi/wiki?PerlDesignPatterns">http://c2.com/cgi/wiki?PerlDesignPatterns</a> </li><li> <a href="http://skx.livejournal.com/">http://skx.livejournal.com/</a> </li><li> <a href="http://www.usemod.com/cgi-bin/mb.pl?PerlDesignPatterns">http://www.usemod.com/cgi-bin/mb.pl?PerlDesignPatterns</a> </li><li> <a href="http://www.mg2.org/jive/thread.jsp?forum=2&amp;thread=1294&amp;tstart=0&amp;trange=15">http://www.mg2.org/jive/thread.jsp?forum=2&amp;thread=1294&amp;tstart=0&amp;trange=15</a> </li><li> <a href="http://c2.com/cgi/wiki/wiki?PerlPatternsRepository">http://c2.com/cgi/wiki/wiki?PerlPatternsRepository</a> </li><li> <a href="http://www.intasysbilling.com/%7Esproctor/">http://www.intasysbilling.com/~sproctor/</a> </li><li> <a href="http://www.mg2.org/jive/thread.jsp?nav=false&amp;forum=2&amp;thread=1294&amp;start=0&amp;msRange=15">http://www.mg2.org/jive/thread.jsp?nav=false&amp;forum=2&amp;thread=1294&amp;start=0&amp;msRange=15</a> </li><li> <a href="http://triaez.kaisei.org/%7Ekaoru/diary/">http://triaez.kaisei.org/~kaoru/diary/</a> </li><li> <a href="http://www.livejournal.com/users/skx/">http://www.livejournal.com/users/skx/</a> </li><li> <a href="http://www.c2.com/cgi/wiki?PerlPatternsRepository">http://www.c2.com/cgi/wiki?PerlPatternsRepository</a> </li><li> <a href="http://savannah.nongnu.org/projects/perlpatbook/">http://savannah.nongnu.org/projects/perlpatbook/</a> </li><li> <a href="http://use.perl.org/%7Eziggy/journal/6988">http://use.perl.org/~ziggy/journal/6988</a> </li><li> <a href="http://www.zanthan.com/itymbi/">http://www.zanthan.com/itymbi/</a> </li><li> <a href="http://www.zanthan.com/itymbi/archives/000997.html">http://www.zanthan.com/itymbi/archives/000997.html</a> </li><li> <a href="http://www.zanthan.com/itymbi/archives/000587.html">http://www.zanthan.com/itymbi/archives/000587.html</a> </li><li> <a href="http://banjo.actrix.com/blog/index.html">http://banjo.actrix.com/blog/index.html</a> </li><li> <a href="http://banjo.actrix.com/blog/">http://banjo.actrix.com/blog/</a> </li><li> <a href="http://www.slowass.net/phaedrus/">http://www.slowass.net/phaedrus/</a> </li><li> <a href="http://savannah.nongnu.org/projects/perlpatbook">http://savannah.nongnu.org/projects/perlpatbook</a> </li><li> <a href="http://www.freeml.com/message/patterns@freeml.com/0002153;jsessionid=gi7p8hr9b1">http://www.freeml.com/message/patterns@freeml.com/0002153;jsessionid=gi7p8hr9b1</a> </li><li> <a href="http://mail.gnu.org/archive/html/savannah-hackers/2002-09/msg00874.html">http://mail.gnu.org/archive/html/savannah-hackers/2002-09/msg00874.html</a> </li><li> <a href="http://www.prefnews.ru/">http://www.prefnews.ru/</a> </li><li> <a href="http://savannah.nongnu.org/people/?group=perlpatbook">http://savannah.nongnu.org/people/?group=perlpatbook</a> </li><li> <a href="http://www.livejournal.com/users/skx/?skip=50">http://www.livejournal.com/users/skx/?skip=50</a> </li><li> <a href="http://www.nedbatchelder.com/blog/200303.html">http://www.nedbatchelder.com/blog/200303.html</a> </li><li> <a href="http://www.nedbatchelder.com/blog/index.html">http://www.nedbatchelder.com/blog/index.html</a> </li><li> <a href="http://www.nedbatchelder.com/blog/">http://www.nedbatchelder.com/blog/</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=170442">http://perlmonks.org/index.pl?node_id=170442</a> </li><li> <a href="http://perlmonks.org/index.pl">http://perlmonks.org/index.pl</a> </li><li> <a href="http://slashdot.org/comments.pl">http://slashdot.org/comments.pl</a> </li><li> <a href="http://www.nedbatchelder.com/blog/200303.html#e20030325T085634">http://www.nedbatchelder.com/blog/200303.html#e20030325T085634</a> </li><li> <a href="http://slashdot.org/comments.pl?sid=58824&amp;threshold=1&amp;commentsort=0&amp;mode=thread&amp;pid=5618273">http://slashdot.org/comments.pl?sid=58824&amp;threshold=1&amp;commentsort=0&amp;mode=thread&amp;pid=5618273</a> </li><li> <a href="http://slashdot.org/pollBooth.pl?qid=946&amp;aid=-1">http://slashdot.org/pollBooth.pl?qid=946&amp;aid=-1</a> </li><li> <a href="http://www.nedbatchelder.com/blog/200303.html#e20030326T071249">http://www.nedbatchelder.com/blog/200303.html#e20030326T071249</a> </li><li> <a href="http://prefnews.ru/?page=calendar&amp;year=2002&amp;month=12">http://prefnews.ru/?page=calendar&amp;year=2002&amp;month=12</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=197321">http://www.perlmonks.org/index.pl?node_id=197321</a> </li><li> <a href="http://savannah.nongnu.org/people/viewjob.php?group_id=3029&amp;job_id=134">http://savannah.nongnu.org/people/viewjob.php?group_id=3029&amp;job_id=134</a> </li><li> <a href="http://www.mg2.org/jive/thread.jsp?forum=2&amp;thread=1294">http://www.mg2.org/jive/thread.jsp?forum=2&amp;thread=1294</a> </li><li> <a href="http://www.mcs.csuhayward.edu/%7Ebillard/6140.html">http://www.mcs.csuhayward.edu/~billard/6140.html</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node=jdporter">http://www.perlmonks.org/index.pl?node=jdporter</a> </li><li> <a href="http://www.t3.rim.or.jp/%7Eraeva/diary/">http://www.t3.rim.or.jp/~raeva/diary/</a> </li><li> <a href="http://skuchero-pc.us.oracle.com/cgi-bin/wiki.pl?WikiLinks">http://skuchero-pc.us.oracle.com/cgi-bin/wiki.pl?WikiLinks</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=170442">http://www.perlmonks.com/index.pl?node_id=170442</a> </li><li> <a href="http://www.c2.com/cgi/wiki/?PerlPatternsRepository">http://www.c2.com/cgi/wiki/?PerlPatternsRepository</a> </li><li> <a href="http://skuchero-pc.us.oracle.com/cgi-bin/wiki.pl?Tools_And_Languages">http://skuchero-pc.us.oracle.com/cgi-bin/wiki.pl?Tools_And_Languages</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=256739">http://www.perlmonks.org/index.pl?node_id=256739</a> </li><li> <a href="http://www.perlmonks.org/index.pl">http://www.perlmonks.org/index.pl</a> </li><li> <a href="http://www.jbisbee.com/files/bookmarks.html">http://www.jbisbee.com/files/bookmarks.html</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=197321">http://www.perlmonks.com/index.pl?node_id=197321</a> - <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=crouchingpenguin">PerlMonks:crouchingpenguin</a> </li><li> <a href="http://rakunet.org/TSNET/pukiwiki/?Perl%2FObject-PerlDesignPatterns">http://rakunet.org/TSNET/pukiwiki/?Perl%2FObject-PerlDesignPatterns</a> </li><li> <a href="http://www.perldesignpatterns.com/">http://www.perldesignpatterns.com</a> </li><li> <a href="http://www.worldwidewiki.net/wiki/OneBigWiki">http://www.worldwidewiki.net/wiki/OneBigWiki</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=170442">http://www.perlmonks.org/index.pl?node_id=170442</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node=crouchingpenguin">http://www.perlmonks.com/index.pl?node=crouchingpenguin</a> </li><li> <a href="http://www.jsw4.net/info/list-archives/cgiapp/03-05/msg00043.html">http://www.jsw4.net/info/list-archives/cgiapp/03-05/msg00043.html</a> </li><li> <a href="http://safari.oreilly.com/?x=1&amp;mode=section&amp;sortKey=title&amp;sortOrder=asc&amp;view=&amp;xmlid=1-56592-699-4&amp;open=true&amp;catid=itbooks.prog.perl&amp;s=1&amp;b=1&amp;f=1&amp;t=0&amp;c=1&amp;u=1&amp;r=&amp;o=1&amp;page=2">http://safari.oreilly.com/?x=1&amp;mode=section&amp;sortKey=title&amp;sortOrder=asc&amp;view=&amp;xmlid=1-56592-699-4&amp;open=true&amp;catid=itbooks.prog.perl&amp;s=1&amp;b=1&amp;f=1&amp;t=0&amp;c=1&amp;u=1&amp;r=&amp;o=1&amp;page=2</a> </li><li> <a href="http://perldesignpatterns.com/">http://perldesignpatterns.com</a> </li><li> <a href="http://wiki.slowass.net/">http://wiki.slowass.net</a> </li><li> <a href="http://www.worldwidewiki.net/wiki/OneBigWikiAlphabeticalIndexP/diff?a=1237&amp;b=1030">http://www.worldwidewiki.net/wiki/OneBigWikiAlphabeticalIndexP/diff?a=1237&amp;b=1030</a> </li><li> <a href="http://prefnews.ru:10000/?page=calendar&amp;year=2002&amp;month=12">http://prefnews.ru:10000/?page=calendar&amp;year=2002&amp;month=12</a> </li><li> <a href="http://www.usemod.com/cgi-bin/mb.pl?action=links&amp;url=1">http://www.usemod.com/cgi-bin/mb.pl?action=links&amp;url=1</a> </li><li> <a href="http://www.diariolinux.com/bienvenidos.php">http://www.diariolinux.com/bienvenidos.php</a> </li><li> <a href="http://diariolinux.com/bienvenidos.php">http://diariolinux.com/bienvenidos.php</a> </li><li> <a href="http://www.jhorman.org/">http://www.jhorman.org/</a> </li><li> <a href="http://maracaibo.linux.org.ve/index.php">http://maracaibo.linux.org.ve/index.php</a> </li><li> <a href="http://www.diariolinux.com/articulos.php?idnodo=127&amp;nodo=Perl&amp;PHPSESSID=4af4d242c6d229990c74eef41170c94b">http://www.diariolinux.com/articulos.php?idnodo=127&amp;nodo=Perl&amp;PHPSESSID=4af4d242c6d229990c74eef41170c94b</a> </li><li> <a href="http://www.worldwidewiki.net/wiki/OneBigWikiAlphabeticalIndexP">http://www.worldwidewiki.net/wiki/OneBigWikiAlphabeticalIndexP</a> </li><li> <a href="http://mcbo.linux.org.ve/index.php">http://mcbo.linux.org.ve/index.php</a> </li><li> <a href="http://maracaibo.linux.org.ve/modules.php?op=modload&amp;name=News&amp;file=article&amp;sid=150&amp;mode=thread&amp;order=0&amp;thold=0">http://maracaibo.linux.org.ve/modules.php?op=modload&amp;name=News&amp;file=article&amp;sid=150&amp;mode=thread&amp;order=0&amp;thold=0</a> </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/Farm/NewInterWiki">http://twiki.med.yale.edu/twiki2/bin/view/Farm/NewInterWiki</a> </li><li> <a href="http://use.perl.org/%7ETeeJay/journal/9036">http://use.perl.org/~TeeJay/journal/9036</a> </li><li> <a href="http://students.csci.unt.edu/%7Eboddupal/Links.html">http://students.csci.unt.edu/~boddupal/Links.html</a> </li><li> <a href="http://oregonstate.edu/cws/morgamic/">http://oregonstate.edu/cws/morgamic/</a> </li><li> <a href="http://c2.com/cgi-bin/wiki?PerlDesignPatterns">http://c2.com/cgi-bin/wiki?PerlDesignPatterns</a> </li><li> <a href="http://mcbo.linux.org.ve/print.php?sid=150">http://mcbo.linux.org.ve/print.php?sid=150</a> </li><li> <a href="http://akinafreak.zive.net/roller/page/moviefreak?catname=Programming">http://akinafreak.zive.net/roller/page/moviefreak?catname=Programming</a> </li><li> <a href="http://akinafreak.zive.net/roller/comments/moviefreak?anchor=20030725">http://akinafreak.zive.net/roller/comments/moviefreak?anchor=20030725</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node=jdporter&amp;go_button=Search">http://www.perlmonks.org/index.pl?node=jdporter&amp;go_button=Search</a> </li><li> <a href="http://kalug.linux.org.tw/%7Echihchun/Lab/index.php/DesignPatterns">http://kalug.linux.org.tw/~chihchun/Lab/index.php/DesignPatterns</a> </li><li> <a href="http://c2.com/cgi/wiki?ScottWalters">http://c2.com/cgi/wiki?ScottWalters</a> </li><li> <a href="http://akinafreak.zive.net/cgi-bin/namazu/roller/20030723.html">http://akinafreak.zive.net/cgi-bin/namazu/roller/20030723.html</a> </li><li> <a href="http://savannah.nongnu.org/project/memberlist.php?group=perlpatbook">http://savannah.nongnu.org/project/memberlist.php?group=perlpatbook</a> </li><li> <a href="http://www.zanthan.com/itymbi/archives/2003_03.html">http://www.zanthan.com/itymbi/archives/2003_03.html</a> </li><li> <a href="http://akinafreak.zive.net/roller/page/moviefreak/20030723">http://akinafreak.zive.net/roller/page/moviefreak/20030723</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=197321">http://perlmonks.org/index.pl?node_id=197321</a> </li><li> <a href="http://matthew.cavalletto.org/perldesignpaterns/assemble.cgi?FacadePattern">http://matthew.cavalletto.org/perldesignpaterns/assemble.cgi?FacadePattern</a> </li><li> <a href="http://www.diariolinux.com/articulos.php?idnodo=127&amp;nodo=Perl">http://www.diariolinux.com/articulos.php?idnodo=127&amp;nodo=Perl</a> 
<br><br>
 <br><br> <a name="HomePage"></a><h2><a href="#HomePage"><b>Home Page</b></a></h2><br> 
<br><br>
 Welcome the <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> repository! 
<br><br>
 Here, CPAN's Object::<a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> is crafted by you and me. <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> is a free online book, forum, and documentation project at <a href="http://savannah.nongnu.org/projects/perlpatbook/">http://savannah.nongnu.org/projects/perlpatbook/</a>. 
<br><br>
 <font size="+2"><b>FAQ</b></font><br><br></li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=assemble.cgi?PerlDesignPatterns">TinyCGI:assemble.cgi?PerlDesignPatterns</a> is the book version of the site - <i>use this to download everything</i> </li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> is the table of contents </li><li> <a href="#AboutPerlPatternsProject"><b>About Perl Patterns Project</b></a> has background on the project </li><li> <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> is this forum software </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=recent.cgi">TinyCGI:recent.cgi</a> is the heart beat monitor if you're wondering if this site is dead or what is new </li><li> <a href="http://www.perldesignpatterns.com/?CategoryCategory">Category Category</a> has a list of indices into the site </li><li> <a href="#PerlPatternsResources"><b>Perl Patterns Resources</b></a> - links to other pattern sites, people, and cool stuff </li><li> <a href="#ScottWalters"><b>Scott Walters</b></a> is the primary author to date - don't hesitate to email me </li><li> <a href="http://www.perldesignpatterns.com/?SimonCavalletto">Simon Cavalletto</a> is polishing my incoherent babble and did the new header and footer too 
<br><br>
 <font size="+2"><b>News</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CommentsHelp">Comments Help</a> - pages are now open to comments and discussion </li><li> <a href="http://www.perldesignpatterns.com/?PatternIndex">Pattern Index</a> - brief synopsis (or problem statement) from each pattern in the table of contents </li><li> Visual renderings of the site structure using <a href="http://www.perldesignpatterns.com/?VisualizationCompilerGraphs">Visualization Compiler Graphs</a>,  available at <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=pdp1.gif">TinyCGI:pdp1.gif</a> (445k) and <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=pdp2.png">TinyCGI:pdp2.png</a> (11k), <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=pdp3.png">TinyCGI:pdp3.png</a> (114k), just for fun. </li><li> <a href="http://www.perldesignpatterns.com/?RateThisPage">Rate This Page</a> has the results of the new, little survey on the bottom of each page. </li><li> <a href="http://www.perldesignpatterns.com/">http://www.perldesignpatterns.com</a> was purchased for this project and now links here. Yay! 
<br><br>
 <font size="+2"><b>Download</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/perldesignpatterns.html">http://www.perldesignpatterns.com/perldesignpatterns.html</a> - 600K - HTML version of the book ["The book" is the <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> page, and everything it directly links to, except for <a href="#ScottWalters"><b>Scott Walters</b></a> and <a href="#GuestLog"><b>Guest Log</b></a>. There are many other pages in the system that are either not finished (see <a href="http://www.perldesignpatterns.com/?PerlPatternsToDo">Perl Patterns To Do</a>)
or not on-topic to the book. assemble.cgi creates documents]. To save
my poor machine from CGI death, link to here if you're a high-volume
site. </li><li> Object::<a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> - the last release version - always slightly out  of date - different server. High volume sites: link here too. </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=assemble.cgi?PerlDesignPatterns">TinyCGI:assemble.cgi?PerlDesignPatterns</a> - 600K - up to the minute snapshot.  </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=download.cgi">TinyCGI:download.cgi</a> - all source files, related or not, in ASCII, and scripts  listed at <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a>. In other words, everything. Up to the second. If it fails or is huge, just get <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=pdp.wiki.tgz">TinyCGI:pdp.wiki.tgz</a> - a snapshot of it. <i>Not</i> an easy way to read through, but if you want aboslutely everything, this  is the way.  <b>Wget users</b> - do this instead, or most pages will be thttpd throttle messages and Wget will run forever! 
<br><br>
 <font size="+2"><b>Development and Forum</b></font><br><br>Browsing the Wiki confuses mere mortals. Grab <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=perldesignpatterns.html">TinyCGI:perldesignpatterns.html</a>  instead for casual reading. 
<br><br>
 </li><li> <a href="#GuestLog"><b>Guest Log</b></a> - your feedback helps me help you, or just say "hi" </li><li> <a href="#AboutPerlPatternsProject"><b>About Perl Patterns Project</b></a> - background information </li><li> <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> - this forum software </li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> - browse the Wiki to collaborate </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=recent.cgi">TinyCGI:recent.cgi</a> - recently edited files 
<br><br>
 <font size="+2"><b>Also Also Wik</b></font><br><br>"We are
now the Knights who say ... Wiki wiki wiki wiki, bih-kang, zoop-boing,
zowenzum" - I've been _dying_ to say that ;) - Kurt quoting <a href="http://www.perldesignpatterns.com/?MontyPython">Monty Python</a> 
<br><br>
 <font size="+2"><b>What in the Heck?</b></font><br><br>There is no master site map: this site is itself a web. Some recommeneded starting points are: <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a>, <a href="http://www.perldesignpatterns.com/?SkipTheIntroduction">Skip The Introduction</a>, <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a>, <a href="#CategoryBook"><b>Category Book</b></a>, <a href="http://www.perldesignpatterns.com/?CategoryConcept">Category Concept</a>, <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a>, <a href="http://www.perldesignpatterns.com/?CategoryWiki">Category Wiki</a>,  <a href="#PerlPatternsResources"><b>Perl Patterns Resources</b></a>. 
<br><br> Why are all the words of all of the links run together?
Because thats how you make links! Words written this way get turned
into links. Linking to an unknown page creates a new page. See <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> for a jumpstart. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?WardCunningham">Ward Cunningham</a> started this madness with his original <a href="http://www.perldesignpatterns.com/?WikiWiki">Wiki Wiki</a> at <a href="http://c2.com/">http://c2.com</a>. 
<br><br> Feel free to edit pages to make corrections, improvements,
editorial comments, ask questions, and so on. Someone will see your
changes in <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=recent.cgi">TinyCGI:recent.cgi</a> and answer your questions or touch up your work. 
<br><br>
 Wikis exist to discuss all topics: see <a href="http://www.perldesignpatterns.com/?CategoryWiki">Category Wiki</a> for a few others.  This site is a tool for collaboration on the <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a>
project. Discussion of Wiki technology, Perl, OO programming in
general, language theory, are on topic. You're encouraged to make a
page named after yourself (for example, <a href="#ScottWalters"><b>Scott Walters</b></a> is mine) and  link to it off the <a href="#GuestLog"><b>Guest Log</b></a> - your <a href="http://www.perldesignpatterns.com/?PersonalPage">Personal Page</a> need not be on topic. Off topic text not on your <a href="http://www.perldesignpatterns.com/?PersonalPage">Personal Page</a> is likely to be moved there or pruned, not because we don't think it's funny, merely because focus is important. See <a href="http://www.perldesignpatterns.com/?HowToWrite">How To Write</a>. 
<br><br>
 <pre>  Have Fun!
  - <a href="#ScottWalters"><b>Scott Walters</b></a> </pre>
<br><br>
 $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Id&amp;word=%20HomePage,v">Id: HomePage,v</a> 1.263 2003/08/30 14:23:08 httpd Exp $ 
<br><br>
 Pages Linking to This Page - automatically generated: 
<br><br>
 <!-- cut here - do not remove this comment --> </li><li> <a href="http://www.slowass.net/wiki2/?PerlDesignPatterns">http://www.slowass.net/wiki2/?PerlDesignPatterns</a> </li><li> <a href="http://www.usemod.com/cgi-bin/mb.pl?ActiveWikiPages">http://www.usemod.com/cgi-bin/mb.pl?ActiveWikiPages</a> </li><li> <a href="http://www.usemod.com/cgi-bin/mb2.pl?PublicallyEditableInterMap">http://www.usemod.com/cgi-bin/mb2.pl?PublicallyEditableInterMap</a> </li><li> <a href="http://www.usemod.com/cgi-bin/mb2.pl?ActiveWikiPages">http://www.usemod.com/cgi-bin/mb2.pl?ActiveWikiPages</a> </li><li> <a href="http://www.slowass.net/phaedrus/">http://www.slowass.net/phaedrus/</a> </li><li> <a href="http://www.slowass.net/">http://www.slowass.net/</a> </li><li> <a href="http://search.cpan.org/author/SWALTERS/interface-0.01/interface.pm">http://search.cpan.org/author/SWALTERS/interface-0.01/interface.pm</a> </li><li> <a href="http://www.seedwiki.com/page.cfm?doc=tinywiki&amp;wikiid=1723&amp;wpid=">http://www.seedwiki.com/page.cfm?doc=tinywiki&amp;wikiid=1723&amp;wpid=</a> </li><li> <a href="http://usemod.com/cgi-bin/mb.pl?ActiveWikiPages">http://usemod.com/cgi-bin/mb.pl?ActiveWikiPages</a> </li><li> <a href="http://www.exiledplanet.org/articles/200.shtml">http://www.exiledplanet.org/articles/200.shtml</a> </li><li> <a href="http://search.yahoo.com/bin/search?p=SLOWASS">http://search.yahoo.com/bin/search?p=SLOWASS</a> </li><li> <a href="http://www.csc.uvic.ca/%7Ecsunion/index.cgi?ExecWikiInstructions">http://www.csc.uvic.ca/~csunion/index.cgi?ExecWikiInstructions</a> </li><li> <a href="http://ipaterson.ca/wiki/assemble.cgi?TinyWiki">http://ipaterson.ca/wiki/assemble.cgi?TinyWiki</a> </li><li> <a href="http://phoenix.pm.org/wiki/?PerlProjects">http://phoenix.pm.org/wiki/?PerlProjects</a> </li><li> <a href="http://www.sowjet.org/plus/parse.pl?file=BasicIdea.D">http://www.sowjet.org/plus/parse.pl?file=BasicIdea.D</a> </li><li> <a href="http://phoenix.pm.org/wiki/assemble.cgi?PerlProjects">http://phoenix.pm.org/wiki/assemble.cgi?PerlProjects</a> </li><li> <a href="http://ipaterson.ca/wiki/assemble.cgi?HomePage">http://ipaterson.ca/wiki/assemble.cgi?HomePage</a> </li><li> <a href="http://www.google.com/search?hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;q=wiki+and+.net">http://www.google.com/search?hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;q=wiki+and+.net</a> </li><li> <a href="http://www.tocc.co.jp/search/servlet/SearchServlet?QRY=fatal+++++could+not+creative+socket%21+&amp;CCM=M%3AW&amp;NRS=10&amp;UNI=HST&amp;UD0=SMP&amp;FRS=10">http://www.tocc.co.jp/search/servlet/SearchServlet?QRY=fatal+++++could+not+creative+socket%21+&amp;CCM=M%3AW&amp;NRS=10&amp;UNI=HST&amp;UD0=SMP&amp;FRS=10</a> </li><li> <a href="http://www.sowjet.org/plus/parse.pl?file=BasicIdea.E">http://www.sowjet.org/plus/parse.pl?file=BasicIdea.E</a> </li><li> <a href="http://use.perl.org/comments.pl">http://use.perl.org/comments.pl</a> </li><li> <a href="http://www.google.fr/search?q=wiki+perl+improvements&amp;hl=fr&amp;ie=UTF-8&amp;oe=UTF-8">http://www.google.fr/search?q=wiki+perl+improvements&amp;hl=fr&amp;ie=UTF-8&amp;oe=UTF-8</a> </li><li> <a href="http://mirrors.develooper.com/perl/backup.pause/authors/id/S/SW/SWALTERS/Perl_Design_Patterns_book_20021008.html">http://mirrors.develooper.com/perl/backup.pause/authors/id/S/SW/SWALTERS/Perl_Design_Patterns_book_20021008.html</a> </li><li> <a href="http://jaramir.twilightparadox.com/cgi-bin/wiki.cgi?TinyWiki">http://jaramir.twilightparadox.com/cgi-bin/wiki.cgi?TinyWiki</a> </li><li> <a href="http://www.whois.net/search.cgi2?str=designpattern.com">http://www.whois.net/search.cgi2?str=designpattern.com</a> </li><li> <a href="http://jaramir.twilightparadox.com/cgi-bin/wiki.cgi?ScottWalters">http://jaramir.twilightparadox.com/cgi-bin/wiki.cgi?ScottWalters</a> </li><li> <a href="http://resin.csoft.net/%7Emch/wiki/index.cgi?TinyWiki">http://resin.csoft.net/~mch/wiki/index.cgi?TinyWiki</a> </li><li> <a href="http://tp001/cgi-bin/wiki.pl?VjPage">http://tp001/cgi-bin/wiki.pl?VjPage</a>
- We sure are popular with the Intranets! Don't forget to vote for your
favorite and least favorite pages, corporate Intranet users =) </li><li> <a href="http://www.perlmonks.org/index.pl?node=scrottie">http://www.perlmonks.org/index.pl?node=scrottie</a> </li><li> <a href="http://c2.com/cgi/wiki?WikiInterchangeFormat">http://c2.com/cgi/wiki?WikiInterchangeFormat</a> </li><li> <a href="http://www.patocarr.com/cgi-bin/pwiki.pl?HomePage">http://www.patocarr.com/cgi-bin/pwiki.pl?HomePage</a> </li><li> <a href="http://www.sowjet.org/%7Estats/usage_200305.html">http://www.sowjet.org/~stats/usage_200305.html</a> </li><li> <a href="http://slowass.net/">http://slowass.net/</a> </li><li> <a href="http://www.google.com/search?sourceid=navclient&amp;ie=UTF-8&amp;oe=UTF-8&amp;q=download+perl+wiki">http://www.google.com/search?sourceid=navclient&amp;ie=UTF-8&amp;oe=UTF-8&amp;q=download+perl+wiki</a> </li><li> <a href="http://www.petitiononline.com/mod_perl/signed.cgi?eldred&amp;1">http://www.petitiononline.com/mod_perl/signed.cgi?eldred&amp;1</a> </li><li> <a href="http://jaramir.wirewolf.org/cgi-bin/wiki.cgi?TinyWiki">http://jaramir.wirewolf.org/cgi-bin/wiki.cgi?TinyWiki</a> </li><li> <a href="http://lcgappdev/wiki/wiki.cgi?TinyWiki">http://lcgappdev/wiki/wiki.cgi?TinyWiki</a> </li><li> <a href="http://theone/cgi-bin/wiki.cgi?TinyWiki">http://theone/cgi-bin/wiki.cgi?TinyWiki</a> </li><li> <a href="http://www.petitiononline.com/mod_perl/signed.cgi?eldred&amp;6701">http://www.petitiononline.com/mod_perl/signed.cgi?eldred&amp;6701</a> </li><li> <a href="http://jaramir.wirewolf.org/cgi-bin/wiki.cgi?ScottWalters">http://jaramir.wirewolf.org/cgi-bin/wiki.cgi?ScottWalters</a> </li><li> <a href="http://www.vdomck.org/wiki/assemble.cgi?SandBox">http://www.vdomck.org/wiki/assemble.cgi?SandBox</a> </li><li> <a href="http://www.worldwidewiki.net/wiki/OneBigWiki">http://www.worldwidewiki.net/wiki/OneBigWiki</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=211039">http://www.perlmonks.org/index.pl?node_id=211039</a> </li><li> <a href="http://axxerve.com/kliki/">http://axxerve.com/kliki/</a> </li><li> <a href="http://larsen.perlmonk.org/cgi-bin/url.pl?mode=yesterday">http://larsen.perlmonk.org/cgi-bin/url.pl?mode=yesterday</a> </li><li> <a href="http://www.google.it/search?q=wiki+wiki+%2B+download&amp;hl=it&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;start=30&amp;sa=N">http://www.google.it/search?q=wiki+wiki+%2B+download&amp;hl=it&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;start=30&amp;sa=N</a> </li><li> <a href="http://www.google.com/search?q=perl+wiki">http://www.google.com/search?q=perl+wiki</a> </li><li> <a href="http://larsen.perlmonk.org/cgi-bin/url.pl?mode=week">http://larsen.perlmonk.org/cgi-bin/url.pl?mode=week</a> </li><li> <a href="http://larsen.perlmonk.org/cgi-bin/url.pl?mode=search&amp;pattern=pattern">http://larsen.perlmonk.org/cgi-bin/url.pl?mode=search&amp;pattern=pattern</a> </li><li> <a href="http://ask.slashdot.org/article.pl?sid=03/06/13/209208">http://ask.slashdot.org/article.pl?sid=03/06/13/209208</a> </li><li> <a href="http://slashdot.org/">http://slashdot.org/</a> </li><li> <a href="http://developers.slashdot.org/article.pl?sid=03/06/23/112212">http://developers.slashdot.org/article.pl?sid=03/06/23/112212</a> </li><li> <a href="http://www.worldwidewiki.net/wiki/OneBigWiki/referrers">http://www.worldwidewiki.net/wiki/OneBigWiki/referrers</a> </li><li> <a href="http://slashdot.org/index.pl?section=developers">http://slashdot.org/index.pl?section=developers</a> </li><li> <a href="http://ask.slashdot.org/article.pl?sid=03/06/13/209208&amp;mode=thread&amp;tid=126&amp;tid=95">http://ask.slashdot.org/article.pl?sid=03/06/13/209208&amp;mode=thread&amp;tid=126&amp;tid=95</a> </li><li> <a href="http://games.slashdot.org/article.pl?sid=03/06/23/112212">http://games.slashdot.org/article.pl?sid=03/06/23/112212</a> </li><li> <a href="http://slashdot.org/developers/">http://slashdot.org/developers/</a> </li><li> <a href="http://tp001/cgi-bin/wiki.pl?VjPage">http://tp001/cgi-bin/wiki.pl?VjPage</a> </li><li> <a href="http://www.freeroller.net/page/mschinc/Weblog">http://www.freeroller.net/page/mschinc/Weblog</a> </li><li> <a href="http://www.freeroller.net/page/mschinc/20030702">http://www.freeroller.net/page/mschinc/20030702</a> </li><li> <a href="http://search.yahoo.com/search?p=patterns+wiki&amp;vm=i&amp;n=20&amp;fl=0&amp;x=wrt">http://search.yahoo.com/search?p=patterns+wiki&amp;vm=i&amp;n=20&amp;fl=0&amp;x=wrt</a> </li><li> <a href="http://freeroller.net/page/mschinc/20030703#this_week_s_sign_of">http://freeroller.net/page/mschinc/20030703#this_week_s_sign_of</a> </li><li> <a href="http://blogs.javalobby.org/page/mschinc/">http://blogs.javalobby.org/page/mschinc/</a> </li><li> <a href="http://www.freeroller.net/page/mschinc">http://www.freeroller.net/page/mschinc</a> </li><li> <a href="http://news.morat.net/">http://news.morat.net/</a> </li><li> <a href="http://www.freeroller.net/referers.do?rmik=Referers&amp;username=mschinc">http://www.freeroller.net/referers.do?rmik=Referers&amp;username=mschinc</a> </li><li> <a href="http://www.perlmonks.org/index.pl">http://www.perlmonks.org/index.pl</a> </li><li> <a href="http://perlmonks.org/index.pl?node=Perl%20Monks%20Discussion">http://perlmonks.org/index.pl?node=Perl%20Monks%20Discussion</a> </li><li> <a href="http://www.robertbrook.com/">http://www.robertbrook.com</a> </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA">http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA</a> </li><li> <a href="http://freeroller.net/page/mschinc">http://freeroller.net/page/mschinc</a> </li><li> <a href="http://search.yahoo.com/bin/search?p=comments+on+poor+design+homepage&amp;ei=UTF-8">http://search.yahoo.com/bin/search?p=comments+on+poor+design+homepage&amp;ei=UTF-8</a> </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/PerlDesignPatterns">http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/PerlDesignPatterns</a> </li><li> <a href="http://www.freeroller.net/page/mschinc/20030708">http://www.freeroller.net/page/mschinc/20030708</a> </li><li> <a href="http://beetle/twiki/bin/view/Costel/SoftwareDevelopment">http://beetle/twiki/bin/view/Costel/SoftwareDevelopment</a> </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/Farm/FarmNews">http://twiki.med.yale.edu/twiki2/bin/view/Farm/FarmNews</a> </li><li> <a href="http://www.wholesale4.com/directory/">http://www.wholesale4.com/directory/</a> </li><li> <a href="http://www.robertbrook.com/">http://www.robertbrook.com/</a> </li><li> <a href="http://genetikayos.com/">http://genetikayos.com/</a> </li><li> <a href="http://www.freeroller.net/page/mschinc/20030711#off_to_the_great_white">http://www.freeroller.net/page/mschinc/20030711#off_to_the_great_white</a> </li><li> <a href="http://www.worldwidewiki.net/wiki/OneBigWikiAlphabeticalIndexT">http://www.worldwidewiki.net/wiki/OneBigWikiAlphabeticalIndexT</a> </li><li> <a href="http://www.worldwidewiki.net/wiki/OneBigWikiAlphabeticalIndexP">http://www.worldwidewiki.net/wiki/OneBigWikiAlphabeticalIndexP</a> </li><li> <a href="http://www.freeroller.net/page/mschinc/">http://www.freeroller.net/page/mschinc/</a> </li><li> <a href="http://www.alpage.org/index.zou?id_article=124">http://www.alpage.org/index.zou?id_article=124</a> </li><li> <a href="http://www.zone-h.org/en/defacements">http://www.zone-h.org/en/defacements</a> - see <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=diff.cgi?word=HomePage&amp;rev=224">TinyCGI:diff.cgi?word=HomePage&amp;rev=224</a> </li><li> <a href="http://www.zone-h.org/en/defacements/view/id=343771/">http://www.zone-h.org/en/defacements/view/id=343771/</a> </li><li> <a href="http://www.zone-h.com/en/defacements">http://www.zone-h.com/en/defacements</a> </li><li> <a href="http://www.zone-h.org/en/defacements/">http://www.zone-h.org/en/defacements/</a> </li><li> <a href="http://www.zone-h.org/en/defacements/filter/">http://www.zone-h.org/en/defacements/filter/</a> </li><li> <a href="http://dir.spylog.ru/redirect.phtml?cid=22866">http://dir.spylog.ru/redirect.phtml?cid=22866</a> </li><li> <a href="http://nus/index.zou?id_article=124">http://nus/index.zou?id_article=124</a> </li><li> <a href="http://scarecrow.fmrp.usp.br/%7Emavcunha/public/anti-patterns.php">http://scarecrow.fmrp.usp.br/~mavcunha/public/anti-patterns.php</a> </li><li> <a href="http://www.illogics.org/">http://www.illogics.org/</a> </li><li> <a href="http://abez.ca/%7Eabez/wiki/index.cgi?HowTheFuckDoIUseThis">http://abez.ca/~abez/wiki/index.cgi?HowTheFuckDoIUseThis</a> </li><li> <a href="http://www.freeroller.net/page/mschinc/20030722">http://www.freeroller.net/page/mschinc/20030722</a> </li><li> <a href="http://62.123.113.69/?TinyWiki">http://62.123.113.69/?TinyWiki</a> </li><li> <a href="http://www.bell-labs.com/cgi-user/OrgPatterns/OrgPatterns?RecentVisitors">http://www.bell-labs.com/cgi-user/OrgPatterns/OrgPatterns?RecentVisitors</a> </li><li> <a href="http://www.freeroller.net/page/mschinc/20030723">http://www.freeroller.net/page/mschinc/20030723</a> </li><li> <a href="http://larsen.perlmonk.org/webalizer/usage_200308.html">http://larsen.perlmonk.org/webalizer/usage_200308.html</a> </li><li> <a href="http://theone/?TinyWiki">http://theone/?TinyWiki</a> </li><li> <a href="http://alpage.org/index.zou?id_article=124">http://alpage.org/index.zou?id_article=124</a> </li><li> <a href="http://illogics.org/">http://illogics.org/</a> </li><li> <a href="http://c2.com/cgi-bin/wiki?WikiInterchangeFormat">http://c2.com/cgi-bin/wiki?WikiInterchangeFormat</a> </li><li> <a href="http://www.worldwidewiki.net/wiki/GuestBook/referrers_sites?global=1">http://www.worldwidewiki.net/wiki/GuestBook/referrers_sites?global=1</a> </li><li> <a href="http://tammouz/cgi-bin/list_sites.pl?host=designpatt">http://tammouz/cgi-bin/list_sites.pl?host=designpatt</a> </li><li> <a href="http://exchange-be1.lancs.local/exchange/norton/Inbox/RE:%20Perl%20design%20patterns.EML?Cmd=open">http://exchange-be1.lancs.local/exchange/norton/Inbox/RE:%20Perl%20design%20patterns.EML?Cmd=open</a> </li><li> <a href="http://www.illogics.org/">http://www.illogics.org</a> </li><li> <a href="http://deyja.sixbit.org/">http://deyja.sixbit.org/</a> </li><li> <a href="http://www.ventu.it/wiki.cgi?TinyWiki">http://www.ventu.it/wiki.cgi?TinyWiki</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=285065">http://www.perlmonks.org/index.pl?node_id=285065</a> </li><li> <a href="http://www.perlmonks.com/index.pl">http://www.perlmonks.com/index.pl</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=285065">http://www.perlmonks.com/index.pl?node_id=285065</a> </li><li> <a href="http://perlmonks.com/index.pl?node_id=285065">http://perlmonks.com/index.pl?node_id=285065</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=285065">http://perlmonks.org/index.pl?node_id=285065</a> </li><li> <a href="http://perlmonks.org/index.pl">http://perlmonks.org/index.pl</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=211039">http://www.perlmonks.com/index.pl?node_id=211039</a> </li><li> <a href="http://127.0.0.1:8080/index/outgoing/?sort=domain">http://127.0.0.1:8080/index/outgoing/?sort=domain</a> </li><li> <a href="http://jaramir.twilightparadox.com/?TinyWiki">http://jaramir.twilightparadox.com/?TinyWiki</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=265877">http://perlmonks.org/index.pl?node_id=265877</a> </li><li> <a href="http://www.perlmonks.org/index.pl?displaytype=raw&amp;node=showchatmessages">http://www.perlmonks.org/index.pl?displaytype=raw&amp;node=showchatmessages</a> </li><li> <a href="http://perlmonks.com/index.pl">http://perlmonks.com/index.pl</a> </li><li> <a href="http://www.freeroller.net/comments/mschinc?anchor=wiki_mining">http://www.freeroller.net/comments/mschinc?anchor=wiki_mining</a> </li><li> <a href="http://aschemann.net/gpw/orga/wiki/index.cgi?CfPextRefactoring">http://aschemann.net/gpw/orga/wiki/index.cgi?CfPextRefactoring</a> </li><li> <a href="http://theoryx5.uwinnipeg.ca/CPAN/data/Object-PerlDesignPatterns/PerlDesignPatterns.html">http://theoryx5.uwinnipeg.ca/CPAN/data/Object-PerlDesignPatterns/PerlDesignPatterns.html</a> 
<br><br>
 <br><br> <a name="SoftwareQualityLevels"></a><h2><a href="#SoftwareQualityLevels"><b>Software Quality Levels</b></a></h2><br> 
<br><br> Software, like all things, has quality. Which scenarios
describe the projects you've worked on? Which of these are familiar?
Which have you over come through experience? <br><br>
 1. Works when no one is watching 
<br><br>
 When the requirements are completely out of control, many programmers celebrate even having reached this point. 
<br><br>
 2. Works if you do it just right 
<br><br>
 Too many applications, most not written in Perl, make it to this point and stop cold. Forget reusable, this isn't even usable. 
<br><br>
 3. Trying most things once, it doesn't break 
<br><br>
 You may be tempted to give a software demo in front of a crowded auditorium at this point. Don't. 
<br><br>
 4. Other people tried it, and it seems to work 
<br><br> Software released to the community often starts at this point.
Before this point, there isn't enough benefit for it to be worthwhile
for them to fix your bugs. <br><br>
 5. Been in production for a while, and you're running out of bugs to fix 
<br><br> Most perl programs quickly shoot to level 5, and stop. Level 5
is a good level. Since its really about the users, not the developers,
Perl has traditionally been great for end users. <br><br>
 6. Other programmers are adding to it, so you made the code understandable 
<br><br>
 Other programs can incorporate this program into theirs, or vice versa, and benefit from your work. 
<br><br>
 7. A lot of people are working on it, so you made it modular and well laid out logically 
<br><br>
 Resistant to damage caused by new features, different requirements, and new programmers. In a lot of ways, like a Spider <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Plant&amp;word=%20fractal,">Plant: fractal,</a> prolific, and cute. 
<br><br>
 8. It has turned into a generic framework for doing things of this kind, and has been separated from early assumption 
<br><br>
 Different products that do the same thing but better are different, but are based on this class, can easily be created. 
<br><br>
 9. Hordes of the nit-pickiest people on the net have picked every last nit out of it 
<br><br>
 College classes are dedicated to exploring your code. Aspiring programmers marvel at the sheer beauty of it. 
<br><br> Most programmers are smart and hard working. Things go wrong
mysteriously. Changing requirements stress the design of a program. A
program at level 5 can quickly turn into a level 2 program, if people
start working on it who don't understand the entire design, or the
original design doesn't take into account the direction it takes into
the future and no one adapts the design. This is the primary reason to
shoot for a level 7 program. Having net-god status thrust upon you and
having to live up to it, or attempting to attain net-god status is the
primary reason to shoot for level 9. Of course, if the program is a few
lines long, none of this amounts to a hill of beans. <br><br>
 <i>Software does not wear out in the traditional sense of
machinery with moving parts. However, software is constantly being used
in ways its authors never expected (often uncovering errors), and end
users are constantly demanding extensions to their software. </i>- <a href="http://www.perldesignpatterns.com/?FredBrooks">Fred Brooks</a>, <a href="http://www.perldesignpatterns.com/?TheMythicalManMonth">The Mythical Man Month</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#YetAnotherIntroduction"><b>Yet Another Introduction</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AboutQuality">About Quality</a> </li><li> <a href="http://www.perldesignpatterns.com/?QualityPattern">Quality Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?SoftwareQuality">Software Quality</a> 
<br><br>
 <br><br> <a name="AboutObjects"></a><h2><a href="#AboutObjects"><b>About Objects</b></a></h2><br> 
<br><br>
 <i>That's about all there is to it. Now you need just to go
off and buy a book about object-oriented design methodology, and bang
your forehead with it for the next six months or so.</i> - <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlobj">PerlDoc:perlobj</a> 
<br><br>
 <i>Objects</i> allow arbitrary arrangements of useful logic.
This enables software to scale, exhibit flexibility within its
development cycle, and within the life on a single invocation.
Implementations of different facilities can be swapped out not only
during development, but while the program is running. <br><br>
 <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> [<a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
is contracted down to OO to avoid reptition induced boredom] Objects
don't help you finish a boring program quicker. They don't help much
with diddling with a bit of code until it works. They don't magically
make your programs maintainable and extensible. <br><br> Clearly, small scripts aren't the place for OO, and before
the code is even working isn't the time. Knowing when and how to use OO
means knowing how to benefit from it without it getting in the way. <br><br> OO, and this book, isn't about ruining Perl's simple type
system and throwing away Perl builtins and features in favor of
something from a far more boring, limited language. Contrary. Perl is
uniquely potent as an object language. At the same time, it introduces
new degenerate cases. Because Perl helps you get things done quicker,
you build larger programs faster, and design becomes important in less
time than in a boring language. Combining Perl's builtins, tieing,
lexicals, closures, and so on, all have places in design. Don't confuse
design with boring objects. <br><br> Conventional wisdom says that you can't graft objects onto
an existing design. Perhaps you're already a Perl fan because it lets
you break rules. This is one that needs breaking. In Perl, you can
indeed bless [<i>bless</i> is the Perl keyword that associates a datastructure with a class, or package.] an existing datastructure into object-hood.  
<br><br>
 Graphical User Interfaces [In particular, <a href="http://www.perldesignpatterns.com/?NeXT">Ne XT</a> Computer Company's <a href="http://www.perldesignpatterns.com/?NeXTView">Ne XTView</a>
desktop, as well as Microsoft Windows, and Xerox Star - the first
machine to sport a GUI at all. The Xerox Star was influenced by Simula,
according to Johnson, Roberts, et al: The Xerox Star, a Retrospective,
IEEE Computer; 11-29, Sept. 1989.] proved the value of Object Oriented
programming: see <a href="http://www.perldesignpatterns.com/?PerlPaint">Perl Paint</a>.
Everything that gets drawn on your screen shares are few similarity: it
has an appearance that only it knows how to draw. It can inside of
another object, such as menus can be in title bars and buttons can be
in windows. It can send messages when activated to other objects which
control the behavior of the application. Versions of components
customized for appearance or behavior could easily be created,
extending existing code. Taking advantage of these similarities allowed
graphical elements to be mixed and matched, and allowed the application
to treat similar elements in the same way. It also allowed complex
structures to be arranged at run time and continiously revised as the
user moved things around on the screen and opens windows. The
possibilities are built in rather than the limits. The gospel spilled
out. Large applications and operating systems adopted the tenets. Web
programming adopted it after a rash of horrible overgrown "scripts",
mostly written by Perl programmers. <br><br> Software Engineering has traditionally meant applying the
right algorithm for the job. Most University educations focus on
understanding algorithms. This is important, and <a href="http://www.perldesignpatterns.com/?MasteringAlgorithmsWithPerl">Mastering Algorithms With Perl</a>,
O'Reilly Press, is good reading on the topic. Attention to the overall
structure of the program, how the algorithms fit together, and building
software with (at least the appearance of) a grand design is the trendy
new wave. <br><br>
 Objects are tools, just like any other Perl shortcut or magic. Remember - There  is More Than One Way To Do It. 
<br><br>
 New to <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming? See <a href="#BasicPerlOOSyntax"><b>Basic Perl OOSyntax</b></a> for a quick introduction, and <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> for the principles behind it. 
<br><br>
 <b>See Also </b>
<br><br>
 </li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> - the table of contents </li><li> <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> </li><li> <a href="http://www.perldesignpatterns.com/?LateBinding">Late Binding</a> </li><li> <a href="#AboutFlack"><b>About Flack</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.overture.com/d/search/p/juno/?type=topbar&amp;mkt=us&amp;lang=en_US&amp;Keywords=perlpaint">http://www.overture.com/d/search/p/juno/?type=topbar&amp;mkt=us&#9001;=en_US&amp;Keywords=perlpaint</a> 
<br><br>
 <br><br> <a name="AboutPatterns"></a><h2><a href="#AboutPatterns"><b>About Patterns</b></a></h2><br> 
<br><br>
 Previous introductions to OO are wrong. They aren't factually incorrect, only functionally incorrect.  <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming books tell you what an <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
program looks like, and all of the benefits of writing code in this
style. You can't teach someone to make a pie by showing them the
ingredients then a finished pie. You must show them the procedure by
which the ingredients are transformed. [From that, they can infer the
ingredients and the finished product, both of which are variable
anyway. Eg, Alton Brown's cookbook, "I'm Just Here For The Food".]
Sitting down to a University course on C++, you'll hear Polymorphism,
Encapsulation, Delegation, Genericity, and so forth [Sitting down to a
Perl text on objects, you'll see example constructors, example method
calls, example accessors - all a much less ambitious attempt to parade
language features.]. These are ideals for software, not methods for
writing software, not rules of thumb, and not techniques that can be
applied. They're language features, and for the past 20 years, people
have graduated in hoardes knowing what they are but not when and how to
apply them, especially how to apply them as a program grows and
changes. They don't tell you how to arrive at this ideal. The result
has been large amounts of code that use OO features, but miss the boat
on benefitting from them. Since we're using them strictly for fun and
profit, we're going to concentrate on the exact utility of each idea,
and when it is useful to apply it. <br><br>
 <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a>
are parables of good software design. Good parables have a cast of evil
creatures, good creatures, and a moral. The follies of evil become
evident. Lessons are learned. Sometimes, the evil creatures aren't
killed, but change their ways. <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a> represent an ideal, explain the ideal, and give a path, all in neat little case studies. Think of it as your software bible. 
<br><br>
 Design Patterns Elements Of Reusable Software Components<a href="http://www.perldesignpatterns.com/?DesignPatternsElementsOfReusableSoftwareComponents">+</a> brought  <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a>
to computer science. When it did, it talked about OO constructs
exclusively. Since Perl programs combine many other ideas, we're going
to extend the concept. Objects are data attached to code; <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> are  code attached to data. Exporting, as in <a href="#ExportingPattern"><b>Exporting Pattern</b></a>,
lets one module alter the world of another. Usually this means adding
keywords, but there are few limits. Perl's introspective, <a href="http://www.perldesignpatterns.com/?DynamicLanguage">Dynamic Language</a> capabilities open up a new area of investigation.  Perl is multi-paradigmatic, and we should be too. 
<br><br>
 <i>I apologize for the length of this letter, for I lacked the time to make it shorter.</i>
-- Blaise Pascal Are Design Patterns worth it? Programmers freshly
exposed to Design Patterns start building Winchester mansions [Sarah L.
Winchester, heir to the Winchester estate, began hearing voices telling
her that when she stopped building the mansion, she would die.
Franticly, she built a 160 room brick mansion, connecting halls,
tunnels, foyers, closets and every other sort of space and passage
everywhere she could connect them.]. The creations themselves could
likewise said be garish curiosities, Victorian in their own right. The
same disease has been noted in programmers first exposed to the <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> style of Scheme and programmers first exposed to <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming. Creatively applying <a href="http://www.perldesignpatterns.com/?ObjectOrientation">Object Orientation</a>
to a problem quickly degenerates into creatively making everything an
object. Soon every variable, operator, condition, state, state
transition, record, and connection is an object. Don't laugh. I've read
serious texts that have turned state transitions into objects [We'll do
that later, in <a href="#StatePattern"><b>State Pattern</b></a>, in a
case where complex many-to-many relationships exists between state
transitions and other parts of the program. ]. There is a difference
between building an abstraction and abstract building. I'd have to
answer the question "no" for most programmers: <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a>
aren't worth it. On the other hand, most programmers don't program
Perl. Perl programmers already have well-ventilated feet. To me,
reading <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
code is often like reading Atari BASIC (or any other non-procedural
BASIC, for that matter). Finding out where values come from is a
riddle. Names of objects and constructor prototypes give hints about
how things are arranged, which let you wager a guess about where it
probably should come from, which is sometimes where they do come from.
The code is a web, and values tend to travel pretty darn far across it.
On the other hand, in BASIC, important constants are near the top. I
think BASIC wins this one. BASIC programs were proud of their
constants: the fact that they were made into variables instead of
repeated hardcodes, and placed at the top of the file, let them proudly
display them as the easy to change options they are. In OO programming
style, something is either adjusted with a GUI preferences screen, or
its a shameful bit of post-war relic. The bad news is in order to be
cleansed of all sin in this nihilist religion, you need an infinite
number of config screens to keep up with the growing number of options
of the growing program: there is no upper bound and no end to this
race. [See <a href="#ExtensibilityPattern"><b>Extensibility Pattern</b></a>, <a href="#ConfigFile"><b>Config File</b></a>, <a href="http://www.perldesignpatterns.com/?InvariantsArentAlwaysConstants">Invariants Arent Always Constants</a>].
At some point, things break down, and some foundation must be
hardcoded, somewhere. The gentle art of bootstrapping, non GUI editable
config files, and compile-time preferences have an enduring place in
software. The breaks need to be put on OO. Perl programs haven't
reached this level of garishness yet. Perl is a humble language, as <a href="http://www.perldesignpatterns.com/?LarryWall">Larry Wall</a>
says, so with some ties to our roots, perspective, and frequent trips
to the confessional, it may never become garish. Lets hope. Systems of
Object relationships should never create more complexity than they
clear up. This is an important and powerful motive to stop OO-ifying a
program at a certain point. OO-ifying a program should make the program
shorter, more readable, easier to prototype, cleaner, more robust -
everything that OO zealots promised. If it doesn't it isn't a fault of
OO or the OO zealots, its your fault - you've gone too far. <br><br>
 An important tip of the hat to <a href="http://www.perldesignpatterns.com/?MarkJasonDominus">Mark Jason Dominus</a> goes here. His "Design  Patterns' Aren't" lightning talk voiced some latent objections I couldn't quite  formulate. <a href="http://www.perldesignpatterns.com/?ChristopherAlexander">Christopher Alexander</a>, author of <a href="http://www.perldesignpatterns.com/?PatternLanguage">Pattern Language</a>,
conceived of design patterns for architecture. His book doesn't tell
you what to build, nor how to build it. To quote M. J. Dominus, <i>The
problem Alexander is trying to solve is: How can you distribute
responsibility for design through all levels of a large hierarchy,
while still maintaining consistency and harmony of overall design?</i>
Convention and communication are key, especially since convention in
Perl is purely voluntary. Alexander's book is concerned with the level
immediately above and immediately below yours, in addition to what
you're doing. To think of space being distributed not only according to
boundaries but according to delegation and impact is novel. When
designing a city, planning for neighborhoods, public transportation,
and intertwined natural areas are smaller scale architectural elements.
When designing a school, park, or housing community, they are larger,
encompassing architectural elements. Designing a nice whatever is
important, but fitting it into the surrounding picture, at the same
time thinking of the people who will pick up your work where you leave
it, is paramount. This cuts deeper to the heart of encapsulation and
delegation than any single programming technique. <br><br>
 <i>Architecture is often seen as a luxury or a frill, or
the indulgent pursuit of lily-gilding compulsives who have no concern
for the bottom line.</i> -- Pattern  Language of Program Design IV 
<br><br> Architects know how to design skylights, and they delegate the
actual construction of architectural objects to qualified builders. The
primary job of the architect is a creative one: designing something
functional that uses standard elements to create custom solutions for
unanticipated specifications. This is remarkably similar to the plight
of the programmer, baring one difference: programmers have to do the
construction themselves. Being bogged down in this labor-intensive
discipline can suck time away from contemplating the bigger picture.
The mention of a skylight makes an architect giddy as he visualizes the
light playing across the open spaces. The mention of a skylight makes a
builder sigh as he ponders reinforcing the roof, hanging drywall in the
roof, and more trim work. Not only can being bogged down in this level
of detail keep programmers from appreciating architectural elements of
software, it can keep them from learning about them at all. If that
isn't enough, only recently was any effort made to catalog them. To top
it all off, clients don't ask for architecturally sound software: they
ask for huge amounts of square footage decorated with endless amounts
of cheap facade. Design is cast away as an inconvenient nuisance that
limits how much software can be churned out how fast. Architects are
judged by the quality of their work. Programmers are judged by the
quantity of their work. <br><br> Architects design stable structures, but they also
creatively ply their craft to devise ways to make their customers value
the structure more. The structures that pass the test of time are not
only the most solid ones, but the most innovative, imaginative,
inspirational, and useful. <br><br> Its important to decide what to build, and how to build it,
on your own. It is also important to know what is available to build,
and the techniques available to do so. Being the designer-constructor,
you have to pay your own price for your design errors. <br><br>
 <i>Programmers are, in their hearts, architects, and the
first thing they want to do when they get to a site is to bulldoze the
place flat and build something grand.</i> - <a href="http://www.perldesignpatterns.com/?JoelOnSoftware">Joel On Software</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.c2.com/cgi/wiki?DonaldNoyes">http://www.c2.com/cgi/wiki?DonaldNoyes</a> </li><li> <a href="http://c2.com/cgi/wiki?DonaldNoyes">http://c2.com/cgi/wiki?DonaldNoyes</a> 
<br><br>
 <br><br> <a name="AboutFlack"></a><h2><a href="#AboutFlack"><b>About Flack</b></a></h2><br> 
<br><br>

<br><br>
 <i>Eventually you wind up with libraries that are more trouble to reuse than rewrite from scratch</i> - <a href="http://www.perldesignpatterns.com/?ObjectOrientedDesignHeuristics">Object Oriented Design Heuristics</a> 
<br><br> OO isn't real, in the sense that it's an idea. There are
seldom litmus tests for presence of ideas. It isn't a feature of a
language that makes your program better. Instead, it is a collection of
ideas, and facilities in the language, to apply these ideas. I won't
ever discuss wither or not a language is an <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
language. Early C++ compilers compiled C++ down to C and fed it to a C
compiler. This doesn't make C++ any less OO. In fact, no matter what
the language and its basic premises, they all run on the same computers
and compile down to the same languages that computer processors can
understand. <br><br> As with anything that is built up too much, results fall
short of expectations. While many people are avid believers in OO,
others are quick to point out cases where it does more harm than good.
Before we do anything else, lets look at exactly what OO is, and what
it isn't. A good, hard, honest evaluation will set reasonable
expectations. Reasonable expectations will keep everyone happy. <br><br>
 </li><li> <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> Programming is Anal 
<br><br>
 Making the program do its own checking frees you from much of the debugging work. See <a href="http://www.perldesignpatterns.com/?TestUnit">Test Unit</a>, <a href="#TypeSafety"><b>Type Safety</b></a>, <a href="#DesignContract"><b>Design Contract</b></a>. 
<br><br>
 </li><li> <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> Programming is Verbose 
<br><br>
 It needn't be. Perl is an idiomatic language and shouldn't change to suit OO's style. See <a href="http://www.perldesignpatterns.com/?IdiomaticProgramming">Idiomatic Programming</a>. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#AboutObjects"><b>About Objects</b></a> 
<br><br>
 <br><br> <a name="AboutPerl"></a><h2><a href="#AboutPerl"><b>About Perl</b></a></h2><br> 
<br><br>

<br><br> Because we don't know how programs will reinvent themselves,
we don't know how to design an "Interface" ["Interface" is much more
trendy than the ailing "Application Programmer Interface", or "API".
Generally speaking, an interface is how you use something. Just like
any consumer appliance, modules should be used in very specific ways:
do not submerse in water. Do not use while driving. Do not paint over
vents. Do not insert fingers. Do not leave on "high" setting
unattended. Not only do programs use APIs to talk to the outside world,
they use them internally to connect parts.] , what composite types are
involved, and what containment and inheritance hierarchies will look
like. In the beginning, we seldom know that a program will grow into
this at all! <br><br> Perl's easy going attitude and powerful features shine here.
After a program has devised a solution to a logic problem, and after it
has proved its continued usefulness, we have a route for improvement. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> 
<br><br>
 <br><br> <a name="BasicPerlOOSyntax"></a><h2><a href="#BasicPerlOOSyntax"><b>Basic Perl OOSyntax</b></a></h2><br> 
<br><br> An "Object" is a little, or not so little, program that has
its own functions (called "methods") and its own data. Objects are a
kind of data, so one object can contain another object, using a
variable. This program-in-a-variable seems to hide from the world in
its little shell, only communicating through method's return values. <br><br>
 In Perl 5, the <i>-&gt;</i> is an operator that expects the thing on the left, <i>$outside</i>, to contain the thing on the right, <i>getSky()</i>. Objects are  one of many reference types. Generally speaking, the arrow operator takes a  reference datatype on the left, <i>$outside</i>,
and attempts to fetch a value from it. The way a value is fetched from
an object is by calling a method in it, possibly passing that method
arguments. Other reference types are similar but slightly different: <br><br>
 Fetching data from an object reference: 
<br><br>
 <pre>  $color = $obj-&gt;getColor();</pre>
<br><br>
 Fetching data from a reference to a subroutine: 
<br><br>
 <pre>  $color = $colorSubroutine-&gt;();</pre>
<br><br>
 Fetching data from a reference to a hash: 
<br><br>
 <pre>  $color = $stuff-&gt;{'color'};</pre>
<br><br>
 Fetching data from an array reference: 
<br><br>
 <pre>  $color = $colors-&gt;[37];</pre>
<br><br>
 Fetching data from a sca lar reference: 
<br><br>
 <pre>  $color = $$colorPointer;</pre>
<br><br>
 Fetching data from a reference to a filehandle: 
<br><br>
 <pre>  $color = &lt;$colorFile&gt;; </pre>
<br><br> It's up to you to use a reference the correct way. It may help
to use paper to make a graph of what contains what. If you find things
empty that you know you stored data in, or perl is telling you you
can't use one reference type as another, you've gotten confused at some
point. Perl 5 references are second only to regular expressions in
creating "line noise" code. It's possible to have an array reference
which contains hash references which contain object references. The
secret is to remember which contains what, and request them in the
correct order: <br><br>
 <pre>  $color = $anArray-&gt;[42]-&gt;{'thatOne'}-&gt;getColor();</pre>
<br><br> Often, calling a method in an object will return a new object.
Sometimes you'll find yourself using, but not saving, intermediate
objects: <br><br>
 <pre>  $color = $outside-&gt;getSky()-&gt;getColor();</pre>
<br><br>
 Programming Perl<a href="http://www.perldesignpatterns.com/?ProgrammingPerl">+</a>,
O'Rielly Press, offers a complete rundown on using references, creating
them, creating objects, and more. It is a thourogh tour of the how and
why of Perl. That knowledge isn't critical to understand this book, but
on the other hand, we don't replicate that information here, either. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> for the table of contents for this beast </li><li> Reference::English </li><li> <a href="#HowPerlDiffersFromC"><b>How Perl Differs From C</b></a> </li><li> <a href="#AboutObjects"><b>About Objects</b></a> 
<br><br>
 <br><br> <a name="InstanceVariables"></a><h2><a href="#InstanceVariables"><b>Instance Variables</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Each copy of the object will have different values for different variables. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>Any object that contains data or state. 
<br><br>
 <pre>  package Color;
  
  sub new {
    my $type = shift;
    bless { }, $type;
  }
  
  sub set_color {
    my $me = shift;
    my $color = shift;
    $me-&gt;{'color'} = $color;
  }
  
  sub get_color {
    my $me = shift;
    return $me-&gt;{'color'};
  }
  
  package main;
  use Color;
  
  my $c1 = new Color; $c1-&gt;set_color('green');
  my $c2 = new Color; $c2-&gt;set_color('blue');
  print "c1: ", $c1-&gt;get_color(), " c2: ", $c2-&gt;get_color(), "\n";</pre>
<br><br> Even though both $c1 and $c2 are instances of the "Color"
object, they have different values. We call these variables "instance
variables" because the variable is associated with a specific instance
of the class. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> </li><li> <a href="#StaticVariables"><b>Static Variables</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=GlobalVariable.htm">ObjectArts:GlobalVariable.htm</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=InstanceVariables.htm">ObjectArts:InstanceVariables.htm</a> 
<br><br>
 <br><br> <a name="ShortHandInstanceVariables"></a><h2><a href="#ShortHandInstanceVariables"><b>Short Hand Instance Variables</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Typing <i>$me-&gt;{'foo'}</i>
to get to your "foo" instance variable is verbose and unnatural. Factor
out the extra syntax for accessing instance variables over static
variables. <br><br>
 <font size="+2"><b>When</b></font><br><br>Whenever you use instance variables in your classes, which should be often. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br><i>This page
has been eclipsed by Object::Lexical, but is still a good illustration
of the problem being solved, and munging namespaces in Perl.</i> 
<br><br>
 Other <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
languages don't distinguish between instance variables and global
variables in syntax, only definition. Perl does. This translates to
more typing. <br><br>
 <pre>  # java:

  public void mouseDown(Event e, int x, int y) {
    lastx = x; lasty = y;
    return true;
  }

  # perl:

  sub mouseDown {
    my($this, $event, $x, $y) = @_;
    $this-&gt;{'lastx'} = $x;
    $this-&gt;{'lasty'} = $y;
    return 1;
  }</pre>
<br><br>
 <i>$this-&gt;{'lastx'}</i> is hardly a worthy substitute for being able to merely say  <i>$lastx</i> and have the language remember the fact that <i>$lastx</i>
is an instance variable. This requirement is going a long way towards
making our little program ugly. For longer functions, we can make some
symbol table aliases to allow us to access things inside of a hash or
array using a short name: <br><br>
 <pre>  sub mouseDown {

    my($this, $event, $x, $y) = @_;

    local *lastx = \$this-&gt;{'lastx'};
    local *lasty = \$this-&gt;{'lasty'};

    # now we can refer to $this-&gt;{'lastx'} merely as $lastx, just like Java and C++!

    $lastx = $x;
    $lasty = $y;

  }</pre>
<br><br> This just makes the problem worse for shorter functions,
cluttering them with unneeded syntax. As a compromise, you can use this
trick for large functions where instance variables are referenced over
and over again, and for short functions, use the plain old hash
dereference syntax that you already know and tolerate. Don't like those
options? Me neither. Lets see what else we can dig up: <br><br>
 <pre>  package Yawn;

  sub public { 
    local $this = shift;
    my $coderef = pop;
    my @fields = keys %$this;
    my $field;
    FIELD:
      $field = pop @fields;
      local *{$field};
      *{$field} = \$this-&gt;{$field};
    goto FIELD if(@fields);
    $coderef-&gt;(@_);
  }

  sub private {
    caller(1) eq __PACKAGE__ or 
      die sprintf "Cannot invoke private method %s from outside %s", 
        (caller(1))[3], __PACKAGE__;
    public(@_);
  }</pre>
<br><br>
 Including these methods at the top of your class will allow you to abbreviate method classes: 
<br><br>
 <pre>  sub set_x {
    private @_, sub {
      $x = shift;
    };
  }</pre>
<br><br> Call public() or private() with the arguments and a subroutine
to execute. public() will run the passed subroutine unconditionally,
while private() will only run it if your method was invoked from within
the object. If another object or package tries to invoke your private
method directly, it will generate an error message: <br><br>
 <pre>  Cannot invoke private method Yawn::setb_x from outside Yawn at foo.pl line 17.</pre>
<br><br> Additionally, you don't need to say $me-&gt;{'x'} to get at
your "x" field: you can refer to it directly as $x. For each value in
the object hash, a local temporary alias is set up with the same name.
$this is set to $me in the same way, which is similar to what other
languages provide. <br><br> Even this is tedious: you have to repeat code at the top of
each class, and the syntax for declaring an accessor isn't natural. You
could of course use <i>require</i> to read it in from a module that doesn't use <i>package</i>
to change the namespace, in the Perl 4 fashion. I like local
customizations, and if I wanted to take the above code and start
melding it, that's exactly what I would do. I've done that and gone one
step further: I've put it into a regular module and grafted some logic
onto it that avoids having to use any strange syntax at all in your
modules. The program [XXX attached, available on website, whatever] <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>.pm gives you all of these features: 
<br><br>
 <pre>  package Foo;

  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>;
  <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply;

  sub new {
    my $type = shift;
    my %options = @_;
    my $me = { x =&gt; $options{'x'}, y =&gt; $options{'y'}};
    bless $me, $type;
  }

  sub _set_x {
    $x = $shift;
  }

  sub get_x {
    return $x;
  } </pre>
<br><br>
 <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply() is called separately because <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>.pm
needs to wait until your package finishes loading before taking action.
When imply() is run, it looks through your name table, finds all of the
functions, and puts a thin wrapper around them. The wrapper creates
temporary aliases to all of the instance variables, once again giving
them the same name. <br><br> Since the "public" and "private" keywords are gone now, the
convention of using functions starting with underscores as private
functions is used. If a function starts with an underscore, <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>.pm checks the call stack using caller()  to make sure that the call originated from within the package. 
<br><br>
 This isn't a real Design Pattern. It does make Perl objects more usable and natural, so I'm giving it special attention. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a> was one pass at a solution. Object::Lexical is the second pass. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> Object::Lexical </li><li> <a href="#InstanceVariables"><b>Instance Variables</b></a> </li><li> <a href="#PrivateFunctions"><b>Private Functions</b></a> 
<br><br>
 <br><br> <a name="StaticVariables"></a><h2><a href="#StaticVariables"><b>Static Variables</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Some classes
rely on values that will never change within the execution of the
program, and putting these values into a global variable where they can
be define once at the top of the module is good enough. No special work
is needed to do this, but passing the set of fixed values to the
constructor of each new object is definitely overkill. <br><br>
 <font size="+2"><b>When</b></font><br><br>A Factory needs
to keep track of what it produces, and also be a sort of container for
them ("has a" relationship). You need serial numbers attached to each
thing produced. All of the objects are dependent upon a single other
object or variable which we aren't worried about changing. <br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?SerialNumbered">Serial Numbered</a>;
  
  my $globalSerialNumber;
  
  sub new {
    my $type = shift;
    $serialNumber++;
    my $me = {@_, <a href="http://www.perldesignpatterns.com/?SerialNumber">Serial Number</a>=&gt;$serialNumber}; 
    bless $me, type;
  }
  </pre>This
example keeps a serial number in a variable. Every object has access to
this, in addition to their own "SerialNumber" instance variable. [<i>my</i> variables can provide storage for <a href="#InstanceVariables"><b>Instance Variables</b></a> as well as <a href="#StaticVariables"><b>Static Variables</b></a> - see <a href="#AccessorPattern"><b>Accessor Pattern</b></a>.] 
<br><br> In C, a "static" variable is one that gets its own place in
memory. It isn't lost when the function its declared in return. This
idea has been extended to Objects. Static variables aren't associated
with any perticular object, but are shared between all of them.
Declaring a variable outside of functions in a package gives you this
behavior. Because we're using a "my" variable, code outside of our
package can't access the variable directly. If it were a local, they
could, but they would have to jump through a few hoops: <br><br>
 <pre>  print ${ref($obj).'::globalSerialNumber'};</pre>
<br><br>
 This assumes that $obj is an object of type <a href="http://www.perldesignpatterns.com/?SerialNumbered">Serial Numbered</a>, and $globalSerialNumber  were a "local" instead of a "my" variable. 
<br><br> This example assumes that serial numbers must be globally
unique accrost the program. Assumptions about only ever having one of a
thing are genereally bad. Perl threads are based on Perl's support for
being able to embed multiple interpreters in another program. To remove
this limitation from the example, you could beak that program into two
objects. One would have an instance variable holding the serial number
and use it to generate copies of the second object. <br><br>

<br><br>
 <hr><br>From perldoc perltootc... 
<br><br>
 <i>.. class attributes act somewhat like global variables for the entire class, </i>   <i>but unlike program-wide globals, class attributes have meaning only to the class itself.</i> 
<br><br>
 <i>Here are a few examples where class attributes might come in handy:// </i>
<br><br>
 <ul><li> <i>to keep a count of the objects you've created, or how many are still extant.</i>
</li><li> <i>to extract the name or file descriptor for a logfile used by a debugging method.</i>
</li><li> <i>to access collective data, like the total amount of cash dispensed by all ATMs in a network in a given day.</i>
</li><li> <i>to access the last object created by a class, or the most accessed object, or to retrieve a list of all objects. </i>
</li></ul> Should be minipulated through accessors, if at all. Many will be private.  
<br><br>
 ---- 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> Singleton </li><li> <a href="#InstanceVariables"><b>Instance Variables</b></a> </li><li> <a href="#AccessorPattern"><b>Accessor Pattern</b></a> </li><li> <a href="#StaticMethods"><b>Static Methods</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=TemporaryVariables.htm">ObjectArts:TemporaryVariables.htm</a> </li><li> <a href="#StaticMethods"><b>Static Methods</b></a> 
<br><br>

<br><br>
 <br><br> <a name="StaticMethods"></a><h2><a href="#StaticMethods"><b>Static Methods</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Method should be available before any instances of the object are created, or some method does not use any instance data. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Publicly accessable static methods. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br><i>new()</i> is implemented by almost all packages as a static method.  
<br><br>
 Static methods aren't called from an instance of an object, but instead directly from the package name: 
<br><br>
 <pre>  # connect is a factory method that returns a different object type.
  # connect is also static.

  use DBI;

  my $dbh = DBI-&gt;connect($dsn, $login, $pass);</pre>
<br><br>

<br><br>
 </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a>
creates instances, but often does so from an object that has no state
itself, but is just a container for the logic. All variables are passed
in and not kept. </li><li> <a href="#NewObjectFromExisting"><b>New Object From Existing</b></a> goes the other direction - a static method, <i>new()</i>, also works when called in an instance method. 
<br><br>
 Contrast with <a href="http://perldesignpatterns.com/intermap.cgi?wiki=AccessorPattern&amp;word=%20accessors">AccessorPattern: accessors</a> alter or report on the status of a specific instance of a type of object. 
<br><br>
 <pre>  # an $sth can only be created using an instance of DBI

  my $sth = $dbh-&gt;prepare("select * from table");</pre>
<br><br>
 Attempting to call <i>DBI-&gt;prepare()</i> would fail.  
<br><br>
 Some packages, such as <i>CGI</i>, allow static method style
access to all public methods. Calls to the package are essentially
redirected to a single default instance of the object. This makes sense
for objects of which there is only likely to ever be one instance, but
multiple instances should be supported. See <a href="#ExportingPattern"><b>Exporting Pattern</b></a>. 
<br><br>

<br><br>
 <i>... For example, suppose you want a function to apply to multiple windows, such as Close All Open Windows<a href="http://www.perldesignpatterns.com/?CloseAllOpenWindows">+</a>. The wrong way to do this is to have clients call a TWindowManager class. The correct way is to make Close All Open Windows<a href="http://www.perldesignpatterns.com/?CloseAllOpenWindows">+</a>
a static member of TWindow. It is associated with the class it applies
to, and its multiobject function is reflected by its being static.</i> -- From Taligent's Guide to Designing Programs, "Managers aren't Objects" section. <a href="http://pcroot.cern.ch/TaligentDocs/TaligentOnline/DocumentRoot/1.0/Docs/books/WM/WM_1.html">http://pcroot.cern.ch/TaligentDocs/TaligentOnline/DocumentRoot/1.0/Docs/books/WM/WM_1.html</a> Care of <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DontNameClassesObjectManagerHandlerOrData">WikiWiki:DontNameClassesObjectManagerHandlerOrData</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#NewObjectFromExisting"><b>New Object From Existing</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> </li><li> <a href="#StaticVariables"><b>Static Variables</b></a> </li><li> <a href="#InstanceVariables"><b>Instance Variables</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?FactoryMethod">Factory Method</a> </li><li> <a href="#ExportingPattern"><b>Exporting Pattern</b></a> </li><li> <a href="http://pcroot.cern.ch/TaligentDocs/TaligentOnline/DocumentRoot/1.0/Docs/books/WM/WM_1.html">http://pcroot.cern.ch/TaligentDocs/TaligentOnline/DocumentRoot/1.0/Docs/books/WM/WM_1.html</a> 
<br><br>
 <br><br> <a name="AccessorPattern"></a><h2><a href="#AccessorPattern"><b>Accessor Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Writing
reusable, interchangeable modules demands presenting a clean, coherent
interface. People accessing instance variables directly ruins any hope
of this. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Use one of the many idioms for writing or generating methods to get data out of an object or minipulate its internal state. 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Seperate what you do and how you do it by putting up a barrier around your data. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>The purpose
of your module is set in stone - other code in the program have
expectations of it. Other code should not have expectations on how you
do it. We aren't barring them, just putting up a hoop and asking them
to jump. Cleanliness is our main goal - not security. [If security is
an issue, you should be running the dubious code in a sandbox using the
<i>Safe</i> module. Every one else has the same permission and access  as you, otherwise. See <a href="http://www.perldesignpatterns.com/?UseOps">Use Ops</a>. See <a href="http://www.pobox.com/%7Eschwern/talks/Design_Patterns/full_slides/slide002.html">http://www.pobox.com/~schwern/talks/Design_Patterns/full_slides/slide002.html</a> for some thoughts on security in accessors in Perl by <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a>.] 
<br><br>
 In <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> lingo, a <i>mutator</i> is an accessor that changes the state of an object, for example by setting <a href="#InstanceVariables"><b>Instance Variables</b></a>.
A mutator is called to request that the state of the object change
rather than accessing the datastructure directly. Guarding access to
our data with mutators lets us: [By guarding access to our data, we <s>acheive</s> <a href="http://www.perldesignpatterns.com/?JustThisGuy">Just This Guy</a>  have the chance to do any of <s>several things</s> the following <a href="http://perldesignpatterns.com/intermap.cgi?wiki=JustThisGuy&amp;word=%20]">JustThisGuy: ]</a> 
<br><br>
 </li><li> Validate the data given to us </li><li> Update our internal state </li><li> Notify other objects or even hardware of the update </li><li> Change how we use the data without modification to outside code. 
<br><br>
 <i>Choose mnemonic identifiers. If you can't remember what mnemonic means, you've got a problem.</i> - <a href="http://www.perldesignpatterns.com/?LarryWall">Larry Wall</a> 
<br><br> This last point is the most important: accessors are most of
our interface. Separate the interface from the implementation, and the
implementation can change without affecting the interface. Our code can
safely be changed without worry of breaking outside code as long as we
meet the contract set forth by our interface. See <a href="#DesignContract"><b>Design Contract</b></a>.
[Since code is being run in your module, you can change how information
is stored, and provide backwards compatability when you do.] <br><br> Should people meddle in the internals of your object, you
must provide backwards compatibility with every bit that gets diddled
or risk breaking other peoples code - even if you have no way of
knowing what people are diddling. <br><br>
 <font size="+2"><b>Writing Accessors is Tedious</b></font><br><br>In many strictly <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
languages, a large amount of repetitious code is needed just to set up
the accessors. While some accessors will vary, most of them fit the
mould of a <i>set_whatever()</i> and <i>get_whatever()</i>, where
"whatever" is the name of a variable. Perl holds true the notion that
computers should do tedious things for us. [Dishwashers wash tedious
dishes for us, VCRs watch tedious television for us, as Douglas Adams<a href="http://www.perldesignpatterns.com/?DouglasAdams">+</a> says]. 
<br><br>
 <pre>  foreach my $i (qw(name price quantity)) {
    my $field = $i;
    *{"get_$field"} = sub {
      my $me = shift;
      return $me-&gt;{$field};
    };
    *{"set_$field"} = sub {
      my $me = shift;
      @_ or die "not enough arguments to set_$field, stopped";
      $me-&gt;{$field} = shift;
      return 1;
     };
  }</pre>
<br><br>
 For each of "name", "price" and "quantity", we create an anonymous subroutine that binds to the current state of <i>my</i> variables. This is called a <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> - see <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a>.
We go on to name these by dropping them into the symbol table using the
glob syntax. They then work as normal methods. When invoked, they are
still bound to the variable that was created with <i>my</i> when they were created in the <i>for</i>
loop. They're able to use this variable to pick out the correct field.
[This code needs a link to the explanation if it is somewhere else, or
else it needs to be included here.] <br><br>
 <font size="+2"><b>ObjectOriented Syntax is Tedious</b></font><br><br>Another
option is to step inside of another object and access the variable
directly. When we do this, we use knowledge about the underlining
datatype used to construct the object, in this case a hash: <br><br>
 <pre>  $stock-&gt;{'price'} *= 2;

  # Rather than the more OO:

  $stock-&gt;set_price($stock-&gt;get_price() * 2);</pre>
<br><br> Of course, if anyone does that to our neat little package,
they void the warranty. Having an accessor, even if it is just a
stand-in for having access to the variables directly, keeps our options
open about changing our implementation, and that's what this is all
about. <br><br> Perhaps that isn't really best, though. One of the most
annoying spectacles heavy Object Oriented code makes is the accessor
bonanza: <br><br>
 <pre>  $foo-&gt;query_ob()-&gt;add($baz-&gt;query_qux());</pre>
<br><br>
 The only operator this code uses is <i>-&gt;</i>, the method call operator. Compare this to normal, non <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> code: 
<br><br>
 <pre>  $foo{ob}-&gt;{bar} += $baz{qux};</pre>
<br><br> While the basic arithmetic, logic, and other operators
represented by symbols in languages (especially in Perl) account for
99% of what people want to do at any given moment, reading OO code
gives you the impression that the only one that hasn't been robbed of
its usefulness is the -&gt; operator. <br><br> You have to fetch everything you want to do a computation on
into a variable, do your operation, then use an accessor to stow this
value away where it belongs. [This is remarkably like how a RISC
processor works, but instead of accessors, you have addressing modes,
and instead of objects, you have pointers into memory.] <br><br>
 This is the main reason <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
languages are seldom expressive. Expressive languages let you
communicate your thoughts readily to the compiler. Not being able to
use the <i>+=</i> operator to tell the language that you want to add is a serious impediment to self expression.. 
<br><br>
 <b>Accessors vs <a href="#InstanceVariables"><b>Instance Variables</b></a>, or: How I Learned to Stop Worrying and Love Accessors</b> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?JamieZawinski">Jamie Zawinski</a>,
of Netscape fame, observantly complained that distinguishing between
accessing object methods and object instance variables required large
amounts of code to be rewritten when you switch from using one to the
other. [Jamie Zawinki's "Why Java Sucks" paper is available on line at <a href="http://www.jwz.org/doc/java.html">http://www.jwz.org/doc/java.html</a>.
Many of the issues apply to several languages. Perl avoids many of the
pitfalls. Its an interesting read.] It isn't unusual at all for a
programmer to start out with a publically accessable instance variable
and later discover the need to wrap it inside of an accessor: <br><br>
 <pre>  # before: direct access to instance variable

  $ob-&gt;{foo};         # Perl
  ob-&gt;foo             # Java

  # after: using an accessor

  $ob-&gt;foo()          # Perl
  ob-&gt;foo()           # Java</pre>
<br><br> In Perl, style dictates that all variables have accessors, and
that instance variables never be diddled directly. Both of these pose
the problem of differing syntax for instance variables versus method
calls. The uselessness of all operators except <i>-&gt;</i> is a closely related problem. 
<br><br>
 <pre>  #!/usr/bin/perl

  package Cart::Item;

  sub TIESCALAR { die unless(ref $_[1] eq 'CODE'); my $foo=$_[1]; bless $foo, $_[0]; }
  sub STORE { my $me=shift; $me-&gt;(@_); }
  sub FETCH { my $me=shift; $me-&gt;(); }

  sub new {
    my $class = shift;
    my $name_value;
    my $me = { };
    tie $me-&gt;{'name'}, __PACKAGE__, sub {
      $name_value = shift if @_;
      $name_value;
    };
    # repeat for price and quantity
    my $color_value;
    tie $me-&gt;{'color'}, __PACKAGE__, sub { 
      die "I *HATE* blue" if $_[0] eq 'blue'; 
      $color_value = shift if @_;
      return $color_value;
    }; 
    bless $me, $class;  
  }

  # create accessors as above, slightly modified

  foreach my $i (qw(name price quantity)) {
    my $field = $i;
    *{"get_$field"} = sub :lvalue {
      my $me = shift;
      $me-&gt;{$field};
    };
    *{"set_$field"} = sub {
      my $me = shift;
      @_ or die "not enough arguments to set_$field, stopped";
      $me-&gt;{$field} = shift;
      return 1;
     };
  }</pre>
<br><br> A lot of this is out of the scope of this chapter. You can
read on, you can employ faith and cut and paste this into your code, or
you can just rest assured that there is a solution to the "-&gt; is the
only useful operator" problem. <br><br> If you're dying to know what this is all about, the
variables that really hold the values are $name_value, $color_value,
etc. What we store in the hash that we bless to represent our object is
$me-&gt;{name}, $me-&gt;{color}, etc, don't cease being when they goes
out of scope. $me holds a "reference" to them, and we return $me.
Another way to put that is, Perl doesn't get rid of $me-&gt;{name} and
$me-&gt;{color} as long as someone can still see them, and since they
are returned as part of our objects, someone can still see them. That
is, until no one can see our object. Then there are no references to
our object, it gets thrown away, then there are no references to our
code references, and they get thrown away. In exactly the same way, as
long as $me-&gt;{color} and $me-&gt;{name} are visible to someone,
somewhere, $name_value and $color_value will continue to live on.
Datastructures hold references to variables like this: <br><br>
 <pre>  $datastructure{'color'} = \$color;</pre>
<br><br> The backslash operator takes a reference of a scalar, hash,
array, etc. We store this reference in something else. Code, created by
with the sub { } mechanism, can store references, too. It looks a
little bit different: <br><br>
 <pre>  my $foo_value;
  my $foo_logic = sub {
    # code
    $foo_value;
    # code
  };</pre>
<br><br> There are two secret ingredients to make this work. First, the
value that we want to keep a reference to in our code must be declared
using "my". Second, we use that variable normally in our sub { } block
from a place where that variable is visible. This is before the end of
the code block that the variable was defined in - be it a subroutine,
eval, do. If it was defined outside of any of those, it is visible
until the end of the file. If we define $color_value and $name_value
inside of the subroutines, they would get created each time these
subroutines are evaluated, then forgotten when they returned. By
declaring the variables outside, the subroutines hold on to already
existing variables, and they retain their values from call to call.
That's really all there is to it! <br><br> The arrangement that we have now is that we return a hash
reference. This hash reference has references to two blocks of code,
where each block of code has reference to a variable. We aren't just
assigning them. We could say $me-&gt;{'color'} = sub { ... } if we
wanted to do that. Instead, we tie them. Tying is like blessing, but
different. Blessing lets you use the -&gt; operator on a reference.
Tying lets you intercept attempts to fetch values from and assign
values to a variable. When someone attempts to fetch the value of the
variable, using any Perl operator, we get to pick the value returned.
Likewise, when someone assigns a value, using any Perl operator, we get
to look at what they are trying to store in us and decide what to do
with it. Even *=, +=, /=, etc work. <br><br>
 This buys us a few things: 
<br><br> 1. To do an operation on two values, each of which are buried
in different objects, we don't have to declare intermediate variables.
XXX test this - not sure if lvalue assignments to tied variables work
;) <br><br>
 <pre>  $ob-&gt;get_value() += $ob-&gt;query_value() * $economy-&gt;query_inflation();</pre>
<br><br>
 2. If someone completely bypasses our accessors, it doesn't matter one bit: our logic still runs. 
<br><br>
 <pre>  $ob-&gt;{'color'} = 'blue'; # this blows up because we're able to trap it</pre>
<br><br>
 <font size="+2"><b>See Also</b></font><br><br>See also: Class::Accessor on CPAN will make accessors for you, programatically. 
<br><br>
 An illustration of the various ways to generate accessors can be found at  <a href="http://www.pobox.com/%7Eschwern/papers/Closures_and_Accessors/">http://www.pobox.com/~schwern/papers/Closures_and_Accessors/</a> 
<br><br>
 XXX - rules: don't combine unrelated things in one call, as per <a href="#ActionAtADistance"><b>Action At ADistance</b></a> or whatever, <a href="http://www.perldesignpatterns.com/?LayingPattern">Laying Pattern</a>. Provide utility methods or layers on the stack that add abstraction. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#AboutFlack"><b>About Flack</b></a> </li><li> <a href="#InstanceVariables"><b>Instance Variables</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?OperatorOverloading">Operator Overloading</a> </li><li> <a href="#LayeringPattern"><b>Layering Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> </li><li> <a href="#MoveLargeDatastructuresToContainers"><b>Move Large Datastructures To Containers</b></a> </li><li> <a href="#MoveCollectionsOfFunctionsToObjects"><b>Move Collections Of Functions To Objects</b></a> </li><li> Mutator Pattern<a href="http://www.perldesignpatterns.com/?MutatorPattern">+</a> </li><li> <a href="http://www.perldesignpatterns.com/?ConstructorPattern">Constructor Pattern</a> </li><li> <a href="http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perltootc.pod#Translucent_Attributes">http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perltootc.pod#Translucent_Attributes</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=AccessorMethods.htm">ObjectArts:AccessorMethods.htm</a> </li><li> <a href="#ReturnYourself"><b>Return Yourself</b></a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://search.yahoo.com/search?p=get+field+datatype+in+Perl&amp;ei=UTF-8&amp;vm=i&amp;n=20&amp;fl=0&amp;xargs=0&amp;b=21">http://search.yahoo.com/search?p=get+field+datatype+in+Perl&amp;ei=UTF-8&amp;vm=i&amp;n=20&amp;fl=0&amp;xargs=0&amp;b=21</a> 
<br><br>
 I'm not sure what this person is asking. Array field or return value of an accessor? If you ask for the <i>ref()</i> of a return value, you're likely to get a specific subclass where you really wanted the relavent superclass - see <a href="#EmptySubclassFailure"><b>Empty Subclass Failure</b></a>. Class::Contract would give a priori  knowledge of this, but the program would have to be written to use this. See <a href="#TypeSafety"><b>Type Safety</b></a> for a module adding static typing to Perl. 
<br><br>

<br><br>
 <br><br> <a name="PrivateFunctions"></a><h2><a href="#PrivateFunctions"><b>Private Functions</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Your object
has methods for other objects to other objects to use it. There is some
common logic between these methods that you move to functions. These
functions aren't meant to be used by anyone but you, from within the
object itself. <br><br>
 <font size="+2"><b>When</b></font><br><br>You want code that you can change around all you want without breaking other people's programs. 
<br><br>
 <pre>  sub muckWithSomething {
    caller eq __PACKAGE__ or die;
    my $self = shift;
    my $arg = shift;
    # code here using $self and $arg
  }</pre>
<br><br> When you write something yourself, you can usually remember
what parts of objects you plan to keep around and which parts you want
to keep open to revision. You may, on the other hand, completely forget
this, or collaborate with other programmers. This gets you stuck in the
trap of having to keep making your object exactly the same way. OO says
that the implementation should be separate from the interface. Opting
to not allow foreign code to access your internals buys you privacy and
freedom to change around your internals. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> Attribute::Protected </li><li> Attribute::Private </li><li> <a href="#ShortHandInstanceVariables"><b>Short Hand Instance Variables</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=PrivateMethods.htm">ObjectArts:PrivateMethods.htm</a> 
<br><br>
 <br><br> <a name="ResultObject"></a><h2><a href="#ResultObject"><b>Result Object</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Polymorphic
objects (interchangeable objects) pass sets of information to each
other and return it back to each other (the arguments in a method call,
and the results of that call). When passed in list form, it is
difficult to add or remove arguments, and optional arguments require
unsightly placeholders. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Rather than
maintain the method calls and returns in all of the calling and callee
objects, put the results in a new, intermediate object type. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>When you
rename, insert, or delete a passed or returned parameter, you have to
change calls all over the program. This could be dozens or hundreds of
calls. When it is tedious and time consuming to change code, the code
doesn't get changed, ugly work-arounds happen, and coherant structure
breaks down. See <a href="http://www.perldesignpatterns.com/?CodeMomentum">Code Momentum</a>. 
<br><br> Intermediate objects hold results, allowing fields to be added
without breaking code anywhere. Deleting or changing a member of the
result only affects places actually using that property. Adding a new
field maintains backwards compatibility - existing code doesn't know or
care that it has been added. Contrast this to the horror of positional
arguments in a method call: <br><br>
 <pre>  $foo-&gt;do($arg, $str, $bleah, $blurgh);</pre>
<br><br>
 Should the arguments <i>do()</i> accepts be changed, every
place it is called would need to be changed as well to be consistent.
Failure to do so results in no warning and erratic bugs. <br><br>
 Using, and reusing, objects opens the door to <a href="#TypeSafety"><b>Type Safety</b></a>. Perl can check all calls to the method to make sure that the right class (or a subclass of it) is expected. See <a href="#TypeSafety"><b>Type Safety</b></a>. 
<br><br>
 <font size="+2"><b>Credits</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?GangOfFour">Gang Of Four</a> 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="#PassingPattern"><b>Passing Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a>, </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=ValueModel.htm">ObjectArts:ValueModel.htm</a> </li><li> <a href="#ReturnYourself"><b>Return Yourself</b></a> </li><li> <a href="#NamedArguments"><b>Named Arguments</b></a> 
<br><br>

<br><br>
 <br><br> <a name="CommandObject"></a><h2><a href="#CommandObject"><b>Command Object</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Similar methods
in an interface have prolifererated, and the interface to implement
objects with that interface has become unwieldy. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Create an object to communicate the details of the action that is desired. Consolidate methods.  
<br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>Too many
public methods for other objects to call. An interface that is
unworkable and always changing. Prose in method names includes verbs
describing the exact action, and this is preventing refactoring your
code. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br><i>fudge_this()</i> and <i>pickle_that()</i>
and all sorts of verb methods (mutators) give other objects control
over the present object, but there are too many of them, and the
interface has become bulky and ugly. Or, several refactorings are now
impossible: <br><br>
 </li><li> <a href="#FactoryObject"><b>Factory Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LayingPattern">Laying Pattern</a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> ...many others 
<br><br>
 A <a href="#CommandObject"><b>Command Object</b></a> is a case of a <a href="#ResultObject"><b>Result Object</b></a>
style object, used to communicate which action is to be performed,
along with any argument data. This is sent to a single method in the
class that handles commands of the given type. This object is free to
implement command processing with a switch, a variable method dispatch,
or a call to a variable subclass. This lets you make changes to which
commands are defined only in the definition of the command objects
itself and the classes that actually use that command, rather than
every class that wants to implement the command processing interface.
In other words, the interface is more easily kept constant, while
implementation is allowed to change. <br><br> This also frees up the command implementing the command
processing interface to use any number of ideas for dispatching the
command, once it has it: <br><br>
 <pre>  # example of a switch style arrangement:

  sub doCommand {
    my $me = shift;
    my $cmd = shift; $cmd-&gt;isa('BleahCommand') or die;
    my $instr = $cmd-&gt;getInstructionCode();
    if($instr eq 'PUT') {
      # PUT logic here
    } elsif($instr eq 'GET') {
      # GET logic here
    }
    # etc
  }

  # example of a variable method call arrangement:
  
  sub doCommand {
    my $me = shift;
    my $cmd = shift; $cmd-&gt;isa('BleahCommand') or die;
    my $instr = $cmd-&gt;getInstructionCode();
    my $func = "process_" . $instr;
    return undef unless defined &amp;$func;
    return $func-&gt;($cmd, @_);
  }

  # example of a variable subclass arrangement.
  # this assumes that %commandHandlers is set up with a list of object references.

  sub doCommand {
    my $me = shift;
    my $cmd = shift; $cmd-&gt;isa('BleahCommand') or die;
    my $insr = $cmd-&gt;getInstructionCode();
    my $objectRef = $commandHandlers{$instr};
    return $objectRef ? $objectRef-&gt;handleCommand($cmd, @_) : undef;
  }</pre>
<br><br>
 Since Perl offers <i>AUTOLOAD()</i>, this idea could be
emulated. If a package wanted to process an arbitrary and growing
collection of commands to the best of its ability, it could catch all
undefined method calls using <i>AUTOLOAD</i>, and then  attempt to dispatch them (this assumes <i>%commandHandlers</i> is set up with a list  of object references keyed by method name): 
<br><br>
 <pre>  sub AUTOLOAD {
    my $me = shift;
    (my $methodName) = $AUTOLOAD m/.*::(\w+)$/;
    return if $methodName eq 'DESTROY';
    my $objectRef = $commandHandlers{$methodName};
    return $objectRef ? $objectRef-&gt;handleCommand($methodName, @_) : undef;
  }</pre>
<br><br>
 This converts calls to different methods in the current object to calls to a  <i>handleCommand()</i>
method is different objects. This is an example of using Perl to
shoehorn a Command Object pattern onto a non Command Object interface. <br><br>
 XXX virtual machine as an interpreter operating on a series of command objects 
<br><br>
 <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a>
enumerates possible commands well. It may be applied to pre-create
possible command objects - or a non variable portion of them. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a>, <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a> </li><li> <a href="#ResultObject"><b>Result Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a> </li><li> <a href="http://www.perldesignpatterns.com/?EventListeners">Event Listeners</a>. </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a> </li><li> <a href="#ClassNaming"><b>Class Naming</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Command/">http://hatena.dyndns.org/~jkondo/DesignPattern/Command/</a>  </li><li> <a href="http://www.martinfowler.com/eaaCatalog/unitOfWork.html">http://www.martinfowler.com/eaaCatalog/unitOfWork.html</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Command.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Command.html</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Interpreter.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Interpreter.html</a> 
<br><br>

<br><br>
 <br><br> <a name="PassingPattern"></a><h2><a href="#PassingPattern"><b>Passing Pattern</b></a></h2><br> 
<br><br> Generally, create things where it makes sense to, and pass
them down constructors, leaving contained objects to do with them what
they wish, rather than making assumptions about their structure. Given
an A that creates a B, and B needs a C that only A can create, create
C, pass it to A's constructor, and let A pass it to B itself, rather
than trying to take charge and set up all of the relationships
yourself. Extension of idea of encapsulation. <br><br>
 [This is dreadful! Prime example of why I need to get diagrams on line...] 
<br><br>
 [XXX better description, code example.] 
<br><br>
 [XXX there are examples of this floating around this Wiki.. have to track them down] 
<br><br>

<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a>, <a href="http://www.perldesignpatterns.com/?CategoryConcept">Category Concept</a>, <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#PassingState"><b>Passing State</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="#CommandObject"><b>Command Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LayingPattern">Laying Pattern</a> </li><li> <a href="#FunctionalProgramming"><b>Functional Programming</b></a> 
<br><br>
 <br><br> <a name="PassingState"></a><h2><a href="#PassingState"><b>Passing State</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>The arguments
to the first function are augmented and repassed to the next function,
possibly recursively. State (context, a concept of what is going on,
whatever) is maintained thus. <br><br>
 <font size="+2"><b>When</b></font><br><br>Context is built
up during evaluation, and this context utliamtely turns into the
result. Recursive code that details with a variable set of variables.
In place of code that uses $$var to directly access the symbol table. <br><br>
 <pre>  my $context = { 
        increment    =&gt; sub { my $context = shift; $context-&gt;{sum}++; return ''; },
        currentvalue =&gt; sub { my $context = shift; return $context-&gt;{sum}; }
  };

  sub expand_macros {
    my $context = shift;
    my $text = shift;
    my $macro = qr{([A-Z][A-Z0-9]{2,})};
    $text =~ s/$macro/$context-&gt;{lc($1)}-&gt;($context)/ge;
    return $text;
  }

  expand_macros($context, "INCREMENT INCREMENT The current value is: CURRENTVALUE");</pre>
<br><br> This is fairly strightfoward: We can pass $context and some
text containing the macros "INCREMENT" and "CURRENTVALUE" to
expand_macros(), and the macros will increment the current value of
$context-&gt;{sum} and return the value. This is a simple template
parser that finds escapes in text and replaces them with the result of
a peice of code passed in through a hash. However, since we're
maintaing our context in a hash reference, we can do this recursively: <br><br>
 <pre>  $context-&gt;{doubleincrement} = sub { 
    my $context = shift; 
    expand_macros($context, "INCREMENT INCREMENT CURRENTVALUE"); 
  }

  expand_macros($context, "The current value is: DOUBLEINCREMENT");</pre>
<br><br> Maintaining state in a hashref rather than the symbol table
only requires us to be vigilent in passing the hash ref around. We have
access to the updated state in the hashref after evaluation has
finished. We can take this same context and pass it off again. In our
example, we could template something else, reusing our same state and
collection of macro definitions. <br><br>
 </li><li> Two bits of unrelated code can reuse the same name without worry of clobbering a value. This reduces problems with <a href="#ActionAtADistance"><b>Action At ADistance</b></a>. </li><li> Multiple exclusive collections of values can be maintained at once. This lets you have several irons in the fire, so to speak. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a> </li><li> <a href="#FunctionTemplating"><b>Function Templating</b></a> </li><li> <a href="#ExtensibilityPattern"><b>Extensibility Pattern</b></a> </li><li> <a href="#ActionAtADistance"><b>Action At ADistance</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?SharedData">Shared Data</a> </li><li> <a href="#FunctionalProgramming"><b>Functional Programming</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AcmeTemplate">Acme Template</a> 
<br><br>

<br><br>
 <br><br> <a name="ProxyPattern"></a><h2><a href="#ProxyPattern"><b>Proxy Pattern</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Objects talk to
each other using an interface that has been overburdoned with the needs
of security, access coherence, or historic versions of the interface. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Move
access-centric features of the interface into a Proxy object. Put it in
charge of security, or implement the translation between the historic
interface there, or use it to inforce access coherency. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>The Proxy
Object is the grand daddy of all encapsulation patterns due to its
sheer lack of scope. Any other delegation pattern is just a special
case of this general case. The Problem/Solution lines list some
possible uses, but they could just as well be phrased "one objects
demands too much of another - have the second handle some of the work
and delegate the rest". <br><br> A Proxy inherits the same base class or interface as the
object it contains. It can be a generic proxy, that wraps arbitrary
objects, or it could be custom crafted to stand in for a certain class.
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?GenericProxy">Generic Proxy</a>;

  sub new {
    my $type = shift;
    my $this = { };
    my $obj = shift; ref $obj or die;
    $this-&gt;{'obj'} = $obj;
    $type .= '::' . ref $obj;
    # copy inheritance info.
    @{ref($this).'::ISA'} = @{ref($obj).'::ISA'};
    bless $this, $type;
  }

  # bug XXX - autoload is only used after @ISA is searched!

  sub AUTOLOAD {
    my $this = shift;
    (my $methodName) = $AUTOLOAD m/.*::(\w+)$/;
    return if $methodName eq 'DESTROY';
    $this-&gt;{'obj'}-&gt;$methodName(@_);
  }</pre>
<br><br>
 This simple idea has many uses:  
<br><br>
 </li><li> Data Replicator - store or transmit information from "set_" methods. </li><li> Logger - for debugging purposes, record all access to the encapsulated object. </li><li> Cache - similar to Memoizing. Record each result and return it directly without recomputing it if it is ever requested again. 
<br><br>
 Other ideas, such as the <a href="#FacadePattern"><b>Facade Pattern</b></a>, are based on this. This Pattern supports the idea of encapsulation. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?AccessCoherency">Access Coherency</a> requirements touch on <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a>. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#FacadePattern"><b>Facade Pattern</b></a> </li><li> <a href="#AdapterPattern"><b>Adapter Pattern</b></a> </li><li> <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a> </li><li> <a href="#RaceCondition"><b>Race Condition</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TransactionPattern">Transaction Pattern</a> </li><li> <a href="http://www.perl.com/pub/a/2002/08/07/proxyobject.html">http://www.perl.com/pub/a/2002/08/07/proxyobject.html</a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Proxy/">http://hatena.dyndns.org/~jkondo/DesignPattern/Proxy/</a>  </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=Proxy.htm">ObjectArts:Proxy.htm</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Mediator.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Mediator.html</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Proxy.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Proxy.html</a> 
<br><br>
 <br><br> <a name="AdapterPattern"></a><h2><a href="#AdapterPattern"><b>Adapter Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Code will work
with one kind of object. There is another object that should be usable
in its place, that should work, but doesn't. The two interfaces are
incompatible implementations of the same idea. Using vender products
interchangeably. Or, an object that requires one kind of object, when
it should accept several different kinds. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Translate one interface to the other using a dedicated Adapter object. 
<br><br>
 The Adapter is a case of the <a href="#ProxyPattern"><b>Proxy Pattern</b></a>. It isn't even a special case. You could call it an example of a Proxy. Or vice versa. 
<br><br> One object requires a certain type of object. You have another
object that provides an interface. You want to use them together. You
could subclass one of the objects, but you'd lose polymorphism, unless
all subclasses and compatible objects were subclassed individually as
well - which wreaks of the <a href="http://www.perldesignpatterns.com/?BridgePattern">Bridge Pattern</a>
or parallel inheritance hierachies. Yuck. Instead, make a generic
container that is accepted by any of the first class, and contains
anything derived from the second class, which translates between the
two disparate interfaces. <br><br>
 /\/\/\/\ 
<br><br>
 graph: {  
<br><br>
 <pre>  title: "Adapters"
  color: lightcyan
  manhattan_edges: yes
  edge.color: lilac
  scale: 90
  port_sharing: no
  display_edge_labels: yes

  node: { title: "Title" label: "Adapters 1" level: 1}

  node: { title:"A" label: "60hz AC 110 volt outlet" level: 1 }
  node: { title:"B" label: "Lamp" level: 3 }
  node: { title:"C" label: "European Laptop" level: 3 }
  node: { title:"D" label: "Funky little box" level: 2 }
  edge: { sourcename:"B" targetname:"A" label: "Cord" }
  edge: { sourcename:"D" targetname:"A" label: "Cord - 110v AC" }
  edge: { sourcename:"C" targetname:"D" label: "Cord - 220v DC" } </pre>
<br><br>
 } 
<br><br>
 /\/\/\/\ 
<br><br>
 </li><li> Sometimes you have an object you want to use in place of another. </li><li> However, it has a different API. </li><li> An Adapter is a wedge between the object and the world grafting another interface onto it. 
<br><br> Here, the "funky little box" implements both the 60hz, 110
volt AC interface, and the 220 volt DC interface. By virtue of
implementing both interfaces, it acts as a bridge [Oh no! Not <a href="http://www.perldesignpatterns.com/?BridgePattern">Bridge Pattern</a> confusion!]. 
<br><br>

<br><br>
 /\/\/\/\ 
<br><br>
 graph: {  
<br><br>
 <pre>  title: "Adapters 2 - DBI"
  color: lightcyan
  manhattan_edges: yes
  edge.color: lilac
  scale: 90
  port_sharing: no

  node: { title: "Title" label: "Two Interfaces, Two Applications, Two Databases" level: 1}

  node: { title: "A" label: "KewlApplication" level: 2 }
  node: { title: "B" label: "DBI::<a href="http://www.perldesignpatterns.com/?MySQL">My SQL</a>" level: 2 }
  node: { title: "C" label: "MySQL database" level: 2 }
  edge: { sourcename: "A" targetname: "B" }
  edge: { sourcename: "B" targetname: "C" }

  node: { title: "D" label: "RadApplication" level: 3 }
  node: { title: "E" label: "DBI::Pg" level: 3 }
  node: { title: "F" label: "Postgres database" level: 3 }
  edge: { sourcename: "D" targetname: "E" }
  edge: { sourcename: "E" targetname: "F" }</pre>
<br><br>
 } 
<br><br>
 /\/\/\/\ 
<br><br>
 /\/\/\/\ 
<br><br>
 graph: {  
<br><br>
 <pre>  title: "Adapters 2 - DBI"
  color: lightcyan
  manhattan_edges: yes
  edge.color: lilac
  scale: 90
  port_sharing: no

  node: { title: "Title" label: "Two Interfaces, Two Applications, One Database, One Adapter" level: 1}

  node: { title:"A" label: "KewlApplication" level: 2 }
  node: { title:"B" label: "RadApplication" level: 2 }
  node: { title:"C" label: "<a href="http://perldesignpatterns.com/intermap.cgi?wiki=DBD&amp;word=AnyDBD">DBD:AnyDBD</a> - Funky little box" level: 3 }
  node: { title:"D" label: "Postgres" level: 4 }
  edge: { sourcename:"A" targetname:"C"  }
  edge: { sourcename:"B" targetname:"C"  }
  edge: { sourcename:"C" targetname:"D"  } </pre>
<br><br>
 } 
<br><br>
 /\/\/\/\ 
<br><br> An anonymous reader writes [anonymous read-writer? Word
changed to be statement of fact rather than statement of question
posed. Or something.], You have an application that works with <a href="http://www.perldesignpatterns.com/?MySQL">My SQL</a>
and you want to work with Postgres. Besides the SQL differences, the
calls through Perl's DBI may be slightly different as well as in some
cases. In that case, something like the Perl module DBD::Any DBD<a href="http://www.perldesignpatterns.com/?AnyDBD">+</a> would be a  solution.  
<br><br>
 Indeed - a solution that adapts to multiple other interfaces. 
<br><br>
 XML::Parser and XML::Simple do the same thing - XML::Simple simplifies XML::Parser. 
<br><br>
 <font size="+2"><b>Code</b></font><br><br><pre>  package FooAdapter;

  sub new {
    my $class = shift;
    my $self = \new Foo @_;
    bless $self, $class;
  }

  sub something {
    my $self = shift;
    my $delegatee = $$self;
    $delegatee-&gt;one_thing();
    $delegatee-&gt;another_thing();
    $delegatee-&gt;some_more();
  }
  </pre><i>Wrap up an instance of Foo inside of a Foo Adapter<a href="http://www.perldesignpatterns.com/?FooAdapter">+</a>. We provide an interface  alternate to Foo's.</i> 
<br><br>
 Don't use Inheritance Pattern<a href="http://www.perldesignpatterns.com/?InheritancePattern">+</a> to make an adapter - you're changing the interface, not specializing the object. Delegate instead - see <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a>. 
<br><br>
 <font size="+2"><b>Resources</b></font><br><br><a href="http://www.pobox.com/%7Eschwern/talks/Design_Patterns/full_slides/slide017.html">http://www.pobox.com/~schwern/talks/Design_Patterns/full_slides/slide017.html</a> -  <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a>'s version from his Design Patterns talk 
<br><br>
 Use <a href="#InnerClasses"><b>Inner Classes</b></a> as
Adapters. Java has no way to pass a closure, a subroutine pointer, or
any other first class object other than an actual object. Java 1.0
required you to create a class for each and every <a href="http://www.perldesignpatterns.com/?CallBack">Call Back</a> you needed.  [A <a href="http://www.perldesignpatterns.com/?CallBack">Call Back</a> allows behavior to be defined, not run immediately, but rather sent to another routine for its use. Perl's <i>sort { $a &lt;=&gt; $b } @list</i> uses this  idea, where the expression <i>{ $a &lt;=&gt; $b }</i> isn't executed immediately, but  rather defined for <i>sort</i>'s
use.] This was clearly unworkable. Java 1.1 eased the matter by
allowing these objects to be defined with a short hand syntax, and
allowed the definition to be placed in your code right where they are
passed. See <a href="#InnerClasses"><b>Inner Classes</b></a> for more information. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ProxyPattern"><b>Proxy Pattern</b></a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CallBack">Call Back</a> </li><li> <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Adapter/">http://hatena.dyndns.org/~jkondo/DesignPattern/Adapter/</a> </li><li> <a href="http://www.pobox.com/%7Eschwern/talks/Design_Patterns/full_slides/slide017.html">http://www.pobox.com/~schwern/talks/Design_Patterns/full_slides/slide017.html</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=Adapter.htm">ObjectArts:Adapter.htm</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Mediator.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Mediator.html</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Adapter.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Adapter.html</a> </li><li> <a href="http://www.perldesignpatterns.com/?FakingAccessorsUsingAutoload">Faking Accessors Using Autoload</a> </li><li> <a href="http://www.perldesignpatterns.com/?FakingAccessorsUsingTiedData">Faking Accessors Using Tied Data</a> </li><li> <a href="http://www.perldesignpatterns.com/?FakingDelegationUsingAutoload">Faking Delegation Using Autoload</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA">http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA</a> 
<br><br>

<br><br>
 <br><br> <a name="FacadePattern"></a><h2><a href="#FacadePattern"><b>Facade Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>A class or
subsystem is unwieldy to use. You don't want to be tied to that
interface or implementation. Your code is becoming closely tied to a
class that you don't like, or you spend a lot of time dealing with a
difficult interface, or several programmers on your team have to learn
a complex subject to accomplish a few simple tasks. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Write a new
interface to it that translates between your simple requests and
perhaps automates tedious things you do frequently. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Normally,
you write for the interface of the class that you're using today, and
if you have to use a different class tomorrow, you write a Proxy. With
a poor or overly complex interface, you may wind up writing for a
complex interface, then writing a Proxy to translate that back to a
simple interface. A Facade is a neutral ground. It allows you to shuff
all of the related undesired complexity should you switch classes. You
can replace it with a new Facade that translates the simple interface
of the first facade to the simple interface of the replacement class. <br><br> A Facade often interfaces to a whole bunch of inter-related
classes, so that complex multi-object interactions are hidden behind a
single object. <br><br>
 A <a href="#DecoratorPattern"><b>Decorator Pattern</b></a> adds complexity to the class it stands in for; a <a href="#FacadePattern"><b>Facade Pattern</b></a> mitigates complexity. Both are cases of the <a href="#ProxyPattern"><b>Proxy Pattern</b></a>. 
<br><br> Conceivably, you could replace one package with a horrible
interface with another package with a horrible interface. In this case,
you would need to stick in an equally complex Facade, but the code
using the interface could remain blissfully ignorant of the whole
ordeal. <br><br>
 [XXX the two XML parsers interfaces would present a good example] 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ProxyPattern"><b>Proxy Pattern</b></a> </li><li> <a href="#DecoratorPattern"><b>Decorator Pattern</b></a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Facade/">http://hatena.dyndns.org/~jkondo/DesignPattern/Facade/</a>  </li><li> <a href="http://www.theperlreview.com/Articles/v0i4/facade.pdf">http://www.theperlreview.com/Articles/v0i4/facade.pdf</a> - "The Facade Design Pattern" by brian d foy, <i>The Perl Review</i>, v0 i4 </li><li> <a href="http://www.martinfowler.com/eaaCatalog/remoteFacade.html">http://www.martinfowler.com/eaaCatalog/remoteFacade.html</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Facade.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Facade.html</a> 
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Credits&amp;word=%20GangOfFour">Credits: GangOfFour</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA">http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA</a> 
<br><br>
 ---- 
<br><br>
 If I understand this correctly, then I think HTML::Toke Parser<a href="http://www.perldesignpatterns.com/?TokeParser">+</a>::Simple
is example of a Perl module that follows the Facade pattern. It
provides an easy interface to HTML::Parser, which some find unwieldy to
use directly. <br><br>
 <br><br> <a name="InnerClasses"></a><h2><a href="#InnerClasses"><b>Inner Classes</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Related packages can be created where they are defined. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>Adding another
Interface to an object, passing out callbacks, creating helper objects.
Moving inheritance, or interfaces, out of your object but not far from
it. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br><pre>  package <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>;

  sub new { ... };

  sub getIterator {
    my $parentThis = shift;
    return eval {
      package <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>::Iterator;
      # this mini sub-package only knows how to iterate over our data structure
      @ISA=(Iterator);
      sub new {
        my $type = shift;
        my $this = { currentIndex=&gt;0 };
        bless $this, $type;
      }
      sub hasNext {
        my $this = shift;
        return @{$parentThis-&gt;{'colors'}} &gt; $this-&gt;{'currentIndex'};
      }
      sub getNext {
        my $this = shift;
        die unless $this-&gt;hasNext();
        return $parentThis-&gt;{'colors'}-&gt;[$this-&gt;{'currentIndex'}++];
      }
      __PACKAGE__;
    }-&gt;new();
  }

  # there should be two underscores on either side of PACKAGE. <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> is having a bug. sorry.</pre>
<br><br>
 <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>::Iterator
implements all of the functions required to be an instance of Iterator.
If something takes an argument, and insists it implement Iterator, it
will accept the result of calling getIterator() on a <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a> object. However, <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>
itself does not implement these methods, or inherit the base abstract
class for Iterators. The package that does is contained entirely inside
<a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>'s
getIterator() method. This technique lets you localize the impact of
having to provide an interface, and keep code related to supporting
that interface together and away from the rest of the code. This
supports the basic idea of putting code where it belongs. <br><br>
 When we return a <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>::Iterator object, that object uses a variable  defined lexically inside <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>.
Since defined lexically (contained inside the block, in this case, the
method) to the variable $parentThis, we hold a reference to it. If it
changes, we see the changes. If the parent is destroyed before the <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>::Iterator
object we return is, this variable will live on until all references
are destroyed. This way, we can share data efficiently with our parent.
In some situations, it may be better to copy the data before giving it
to the inner class, or to use Immutable Objects, explained in Chapter
XXX. <br><br> Our Perl implementation could cause problems if two threads
contend for the same datastructure, even by way of different objects.
Thus, if used in a threading environment, the <a href="http://www.perldesignpatterns.com/?WebsafeColors">Websafe Colors</a>
and all of its returned inner classes would need to synchronize on the
same object for access to the array of colors. Failure to do so would
lead to iterators that miss colors, end prematurely, or overrun the
array. <br><br>
 <a href="#BiDirectionalRelationshipToUnidirectional"><b>Bi Directional Relationship To Unidirectional</b></a> talks about how <a href="#InnerClasses"><b>Inner Classes</b></a> may be employed to cleanly build structures of mutually referring objects. 
<br><br>
 <a href="#AdapterPattern"><b>Adapter Pattern</b></a> is similar to <a href="#InnerClasses"><b>Inner Classes</b></a>,
but the adapter has no access to lexical data, and sits in a seperate
file. Adapters can be (and usually are) added after the fact, and have
the advantage of not requiring tampering with a class to implement. <a href="#CurryingConcept"><b>Currying Concept</b></a> talks about creating method-level wrappers to serve as adapters. 
<br><br>
 An <a href="#IteratorInterface"><b>Iterator Interface</b></a> is a good use of <a href="#InnerClasses"><b>Inner Classes</b></a>.
Interfaces clutter up a namespace with lots of methods designed to
present the data and logic in an object is various ways. The <a href="#IteratorInterface"><b>Iterator Interface</b></a> encapsulates the requirements, keeping things as neat as possible. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=246322">PerlMonks:246322</a> </li><li> <a href="#AdapterPattern"><b>Adapter Pattern</b></a> </li><li> <a href="#BiDirectionalRelationshipToUnidirectional"><b>Bi Directional Relationship To Unidirectional</b></a> </li><li> <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> </li><li> <a href="#InlineObjects"><b>Inline Objects</b></a> 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>Hmm; maybe I'm
missing something, but I don't see the utility of this pattern... Why
put the declaration for the inner class inside an eval block, rather
thank an unlabeled bloc at package scope? -- <a href="http://www.perldesignpatterns.com/?SimonCavalletto">Simon Cavalletto</a> - <i>Thu Aug 21 14:44:57 2003 207.18.115.52</i> 
<br><br>
 I guess the key point should be that when <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> are used
 (a good polymorphic OO program, with <a href="#TypeSafety"><b>Type Safety</b></a> and the whole nine yards),
 the list of interfaces that you implement can become prolific. 
 Rather than listing dozens of interfaces in the front of the code, stick them
 where you need them, in a contained sub-class. 
 This also serves to limit the scope of the interface - it is clear that
 a small amount of code implements that interface, rather than some mysterious
 portion of a large file. That still doesn't answer your question.
 Lexical scoping - the sub class hangs onto variables from the parent class.
 It is a closure. Java fakes this, badly. In Java, when you use a variable
 that exists in the parent class, it silently creates an accessor and calls it
 from the inner class to get at that value. Reguardless, an inner class
 is a sort of adapter between one larger object and a very small object
 with the intention of seperating out the interfaces needed by each, and
 this sort of data sharing between the child and parent is very important.
 Good question! I'll merge both of these in later ;)
 This comment things seems like a good idea. Rather than just redoing pages,
 we can discuss them a bit first, make some resolution, and then blow them
 away! - <a href="#ScottWalters"><b>Scott Walters</b></a> - <i>Thu Aug 21 17:38:20 2003 216.190.249.170</i> 
<br><br>
 <!-- cut - end comments --> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perlmonks.org/index.pl?parent=246322&amp;title=Dynamicly%20controlling%20%40ISA%20and%20namespaces&amp;lastnode_id=246322&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on">http://www.perlmonks.org/index.pl?parent=246322&amp;title=Dynamicly%20controlling%20%40ISA%20and%20namespaces&amp;lastnode_id=246322&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on</a> 
<br><br>

<br><br>
 <br><br> <a name="TypeSafety"></a><h2><a href="#TypeSafety"><b>Type Safety</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>The order of a method's arguments changes, leading to latent bugs. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Check argument
datatype, reference type, and especially class membership. Use
interfaces and abstract classes to facilitate class membership
checking. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br><i>The
conclusion here: Type checking is nice, and so is Perl, but not in the
same way. Adding type-checking to Perl would be like making a hot fudge
sundae with mashed potatoes instead of ice cream and with gravy instead
of fudge. It might be perfectly edible, but it wouldn't be a hot fudge
sundae. Perl's present design is simply not consistent with most of the
goals of compile-time type checking.</i> - <a href="http://www.perldesignpatterns.com/?MarkJasonDominus">Mark Jason Dominus</a> at <a href="http://perl.plover.com/yak/typing/notes.html">http://perl.plover.com/yak/typing/notes.html</a> [To be fair, <a href="http://www.perldesignpatterns.com/?MarkJasonDominus">Mark Jason Dominus</a>
was talking about checking ints, strings, floats, booleans, and
non-object compositions of these types. OO is another matter entirely,
and because <i>-&gt;</i> is the only real operator in a true OO program, much easier <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=160268">PerlMonks:160268</a> quotes MJD here]. 
<br><br> Orders of a method's arguments change, leading to latent bugs.
Return values could be anything. You don't know what to expect, so you
have to check for every case. Code bloats and you still aren't safe. <br><br>
 Use interfaces and abstract classes to facilitate class membership checking. Use tools like <a href="http://search.cpan.org/author/SWALTERS/typesafety-0.01/typesafety.pm">http://search.cpan.org/author/SWALTERS/typesafety-0.01/typesafety.pm</a> to automatically do strong type checking. 
<br><br>
 <font size="+2"><b>Why Type Check?</b></font><br><br>Ever program in <i>bash</i>? If there is a syntax error in your program, you don't know about it until <i>bash</i>
actually gets to that line. It doesn't parse the whole thing in
advance, but instead does one line at a time, as it goes. When changing
part of the program, you must not only run the program to make sure it
is syntactically valid, but you must also go through all of the
features that correspond to the code you changed. Perl's compile-time
type checking is a life saver here. What if Perl could check a lot more
things to detect run-time errors without having to the run every square
inch of the program? <br><br>
 For CPAN modules: 
<br><br>
 </li><li> Refusing to work except on our terms is the best documentation. </li><li> Users don't read paper docs. </li><li> They putz around until it appears to work. </li><li> This leaves latent bugs. </li><li> "die is documentation" 
<br><br>
 For your own programs: 
<br><br>
 </li><li> When you can't remember what is returning or accepting what and you'd like the language to remind you.  </li><li> When you're refactoring and moving things around, and you'd like to be told what you've broken.  </li><li> When you're checking for strange values anyway and it is cluttering your program.  </li><li>
You're dealing with a complex design and making it more concrete will
help you see the shortfalls of it - specifically, you're being too
general in some places (expecting Pets where you only want Dog objects)
or not general enough (a routine should be able to deal with all Pets,
not just Dogs). </li><li> Formalizing your types helps you realize
what is a subset of what, and what subsets what routines should be
prepared to deal with. </li><li> It also encourages you to break out
things into types and subtypes, which helps maintain order and
refactorability in a large program, especially one with multiple
authors, especially when those multiple authors are all working on the
code at the same time. <br><br>
 <font size="+2"><b>Run-Time Type Checking</b></font><br><br><pre>  sub play {
    my $me = shift;
    my $investor = shift; $investor-&gt;isa('<a href="http://www.perldesignpatterns.com/?InvestmentBanker">Investment Banker</a>') or die;
    my $stock = shift; $stock-&gt;isa('Stock') or die;
    my $amount = shift;
    $stock-&gt;set_quantity($amount);
    $me-&gt;{$investor}={$stock};
  }</pre>
<br><br>
 This is the <i>play()</i> method from our <a href="http://www.perldesignpatterns.com/?TradingFloor">Trading Floor</a>.pm example. We mentioned this briefly in <a href="http://www.perldesignpatterns.com/?ObjectOrientationOrientation">Object Orientation Orientation</a>. Each object passed in is tested to see if they fit that type.  For <i>-&gt;isa()</i>,
either being blessed into that package directly, or inheriting from
that package will work. In the case of references, check the reference
type directly: <br><br>
 <pre>    my $arrayref = shift; ref $arrayref eq 'ARRAY' or die;</pre>
<br><br>
 Given a bless object, <i>ref()</i> will return its blessed type, but this usual isn't what we want: see <a href="#CheckingTypeInsteadOfMembership"><b>Checking Type Instead Of Membership</b></a>.
For references, it will return 'ARRAY', 'HASH', 'SCALAR', 'GLOB', or
one of several other possible values [XXX some perldoc reference]. <br><br>
 Passing related variables together in a container compliments this solution: see <a href="#TooManyVariables"><b>Too Many Variables</b></a>, <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a> and <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a>. 
<br><br>
 <font size="+2"><b>Dynamic Types</b></font><br><br>Perl is normally a <a href="http://www.perldesignpatterns.com/?DynamicLanguage">Dynamic Language</a>
- the types of variables need not be pre-established (declared), they
may change on the fly, and at any given moment, any variable may hold
any kind of value. Only in a <a href="http://www.perldesignpatterns.com/?DynamicLanguage">Dynamic Language</a> would this be valid: 
<br><br>
 <pre>  my $x = 0;
  $x = "Hi there\n";
  $x = new CGI;
  $x = [new CGI, 0, "Hi there\n"];</pre>
<br><br> Since any function may return any value, and any variable may
hold any kind of data, you cannot safely write a sequence of code to
operate on a return value or datum without first doing elaborate and
numerous checks on the data. Or perhaps you safely can - but you have
no assurance. Safety is not assured. You are completely on your own.
Code at your own risk. Values obtained are not warrented for
merchantiability for fitness for any purpose. <br><br> Compiled languages seldom offer this flexibility, and they
do so at great expense. Interpretive langauges pay a penalty, but a
reasonably small one. Common wisdom says that if you're making an
interpretive language, you might as well make it a dynamic language.
For example, Python is a <a href="http://www.perldesignpatterns.com/?DynamicLanguage">Dynamic Language</a>, in stark contrast to its strong <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> religion. See <a href="http://www.perldesignpatterns.com/?DynamicLanguage">Dynamic Language</a>, <a href="http://www.perldesignpatterns.com/?DynamicTypes">Dynamic Types</a>, <a href="#HowDoesPerlStackUp"><b>How Does Perl Stack Up</b></a>. 
<br><br>
 <font size="+2"><b>Strict Types</b></font><br><br>Opposite of dynamic types.  
<br><br>
 <a href="http://search.cpan.org/search?query=typesafety&amp;mode=all">http://search.cpan.org/search?query=typesafety&amp;mode=all</a> performs "compile time static type analysis". What? 
<br><br>
 </li><li> Compile time: It happens before the program runs,
not as it goes. This means each expression is checked, and only checked
once. Doing it runtime, expressions may escape during any given run if
the code doesn't cover them [See Devel::Coverage for a tool that tells
you what your coverage is - in other words, what code executed during a
run and what code wasn't touched]. Since everything is checked once,
checks need not run every time a method is called, returns, or an
assignment is made. This is much quicker. </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Static&amp;word=%20The">Static: The</a>
thing being studied - your program - is not moving. It is frozen in
time. Behavior is inferred from looking at the program in freeze frame,
not from watching things it does as it moves. </li><li> Type <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Analysis&amp;word=%20The">Analysis: The</a>
passing, return, and assignment of typed data is analysed. Each of
these operations must be consistent with the declarations of the types:
what class they were defined as being or holding a reference to, and
how they are being stored or passed. <br><br>
 <font size="+2"><b>Interoperability and Type Safety</b></font><br><br><a href="http://www.perl.com/pub/a/2003/03/26/perlanddotnet.html">http://www.perl.com/pub/a/2003/03/26/perlanddotnet.html</a>
talks about making Perl play nice with Microsoft's new platform
[Infuratingly named platform, at that. It's like naming something
".COM" or ".ORG". The implication that they are somehow responsible or
associated with a TLD is baffeling, though I suppose it is no stranger
than naming a word processor "Word". More than once I've asked someone
whether or not they have access, and they respond with a version
number: "Yes, I have Access 97!". Damn it. Namespace polution should be
a crime.]. <a href="#TypeSafety"><b>Type Safety</b></a> is the key.
Interoperating with CORBA, ADO, and any other object technology that
allows reuse of componets or communication between parts hinges on
types. XS uses <i>typemap</i>, a translation of types been C and Perl, to glue do the glue [no, don't do the glue, it's bad for you]. <a href="http://www.perldesignpatterns.com/?WebServices">Web Services</a> is valid as a technology because, like CORBA, it maps types between systems and languages. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?MarkerInterface">Marker Interface</a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#AssertPattern"><b>Assert Pattern</b></a> </li><li> <a href="#CheckingTypeInsteadOfMembership"><b>Checking Type Instead Of Membership</b></a> </li><li> <a href="#ShortHandInstanceVariables"><b>Short Hand Instance Variables</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WebServices">Web Services</a> </li><li> <a href="#AssertPattern"><b>Assert Pattern</b></a> </li><li> <a href="#TypedVariables"><b>Typed Variables</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DesignByContract">Design By Contract</a> </li><li> <a href="#DesignContract"><b>Design Contract</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DesignDocument">Design Document</a> </li><li> <a href="http://www.perldesignpatterns.com/?NoseJobRefactoring">Nose Job Refactoring</a> </li><li> <a href="http://www.perldesignpatterns.com/?DynamicTypes">Dynamic Types</a> </li><li> <a href="http://www.perldesignpatterns.com/?DynamicLanguage">Dynamic Language</a> </li><li> <a href="#CreatingCPANModules"><b>Creating CPANModules</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=278531">PerlMonks:278531</a> - Why not prototype? </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=Griping%20about%20Typing">PerlMonks:Griping%20about%20Typing</a> </li><li> <a href="http://www.perl.com/pub/a/2003/03/07/apocalypse6.html?page=1">http://www.perl.com/pub/a/2003/03/07/apocalypse6.html?page=1</a> </li><li> <a href="http://search.cpan.org/search?mode=module&amp;query=Params%3A%3AValidate">http://search.cpan.org/search?mode=module&amp;query=Params%3A%3AValidate</a> </li><li> Params::Validate </li><li> Attribute::Params::Validate </li><li> Params::Check </li><li> Design::Contract </li><li> <a href="http://perl.plover.com/yak/typing/">http://perl.plover.com/yak/typing/</a> </li><li> Carp::Assert </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=278531">PerlMonks:278531</a> </li><li> <a href="http://search.cpan.org/author/ABERGMAN/types-0.05/lib/types.pm">http://search.cpan.org/author/ABERGMAN/types-0.05/lib/types.pm</a> </li><li> <a href="http://search.cpan.org/author/ABERGMAN/optimize-0.03/lib/optimize.pm">http://search.cpan.org/author/ABERGMAN/optimize-0.03/lib/optimize.pm</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://perlmonks.org/index.pl?parent=278531&amp;title=Considering%20Prototypes&amp;lastnode_id=278531&amp;parent_node=278531&amp;node=Offer%20your%20reply">http://perlmonks.org/index.pl?parent=278531&amp;title=Considering%20Prototypes&amp;lastnode_id=278531&amp;parent_node=278531&amp;node=Offer%20your%20reply</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=278531">http://www.perlmonks.com/index.pl?node_id=278531</a> 
<br><br>
 <br><br> <a name="TypedVariables"></a><h2><a href="#TypedVariables"><b>Typed Variables</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Not knowing
what data may be returned by a function or contained in a variable
leads to lots of conditional code to handle all possible scenarios.
Unless all scenarios are checked at each point, there is still a very
real chance that something unexpected could appear for a value. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Use run-time or compile-time type checking. 
<br><br>
 <font size="+2"><b>Weak Types</b></font><br><br>Perl is a
"weakly typed" language. A variable may hold a string, number, or
reference, including an object reference. This leads to debugging code
strewn around the program: <br><br>
 <pre>  die unless $ob-&gt;isa('Number::Complex');

  or more typically:

  if(!$ob || $ob-&gt;error) {
    print "well that didnt work\n";
  }</pre>
<br><br> When variables are created to hold exactly one datatype, we
often do a lot of checking to make sure thats the case. This clutters
up code. Perl is difficult enough to understand without clutter. <br><br>
 <pre>  # in Scalar/Typed/Factory.pm:

  package Scalar::Typed::Factory;
  
  sub import {
    my $package = shift;
    my $referencetype = shift or
      die __PACKAGE__ . ': import statement must specify reference type';
    $package .= '::' . $referencetype;
    my $caller = caller;

    # construct a package for this type.
    # note that $referencetype is lexically bound to this context

    *{$package.'::TIESCALAR'} = sub { 
      bless \$_[1], $_[0]; 
    };

    *{$package.'::FETCH'} = sub { 
      my $me = shift; $$me; 
    };
  
    *{$package.'::STORE'} = sub { 
      my $me = shift; 
      my $val = shift;
      ref $val and $val-&gt;isa($referencetype) or 
        die sprinf "Incorrect type in assignment: expecting $referencetype: " .
                   "%s in package %s at line %d in %s\n", 
                   (caller)[1, 0, 2];
      $$me = $val;
    };
  
    # finally, export a constructor for this new datatype to our users package:

    (my $constructor) = $referencetype =~ s/[^A-Za-z]//g; 
    $constructor = lc $constructor;

    *{$caller.'::'.$constructor} = sub ($) :lvalue {
      tie $_[0], __PACKAGE__.'::'.$referencetype;
      $_[0];
    };
  }
  
  1;

  # in the main program:

  package main;

  use Scalar::Typed::Factory 'XML::Parser';
  use CGI;
  use XML::Parser;
  use XML::Parser::Compatiable;

  xmlparser my $parser = new XML::Parser;   # ok
  xmlparser my $compat = new XML::Parser::Compatiable; # ok
  xmlparser my $other = new CGI; # dies
  $parser = new CGI; # dies
  $parser = 10; # dies
  $parser = undef;  # dies - see <a href="#IntroduceNullObject"><b>Introduce Null Object</b></a></pre>
<br><br> This is "runtime type checking". Some languages do this
checking at compile time. If we had that, it would prevent the program
from ever reaching the "die" point: if it were even possible to reach
it, the program wouldn't compile. <br><br>
 Well, we do have that. See <a href="#TypeSafety"><b>Type Safety</b></a>. This example code illustrates what is being checked, and what logic is used in doing so.  
<br><br>
 XXX - explaination of this rather obscure code 
<br><br>
 <font size="+2"><b>Type Safety</b></font><br><br>This is a run-time version of <a href="#TypeSafety"><b>Type Safety</b></a>. The <a href="#TypeSafety"><b>Type Safety</b></a> page discusses a module which does this and more at compile time.  
<br><br>
 <font size="+2"><b>And So Much More</b></font><br><br><a href="#DebuggingPattern"><b>Debugging Pattern</b></a> has a good explaination of using asserts to track bugs to their source. <a href="#AssertPattern"><b>Assert Pattern</b></a> expounds on this idea. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="#IntroduceNullObject"><b>Introduce Null Object</b></a> </li><li> <a href="#MoveCollectionsOfFunctionsToObjects"><b>Move Collections Of Functions To Objects</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WeaklyTyped">Weakly Typed</a> </li><li> <a href="#DebuggingPattern"><b>Debugging Pattern</b></a> </li><li> <a href="#AssertPattern"><b>Assert Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ConditionalElimination">Conditional Elimination</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://perlmonks.org/index.pl?parent=268029&amp;title=Learning%20OOP&amp;lastnode_id=268029&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on">http://perlmonks.org/index.pl?parent=268029&amp;title=Learning%20OOP&amp;lastnode_id=268029&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=268463">http://www.perlmonks.org/index.pl?node_id=268463</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=268029">http://www.perlmonks.org/index.pl?node_id=268029</a> </li><li> <a href="http://perlmonks.org/?node_id=268029">http://perlmonks.org/?node_id=268029</a> 
<br><br>
 <br><br> <a name="CompositePattern"></a><h2><a href="#CompositePattern"><b>Composite Pattern</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Decompose
objects into their parts, and reassemble them in whichever combination
you need with "has-a" relationships. That is to say, break things into
the largest parts that still let you reuse the parts, and build your
objects of those. <br><br>
 <font size="+2"><b>When</b></font><br><br>Any time there is partial overlap in the capabilities of objects. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br><i>Compose
objects into tree structures to represent part-whole hierarchies.
Composite lets clients treat individual objects and compositions of
objects uniformly.</i> - <a href="http://www.perldesignpatterns.com/?ChristopherAlexander">Christopher Alexander</a> 
<br><br> Objects may be members of a number of linked lists in our
system. The linked lists organize the objects by different criteria. <br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>;
  use <a href="http://www.perldesignpatterns.com/?ImplictThis">Implict This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();

  sub new {
    my $type = shift;
    bless { next=&gt;'', previous=&gt;'' }, $type;
  }

  sub next { return $next; }
  sub set_next { $next = shift; return 1; }
  sub previous { return $previous; }
  sub set_previous { $previous = shift; return 1; }
  sub append { 
    my $ob = shift; $ob-&gt;isa(__PACKAGE__) or die;
    $next or do { $next = $ob; $ob-&gt;set_previous($this); return 1; }
    $ob-&gt;set_next($next);  $next-&gt;set_previous($ob);
    $ob-&gt;set_previous($this); $this-&gt;set_next($ob);
    return 1;
  }</pre>
<br><br>
 We can inherit this, but inheriting it multiple times doesn't do us any good:  we only ever have one instance of the <a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a> this way - ourselves. Using  composition gives us what we want: 
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?TriceQueuedObject">Trice Queued Object</a>;
  use <a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();

  sub new {
    my $type = shift;
    my $me = { 
      sort_order =&gt; new <a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>,
      size_order =&gt; new <a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>,
      save_order =&gt; new <a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>,
      @_
    };
    bless $me, $type;
  }

  # create accessors that defer the action to each object, for each object composing us:
  # method A: see text below

  sub next_sort { return $sort_order-&gt;next(); }
  sub previous_sort { return $sort_order-&gt;previous(); }
  sub set_next_sort { return $sort_order-&gt;set_next(@_); }
  sub append_sort { return $sort_order-&gt;append(@_); }

  sub next_size { return $size_order-&gt;next(); }
  sub previous_size { return $size_order-&gt;previous(); }
  sub set_next_size { return $size_order-&gt;set_next(@_); }
  sub append_size { return $size_order-&gt;append(@_); }

  sub next_save { return $save_order-&gt;next(); }
  sub previous_save { return $save_order-&gt;previous(); }
  sub set_next_save { return $save_order-&gt;set_next(@_); }
  sub append_save { return $save_order-&gt;append(@_); }

  # directly return references to objects that compose us:
  # method B: see text below

  sub get_sort_order { return $sort_order; }
  sub get_size_order { return $size_order; }
  sub get_save_order { return $save_order; }</pre>
<br><br> Where it says "method A" and "method B" illustrate two very
different approaches to giving users of our object access to the our
parts. "Method A" creates all new accessors which do their work by
calling accessors in the composing objects. "Method B" simply returns
the composing objects and lets the user call the methods directly. For
example: <br><br>
 <pre>  # using method A:

  $ob-&gt;next_sort($ob2);

  # using method B:

  $ob-&gt;get_sort_order()-&gt;set_next($ob2);</pre>
<br><br> Which is better? Well, it depends. If your object is merely a
container for other objects, B makes more sense. If your object is a
Facade, providing a new interface to several objects, A makes more
sense. If you consider the objects you contain to be implementation
dependent, and you don't want to have to support returning intermediate
objects in the future, A lets you hide your implementation better. B
makes for shorter code and less typing when the relationship between
the objects isn't likely to change. <br><br>
 Each <a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a> instance is a "delegate" in this example. The methods that  propogate requests to them are "delegate methods". 
<br><br>
 <i>Compose</i> means a special thing: it refers to building objects using <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a>. Delegation-composition hangs onto constituent parts using references. By contrast, <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> inherit from each part. <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> prevent returning a <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> in responce to requests for information, and they prevent you from having a more than one of any given part. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> </li><li> <a href="#FacadePattern"><b>Facade Pattern</b></a> </li><li> <a href="#DecoratorPattern"><b>Decorator Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="http://www.cs.oberlin.edu/%7Ejwalker/puzzle/">http://www.cs.oberlin.edu/~jwalker/puzzle/</a> </li><li> Class::Delegation on CPAN </li><li> <a href="http://www.pobox.com/%7Eschwern/talks/Design_Patterns/full_slides/slide014.html">http://www.pobox.com/~schwern/talks/Design_Patterns/full_slides/slide014.html</a> for a critism of delegation by <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a>... <i>"Monkey code"</i>. </li><li> <a href="http://www.pobox.com/%7Eschwern/talks/Design_Patterns/full_slides/slide025.html">http://www.pobox.com/~schwern/talks/Design_Patterns/full_slides/slide025.html</a> - <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a>'s "Monkey Delegation" </li><li> <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=Composite.htm">ObjectArts:Composite.htm</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/lazyLoad.html">http://www.martinfowler.com/eaaCatalog/lazyLoad.html</a> </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/149878">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/149878</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Composite.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Composite.html</a> </li><li> <a href="http://www.perldesignpatterns.com/?ConditionalElimination">Conditional Elimination</a> 
<br><br>
 <br><br> <a name="DecoratorPattern"></a><h2><a href="#DecoratorPattern"><b>Decorator Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Attach additional logic to an existing object. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>Something about an object needs to change. Objects can have attributes  that change something about them. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Decorators provide a flexible alternative to subclassing for extending  functionality. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?TheJoyOfPatterns">The Joy Of Patterns</a>
used stacking burger toppings as an example. It's a good example. Lets
use taco toppings instead, so we aren't copying them too blatantly.
Lets imagine that there is a taco concession in a mall. We won't call
it a Mexican restaurant. That would be a stretch. Most of their tacos
sit under a heat lamp, pre-made, waiting for someone to order the
standard taco. A rash of bowel disrupting bacteria outbreaks brought
suspicion on the heat lamps, so people began ordering tacos with and
without all kinds of weird toppings in attempt to foil the pre-making
efforts and get a fresh taco. The concessions stand management found
that the cashiers were making a lot of errors adding up the costs of
the toppings, so they complained to the corporate office. Corporate
office searches the web for "a programmer that doesn't interview like
they are reading from a script and who doesn't design patterns using
taco toppings like the last guy", and hires the first person that comes
up: a Perl programmer! [Actually, thats not true. On Google, top
rankings for this search are held by Phillip Kerman, a Flash <a href="http://www.perldesignpatterns.com/?ActionScript">Action Script</a> programmer, and Jeff Turner, a Java programmer]. 
<br><br>
 This programmer could write something like: 
<br><br>
 <pre>  # in a file named Taco.pm:
  
  package Taco;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  
  sub new { bless { price=&gt;5.95}, $_[0]; }
  sub query_price { return $price; }
  
  # in a file named <a href="http://www.perldesignpatterns.com/?TacoWithLettuce">Taco With Lettuce</a>.pm:
  
  package <a href="http://www.perldesignpatterns.com/?TacoWithLettuce">Taco With Lettuce</a>;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  @ISA = qw(Taco);
  sub query_price { return $this-&gt;Taco::query_price() + 0.05; }
  
  # in a file named <a href="http://www.perldesignpatterns.com/?TacoWithTomato">Taco With Tomato</a>.pm:
  
  package <a href="http://www.perldesignpatterns.com/?TacoWithTomato">Taco With Tomato</a>;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  @ISA = qw(Taco);
  sub query_price { return $this-&gt;Taco::query_price() + 0.10; }
  
  # in a file named <a href="http://www.perldesignpatterns.com/?TacoWithTomatoAndLettuce">Taco With Tomato And Lettuce</a>.pm:
  
  package <a href="http://www.perldesignpatterns.com/?TacoWithTomatoAndLettuce">Taco With Tomato And Lettuce</a>;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  @ISA = qw(Taco);
  sub query_price { return $this-&gt;Taco::query_price() + 0.10; }
  </pre>To
do it this way, they would have to create a class for each and every
topping, as well as each and every combination of toppings! With two
toppings this isn't out of hand. With 8 toppings, you've got 256
possible combinations. With 12 toppings, you've 4096 combinations.
Creating a permanent inheritance is the root of the problem, here. If
we could do something similar, but on the fly, we wouldn't need to
write out all of the possible combinations in advance. We could also
make the inheritance chain deeper and deeper as we needed to. <br><br>
 <pre>  # in a file named Taco.pm:
  
  package Taco;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  
  sub new { 
    bless { price=&gt;5.95, first_topping=&gt;new Topping::<a href="http://www.perldesignpatterns.com/?BaseTaco">Base Taco</a> }, $_[0]; 
  }
  sub query_price { return $first_topping-&gt;query_price(); }
  sub add_topping {
    my $topping = shift; $topping-&gt;isa('Topping') or die "add_topping requires a Topping";
    $topping-&gt;inherit($first_topping);
    $first_topping = $topping;
  }
  
  # in a file named Topping.pm:
  
  package Topping.pm;
  # this is just a marker class
  
  # in a file named Topping/<a href="http://www.perldesignpatterns.com/?BaseTaco">Base Taco</a>.pm:
  
  package Topping::<a href="http://www.perldesignpatterns.com/?BaseTaco">Base Taco</a>;
  @ISA = qw(Topping);
  
  sub query_price { return 5.95; }
  
  # in a file named Topping/Lettuce.pm:
  
  package Topping::Lettuce;
  @ISA = qw(Topping);
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  sub query_price { return 0.05 + $this-&gt;SUPER::query_price(); }
  sub inherit { my $parent = shift; unshift @ISA, $parent; return 1; }
  
  # and so on for each topping...
  </pre>The
astute reader will notice that this isn't much more than a linked list.
Since inheritance is now dynamic, we've gotten rid of needing to
explicit create each combination of toppings. We use inheritance and a
recursive query_price() method that calls its parent's version of the
method. When we add a topping, we tell it to inherit it from the last
topping (possibly the base taco). When someone calls query_price() on
the taco, we pass off the request to our first topping. That topping
passes it on down the line, adding them up as it goes. <br><br> There are two gotchas here, though. What if we want a taco
with extra, extra tomatos? Topping::Tomato would be told to inherit
itself. This would create an endless loop! All tomatos would have
tomatos are their parent, not just the last one added. Base taco would
be forgotten about. The real problem here is that we're modifying the
whole class - not just the particular instance of the tomato we added
last. This would keep us from using a multithreaded cash register
shared by two people, and it would keep us from having two taco orders
on the same tab, each with different toppings. Dynamic inheritance is a
cool trick, but you must remember that its effects are global. Reserve
it for creating objects of a new, unique name, of user specification,
and perhaps a few similar applications. See <a href="http://www.perldesignpatterns.com/?BeanPattern">Bean Pattern</a> and <a href="#AbstractFactory"><b>Abstract Factory</b></a> for more on custom-crafted objects. For some reason, this mess reminds me of <a href="#SelfJoiningData"><b>Self Joining Data</b></a>. 
<br><br> For our purposes, though, this won't fly. The linked list
approach is the right approach. We need to instantiate individual
toppings as objects, so that they each have private data. In this
private data, we need to store the relationship: what the topping is
topping is an attribute of each topping. See <a href="#InstanceVariables"><b>Instance Variables</b></a> for more on keeping data private to an instance of an object.  
<br><br>
 <pre>  # in a file named Taco.pm:
  
  package Taco;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  
  sub new { bless { price=&gt;5.95, top_topping=&gt;new Topping::<a href="http://www.perldesignpatterns.com/?BaseTaco">Base Taco</a> }, $_[0]; }
  sub query_price { return $price; }
  sub add_topping {
    my $new_topping = shift;
    # put the new topping on top of existing toppings. this new topping is now our top topping.
    $new_topping-&gt;top($top_topping);
    $top_topping = $new_topping;
    return 1;
  }
  
  # in a file named Topping.pm:
  
  package Topping.pm;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  
  sub new {
    my $type = shift;
    bless { we_top=&gt;undef }, $type;
  }
  
  sub top { 
    my $new_topping = shift; $new_topping-&gt;isa('Topping') or die "top must be passed a Topping";
    $we_top = $new_topping; 
    return 1; 
  }
  
  # in a file named Topping/<a href="http://www.perldesignpatterns.com/?BaseTaco">Base Taco</a>.pm:
  
  package Topping::<a href="http://www.perldesignpatterns.com/?BaseTaco">Base Taco</a>;
  @ISA = qw(Topping);
  sub query_price { return 5.95; }
  
  # in a file named Topping/Lettuce.pm:

  package Topping::Lettuce;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();
  @ISA = qw(Topping);
  sub query_price { return 0.05 + ($we_top ? $we_top-&gt;query_price() : 0); }
  </pre>There!
We finally have something that passes as workable! This solution is
good for something where we want to change arbitrary features of the
object without the containing object (in this case, taco) knowing
before hand. We don't make use of this strength in this example. The
query_price() method of the taco object just passes the request right
along, we any math we want can be done. A
two-for-taco-tappings-Tuesday, where all toppings were half price on
Tuesdays, would show off the strengths of the <a href="#DecoratorPattern"><b>Decorator Pattern</b></a>.
With a press of a button, a new object could be pushed onto the front
of the list that defined a price method that just returns half of
whatever the price_method() in the next object returns. The important
thing to note is that we can stack logic by inserting one object in
front of another when "has-a" relationships. <br><br>
 For yet another approach, see the <a href="#AggregatePattern"><b>Aggregate Pattern</b></a>. 
<br><br> For the sake of simplicity and clarity, each of these
approaches has a different API. There is no reason they couldn't have
been done consistently. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> NEXT on CPAN </li><li> <a href="#AggregatePattern"><b>Aggregate Pattern</b></a> </li><li> <a href="http://patternsinperl.com/designpatterns/decorator/">http://patternsinperl.com/designpatterns/decorator/</a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Decorator/">http://hatena.dyndns.org/~jkondo/DesignPattern/Decorator/</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=227847">PerlMonks:227847</a> - modifying @ISA at runtime </li><li> <a href="#SelfJoiningData"><b>Self Joining Data</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?BeanPattern">Bean Pattern</a> </li><li> <a href="http://www.perl.com/pub/a/2003/06/13/design1.html?page=2">http://www.perl.com/pub/a/2003/06/13/design1.html?page=2</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Decorator.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Decorator.html</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>

<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perlmonks.org/index.pl?parent=246322&amp;title=Dynamicly%20controlling%20%40ISA%20and%20namespaces&amp;lastnode_id=246322&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on">http://www.perlmonks.org/index.pl?parent=246322&amp;title=Dynamicly%20controlling%20%40ISA%20and%20namespaces&amp;lastnode_id=246322&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on</a> 
<br><br>
 <br><br> <a name="AggregatePattern"></a><h2><a href="#AggregatePattern"><b>Aggregate Pattern</b></a></h2><br> 
<br><br> Members of a common subclass are each known to have certain
methods - that is, they all implement a given interface. These methods
return information about the state of that perticular object, or make
changes to its state. It does happen that an application is concerned
with an aggregation, or an amalgamation, of data from several object of
the same type. This leads to code being repeated around the program: <br><br>
 <pre>  my $subtotal;
  foreach my $item (@cart) {
    $subtotal += $item-&gt;query_price();
  }

  my $weight;
  foreach my $item (@cart) {
    $weight += $item-&gt;query_weight();
  }

  # and so on</pre>
<br><br>
 Representing individual objects, when the application is concerned about the general state of several objects, is an <a href="http://www.perldesignpatterns.com/?ImpedenceMismatch">Impedence Mismatch</a>.
This is a common mismatch: programmers feel obligated to model the
world in minute detail then are pressed with the problem of giving it
all a high level interface. <a href="#LayeringPattern"><b>Layering Pattern</b></a> tells us to employ increasing levels of abstraction. 
<br><br> Create an object as a wrapper, using the same API as the
objects being aggregated. Speak of objects in terms of the required
interface - see <a href="#AbstractClass"><b>Abstract Class</b></a>.
This means using a common type as an entry, but allow the container to
hold others that subclass it or imlpement it as an interface. Define
its accessors to return aggregate information on the objects it
contains. <br><br>
 <pre>  package Cart::Basket;

  use base 'Cart::Item';

  sub query_price {
    my $self = shift;
    my $contents = $self-&gt;{contents};
    foreach my $item (@$contents) {
    }
  }

  sub add_item {
    my $self = shift;
    my $contents = $self-&gt;{contents};
    my $item = shift; $item-&gt;isa('Cart::Item') or die;
    push @$contents, $item;
    return 1;
  }

  # query_ routines:

  sub query_price {
    my $self = shift;
    my $contents = $self-&gt;{contents};
    my $subtotal;
    foreach my $item (@$contents) {
      $subtotal += $item-&gt;query_price();
    }
    return $subtotal;
  }

  sub query_price {
    my $self = shift;
    my $contents = $self-&gt;{contents};
    my $weight;
    foreach my $item (@$contents) {
      $weight += $item-&gt;query_weight();
    }
    return $weight;
  }</pre>
<br><br> The aggregation logic, in this case, totalling, need only
exist in this container, rather than being strewn around the entire
program. Less code, less <a href="http://www.perldesignpatterns.com/?CodeMomentum">Code Momentum</a>, fewer depencies, more flexibility. 
<br><br>
 We have an object of base type <i>Cart::Item</i> that itself holds other <i>Cart::Item</i>
objects. That makes us recursive and nestable - one basket could hold
several items along with another basket, into which other items and
baskets could be placed. You may or may not want to do this
intentionally, but to someone casually calling <i>-&gt;query_price()</i> on your <i>Cart::Basket</i> object won't have to concern himself with this - things will just work. 
<br><br>
 This will break. Unless the advice of <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>
is followed and different implementations of the same thing share the
same interface, the basket can't confidently aggregate things. Unless
the advice of <a href="#StateVsClass"><b>State Vs Class</b></a> is heeded, <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>
will never be acheived: the temptation to draw distinctions between
classes that lack certian functions will be too strong. These
distinctions run counter to <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>,
causing segmentation and proliferation of interfaces for no good
reason. This proliferation of types prevents aggregation in baskets and
containers. Avoid this vicious cycle. Parrots that don't squak are
still parrots. <br><br>
 <a href="#IteratorInterface"><b>Iterator Interface</b></a>
blurb - aggregation is kind of like iteration in that they both present
information gleaned from a number of objects through a tidy interface
in one object. While <a href="#IteratorInterface"><b>Iterator Interface</b></a> deals with each contained or known object in turn, <a href="#AggregatePattern"><b>Aggregate Pattern</b></a> summerizes them in one fell swoop. 
<br><br>
 <a href="#ContainerPattern"><b>Container Pattern</b></a> continues (duplicates) this, with more depth, more gotchas,  and more references. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#VisitorPattern"><b>Visitor Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TemplateClass">Template Class</a> </li><li> <a href="#FacadePattern"><b>Facade Pattern</b></a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="#FunctionalProgramming"><b>Functional Programming</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> 
<br><br>

<br><br>
 <br><br> <a name="ContainerPattern"></a><h2><a href="#ContainerPattern"><b>Container Pattern</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>The goals of <a href="#TypeSafety"><b>Type Safety</b></a> and reusable code clash when attempting to reuse containers of other objects. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Rethink interfaces. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br><i>This overlaps heavily with <a href="#AggregatePattern"><b>Aggregate Pattern</b></a>, but there is loads of good information in there.</i> 
<br><br>
 Objects created to hold other objects. Queues, FIFOs/stacks,  buffers, shopping carts, and caches all fit this description. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?BreadthFirstRecursion">Breadth First Recursion</a> has an example of recursing through a network of objects to find them all, where a queue is used to hold unexplored paths. 
<br><br>
 <a href="#IteratorInterface"><b>Iterator Interface</b></a>
is an important part of all objects that act as containers in one way
or another. It provides a consistent way to loop through that
containers contents: any container should be functionally
interchangable with any other for the purposes of inspecting their
contents. This employes the ideas of <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> and <a href="#AbstractClass"><b>Abstract Class</b></a>.  
<br><br>
 <a href="http://www.perldesignpatterns.com/?TemplateClass">Template Class</a> talks about generators for containers. <a href="#TypeSafety"><b>Type Safety</b></a>
breaks down when presented with generic, reusable containers that can
hold any type of data. If a container only holds one specific type of
data, we know any items retreived from it are of the correct type, and
no type errors can occur, but then we can't reuse that container. <a href="http://www.perldesignpatterns.com/?TemplateClass">Template Class</a>
follows C++'s ideas of templates, and provides a generic implementation
that can create instances tailored to specific data types to enforce
safety. <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> purists will find this of interest. 
<br><br>
 Aggregation Pattern<a href="http://www.perldesignpatterns.com/?AggregationPattern">+</a> and <a href="#StateVsClass"><b>State Vs Class</b></a>
talk about other, more present, type issues that crop up when creating
containers full of subclasses of a certain type. What if one subclass
doesn't do something the superclass does? Model it as state.
Null-methods are okey. Don't fork the inheritance to remove a feature.
Similar to <a href="#IntroduceNullObject"><b>Introduce Null Object</b></a>, but for methods. Hmm. Introduce Null Method<a href="http://www.perldesignpatterns.com/?IntroduceNullMethod">+</a>? 
<br><br>
 <a href="http://www.perldesignpatterns.com/?ObjectOrientedDesignHeuristics">Object Oriented Design Heuristics</a>,
section 5.19, has an example of a basket that cores fruit. How could
this possibly made general? Anything other than a fruit would need a <i>-&gt;core()</i> method that does nothing, requiring a base class implementing a stub <i>core()</i> to be inherited by all.  
<br><br>
 Extract a generic interface: 
<br><br>
 </li><li> Generalize - Rather than <i>core()</i>, why not <i>prepare()</i>?
Oranges could peel themselves, grapes devine themselves, and so forth.
Method calls aren't instructions on how to do something but rather a
request that an end be acheived. How it is done is best left to the
object. </li><li> Extract interface - Given a saner interface, make it optional. Let the basket test <i>-&gt;can('prepare')</i>.
If the item is capable of doing so, it may. If it isn't, no big deal.
The magic basket prepares fruit. Not preparing non-fruit is okey. No
one ever said just because it prepares fruit it has to blow up when
presented with non-fruit. This is somewhat of a comprimise - <a href="#TypeSafety"><b>Type Safety</b></a>
doesn't exist for things wishing to use the basket as a repository for
all things fruit and no thing not fruit. Useful for avoiding
interfacebloat - <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a>. 
<br><br>

<br><br>
 <hr><br>Containers should maintain relationships between
objects they contain when the relationships are too numerous or
abstract. An object that is part of a series might have links to the
next and previous objects in that sequence: <br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>::Link;

  sub new { bless { prev =&gt; undef, next =&gt; undef }, $_[0]; }

  sub next { $_[0]-&gt;{next} }

  sub set_next { $_[0]-&gt;{next} = $_[1] }

  sub prev { $_[0]-&gt;{prev} }

  sub set_prev { $_[0]-&gt;{prev} = $_[1] }</pre>
<br><br>
 See <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a>
for an explanation of this style of code, if you must. The objects
place in the sequence makes sense to be part of the object. Each object
can point you at the next one, following the <a href="#LawOfDemeter"><b>Law Of Demeter</b></a>.
Should the object be part of two linked lists, or three linked lists,
or an arbitrary number of linked lists, no fixed method can be called
to deturmine the "next" object in the sequence, because no assumption
can be made about <i>which</i> sequence you're talking about. An access would have to exist for previous and next for <i>each</i>
sequence the object is part of. It makes more sense to seperate the
linking from the object. Rather than adding the code to do whatever to <i><a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>::Link</i>, <i><a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>::Link</i> should delegate to it: see <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a>. The object would be bare of any linked list logic, though several <i><a href="http://www.perldesignpatterns.com/?LinkedList">Linked List</a>::Link</i> objects may hold a reference to it, and it might be part of an arbitrary number of linked lists, or other data structures. See <a href="#ObjectsAndRelationalDatabaseSystems"><b>Objects And Relational Database Systems</b></a> for more on the problems of complex inter-object relationships. 
<br><br>

<br><br>
 <hr><br><pre> </pre><a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#AggregatePattern"><b>Aggregate Pattern</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TemplateClass">Template Class</a> </li><li> <a href="http://www.perldesignpatterns.com/?BreadthFirstRecursion">Breadth First Recursion</a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="#IntroduceNullObject"><b>Introduce Null Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ObjectOrientedDesignHeuristics">Object Oriented Design Heuristics</a> </li><li> <a href="http://www.perldesignpatterns.com/?FunctionalityIsToBeShared">Functionality Is To Be Shared</a> 
<br><br>
 <br><br> <a name="VisitorPattern"></a><h2><a href="#VisitorPattern"><b>Visitor Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>The operations
that can be performed on a type of object is poorly defined, and always
changing. Objects contain large numbers of unrelated methods that
perform some sort of logic. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Instead of
continuously revising the objects themselves, put the logic is put into
interchangeable (polymorphic) Visitor objects. Use a fixed interface
between the objects containing data and the objects defining the
behavior. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Data is contained in objects of a certain class or subclass. Many  operations can be performed on objects of this class.  
<br><br> The actual operation to be done becomes pluggable. This fits
with putting code where it belongs. Infocom, famous for its text
adventure games with extremely intelligent natural language parsers,
used a permutation of this idea. Any action you wished to perform was
stated as a sentence. The parser picked out the verb, direct object,
and indirect object. In three rounds, the verb was invoked, then the
direct object, then the indirect object. The first round, each object
was given a chance to veto the action: perhaps the verb object checked
to see if the environment was tagged as being underwater, or the direct
object may know for a fact that the material it is made out of is
non-flammable, or the indirect object may be a torch that isn't
currently lit, and vetos the action because it knows it isn't lit. If
not vetoed, this is repeated for a round where changes actually take
affect and objects update their state, then for a final round where
each object reports on the consequence of the action. In this case, a
container object holding information about the sentence, is acted upon
by three pluggable objects: the verbs Visitor, the direct objects
Visitor, and the indirect objects Visitor. Another example would be a
porridge container acted upon by three different bear Visitors objects.
<br><br>
 [XXX code example!] 
<br><br> Use different objects logic to work on our data. As Perl gives
us dynamic inheritance, adding and removing objects from our @ISA array
could have the same effect. We simply inherit the object that accesses
our data the way we want, when we want. When methods defined in the
Visitor object are called, they are presented with all of our data,
saving the bother of querying each item individually. This still
requires a clean, well defined interface: which methods need to be
defined, and how the data is represented. This approach rules out
making changes to how we store the data and maintaining compatibility
through the interface, as a disadvantage. <br><br> The Visitor name emphasises that the objects implementing
behavior and the object containing data have no real relationship with
each other: neither holds on to a reference to the other. They are
merely interchangeable parts, to be here today and gone tomorrow. <br><br>
 Borrowing from the <a href="http://patternsinperl.com/designpatterns/visitor/">http://patternsinperl.com/designpatterns/visitor/</a> example by <a href="http://www.perldesignpatterns.com/?NigelWetters">Nigel Wetters</a>,
data items are coerced into a common superclass. This isn't object
clean. It is always better to fix problems at the source rather than
lurk in wait wielding band-aids [band-aid is registered trademark of
whatever <a href="http://www.bandaid.com/">http://www.bandaid.com</a>
says it is]. The example does serve to illustrate that data items
should be of a common base type to be accepting as a Visitor. <br><br>
 <pre>  foreach my $class ( qw(NAME SYNOPSIS CODE) ) {
          no strict 'refs';
          push @{ "POD::${class}::ISA" }, "POD::POD";
  }</pre>
<br><br> Not having to use a different method call in each behavior
object is key. That would prvent us from using them interchangably. It
would introduce need for hardcoded dependencies. We would no longer be
able to easily add new behavior objects. Assuming that each behavior
object has exactly one method, each method should have the same name.
Something generic like <i>-&gt;go()</i>
is okey, I suppose. Naming it after the data type it operators on makes
more sense, though. If there is a common theme to the behavior objects,
abstract it out into the name. <i>-&gt;top_taco()</i> is a fine name. 
<br><br>
 <pre>  package Taco::Topper;

  sub top_taco { 
    my $self = shift;
    die "we're an abstract class, moron. use one of our subclasses" if ref $self eq __PACKAGE__;
    die "method strangely not implemented in subclass";
  }

  sub new {
    my $class = shift;
    bless [], $class;
  }

  package Taco::Topper::Beef;

  sub top_taco {
    my $self = shift;
    my $taco = shift;
    if($taco-&gt;query_flags()) {
       die "idiot! the beef goes on first! this taco is ruined!";
    }
    $taco-&gt;set_flags(0xdeadbeef);
    $taco-&gt;set_cost($taco-&gt;query_cost() + 0.95);
  }

  package Taco::Topper::Cheese;

  sub top_taco {
    my $self = shift;
    my $taco = shift;
    if(! $taco-&gt;query_flag(0xdeadbeef) and ! $taco-&gt;query_flag(0xdeadb14d)) {
      # user is a vegitarian. give them a sympathy discount because we feel
      # bad for them for some strange reason, even though they'll outlive us by 10 years
      $taco-&gt;set_cost($taco-&gt;query_cost() - 1.70);
    }
    $taco-&gt;set_flags(0xc43323);
    $taco-&gt;set_cost($taco-&gt;query_cost() + 0.95);
  }

  package Taco::Topper::Gravy;

  # and so on...</pre>
<br><br>

<br><br> Gravy? On a taco? Yuck! In real life, places in the mall that
serve "tacos" also tend to serve fries, burgers, hotdogs, and other
dubiously non-quasi-Mexican food. It doesn't make sense to have one vat
of cheese for the nachos, another for tacos, and yet another for
cheesy-gravy-fries. The topper should be able to apply cheese to any of
them. Keep in mind that these behavior classes work on a general class
of objects, not merely one object. A burger could be a subclass of a
taco. See <a href="#StateVsClass"><b>State Vs Class</b></a> for some thoughts on what makes a good subclass. 
<br><br>
 The taco object could then do something vaguley along the lines of... 
<br><br>
 <pre>  $topping_counter-&gt;get_cheese_gun()-&gt;top_taco($self);</pre>
<br><br>
 ... where <i>$topping_counter</i> holds our different topping guns, and <i>get_cheese_gun()</i> returns a cached instance of <i>Taco::Topper::Cheese</i>.
This creates a sort of a cow-milking-itself problem. The taco shouldn't
be cheesing itself, some other third party should make the connection.
Assuming that the topping counter has been robotized and humans
enslaved by the taco craving robots, perhaps the topping counter could
cheese the taco. [Verbing nouns is considered bad style - I'm sorry]. <br><br>
 <i>Taco::Topper</i>'s strange <i>die()</i> calls give a
prime example of run time interface checking versus compile time
interface checking. Perl does this run time, Java compile time. Since
the Java compiler would catch either of those errors, no run time
checks are needed - those <i>die()</i> calls could go away. Also, the program wouldn't need to be thoroughly tested to find out if those <i>die()</i> calls ever happen - once again, it would be cought at compile time.  
<br><br>
 The <a href="#VisitorPattern"><b>Visitor Pattern</b></a> is a special case of <a href="http://perldesignpatterns.com/intermap.cgi?wiki=FeatureEnvy&amp;word=%20we%27re">FeatureEnvy: we're</a> more concerned about another objects data than our own. This flies in the face of the first rule of <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming: data and related code should be packaged together. <a href="#FeatureEnvy"><b>Feature Envy</b></a>
suggests that perhaps the code should just be moved into the object
being tweaked. In this case, we've been there, didn't like it, and
moved it, but abstracted it behind an interface. The alternatives would
have been <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> or something far worse. The first rule of <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming is that anything is okay if its  hidden behind an interface. 
<br><br> The important thing to remember is that we can cheese things
as long as they provide an interface that allows cheesing. In this
example, <i>query_flag()</i>, <i>set_flags()</i>, <i>query_price()</i>, and <i>add_price()</i>.  
<br><br>
 <font size="+2"><b>Credits</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?GangOfFour">Gang Of Four</a> 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#ResultObject"><b>Result Object</b></a> </li><li> <a href="#MoveLargeDatastructuresToContainers"><b>Move Large Datastructures To Containers</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> Class::Visitor </li><li> Netscape::Bookmarks </li><li> <a href="http://patternsinperl.com/designpatterns/visitor/">http://patternsinperl.com/designpatterns/visitor/</a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Visitor/">http://hatena.dyndns.org/~jkondo/DesignPattern/Visitor/</a> </li><li> <a href="http://www.perldesignpatterns.com/?AdvancedPerlProgramming">Advanced Perl Programming</a>, page 56: the <a href="http://www.perldesignpatterns.com/?ExpressionPlotting">Expression Plotting</a> example </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Visitor.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Visitor.html</a> 
<br><br>

<br><br>
 <br><br> <a name="IteratorInterface"></a><h2><a href="#IteratorInterface"><b>Iterator Interface</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Create a unified interface for iterating through data items. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>You have objects that contain sets of things, or you have objects that  are arranged into structures. 
<br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>Each package has a slightly different way to look through data items it contains. 
<br><br> This is a specific example of a general idea: if there is a
kind of thing that needs done, create an abstract class (a package that
has only empty methods) that outlines a general interface for doing it.
In this case, we're concerned about looping through a collection of
values: <br><br>
 <pre>  package Iterator;

  sub hasNext { die; }
  sub getNext { die; }</pre>
<br><br> Other packages can come along and add Iterator to their @ISA
list. They will need to redefine these methods. Now we have a uniform
way of doing something. If a method in an object is expecting an
Iterator as its argument, it has a way of checking to see if its
argument really is an Iterator. It can be an Iterator and anything,
else, too. This supports Type Safety. <br><br> This is a simple case. If an object doesn't directly contain
the values, but instead references a network of items, we can recurse
over them. This can be wrapped in an Iterator interface. <br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?SampleTree">Sample Tree</a>;

  sub new {
    my $type = shift;
    my $this = { @_ };

    bless $this, $type;
  }

  sub getIterator {
    my $this = shift;
    return new Foo::Iterator node=&gt;$this;
  }

  sub get_left {
    my $this = shift;
    return $this-&gt;{'leftNode'};
  }

  sub get_right {
    my $this = shift;
    return $this-&gt;{'rightNode'};
  }

  package <a href="http://www.perldesignpatterns.com/?SampleTree">Sample Tree</a>::Iterator;

  sub new {
    my $type = shift;
    my %opts = @_;
    my $this = {state=&gt;0, iterator=&gt;undef, node=&gt;$opts{'node'};
    bless $this, $type;
  }

  sub getNext {
    my $this = shift;
    my $result;
    if($this-&gt;{'iterator'}) {
      $result = $this-&gt;{'iterator'}-&gt;getNext();
    }
    if($result) { 
     return $result;
    } elsif($this-&gt;{'state'} == 0) {
      # try the left node
      $this-&gt;{'iterator'} = $this-&gt;{'node'}-&gt;get_left();
      $this-&gt;{'state'} = 1; 
      return $this-&gt;getNext();
    } elsif($this-&gt;{'state'} == 1) {
      # try the right node
      $this-&gt;{'state'} = 2;
      $this-&gt;{'iterator'} = $this-&gt;{'node'}-&gt;get_right();
      return $this-&gt;getNext();
    } else {
       # state == 2
       return undef;
    }
  }</pre>
<br><br>
 This [untested XXX] code allows a network of objects having the <i>getIterator()</i>
method to cooperatively and transparently work together. Each object in
the network may have a different way of iterating. This example
represents a tree datastructure. The tree may contain other tree nodes,
array objects, queues, and so forth. As long the network consists of
objects with a <i>getIterator()</i> method that returns an object that
implements the Iterator iterface, we can crawl through the whole thing.
That's composition you can take to the bank and smoke! <br><br> Iteratoring through data sets which your object contains or
which other objects contain is all fine and dandy, but this same
interface gives us everything we need to iterator over data sets that
don't exist at all, except perhaps in our imagination. The things we
iterate over could be things that we know to exist from theory, like
prime numbers. Computing things from a large set as they are needed,
rather than beforehand, is called <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a>. <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a>
lets you set up pipelines where different parts of the program do
operations on data as it is generated when read. Contrast this with the
typical Perl approach of slurping everything into memory, then working
on it: <br><br>
 <pre>  # slurp everything into memory, then work on it:

  open my $file, 'dataset.cvs' or die $!;
  read $file, my $data, -s $file or die $!;
  close $file;

  foreach my $i (split /\n/, $data) {
    # process
  }

  # process as we read:

  my $process = sub {
    # process
  };

  open my $file, 'dataset.cvs' or die $!;
  while(my $record = &lt;$file&gt;) {
    $process-&gt;($record);
  }
  close $file;</pre>
<br><br>
 Returning all of the data from a <i>get_</i> method fosters
slurping everything into memory. This fosters programers which are
limited by memory in how large of datasets they can work on. You can
chuckle and say that virtual memory will take up the slack, but if I
can tell you that there are a heck of a lot of multi terrabyte data
warehouses kicking around the world. Dealing with data in place, where
your storage is essentially at capacity at all times, or having
multiple clients process a very large dataset in parallel demands
efficiency. There are still a few applications for good programmers and
a few applications for good programmers to write. <br><br>
 The second example above, rewritten as a <i>provider</i>: 
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?RecordReader">Record Reader</a>;

  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>;
  @ISA = qw(Interface);

  sub new {
    my $type = shift;
    my $file = shift;
    open my $filehandle, $file or die $!;
    my $me = { handle =&gt; $filehandle, next =&gt; undef };
    bless $me, $type;
  }

  sub getNext {
    return $next if defined $next;
    return &lt;$handle&gt;;
  }

  sub hasNext {
    return 1 if defined $next;
    $next = &lt;$me&gt;;
    if($next) {
      return 1; 
    } else {
      close $fh;
      return 0;
    }
  }</pre>
<br><br> Compare this to Java's IO Filters, which will superimpose read
of datastructures, international characters, and so forth on top of IO
strems: you'll find it to be remarkably similar. It lets users mix and
match IO processing facilities. <br><br>
 <font size="+2"><b>Iterating and Overloading</b></font><br><br>Perl <i>overloads</i> the "++" operator to iterator strings through a useful realm of values: 
<br><br>
 <pre>  $a = "aaa"; $a++; print $a, "\n"; # prints "aab"</pre>
<br><br>
 See <a href="#OverloadOperators"><b>Overload Operators</b></a> for how to create constructs like this yourself in Perl according to this formula: 
<br><br>
 </li><li> An accessor returns an object, perhaps using <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> That object has operators overloaded for it, specifically "++" 
<br><br>
 XXX - an exmample of exactly this would be really nice 
<br><br>
 <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a> may be implemented in Tied Hash<a href="http://www.perldesignpatterns.com/?TiedHash">+</a>
- XXX. As many Perl Patterns writeups point, hashes themselves have an
interator interface. Many implementaitons of an iterator will need a
more complex interface - reporting on the data it contains, or removing
items from the beginning or end of a queue. This creates pressure to
use another interface besides a Tied Hash<a href="http://www.perldesignpatterns.com/?TiedHash">+</a>, but even then, a Tied Hash<a href="http://www.perldesignpatterns.com/?TiedHash">+</a> may be used as both an object and a hash at the same time. 
<br><br>
 XXX - an exmample of exactly this would be really nice 
<br><br>
 <font size="+2"><b>Sieve of Eratosthenes</b></font><br><br><a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/117119">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/117119</a> - implemented in Python. A Perl version would be a nice example for Perl iterators. 
<br><br> (FWIW, I would suggest separating the sections of this page
that are about iteration in general from those which describe the
pattern of creating an iterator entity for the purposes of controlling
a loop. Perhaps things like Sieve of Eratosthenes go on a new page
named Iteration Techniques<a href="http://www.perldesignpatterns.com/?IterationTechniques">+</a>? Or if the point is that they're instances of the Iterator pattern, that needs to be made a bit clearer. - <a href="http://www.perldesignpatterns.com/?SleepyDee">Sleepy Dee</a> ) 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryConcept">Category Concept</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#NoSexUntilMarriage"><b>No Sex Until Marriage</b></a> </li><li> <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ProcessDataInPlace">Process Data In Place</a> </li><li> <a href="http://www.perldesignpatterns.com/?AdvancedPerlProgramming">Advanced Perl Programming</a> page 60 </li><li> <a href="#FunctionalProgramming"><b>Functional Programming</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AbstractTypes">Abstract Types</a> </li><li> 2D Linked List - where did that go? </li><li> <a href="http://www.perlmonks.org/index.pl?node=looping+over+multiple+arrays">http://www.perlmonks.org/index.pl?node=looping+over+multiple+arrays</a> - Closures as Iterators </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Iterator/">http://hatena.dyndns.org/~jkondo/DesignPattern/Iterator/</a>  </li><li> <a href="http://www.theperlreview.com/Issues/v0i5.shtml">http://www.theperlreview.com/Issues/v0i5.shtml</a> - <a href="http://www.perldesignpatterns.com/?ThePerlReview">The Perl Review</a> article </li><li> <a href="http://www.samag.com/documents/s=1273/sam05020007/">http://www.samag.com/documents/s=1273/sam05020007/</a> - <a href="http://www.perldesignpatterns.com/?ThePerlJournal">The Perl Journal</a>'s Iterator </li><li> <a href="http://www.perldesignpatterns.com/?CommandProcessingChainOfResponsibility">Command Processing Chain Of Responsibility</a> </li><li> <a href="http://citeseer.nj.nec.com/55669.html">http://citeseer.nj.nec.com/55669.html</a> </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/117119">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/117119</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Iterator.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Iterator.html</a> 
<br><br>

<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://perlmonks.org/index.pl?node_id=285065">http://perlmonks.org/index.pl?node_id=285065</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=285065">http://www.perlmonks.org/index.pl?node_id=285065</a> 
<br><br>
 <br><br> <a name="ConstraintSystem"></a><h2><a href="#ConstraintSystem"><b>Constraint System</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Difficult to solve problem. All of the related logic is huge and no control structure or organisation seems to be adequate. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Model the
problem using logic blocks that exert force on each other through a
network of connections. Let scenarios play themselves out recursively
across the network. <br><br>
 This rather large example was adapted from code in <a href="http://www.perldesignpatterns.com/?StructureAndInterpretationOfComputerPrograms">Structure And Interpretation Of Computer Programs</a>,
an excellent book. The program was originally written in Scheme, the
languaged featured in Structure and Interpretation. Even if you write
nothing but Perl, C or Java all of your life, I highly recommend this
book. Decomposing problems into functions is the first cautious step in
learning to program; decomposing programs into objects could be seen as
a second and factoring out the recursive nature of complex problems a
third. Complexity is the program killer, and its management is
paramount in scaling programs as well as solving problems. <br><br> In addition to adopting the example to Perl, I've adopted it
to use objects rather than lambda closures. This made the code longer
and less elegant, but verbose borish implementation is considered a
virtue in this day and age. <br><br>
 <i>Constrain::new()</i> is a wee little factory that spits
out subtypes on demand. We're not actually using this right now in our
code because by the time we got to the bottom of the file we forgot
that we had done that. Using a factory as such is a good policy: it
adds a layer of abstraction in the creation of objects, and each layer
of abstraction is insurance against change, giving us a single place
where we can translate the old interface to whatever is new. <br><br>
 <i>Constrain::Adder</i> is our first and only serious logic componenet. It should be  refactored into a base class with a <a href="http://www.perldesignpatterns.com/?TemplateFunction">Template Function</a>
and a sample implementation. Perhaps I'll get around to this later XXX,
as it would make this code more directly useful to random purposes.
When told what its value should be, it lashes back, sending a message
out on one of its connectors informing the objects on that connector
what value they must have to satisfy the condition. The <i>Adder</i>
object does whatever it must to satisfy the constraint. The three
inputs are identical in that they are all connections that may be
connected to any other logic devices. They differ in that the last will
be the sum of the first two. If any single inputs value is unspecified,
a value will be sent out on that connector. If all values are specified
after a new value comes in, the last output is the one we force to fit
the constraint. Should it not wish to do so, it may in turn push out a
new value by calling <i>setvalue()</i> on the connector. Eventually, a
solution that all nodes are happy with will be arrived at, or else
every possibility will be exhausted. XXX, return failure should we be
unable to arrive at a solution. This component has exactly three
connections. <br><br>
 <i>Constrain::Probe</i> describes an object that merely
repeats to the screen any value it is told to have. This componenet has
exactly one connection. <br><br>
 <i>Constrain::Constant</i> asserts a value on the wire and
refuses to accept any other value. Should it be told to be another
value, it fights back, pushing its own value back out again. This
componenet has exactly one connection. <br><br>
 Finally, <i>Constrain::Connector</i> isn't a logical
component at all - just a wire or messenger between them. It has no
behavior of its own other than to relay messages from one connection
out on the other connections. The above components each have a fixed
number of inputs - not so with a connector. A connector may be
connected to any number of components. <br><br>
 <pre>  package Constrain;
  
  # component - anonymous functions that exert force on each other.
  #             these are generated by various functions, much as an
  #             object in OO Perl would be created.
  
  sub new {
  
    my $type = shift;
    my $subtype = shift;

    return new Constrain::Adder(@_)     if $subtype eq 'adder';
    return new Constrain::Constant(@_)  if $subtype eq 'constant';
    return new Constrain::Probe(@_)     if $subtype eq 'prober';
    return new Constrain::Connector(@_) if $subtype eq 'connector';

    warn "Unknown Constrain subtype: $subtype";

  }
  
  package Constrain::Adder;
  
  sub new {
    my $type = shift;
  
    my $a1 = shift;         # the name of our first connector
    my $a2 = shift;         # the name of 2nd connector we are tied to
    my $sum = shift;        # the name of 3rd connector we are tied to
  
    my $obj = { a1=&gt;$a1, a2=&gt;$a2, sum=&gt;$sum };
    bless $obj, $type;
  
    $a1-&gt;xconnect($obj);
    $a2-&gt;xconnect($obj);
    $sum-&gt;xconnect($obj);
  
    return $obj;
  
  }
  
  sub forgetvalue {
     my $this = shift;
  
     $a1-&gt;forgetvalue($obj);
     $a2-&gt;forgetvalue($obj); 
     $sum-&gt;forgetvalue($obj); 
     $this-&gt;set_value(undef);
  }
  
  sub setvalue {
    my $this = shift;
    local *a1 = \$this-&gt;{a1};
    local *a2 = \$this-&gt;{a2};
    local *sum = \$this-&gt;{sum};
  
    if($a1-&gt;hasvalue() and $a2-&gt;hasvalue()) {
      $sum-&gt;setvalue($a1-&gt;getvalue() + $a2-&gt;getvalue(), $this);
  
    } elsif($a1-&gt;hasvalue() and $sum-&gt;hasvalue()) {
      $a2-&gt;setvalue($sum-&gt;getvalue($sum) - $a1-&gt;getvalue($a1), $this);
  
    } elsif($a2-&gt;hasvalue() and $sum-&gt;hasvalue()) {
      $a1-&gt;setvalue($sum-&gt;getvalue() - $a2-&gt;getvalue(), $this);
    }
  }
  
  sub dump {
     my $this = shift;
     local *a1 = \$this-&gt;{a1};
     local *a2 = \$this-&gt;{a2};
     local *sum = \$this-&gt;{sum};
  
     print("a1 has a value: ", $a1-&gt;getvalue(), "\n") if $a1-&gt;hasvalue();
     print("a2 has a value: ", $a2-&gt;getvalue(), "\n") if $a2-&gt;hasvalue();
     print("sum has a value: ", $sum-&gt;getvalue(), "\n") if $sum-&gt;hasvalue();
  }
  
  package Constrain::Constant;
  
  sub new {
  
    my $type = shift;
  
    my $value = shift;     # our value. we feed this to anyone who asks.
    my $connector = shift; # who we connect to.
  
    my $obj = { value =&gt; $value, connector =&gt; $connector };
  
    bless $obj, $type;
  
    $connector-&gt;xconnect($obj);
    $connector-&gt;setvalue($value, $obj);
  
    return $obj;
  
  }
  
  sub setvalue {
    my $this = shift;
    my $value = shift; 
    $this-&gt;{connector}-&gt;setvalue($value, $this);
  }
  
  sub getvalue {
    my $this = shift;
    return $this-&gt;{value};
  }
  
  package Constrain::Probe;
  
  sub new {
  
    my $type = shift;
    my $connector = shift;
    my $name = shift;
  
    my $obj = { connector =&gt; $connector, name =&gt; $name };
    bless $obj, $type;
  
    $connector-&gt;xconnect($obj);
  
    return $obj;
  
  }
  
  sub setvalue {
    my $this = shift;
    my $name = $this-&gt;{name};
    print "Probe $name: new value: ", $this-&gt;{connector}-&gt;getvalue(), "\n";
  }
  
  sub forgetvalue {
    my $this = shift;
    my $name = $this-&gt;{name};
    print "Probe $name: forgot value\n";
  }
  
  package Constrain::Connector;
  
  sub new {
  
    my $type = shift;
    my $obj = { informant=&gt;undef, value=&gt;undef, dontreenter=&gt;0, constraints=&gt;[] };
    bless $obj, $type;
  
  }
  
  sub hasvalue {
    my $this = shift;
    return $this-&gt;{informant}; 
  }
  
  sub getvalue {
    my $this = shift;
    return $this-&gt;{value};
  }
  
  sub setvalue {
    my $this = shift;
    local *constraints = \$this-&gt;{constraints};
    my $newval = shift;
    my $setter = shift or die;
  
    return if $this-&gt;{dontreenter}; $this-&gt;{dontreenter} = 1;
  
    $this-&gt;{informant} = $setter;
    $this-&gt;{value} = $newval;
  
    foreach my $i (@$constraints) {
      $i-&gt;setvalue($newval, $this) unless $i eq $setter;
    } 
  
    $this-&gt;{dontreenter} = 0; 
  }
  
  sub forgetvalue {
    my $this = shift;
    local *constraints = \$this-&gt;{constraints};
    my $retractor = shift;
  
    if($this-&gt;{informant} eq $retractor) {
      $this-&gt;{informant} = undef;
      foreach my $i (@$constraints) {
        $i-&gt;forgetvalue($this) unless $i eq $retractor;
      }
    }
  }
  
  sub xconnect {
    my $this = shift;
    local *constraints = \$this-&gt;{constraints};
    local *value = \$this-&gt;{value};
    my $newconstraint = shift or die;
  
    push @$constraints, $newconstraint;
    $newconstraint-&gt;setvalue($value, $obj) if $value;
  
  }
  
  package main;
  
  my $a =         Constrain::Connector-&gt;new();
  my $a_probe =   Constrain::Probe-&gt;new($a, 'a_probe');
  
  my $b =         Constrain::Connector-&gt;new();
  my $b_probe =   Constrain::Probe-&gt;new($b, 'b_probe');
  
  my $c =         Constrain::Connector-&gt;new();
  my $c_probe =   Constrain::Probe-&gt;new($c, 'c_probe');
  
  my $a_b_adder = Constrain::Adder-&gt;new($a, $b, $c);
  
  my $a_const =   Constrain::Constant-&gt;new(128, $a);
  
  my $b_const =   Constrain::Constant-&gt;new(256, $b);
  </pre>
<br><br>
 XXX - constraint system example - IK system using X11::Protocol? 
<br><br>
 XXX- constraint system example - traffic lights 
<br><br>
 XXX- constraint system with tied variables... $tempcelcius = 100; print $tempfarenheight; 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryExpert">Category Expert</a>, <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?StructureAndInterpretationOfComputerPrograms">Structure And Interpretation Of Computer Programs</a> </li><li> <a href="http://www.perldesignpatterns.com/?FuzzyLogic">Fuzzy Logic</a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> 
<br><br>

<br><br>
 <br><br> <a name="AboutInheritance"></a><h2><a href="#AboutInheritance"><b>About Inheritance</b></a></h2><br> 
<br><br>
 <pre>  
  /*
   * If you are going to copy this file, in the purpose of changing
   * it a little to your own need, beware:
   *
   * First try one of the following:
   *
   * 1. Do clone_object(), and then configure it. This object is specially
   *    prepared for configuration.
   *
   * 2. If you still is not pleased with that, create a new empty
   *    object, and make an inheritance of this objet on the first line.
   *    This will automatically copy all variables and functions from the
   *    original object. Then, add the functions you want to change. The
   *    original function can still be accessed with '::' prepended on the name.
   *
   * The maintainer of this LPmud might become sad with you if you fail
   * to do any of the above. Ask other wizards if you are doubtful.
   *
   * The reason of this, is that the above saves a lot of memory.
   */
  </pre><i>- Comment as seen on core library objects in LPMud 2.4.5</i> 
<br><br>
 <font size="+2"><b>Mirroring Real-Life</b></font><br><br>If you're thinking of using inheritance - <i>@ISA</i> in Perl - then you should be reading <a href="http://www.perldesignpatterns.com/?AbstractClasses">Abstract Classes</a> - there is a correct way to do it, then there is what everyone else does. 
<br><br>
 If you aren't thinking of using inheritance, then I wonder why you're reading this, and you probably are too. 
<br><br> LPMud is a dynamic adventure system. Players play while
wizards code. New puzzles spring into being from within the game, while
its running. The game is, of course, <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>,
in the name of mirrioring real-life object relationships. LPMud comes
from the days when 24 megs was a lot of memory on a Unix server [...And
a server had a lot more jobs than a server does now - mail, programming
language class development machine, DNS for their domain, running MUDs,
shell accounts for emailing with, perhaps a dozen other things.] <br><br> Given this object oriented system and these 24 megs of RAM,
wizards cleverly started copying core library objects around - the
player object, the monster object, the weapon object - and making
changes to them for their own use - a clear case of <a href="#CutAndPasteProgramming"><b>Cut And Paste Programming</b></a>. As you can see, that didn't go over very well.  
<br><br>
 Modern motivations against <a href="#CutAndPasteProgramming"><b>Cut And Paste Programming</b></a> are different than lack of RAM. See <a href="#CutAndPasteProgramming"><b>Cut And Paste Programming</b></a>, and then when you're sold, <a href="#AbstractClass"><b>Abstract Class</b></a>. 
<br><br>
 Perl's equivilent to LPMud's <i>clone_object(ob)</i> is <i>ob-&gt;new()</i>, though a <a href="http://www.perldesignpatterns.com/?FactoryMethod">Factory Method</a> may return a cloned or configured object. See <a href="#CloningPattern"><b>Cloning Pattern</b></a>. Creating object structures by holding onto references to other objects that you created with <i>new()</i> is known as <i>delegation</i>. See <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a>. This is the basis of most object patterns in this book. 
<br><br>
 Perl's equivilent to <i>inherit</i> is <i>use base</i>. See <a href="http://www.perldesignpatterns.com/?UseBase">Use Base</a>. Creating object structures using inheritance is called <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a>. <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a>
are best avoided. Inheritance should be used to build specialized
versions of generic objects - not to generalize further, and not to
combine general objects to make something. <br><br>
 Inheritance shouldn't be confused with exporting. Exporting adds features to a package, very much like <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a>,
but these features are used by that object only. Exporting isn't used
by sane people to build new types of objects. If you want <i>Carp</i>, for instance, you'll <i>use Carp</i> yourself, and not attempt to call <i>croak</i> in another object that happens to <i>use Carp</i>. See <a href="#ExportingPattern"><b>Exporting Pattern</b></a>. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?UseBase">Use Base</a> </li><li> <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TemplateMethodFromSubclassCommonalities">Template Method From Subclass Commonalities</a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ImplementationInheritance">Implementation Inheritance</a> </li><li> <a href="http://www.perldesignpatterns.com/?AttributeInheritance">Attribute Inheritance</a> </li><li> <a href="http://www.perldesignpatterns.com/?InterfaceInheritance">Interface Inheritance</a> </li><li> <a href="http://www.perldesignpatterns.com/?ParrallelInheritanceHeirachies">Parrallel Inheritance Heirachies</a> </li><li> <a href="#HowDoesPerlStackUp"><b>How Does Perl Stack Up</b></a> </li><li> <a href="#CloningPattern"><b>Cloning Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ConceptCrossReference">Concept Cross Reference</a> </li><li> Delegation::Concept </li><li> Graph Viz<a href="http://www.perldesignpatterns.com/?GraphViz">+</a>::ISA - graph inheritance trees </li><li> Devel::Symdump - same, but in ASCII  
<br><br>
 <font size="+2"><b> Contrast</b></font><br><br></li><li> Class::Classless 
<br><br>
 <font size="+2"><b>Category</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a>, <a href="http://www.perldesignpatterns.com/?ConceptsCrossReference">Concepts Cross Reference</a> 
<br><br>
 <br><br> <a name="ImportPattern"></a><h2><a href="#ImportPattern"><b>Import Pattern</b></a></h2><br> 
<br><br>

<br><br> Not all packages exist solely to create objects. In fact,
looking at most code, you would never know that it was using objects,
even though you clearly see "use" statements at the top of the code.
Import/export is a facility many objects provide to use features they
provide with a non-OO interface. This is often the best solution for
packages that add new features or abilities, like error handling, that
applies to the whole program, doesn't contain information, and doesn't
make sense to have copies of. Many Perl core modules like CGI.pm, offer
both an OO interface and a non-OO interface. <br><br> When Perl is parsing a program file and finds a "use"
statement, it stops in its tracks. The used module might offer features
needed to finish compiling. Perl goes off to load the new required
module. As soon as it is loaded, Perl calls the import() method. This
gives the module a chance to modify the state of the Perl interpreter
(in the case of pragmas, like "use strict"), to export functions, or
what ever else. It also allows you to insist on a certain level of
features in Perl when used with a number: <br><br>
 <pre>  use 5.9.34;
  print "Perl 6 should be just about ready by now!\n";</pre>
<br><br>
 To write a module that exports functions when use'd, the Exporter offers a convinient way: 
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?PrintLN">Print LN</a>;
  use Exporter;
  @ISA = qw(Exporter);

  @EXPORT = qw(println);                 # symbols to export by default
  @EXPORT_OK = qw(printpf);              # symbols to export on request

  sub println { print @_, "\n"; }        # print a line with a line feed
  sub printpf { print @_, chr(0x0c); }   # print a line with a page feed</pre>
<br><br> Functions named in @EXPORT always get exported to the program
that uses us. They can use them (almost) just like normal built in Perl
functions. Functions listed in @EXPORT_OK must be requested: <br><br>
 <pre>  package main;
  use <a href="http://www.perldesignpatterns.com/?PrintPL">Print PL</a> qw(printpf);

  printpf("This page intentionally left blank.");</pre>
<br><br>
 You could do the same thing manually, of course. Define an import method in your module, like so: 
<br><br>
 <pre>  sub import  {
    *{caller().'::printpf'} = sub { 
      print @_, chr(0x0c); 
    };
  }</pre>
<br><br> This doesn't have a lot to do with Object Oriented
programming. It is a staple of Perl programming, so we need to know
about it. <br><br>
 "use" also checks a modules version number, as stored in $VERSION, for you: 
<br><br>
 <pre>  use CGI 2.4;</pre>
<br><br> This will die unless $CGI::VERSION &gt;= 2.4. Perl checks the
target module's $VERSION package global variable variable and verifies
that it is equal to or greater than the number you specify. Perl
understands "ordinals", comparing 2.4.1 against 2.4.2 does the right
thing: 2.4.2 is larger. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#ExportingPattern"><b>Exporting Pattern</b></a> </li><li> <a href="#AboutInheritance"><b>About Inheritance</b></a> </li><li> <a href="#GlobalToLexical"><b>Global To Lexical</b></a> 
<br><br>
 <br><br> <a name="AbstractClass"></a><h2><a href="#AbstractClass"><b>Abstract Class</b></a></h2><br> 
<br><br> Problem: Several objects should be of the same basic type, as
they are interchangeable, though they will have different
implementations. <br><br> Solution: Implement the service differently in each
subclass, but provide the same interface. Use one or more "empty"
objects as parents to create common base types. <br><br>
 <font size="+2"><b>Abstract Classes Happen</b></font><br><br>Writing
code in the procedural style, a subroutine of a given name can be can
be defined several times - and often is. Which one is actually called
when its name is invoked depends on the exact type of the object:
different objects each may have a different definition of each
function. See <a href="http://www.perldesignpatterns.com/?LateBinding">Late Binding</a>. 
<br><br>
 The laundry list of functions that might be called in one object is called its <i>interface</i>.
In order to use objects interchangeably, they must each define all of
the functions that every other one does. Every time a new function is
added to one object, it must be added to all other objects meant to be
interchangeable, or eventually the program will die with an undefined
method error. This list of functions that must be available is the
interface. <br><br>
 <font size="+2"><b>Abstract Class Is...</b></font><br><br></li><li> Objects are user-defined datatypes. </li><li> One object can serve as any number of different object types as enforced by <i>-&gt;isa()</i>. </li><li> Testing for the presence of an Interface allows a running program to deturmine if an object offers certain features. </li><li> An Interface, or API, is a specification of features that doesn't include any actual implementation of the features. </li><li> Interfaces are defined by <a href="http://www.perldesignpatterns.com/?AbstractClasses">Abstract Classes</a>. 
<br><br>
 <font size="+2"><b>Formula</b></font><br><br></li><li> Create an empty base package and inherit it from each interchangeable module using <i>use base</i> or <i>@ISA</i>. <i>use interface</i> or a similar mechanism to do compile-time checking to catch API omissions.  </li><li>
Create stub methods in the base class to document the required methods
and to generate meaningful warnings if they aren't implemented in the
subclass. <br><br>
 <font size="+2"><b>Logic</b></font><br><br>Having an
interface, or extending a real class is basically the same idea: put
the new class or interface in the @ISA array, and you offer all of the
methods required to be a working version of that class. Normally this
is not a problem - the base class takes care of everything. Some base
classes only contain stubs for methods, and leave it up to you to
implement something useful for each of them. This is an <a href="#AbstractClass"><b>Abstract Class</b></a>, or "Pure Virtual Class". An  Abstract Class defines an "Interface". 
<br><br>
 <font size="+2"><b>Motivations</b></font><br><br></li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> Polymorphism 
<br><br>
 <font size="+2"><b>Section</b></font><br><br>Some times you
will see Abstract Classes define an Interface with nothing in it. Any
class in the world can automatically meet the expectations of an empty
interface merely by including mention of the Abstract Class in its @ISA
array. This is a <a href="http://www.perldesignpatterns.com/?MarkerInterface">Marker Interface</a>.
It tells the world that the object can do something, or be used in a
certain way that does not directly translate to which methods it
defines. It could mark the class as being "lightweight", telling the
world that its okay to create a million instances of it. It could be
used to tell the world that the object is safe to store with Storable. <br><br> Inheriting empty classes can be used as a simple, cheap way
to set attributes on objects. It can mark two classes as being the same
base type so they can be used interchangeably (polymorphism). <br><br> Why bother? Lets say you have a web based shopping cart, as
so many programmers do. You can add objects to it. These objects may
return thier price, weight, name, description, and an image when
queried. You start off with one kind of object - lets say, ink jet
cartridges. So far, so good. <br><br>
 <pre>  package Item;

  sub new {
    my $type = shift;
    my %args = @_;
    $me-&gt;{name} = $args{name};
    $me-&gt;{price} = $args{price};
    $me-&gt;{image} = $args{image};
    $me-&gt;{description} = $args{description};
    $me-&gt;{weight} = $args{weight};
  }
  
  foreach my $i (qw(name price weight desciption image)) {
    # create accessor
  }
  </pre>Then
the store adds paper, toner, refill kits, cables, dye sublimation ink,
impact ribbons, and new ribbons. Then the store starts giving discounts
for toner and inkjet cartridge returns. Then you're asked to give
warnings if someone tries to buy a new printer with the wrong kind of
paper or ink. Fields are introduced to specify compatibilty and
compatibility requirements, as well as return discount amout and
eligability. <br><br> Since each type of object is doing something a little
different, you make them seperate objects. You've lain the original
Item class to rest in favor of Printer, Toner, Ink, <a href="http://www.perldesignpatterns.com/?InkRefill">Ink Refill</a>,
Paper, etc classes. Years later, another programmer comes along and
adds donations to a good cause (matched by the store) that users may
buy. Unaware of the ugliness behind the cart, he adds the name, price,
weight, decription, and image fields. Everything seems to work fine
until someone tries to buy a printer and thc cart calls
compatability($printerob) in his object to find out if that item is
compatable with that printer. This method isn't found, and the program
blows up. <br><br> By reintroducing Item.pm as an object full of empty methods,
and using interface.pm to declare Item.pm as an interface in Toner.pm,
Paper.pm, Donation.pm, Ink.pm, and <a href="http://www.perldesignpatterns.com/?InkRefill">Ink Refill</a>.pm,
we know right away if a module has failed to define a needed method. We
don't need to wait for a good testing, or worse: a user finds it before
we do. This is "design by contract": because of the interface contract,
we know exactly which methods need to be implemented, not because we
were told, but because the system requires it by refusing to compile.
The objects in question can be used interchangeably - we're garunteed
of it. <br><br> Explicitly using, then adding to @ISA, a marker interface is
kind of ugly. One solution is to move part of the work to the abstract
marker class: <br><br>
 <pre>  package Item;

  sub import {
    push @{caller().'::ISA'}, __PACKAGE__;
  }</pre>
<br><br> Viola! Whenever anyone uses Item.pm, their package will be
marked as being (is-a) Item. Should that object ever be tested with
-&gt;isa('Item'), it will come back true. We have this one bit of @ISA
munging logic in the abstract marker class rather than: <br><br>
 <pre>  use Item;
  push @ISA, 'Item';</pre>
<br><br>
 ...floating around everywhere.  
<br><br>
 A quick and dirty trick for  A base class could abuse its <i>import()</i> method to do compile-time interface (API) checking. Since <i>import()</i> gets called while the <i>use</i> for that module is being processed and before the <i>use</i>'ing
module is allowed to run, it has a perfect chance to steal that
CPU-share (kind of like mind-share) to do some checking and discover if
any of the stub methods aren't in fact being redefined. <br><br>
 <pre>  # example of making sure that an interface is implemented

  package <a href="http://www.perldesignpatterns.com/?FooAbstractClass">Foo Abstract Class</a>; # rename this with your abstract class

  sub import {
    my $caller = caller;
    eval "use $caller;"; # let them finish loading
    foreach my $i (grep { defined &amp;{$_} } keys %{__PACKAGE__.'::'}) {
      die __PACKAGE__ . " is listed as a base type in $caller, but the $i method is not implemented!"
        unless defined &amp;{$caller.'::'.$i};
    }
  }</pre>
<br><br> interface.pm by yours truly (look for it on CPAN) implements
compile-time interface checking in Perl, similar to the example above,
merely with a cleaner interface itself: <br><br>
 <pre>  use interface 'Class::Struct', 'Clonable';</pre>
<br><br> This tells Perl that we must define all of the methods listed
in Class::Struct as well as Clonable. If we fail to, we don't compile,
and we don't run. <br><br>
 <font size="+2"><b>Interface Design Guidelines</b></font><br><br></li><li>
Don't bundle unrelated operations in a single method. Methods shouldn't
have bizarre side effects when used from the perspective of wanting one
or the other feature. </li><li> Few is usually better than more.
Should new functionality be needed in the future, it can be defined by
an interface, then implemented by whichever modules it is appropriate
for, or even added directly to the base parent class. </li><li> The
few operations should combine well. This means creating and returning
objects that can be directly used by other accessors and other objects.
</li><li> Objects of the same type should combine well. <a href="http://www.perldesignpatterns.com/?OverloadPattern">Overload Pattern</a>
can be employed to define the combinatrics of how two objects interact.
If operator overloading isn't desired, think in terms of operating
overloading. <a href="http://www.perldesignpatterns.com/?EqualsInterface">Equals Interface</a>, <a href="#AggregatePattern"><b>Aggregate Pattern</b></a> 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?WhyPerlDesignPatterns">Why Perl Design Patterns</a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?UseBase">Use Base</a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?MarkerInterface">Marker Interface</a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?EqualsInterface">Equals Interface</a> </li><li> <a href="#AggregatePattern"><b>Aggregate Pattern</b></a> </li><li> <a href="#DesignContract"><b>Design Contract</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AbstractObject">Abstract Object</a> </li><li> <a href="#TemplateMethod"><b>Template Method</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="#InterfaceBloat"><b>Interface Bloat</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DiverseInterfaces">Diverse Interfaces</a> </li><li> Attribute::Abstract </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=AbstractClass.htm">ObjectArts:AbstractClass.htm</a> </li><li> <a href="http://www.perldesignpatterns.com/?LateBinding">Late Binding</a> 
<br><br>

<br><br>
 <br><br> <a name="TemplateMethod"></a><h2><a href="#TemplateMethod"><b>Template Method</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Each subclass changes details of an otherwise identical method. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Implement the essential framework of the method in the superclass and use <i>$this-&gt;foo()</i> to access the bits and peices that vary by subclass. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Even though you can override methods in subclasses, the base classes won't use your new methods by default: 
<br><br>
 <pre>  # redefining compute_gcd() in a sublass won't affect this code
  $gcd = compute_gcd($x, $y);     </pre>
<br><br>
 They will continue using the methods and functions defined in the same class as themselves, unless they go out of their way: 
<br><br>
 <pre>  # this will use the top-most version of compute_gcd() 
  $gcd = $this-&gt;compute_gcd($x, $y); </pre>
<br><br> A method that does some work, but passes off sub-tasks using
the -&gt; syntax is said to be a "template method". This method forms
the basis for an operation, but is open-ended. Its behavior can be
tailored, customized and specialized in subclasses. This aids in code
re-use. <br><br> In order for the class to be used, either default
implementations must be provided, or someone must subclass it and fill
in the missing methods required by the code in the base class. <br><br>
 Template methods can be used with <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a>, even outside of objects: 
<br><br>
 <pre>  package main;

  our $this = __PACKAGE__;

  sub template_records {
    my @records = $this-&gt;query_records();
    foreach my $record (@records) {
      $this-&gt;per_record($record);
      my $output = $this-&gt;template_record($record);
      $this-&gt;save_record($output);
    }
  }

  sub per_record {
    # do nothing
  }

  sub query_records {
    # default implementation
  }

  sub template_record {
    # populate a template with data from $record
  }

  sub save_record {
    # save $output to disc
  }</pre>
<br><br> We write this code as a normal program, with no special or
even ordinary object-orientedness. Its not in a package. It wasn't
created from a constructor. We can't handle multiple instances of our
program. The only thing we need to take advantage of template methods
is the <i>$this-&gt;method()</i> syntax itself. We can fake having an object instance with the <i>our $this = <u>PACKAGE</u>;</i> gambit. <u>PACKAGE</u>
always contains the name of the current package for the module its in.
Rather than access an instance of the class, we access the definition
of the class directly. <br><br> When the time comes to add customizations for a single
client, the changes are dropped in without affecting the behavior of
the original, though perhaps we will need to break out more logic from
the main <i>template_records()</i> routine. 
<br><br>
 <pre>  # in <a href="http://www.perldesignpatterns.com/?MegaCorp">Mega Corp</a>.pm:

  package <a href="http://www.perldesignpatterns.com/?MegaCorp">Mega Corp</a>;

  our $this = __PACKAGE__;
  @ISA = qw(main);

  sub per_record {
    my $this = shift;
    my $record = shift;
    if($record-&gt;{price} == 0) {
      $record-&gt;{availability} = "Sold Out";
    }
  }

  1;</pre>
<br><br>
 We load up the original code, but we also load up <a href="http://www.perldesignpatterns.com/?MegaCorp">Mega Corp</a>.pm,
and thats what we use. It borrows all of the logic from the original,
but makes some changes to it. The best part is that we can create any
number of modules like this and share the main code between all of
them. The same code can work different ways for each client, project,
customer, and so on. <br><br>
 The normal mode of the <a href="#TemplateMethod"><b>Template Method</b></a>
is that we expect to be inherited and have things overridden on a fine
scale. The flip side of the coin is the module that inherits us. These
are two sides of the same coin, so to speak: coming at the same problem
from two angles to make things better. <br><br>
 <i>A subtle phenomenon occurs in traditional programming
languages: While writing the program for 'Issue an error message and
try to recover', a programmer subconsciously tries to get by with the
fewest possible lines of code, in cases where the program for 'Update
the code structure' is quite short. For if an extensive error recovery
were actually programmed, the subroutine would appear to hvae
error-message printing as its main purpose. The programmer knows that
the error is really an exceptional case that arises only rarely;
therefore a lengthy error recovery doesn't look right, and most
programmers will minimize it (without raelizing they are doing so) in
order to make the subroutine appearance match its intended behavior.</i> - <a href="http://www.perldesignpatterns.com/?DonaldKnuth">Donald Knuth</a>, in <a href="#LiterateProgramming"><b>Literate Programming</b></a> 
<br><br> This highlights another benefit: the purpose of the routine is
immediately obvious, while nit-picky details are farmed out. Routines
can be composed to resemble what they do to a greater degree and how
they do it to a lesser degree. <br><br>
 A permutation of the <a href="#TemplateMethod"><b>Template Method</b></a>
is the "abstract template method". Used when a base class provides a
case so general that there is no default behavior. This may well
describe most cases. <i>map { }</i> is a simple example: a code block
is applied to each item in the input list, and the collected results
are returned as a new array. Only the strucure is defined: what is
actually done to each array element is left to the user to specify via
a code block. <i>map { }</i> takes the codeblock as an argument, rather than calling a method with a fixed name.  Programmers used to the <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> style of programming will find <i>map { }</i> more natural. Indeed, it is identical to the <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> style with few exceptions:  
<br><br>
 </li><li> Callbacks are named, as arguments, before the template method is invoked rather than hardcoded, by name, inside of it. </li><li> Code references passed explicitly to be called back negate the need for <i>$this</i> to point to the current object. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TemplateMethodFromSubclassCommonalities">Template Method From Subclass Commonalities</a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Template-method.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Template-method.html</a> 
<br><br>

<br><br>
 <br><br> <a name="StateVsClass"></a><h2><a href="#StateVsClass"><b>State Vs Class</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>The base class
is simple and subclasses are frequently implementing the same features
on top of the base class, but in different combinations. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Allow
objects to handle methods differently depending on their state, rather
than demand that every possibily behavior be exhibited by a seperate
object. Move shared behavior upwards even if not every subclass
ultimately uses it. Make the base class the general, and allow
subclasses to remove features - permenently or conditionally - to
create special purpose version. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Given a
special case of something that isn't really one at all, refactor. Gimpy
versions of objects are still merely versions of those objects. Lack of
feature doesn't automatically make something a candidate for
superclasshood. In general, there is no harm adding functionality to
the base class: this is often the cleanist solution, and the quickist
way to make it available to all of the subclasses. <a href="#DecoratorPattern"><b>Decorator Pattern</b></a> talks about a degenerate situation where <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> attempt to create endless combinations of features and ultimately fail.  
<br><br>
 Simple <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Rules&amp;word=*">Rules:
*</a> The result of invoking -&gt;isa() on the objects should always make sense. If -&gt;isa() disagrees, the design is wrong. </li><li> The general case should be the superclass. A parrot that could not <i>perch()</i> is still a parrot.  </li><li> Don't confuse stateful behavior with the need to subclass. 
<br><br>
 A parrot that is as dead as a door nail is still just a special case of parrots,  and parrots in general have facilities to <i>perch()</i>, <i>squak()</i>, <i>eat()</i> and <i>bite()</i>.
Whether or not these facilities are working, or what the exact behavior
of them can be left to the subclass. Perhaps the parrot is pining for
the fjords and doesn't feel like <i>squak()</i>ing. Perhaps its deceased, but a parrot nonetheless. 
<br><br> Inheritance is "specialized case of", not "made out of". A
bird is not a specialized case of a beak and legs. For composing
something out of mix and match parts, use composition: see <a href="#CompositePattern"><b>Composite Pattern</b></a>. 
<br><br>
 <pre>  package Parrot;

  sub new {
    my $type = shift;
    my $me = { @_ };
    bless $me, $type;
  }

  sub perch {
    my $this = shift;
    $this-&gt;{perch} = shift;
    $this-&gt;{perch}-&gt;add_weight(38);
    return 1;
  }

  sub squak {
    print "Eeeeeeeeeeek!\n";
  }

  package Parrot::African;
  use base 'Parrot';
  
  sub squak {
    print "EEEEEEEEEEEEEEEEEEEEEEEEK!\n";
  }

  package Parrot::Pining;
  use base 'Parrot';

  sub perch {
    my $this = shift;
    return SUPER::perch(@_) if $this-&gt;{at_fjords};
    return undef;
  }
  
  sub squak {
    my $this = shift;
    return SUPER::squak(@_) if $this-&gt;{at_fjords};
    return undef;
  }</pre>
<br><br>
 A call to <i>squak()</i> in a parrot is a notification that
it should squak, or a request that it sqauk, never a garantee that a
squak will be emitted. <br><br>
 <a href="#AbstractClass"><b>Abstract Class</b></a> and <a href="http://www.perldesignpatterns.com/?FunctionalityIsToBeShared">Functionality Is To Be Shared</a> [and elsewhere? or elsewhere?]  tell us to move functionality as high up the inheritance chain as is useful. 
<br><br>
 <a href="#StatePattern"><b>State Pattern</b></a> suggests
delegating requests to a different object depending upon state, where
each object you delegate to represents a state. This satisifies our
requirement that objects not be swapped out runtime, and that
polymorphism should be maintained [that is, the requirements of the
interface should still be met - see <a href="#DesignContract"><b>Design Contract</b></a>], even when the bird goes into a "dead" state. We still maintain the same presentation - unlike <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a>,
a completely different object isn't swapped in in our place. Only
behind the scenes, through a cleverly placed layer of delegating, is
statehood implemented in terms of objects. This satisifies the <a href="#LawOfDemeter"><b>Law Of Demeter</b></a>. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryConcept">Category Concept</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryExpert">Category Expert</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ObjectOrientedDesignHeuristics">Object Oriented Design Heuristics</a> 5.17, 6.2 </li><li> <a href="#ExplicitTypeCaseAnalysis"><b>Explicit Type Case Analysis</b></a>, <a href="#StatePattern"><b>State Pattern</b></a>, <a href="#DecoratorPattern"><b>Decorator Pattern</b></a>, <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> </li><li> C2 <a href="http://www.perldesignpatterns.com/?DualityBetweenStateAndClass">Duality Between State And Class</a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?FunctionalityIsToBeShared">Functionality Is To Be Shared</a> </li><li> <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a> </li><li> <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a>, <a href="#ThinWrappers"><b>Thin Wrappers</b></a> </li><li> <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> </li><li> <a href="#NoSexUntilMarriage"><b>No Sex Until Marriage</b></a> 
<br><br>

<br><br>
 <br><br> <a name="ChainOfConstructors"></a><h2><a href="#ChainOfConstructors"><b>Chain Of Constructors</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Adding
features to a class via inheritance. The class you're extending may do
some, but you need to do some setup, too. You run their constructor,
then augment the result. <br><br>
 <font size="+2"><b>When</b></font><br><br>Any time you inherit, but especially when the constructor of the class does some setup work. 
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?BetterGronkulator">Better Gronkulator</a>;

  @ISA=('Gronkulator');

  sub new {
    my $type = shift;
    my $me = SUPER::new($type, @_);
    $me-&gt;{'spiffyNewThing'} = new <a href="http://www.perldesignpatterns.com/?BetterGronkulator">Better Gronkulator</a>::<a href="http://www.perldesignpatterns.com/?SpiffyNewThing">Spiffy New Thing</a>;
    return $me;
  }</pre>
<br><br>
 We let <i>SUPER::new()</i> (our parent's new() method)
create the object for us. If they do it correctly, using the type in
the first argument, we don't need to bless it. We are now free to
modify the object however suits us. Here, we're creating a new object
and storing a reference to it. This lets us add to the features of a
class without having to rewrite their entire constructor, and risk
having it change in a future version. If someone extends us, they can
apply this same pattern, and add features to what we do. <br><br>
 <font size="+2"><b>Categories</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#RevisitingNamespaces"><b>Revisiting Namespaces</b></a> </li><li> NEXT on CPAN </li><li> <a href="#AboutInheritance"><b>About Inheritance</b></a>  </li><li> <a href="#EmptySubclassFailure"><b>Empty Subclass Failure</b></a> 
<br><br>

<br><br>
 <br><br> <a name="SingletonPattern"></a><h2><a href="#SingletonPattern"><b>Singleton Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>There should be only one object of this type.  
<br><br>
 <font size="+2"><b>Context</b></font><br><br>Writing a constructor method. Limiting the creation of objects in the constructor. 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>You've found a
very good reason to have exactly one of a certain class. Your class
features a constructor that other modules can call, but the design
considers it an error to create more than one instance of that class.
Or, you have a single instance of an object now, but this is an
implementation detail, subject to change. <br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>Resource
objects are created when the program starts and passed to the
constructor of each object initially spawned. Each of those objects in
turn pass this resource object to each of their children. <br><br>
 <font size="+2"><b>Pressures</b></font><br><br></li><li> <a href="#PassingState"><b>Passing State</b></a> says to create the resources as early as needed and  pass it to constructors, but you would be passing it almost everywhere.  </li><li> <a href="#FlyweightPattern"><b>Flyweight Pattern</b></a> teaches to reuse objects rather than creating numerous indentical duplicates. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Rig a
constructor to return a single existing instance instead of making a
new one. Have your public constructor return the same single object
every time it is called. Allow objects to call the constructor wherever
they need it. The Singleton will create the single instance of itself,
and will be the repository for that single instance. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br><a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wiki&amp;word=SingletonPattern">Wiki:SingletonPattern</a> lists example valid uses as logging, network interaction, and database connections.  
<br><br>
 This is the most popular of the "Design Patterns" cataloged by the <a href="http://www.perldesignpatterns.com/?GangOfFour">Gang Of Four</a>. 
<br><br>
 </li><li> Stems from deep seated paranoia. </li><li> Doesn't let anyone make more than exactly one of something. </li><li> Used as an excuse to hardcode object references around instead of taking them in the constructor. See <a href="#PassingPattern"><b>Passing Pattern</b></a>. 
<br><br>
 Singletons are a special case of Static Objects<a href="http://www.perldesignpatterns.com/?StaticObjects">+</a>. 
<br><br>
 <font size="+2"><b>//Don't Use Singletons When...//</b></font><br><br>This
is over used. Don't make too many assumptions about when two of
something could be handy. For example, the X-Windows windowing system
early on assumed that more than one display could be attached to a
system. <br><br> This pattern should be used to distribute globally available
resources. It should not be used to contain context or state
information - this would make it impossible to create distinct
instances of objects which use the singleton. <br><br>
 Singletons should not be Value Objects<a href="http://www.perldesignpatterns.com/?ValueObjects">+</a>. 
<br><br> Since many programs have a proliferation of Singletons, it may
be handy to place all of them in a global Static Object, which itself
is a Singleton. <br><br>
 A Singleton managing a set of 1 or more objects for which there is contention or sharing is a <a href="http://www.perldesignpatterns.com/?ResourcePool">Resource Pool</a>. 
<br><br>
 When a <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a> is wanted to hold configuration information, instead use <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PassingPattern&amp;word=%20this">PassingPattern: this</a>
allows different instances of objects to be given different runtime
parameters. Failure to do so would violate the identity requirement of <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming, and we wouldn't want that, would we? 
<br><br>
 <font size="+2"><b>Examples</b></font><br><br>Given a <a href="http://www.perldesignpatterns.com/?MountRushmore">Mount Rushmore</a> object, you want to be sure that its the true, one and  only, <a href="http://www.perldesignpatterns.com/?MountRushmore">Mount Rushmore</a>, and not someone's cheap knock-off.  
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?MountRushmore">Mount Rushmore</a>; 
  
  sub new {
    my $type = shift;
    my $this = {  
      presidents =&gt; ['George Washington', 'Thomas Jefferson', 
                     'Theodore Roosevelt', 'Abraham Lincoln']
    };
    return bless $this, $type;
  }
  
  sub someMethod { ... }</pre>
<br><br>
 Lazy initialization with file lexical: Calling the <i>instance()</i> method will always return the same object. 
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?MountRushmore">Mount Rushmore</a>; 
  
  my $oneTrueSelf;
  
  sub instance {
    $oneTrueSelf ||= (shift)-&gt;new();
  }
  
  sub new {
    my $type = shift;
    my $this = {  
      presidents =&gt; ['George Washington', 'Thomas Jefferson', 
                     'Theodore Roosevelt', 'Abraham Lincoln']
    };
    return bless $this, $type;
  }</pre>
<br><br>
 Lazy initialization with embedded constructor: The example eliminates the general-purpose constructor altogether. 
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?MountRushmore">Mount Rushmore</a>; 
  
  my $oneTrueSelf;
  
  sub new {
    if($oneTrueSelf) {
      return $oneTrueSelf;
    } else {
      my $type = shift;
      my $this = {
        presidents =&gt; ['George Washington', 'Thomas Jefferson', 
                       'Theodore Roosevelt', 'Abraham Lincoln']
      };
      $oneTrueSelf = bless $this, $type;
    }
  }</pre>
<br><br>
 <font size="+2"><b>Resources</b></font><br><br><a href="http://www.theperlreview.com/Issues/The_Perl_Review_0_1.pdf">http://www.theperlreview.com/Issues/The_Perl_Review_0_1.pdf</a> - brian d foy's article on Singleton in The Perl Review 
<br><br>
 <a href="http://www.perlmonks.com/index.pl?node_id=234123">http://www.perlmonks.com/index.pl?node_id=234123</a> for a good description of the delimma - very good. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>Credits</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?GangOfFour">Gang Of Four</a> 
<br><br>
 <font size="+2"><b>Also Known As</b></font><br><br></li><li> The Highlander ("There can be only one!") 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="#PassingPattern"><b>Passing Pattern</b></a> </li><li> <a href="#FlyweightPattern"><b>Flyweight Pattern</b></a> </li><li> <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ResourcePool">Resource Pool</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=Singleton.htm">ObjectArts:Singleton.htm</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=SingletonsAreEvil">WikiWiki:SingletonsAreEvil</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=NarrowTheInterface">WikiWiki:NarrowTheInterface</a> </li><li> <a href="http://www.theperlreview.com/Issues/The_Perl_Review_0_1.pdf">http://www.theperlreview.com/Issues/The_Perl_Review_0_1.pdf</a> </li><li> <a href="http://patternsinperl.com/designpatterns/singleton/">http://patternsinperl.com/designpatterns/singleton/</a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Singleton/">http://hatena.dyndns.org/~jkondo/DesignPattern/Singleton/</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=PerlSingleton">WikiWiki:PerlSingleton</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=234123">http://www.perlmonks.com/index.pl?node_id=234123</a> </li><li> <a href="http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perltootc.pod#Monadic_Classes">http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perltootc.pod#Monadic_Classes</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/identityMap.html">http://www.martinfowler.com/eaaCatalog/identityMap.html</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/registry.html">http://www.martinfowler.com/eaaCatalog/registry.html</a> </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/66531">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/66531</a> - Borg Object<a href="http://www.perldesignpatterns.com/?BorgObject">+</a> - good discussion </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Singleton.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Singleton.html</a> </li><li> <a href="http://www.perldesignpatterns.com/?PatternTemplate">Pattern Template</a> 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>I like this. I've made some changes to wording to try to keep a
 good flow to it. I'm also playing with the 2nd level heading style
 I proposed in <a href="http://www.perldesignpatterns.com/?PatternTemplate">Pattern Template</a> and the "Also Known As" block also
 suggested there. This page still contains some references that I need to 
 fix. Very cool. - <a href="#ScottWalters"><b>Scott Walters</b></a> - <i>Thu Aug 21 19:20:52 2003 216.190.249.170</i> 
<br><br>
 <!-- cut - end comments --> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA">http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA</a> 
<br><br>
 <br><br> <a name="CurryingConcept"></a><h2><a href="#CurryingConcept"><b>Currying Concept</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Code is repeated and resists being refactored out.  
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Make the
process of building the function or object you ultimately need and
incremental process, requiring fixed or variable information at each
state. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>This is based on <a href="#TypeSafety"><b>Type Safety</b></a>, which is itself based on <a href="http://www.perldesignpatterns.com/?AbstractClasses">Abstract Classes</a>, or the  concept of types it puts forward, rather. We confound the subject with  <a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a>. We use <a href="#TypeSafety"><b>Type Safety</b></a>, <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a> and <a href="#NewObjectFromExisting"><b>New Object From Existing</b></a>. <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a> is a fundamental idea to the <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> idea of currying, and we demonstrate it in the second example. 
<br><br>
 Currying is a universe of single argument functions. This sounds absurd and useless, and would be except for the tenets of <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a>. This pattern develops when state is accumulated incrementatally: see <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a>. <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a> comes about when there are <a href="#TooManyArguments"><b>Too Many Arguments</b></a>
to pass all at once. Attempting to pass them all at once loose us the
flexibility of being able to set things up, run, change a few things,
run, and so on. <br><br>
 For example, lets say we're playing roulette. We can pick a color and  perhaps a few numbers. 
<br><br>
 <pre>  package Roulette::Table;

  sub new {

    my $class = shift;
    my $this;

    # if new() is called on an existing object, we're providing additional
    # constructors, not creating a new object

    if(ref $class) {
      $this = $class;
    } else {
      $this = { };
      bless $this, $class;
    }

    # read any number of and supported type of arguments

    foreach my $arg (@_) {
      if($arg-&gt;isa('Roulette::Color')) {
        $this-&gt;{'color'} = $arg;
      } elsif($arg-&gt;isa('Roulette::Number')) {
        push @{$this-&gt;{numbers}}, $arg;
      } elsif($arg-&gt;isa('Money')) {
        if($this-&gt;{money}) {
          $this-&gt;{money}-&gt;combine($arg);
        } else {
          $this-&gt;{money} = $arg;
        }
      }
    }

    return $this;

  }

  sub set_color { new(@_); }
  sub add_number { new(@_); }
  sub add_wager { new(@_); }</pre>
<br><br>
 The constructor, <i>new()</i>, accepts any number or sort of
object of the kinds that it knows about, and skuttles them off to the
correct slot in the object. Our <i>set</i> routines are merely aliases for <i>new()</i>. <i>new()</i>
may be called multiple times, directly or indirectly, to spread our
wager over more numbers, change which color we're betting on, or plunk
down more cash. I don't play roulette - I've probably butched the
example. Feel free to correct it. Use the little <i>edit</i> link. People won't be doing everything for you your entire life, atleast I hope. 
<br><br>
 We still have the problem of having an object exist in an indeterminate state. If we apply <a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a>,
we get something much closer to the original idea of currying. Rather
than storing state in an object as it is built up, store it in a <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> that is object aware: 
<br><br>
 <pre>  package Roulette::Table;

  use <a href="http://www.perldesignpatterns.com/?MessageMethod">Message Method</a>;

  sub new {
    my $class = shift;
    my $this;
    my $curry;

    bless $this, $class;
    
    $curry = <a href="http://www.perldesignpatterns.com/?MessageMethod">Message Method</a> sub {

        my $msg = shift;

        if($msg eq 'spin_wheel') {
          die "Inconsistent state: not all arguments have been specified";
        }

        if($msg eq 'set_color') {
          $this-&gt;{'color'} = shift;
        } 

        if($msg eq 'add_number') {
          $this-&gt;{'numbers'} ||= [];
          my $numbers = $this-&gt;{'numbers'};
          push @$numbers, $arg;
        }

        if($msg eq 'add_add_money') {
          if($this-&gt;{'money'}) {
            $this-&gt;{'money'}-&gt;combine($arg);
          } else {
            $this-&gt;{'money'} = $arg;
          }
        }

        if($msg eq 'is_ready') {
          return 0;
        }

        if($this-&gt;{'money'} and $this-&gt;{'color'} and $this-&gt;{'numbers'}) {
          return $this;
        } else {
          return $curry;
        }
        
    };

    return $curry;

  }

  sub spin_wheel {
    # logic here...
  }

  sub is_ready {
    return 1;
  }</pre>
<br><br>
 This second example doesn't support repeated invocations of <i>new()</i>
to further define an unfinished object. It could, but it would detract
from the example. Add it for backwards compatability if for any reason.
More radically, we don't accept any constructors. We return an entirely
new object that has the sole purpose of accepting data before letting
us at the actual object. <br><br>
 Representing two different states of an object with two different objects is the subject of an ongoing debate as well as <a href="#StateVsClass"><b>State Vs Class</b></a>. 
<br><br>
 Rather than using <a href="#TypeSafety"><b>Type Safety</b></a> to check the class membership of objects passed in, we could just as easily accept <a href="#NamedArguments"><b>Named Arguments</b></a>. The choose is a matter of what feels right, and what is adequate without being overkill. 
<br><br> In brief, returning a custom object, partially configured by
some argument, ready to either do work or accept more configuration, is
the act of currying. More correctly, constructing a function to accept
single arguments and return another function, or converting an existing
function to such, is currying. <br><br>
 <pre>  sub create_roulette_table {
    my $color;
    my $money;
    my $numbers;
    return sub {
      $color = shift;
      return sub {
        $money = shift;
        return sub {
          push @$numbers, shift;
          return sub {
            # play logic here
          };
        };
      };
    };
  }

  # to use, we might do something like:

  my $table = create_roulette_table()-&gt;('red')-&gt;('500')-&gt;(8);
  $table-&gt;(); # play
  $table-&gt;(); # play again

  # or we might do something like:

  my $table_no_money = create_roulette_table()-&gt;('red')-&gt;('500');
  my $table;
  $table = $table_no_money-&gt;(100);
  $table-&gt;(); # play
  $table-&gt;(); # play again -- oops, lost everything
  $table = $table_no_money-&gt;(50);
  $table-&gt;(); # play some more
  </pre>This
is stereotypical of currying as you'd see it in a language like Lisp.
The arguments are essentially untyped, so we take them one at a time,
in a specific order. Also like Lisp, the code quickly migrates across
the screen then ends aburptly with a large number of block closes (the
curley brace in Perl, paranthesis in Lisp). The Lisp version makes
heavy use of <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a>. If we wanted to adapt this logic to spew out <a href="http://www.perldesignpatterns.com/?GeneratedMethods">Generated Methods</a>,
where each method generated wasn't tied to other generated methods, we
would need to explicitly copy the accumulated lexical variables rather
than simply binding to them. For example, <i>my $color = $color; my $money = shift;</i> would prevent each anonymous routine returned from sharing the same <i>$color</i>
variable, although without further logic, they would all have the same
value. This amounts to the distinction between instance and class data.
<br><br> Understanding the Lisp-ish example isn't critical to using
this idea. It merely serves to give us some context to the idea, and a
counter-example to the <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
approach. It also clearly demonstrates the advantages of having
partially constructed objects laying around: we don't need to construct
a whole new table just to put some more money down, but we have the
power of creating objects to represent state at the same time. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=62737">PerlMonks:62737</a> - taking reference to methods (closure) - closely related to <a href="#CurryingConcept"><b>Currying Concept</b></a> - <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> - import this 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryConcept">Category Concept</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a>, <a href="http://www.perldesignpatterns.com/?CategoryExpert">Category Expert</a>, <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> </li><li> <a href="#FunctionalProgramming"><b>Functional Programming</b></a> </li><li> <a href="#TooManyArguments"><b>Too Many Arguments</b></a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> Perl6::Currying  </li><li> <a href="http://www.perldesignpatterns.com/?CoRoutines">Co Routines</a> </li><li> <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CrossSectionalRefactoring">Cross Sectional Refactoring</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=62737">PerlMonks:62737</a> - taking references to methods </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/52549">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/52549</a> </li><li> <a href="http://www.perldesignpatterns.com/?ConditionalElimination">Conditional Elimination</a> </li><li> <a href="#CutAndPasteProgramming"><b>Cut And Paste Programming</b></a> </li><li> <a href="#BreakDownLargeFunctions"><b>Break Down Large Functions</b></a>  </li><li> <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a> </li><li> <a href="http://perl.plover.com/yak/typing/samples/slide024.html">http://perl.plover.com/yak/typing/samples/slide024.html</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=264874">http://www.perlmonks.org/index.pl?node_id=264874</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=264874">http://perlmonks.org/index.pl?node_id=264874</a> </li><li> <a href="http://www.perlmonks.com/index.pl">http://www.perlmonks.com/index.pl</a> 
<br><br>
 <br><br> <a name="FactoryObject"></a><h2><a href="#FactoryObject"><b>Factory Object</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>An object
becomes overgrown and it is possible to seperate out logic for
different scenarios, but you don't want to spread logic around the
program to decide which exact subclass to create. <br><br>
 Or, you already have logic strewn around the program to decide which of several subclasses to create depending on criteria. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Create a
factory that centralizes the decision making logic surrounding which
implementation to use. Channel all requests for objects of for that
role through the factory. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>A <a href="#FactoryObject"><b>Factory Object</b></a> has a <a href="http://www.perldesignpatterns.com/?FactoryMethod">Factory Method</a>. 
<br><br> The basic factory always creates objects of the same concrete
type. Factories, as objects, are pluggable: Which factory is used, and
therefore which concrete type is created by it, can be changed. <br><br>
 <pre>  my $factory = new FordFactory; 

  my $wifes_car = $factory-&gt;create_car(); 
  $wifes_car-&gt;isa('Car') or die; 

  # later:

  $factory = new ChevyFactory;

  my $husbands_car = $factory-&gt;create_car();
  $husbands_car-&gt;isa('Car') or die; </pre>
<br><br>
 Code need not be concerned with where the cars come from, only that a <i>Car</i>
materialize upon demand. Having a second source available for things is
important. If there were only one auto manufacturer, a lot fewer people
would be happy with their ride. Ralph Nader never would have won a law
suit against them. The same goes for programs. Hacking up an entire
program to change which implementation you use is undesireable.
Sometimes you have an implementation you really want to get rid of. <br><br> Usually the decision is made at some point in configuration
which factory is to be used, though it may be used to implement the <a href="#StatePattern"><b>State Pattern</b></a>. 
<br><br>
 A Factory will always create objects of the same concrete type. Contrast this with the <a href="#AbstractFactory"><b>Abstract Factory</b></a>: 
<br><br>
 Per <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>, all objects of a new type should be an Abstract Type<a href="http://www.perldesignpatterns.com/?AbstractType">+</a> and a concrete implementation of it. This lets you talk about objects in terms of type where <a href="#TypeSafety"><b>Type Safety</b></a> is concerned and not have to change those type delcarations when a new implementation is introduced. 
<br><br>
 An <a href="#AbstractFactory"><b>Abstract Factory</b></a> will create objects of a fixed Abstract Type<a href="http://www.perldesignpatterns.com/?AbstractType">+</a> and a conrete type of it's chosing. 
<br><br> A plain old factory is useful when we're able to deturmine at
some point what type all future manufactured objects should have for a
concrete type. An <a href="#AbstractFactory"><b>Abstract Factory</b></a> is suitable when this decision can never be finalized: the current state of the running program always sways the decision. 
<br><br>
 Supports Polymorphism and <a href="#LooseCoupling"><b>Loose Coupling</b></a>. <pre> </pre><a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://patternsinperl.com/designpatterns/factorymethod/">http://patternsinperl.com/designpatterns/factorymethod/</a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/FactoryMethod/">http://hatena.dyndns.org/~jkondo/DesignPattern/FactoryMethod/</a> </li><li> <a href="http://www.pobox.com/%7Eschwern/talks/Design_Patterns/full_slides/slide015.html">http://www.pobox.com/~schwern/talks/Design_Patterns/full_slides/slide015.html</a> - example by <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a> </li><li> <a href="http://www.perldesignpatterns.com/?FactoryPattern">Factory Pattern</a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?FactoryMethod">Factory Method</a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=Factory.htm">ObjectArts:Factory.htm</a> </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/86900">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/86900</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Factory-method.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Factory-method.html</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Builder.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Builder.html</a> </li><li> <a href="#CutAndPasteProgramming"><b>Cut And Paste Programming</b></a> 
<br><br>
 <br><br> <a name="NewObjectFromExisting"></a><h2><a href="#NewObjectFromExisting"><b>New Object From Existing</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Make your constructors work as methods. Let users make a new object without knowing your package name. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br><pre>  sub new {
    my $type = shift;
    $type = ref $type if ref $type;
    my $this = { };
    bless $this, $type;
  }</pre>
<br><br> Line 3 does the work of making sense out of either a package
name or a reference. The normal case is a scalar containing the package
name. Thats the case with: <br><br>
 <pre>  <a href="http://www.perldesignpatterns.com/?MyPackage">My Package</a>-&gt;new();
  ... and ...
  new <a href="http://www.perldesignpatterns.com/?MyPackage">My Package</a>;</pre>
<br><br>
 The new case we handle is when someone already has a reference but wants a new one: 
<br><br>
 <pre>  $anothermypack = $mypack-&gt;new();</pre>
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#CloningPattern"><b>Cloning Pattern</b></a> 
<br><br>

<br><br>
 <br><br> <a name="CloningPattern"></a><h2><a href="#CloningPattern"><b>Cloning Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>A copy of an
object is needed so it can be diddled while preserving the original.
Or, an existing object should serve as a template for a new object. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Instead of probing into its innards from outside, implement it, or re-implement  it, to have a <i>clone()</i> method. <i>clone()</i> makes an exact duplicate of it  from the inside.  
<br><br>
 <font size="+2"><b>When</b></font><br><br>You want to keep
an unmodified copy of an object around, or you want to play with a copy
of an object without hurting the original. <br><br> You're querying all of the fields out of one object, and
passing them to the accessor methods of another object of the same
type. Or, you access the underlining data structure directly, looping
over the fields in one object, assigning the values to another. You
spend a lot of effort to set up objects with are similar to each other.
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Cloning
lets you distribute or play with copies of objects. It also lets you
more easily make a series of similar objects, using one object as a
template for others. <br><br>
 Cloning should be designed into an object, or added in subclass.  Subclasses of a class with a <i>clone()</i> interface  need to override the ancestors <i>clone()</i>
method and augment it to handle the new features of the subclass. Since
only a designer of a class will know for sure how to correctly clone
it, it should be implemented with each package that features it. <br><br>
 For objects based on hashes, an extremely simple implementation of this might look like: 
<br><br>
 <pre>  package Mumble;

  sub new { ... }; # standard constructor

  sub clone {
    my $self = shift;
    my $copy = { %$self };
    bless $copy, ref $self;
  };</pre>
<br><br>
 <i>Sample clone() method.</i> 
<br><br>
 This is a Shallow Copy<a href="http://www.perldesignpatterns.com/?ShallowCopy">+</a>, not a <a href="http://perldesignpatterns.com/intermap.cgi?wiki=DeepCopy&amp;word=%20//clone%28%29//">DeepCopy: //clone()//</a>
will return an object that holds additional references to things that
the object being copied holds onto. If it were a Deep Copy<a href="http://www.perldesignpatterns.com/?DeepCopy">+</a>,
the new copy would have it's own private copies of things. This is only
a problem when the object being copied refers to other objects, perhaps
delegating to them. A Deep Copy<a href="http://www.perldesignpatterns.com/?DeepCopy">+</a> is a recursive copy. It requires that each and every object in this network implement <i>-&gt;clone()</i>.
If an object doesn't, we'll either have to copy it using code external
to its implementation and probe around under the hood, or else copy the
references. Copying the references may cause problems - calling methods
in our supposed copy might affect the original object. <br><br>
 <pre>    my $copy = { %$self };</pre>
<br><br>
 <i>%$self</i> expands the hash reference, <i>$self</i>, into
a hash. This is done in a list context, so all of the key-value pairs
are expanded returned out - this is done by value, creating a new list.
This happens in side of the <i>{ }</i> construct, which creates a new anonymous hash. This is assigned to <i>$copy</i>. <i>$copy</i> will then be a reference to all of the same data as <i>$this</i>,  The end result is a duplicate of everything in side of <i>$self</i>. This is the same thing as: 
<br><br>
 <pre>  sub clone {
    my $self = shift;
    my $copy;
    foreach my $key (keys %$self) {
      $copy-&gt;{$key} = $self-&gt;{$key};
    }
    bless $copy, ref $self;
  }</pre>
<br><br>
 If we wanted to do a Deep Copy<a href="http://www.perldesignpatterns.com/?DeepCopy">+</a>, we could modify this slightly: 
<br><br>
 <pre>  sub clone {
    my $self = shift;
    my $copy;
    foreach my $key (keys %$self) {
      if(ref $self-&gt;{$key}) {
        $copy-&gt;{$key} = $self-&gt;{$key}-&gt;clone(); 
      } else {
        $copy-&gt;{$key} = $self-&gt;{$key};
      }
    }
    bless $copy, ref $self;
  }</pre>
<br><br>
 This assumes that <i>$self</i> contains no hashrefs,
arrayrefs, and so on - only scalar values and other objects. This is
hardly a reasonable assumption, but this example illustrates the need
for and implementation of recursion when cloning nested object
structures. <br><br>
 <font size="+2"><b>//Summary//</b></font><br><br>When possible, implement a <i>clone()</i>
method that knows how to handle internally held resources. In other
cases, use the CPAN Clone or Storable module, or Clone::PP or
Clone::Any modules. Reguardless, it is helpful to understand the
mechanics and problems inherent in cloning. <br><br>
 <font size="+2"><b>Examples</b></font><br><br><pre>  package Mumble;

  sub new { 
    my $type = shift;
    my %args = @_;
    bless { 
      color =&gt;  $args{color},
      dealie =&gt; Mumble::Dealie-&gt;new($args{dealie}),
      userob =&gt; Mumble::User-&gt;new(),
    }, $type;
  }; 

  sub clone {
    my $self = shift;
    my $copy = {  
      color  =&gt; $self-&gt;{color},
      dealie =&gt; $self-&gt;{dealie}-&gt;clone(),
      userob =&gt; $self-&gt;{userob},
    };
    bless $copy, ref $self;
  };  </pre>
<br><br>
 <i>An object implementing its own clone() routine. We copy
"color" varbatum when we clone; we make a new "dealie", cloned from
ours; userob is also passed by reference and shared in the new object,
because we know that it is safe to share it.</i> 
<br><br>
 <pre>  use Clone::Any 'clone';
  
  my $foo = new Foo();
  my $bar = clone($foo);</pre>
<br><br>
 <i>Using an outside clone() routine for objects that don't have their own. Clone::Any copies datastructures, too.</i> 
<br><br>
 <font size="+2"><b>Resources</b></font><br><br></li><li> <a href="#MomentoPattern"><b>Momento Pattern</b></a> has an example of copying an objects data against its permission - something that shouldn't be made a habit. </li><li> <a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a> keep a pool of archetypical objects, and return  copies on request. 
<br><br> Permutations exist where other objects serve as general
purpose object cloners or copiers. Due to Perl's introspective nature,
a great deal of detail can be replicated. However, this will not always
be safe, as some packages have special arrangements with their
contents, some objects cannot handle multiple references existing to
them, and so forth. This violates the encapsulation principle. <br><br> Class::Classless is an interesting twist on the idea of
using one class as a template - not only is object instance data
replicated, but objects themselves are configured to have the logic and
methods you want, and then are cloned for their behavior. <a href="http://www.perldesignpatterns.com/?JavaScript">Java Script</a>
works this way. Objects could be looked at as buckets of data and
methods, whether either type of thing can be thrown into the bucket.
Copying (by reference) the methods from one object into a fresh one is
the work of a constructor, and is how new objects of that "class" are
made. Copying the methods and the data would be a clone, according to
our description of object cloning. XXX more on Class::Classless. <br><br>
 <a href="http://www.stonehenge.com/merlyn/UnixReview/col30.html">http://www.stonehenge.com/merlyn/UnixReview/col30.html</a> - Deep copy vs shallow copy, a column in Unix Review<a href="http://www.perldesignpatterns.com/?UnixReview">+</a> magazine. 
<br><br>
 <font size="+2"><b>Pressures</b></font><br><br></li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>
says that objects that can be used in a way should have a common base
type. No logic need actually be implemented in that base type. Objects
that can be cloned should implement a <i>Clonable</i> interface that you'll have to make. </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> depends on <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> to do compile time checking to make sure objects are used correctly. </li><li> <a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a>
should be applied in cases where cloning is used to ease configuration
and customization of objects. Cloning, in the sense of this pattern,
should be reserved for use at times other than normal creation of
objects. <br><br>
 <font size="+2"><b>Credits</b></font><br><br>Unknown 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a> </li><li> <a href="#MomentoPattern"><b>Momento Pattern</b></a> </li><li> <a href="#NewObjectFromExisting"><b>New Object From Existing</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a>, <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a> </li><li> Class::Classless </li><li> <a href="http://www.perldesignpatterns.com/?ClassClassless">Class Classless</a> </li><li> Clone on CPAN </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?IteratorPattern">Iterator Pattern</a> </li><li> <a href="#ImmutableObject"><b>Immutable Object</b></a> 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>I think that "Clone Factories" means the same thing as what I've discussed in <a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a>. -- <i><a href="http://www.perldesignpatterns.com/?SimonCavalletto">Simon Cavalletto</a></i>  - <i>Sun Aug 24 17:35:11 2003 207.18.115.52</i> 
<br><br> Generic cloning functions are provided by the Clone and
Storable modules. I've recently posted Clone::PP and Clone::Any which
also provide such a function. -- <i><a href="http://www.perldesignpatterns.com/?SimonCavalletto">Simon Cavalletto</a></i> - <i>Sun Aug 24 17:36:44 2003 207.18.115.52</i> 
<br><br>
 Good intelligence! Merged that in. Feel free to touch it up. - <a href="#ScottWalters"><b>Scott Walters</b></a> - <i>Tue Aug 26 11:45:53 2003 216.190.249.92</i> 
<br><br>
 <!-- cut - end comments --> 
<br><br>
 <br><br> <a name="ClonePrototypicalObjects"></a><h2><a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Provide one or more prototypical objects that can be cloned to create new instances. 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Constructors could simplify generation of the most common kinds of instances of some abstract class, but: 
<br><br>
 </li><li> Different subclasses require different default initialization values. </li><li> Subclasses may be loaded later, perhaps at run-time, to either add functionality or to override the normal behavior. </li><li> Creating a <a href="http://www.perldesignpatterns.com/?FactoryMethod">Factory Method</a> or <a href="#FactoryObject"><b>Factory Object</b></a> for each type added should be avoided. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Store
references to one or more prototypical objects, and an interface to
allow the collection to be extended or updated by subclasses. Have the
public constructor use the <a href="#CloningPattern"><b>Cloning Pattern</b></a> to make copies of those objects. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Inheritance
allows objects to be refined and specialized while serving the same
basic purpose as the original. This need not apply only to code. Object
initialization - copying of default values from another object,
computation of values, passing of vaules to the constructor and
validation of them all add up. Code and complexity can be reduced by
moving this sort of initialization into subclasses. <br><br>
 <font size="+2"><b>Example</b></font><br><br>A superclass can store a hash of prototypical instances: 
<br><br>
 <pre>  package Acme::Pet;

  # Typical constructor 
  sub new { 
    my $class = shift;
    bless { @_ }, $class;
  }
  
  # Typical accessors
  sub variety { scalar(@_) == 1 ? (shift)-&gt;{variety} 
                                : (shift)-&gt;{variety} = shift }
  sub age     { scalar(@_) == 1 ? (shift)-&gt;{age} 
                                : (shift)-&gt;{age} = shift }
  
  # Simple copy here, but could be deep; see <a href="#CloningPattern"><b>Cloning Pattern</b></a>
  sub clone {
    my $instance = shift;
    bless { %$instance }, ref $instance;
  }
  
  # Prototypical instances
  use vars qw( %CommonPets );
  sub common_pets { scalar(@_)==1 ? keys %CommonPets : $CommonPets{shift} }
  sub add_common_pets { shift; %CommonPets = (%CommonPets, @_) }
  sub new_common_pet  { shift; $CommonPets{ (shift) }-&gt;clone }
  
  package Acme::Pet::Dog;
  @ISA = 'Acme::Pet';
  
  Acme::Pet-&gt;add_common_pets(
    'puppy' =&gt; Acme::Pet::Dog-&gt;new( variety =&gt; 'Golden Retriever', age =&gt; 0.4 ),
    'lassie' =&gt; Acme::Pet::Dog-&gt;new( variety =&gt; 'Collie', age =&gt; 5 ),
  );
  
  package Acme::Pet::Cat;
  @ISA = 'Acme::Pet';
  
  Acme::Pet-&gt;add_common_pets(
    'kitten' =&gt; Acme::Pet::Cat-&gt;new( variety=&gt;'American Shorthair', age=&gt;0.25 ),
    'evil_sidekick' =&gt; Acme::Pet::Cat-&gt;new( variety =&gt; 'Albino Persian', age=&gt;7 ),
  );
  
  package Acme::Pet::Bird;
  @ISA = 'Acme::Pet';
  sub feather_color { scalar(@_) == 1 ? (shift)-&gt;{variety} 
                                : (shift)-&gt;{variety} = shift }
  
  Pet-&gt;add_common_pets(
    'parrot' =&gt; Pet::Bird-&gt;new( variety=&gt;'Norwegian Blue', age=&gt;2, feathers =&gt; 'blue' ),
  );
  
  package Acme::PetStore;
  
  sub prompt {
    my $store = shift; 
    print "Whaddya want, kid? (" . join (', ' Acme::Pet-&gt;common_pets) . ")\n";
  }
  
  sub mill { 
    my $store = shift; 
    my $kind = shift;
    unless ( grep { $kind eq $_} Pet-&gt;common_pets ) {
      warn "Sorry, we don't have any $kind in stock.";
      return;
    }
    return Pet-&gt;new_common_pet( $kind );
  }

  package main;
  
  my $puppy = Acme::PetStore-&gt;mill('puppy');</pre>
<br><br>
 The prototypes can also be stored in a separate prototype manager. 
<br><br>
 <pre>  package Object::PrototypeSet;
  
  use Clone::Any 'clone';
  
  # $pset = Object::PrototypeSet-&gt;new();
  # $pset = $existing_pset-&gt;new();
  sub new { 
    my $self = shift;
    if ( my $type = ref $self ) {
      bless { %$self, @_ }, $type
    } else {
      bless { @_ }, $self;
    }
  }
  
  # Basic hash operations
  sub fetch  { (shift)-&gt;{ (shift) } }
  sub store  { (shift)-&gt;{ (shift) } = (shift) }
  sub add    { %{ $_[0] } = ( %{ (shift) }, @_ ); }
  sub delete { delete (shift)-&gt;{ (shift) } }
  sub keys   { keys   %{ (shift) } }
  sub values { values %{ (shift) } }
  
  # Clone constructor
  sub create { clone( (shift)-&gt;fetch(@_) or return ) }
  
  # ...

  package Acme::Pet;
  
  # Typical constructor 
  sub new { 
    my $class = shift;
    bless { @_ }, $class;
  }
  
  # Typical accessors
  sub variety { scalar(@_) == 1 ? (shift)-&gt;{variety} 
                                : (shift)-&gt;{variety} = shift }
  sub age     { scalar(@_) == 1 ? (shift)-&gt;{age} 
                                : (shift)-&gt;{age} = shift }
  
  # Prototypical instances
  use constant common_pets =&gt; Object::PrototypeSet-&gt;new();
  
  package Acme::Pet::Dog;
  @ISA = 'Acme::Pet';
  
  Acme::Pet-&gt;common_pets-&gt;add(
    'puppy' =&gt; Acme::Pet::Dog-&gt;new( variety =&gt; 'Golden Retriever', age =&gt; 0.4 ),
    'lassie' =&gt; Acme::Pet::Dog-&gt;new( variety =&gt; 'Collie', age =&gt; 5 ),
  );
  
  package Acme::Pet::Cat;
  @ISA = 'Acme::Pet';
  
  Acme::Pet-&gt;common_pets-&gt;add(
    'kitten' =&gt; Acme::Pet::Cat-&gt;new( variety=&gt;'American Shorthair', age=&gt;0.25 ),
    'evil_sidekick' =&gt; Acme::Pet::Cat-&gt;new( variety =&gt; 'Albino Persian', age=&gt;7 ),
  );
  
  package Acme::Pet::Bird;
  @ISA = 'Acme::Pet';
  
  # Typical accessors
  sub feather_color { scalar(@_) == 1 ? (shift)-&gt;{variety} 
                                      : (shift)-&gt;{variety} = shift }
  
  Acme::Pet-&gt;common_pets-&gt;add(
    'parrot' =&gt; Pet::Bird-&gt;new( variety=&gt;'Norwegian Blue', age=&gt;2, feathers =&gt; 'blue' ),
  );
  
  package Acme::PetStore;
  
  sub prompt {
    my $store = shift; 
    print "Whaddya want, kid? (" . join (', ' Acme::Pet-&gt;common_pets-&gt;keys) . ")\n";
  }
  
  sub mill { 
    my $store = shift; 
    my $kind = shift;
    unless ( Acme::Pet-&gt;common_pets-&gt;fetch($kind) ) {
      warn "Sorry, we don't have any $kind in stock.";
      return;
    }
    return Pet-&gt;common_pets-&gt;create( $kind );
  }
  
  package main;
  
  my $puppy = Acme::PetStore-&gt;mill('puppy');</pre>
<br><br>
 <font size="+2"><b>Resources</b></font><br><br></li><li> <a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a> reduces initialization overhead in some, often different, cases. </li><li> <a href="#CloningPattern"><b>Cloning Pattern</b></a> takes a more generic approach, rather than this structural approach. Use this one if order can be identified in your code.  </li><li> <a href="http://www.perldesignpatterns.com/?JavaScript">Java Script</a>
introduces Class::Classless - a generic, unorganized of using objects
as templates for both data and for methods. It is a different way of
thinking about objects. </li><li> <a href="http://www.perldesignpatterns.com/?FactoryPattern">Factory Pattern</a>
centralizes object set-up logic into one place (naturally, an object
method). This solves another problem, but one related to configurating
objects when creating them. <br><br>
 <font size="+2"><b>Credits</b></font><br><br>Described by the <a href="http://www.perldesignpatterns.com/?GangOfFour">Gang Of Four</a> as the Prototype pattern. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#CloningPattern"><b>Cloning Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?FactoryPattern">Factory Pattern</a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?JavaScript">Java Script</a> 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>"You want" is
ambigious. It could mean "You happen to desire", or it could mean "It
should be an objective of yours, whether you realize it or not". I'm a
cross reference freak, so I'm start to really like the idea of aq
Pressures section. I can't seem to identify anything actually applying
pressure here though, so I'll stick with a Resources block for now. I
love this pattern and I love the example. Also threw in a Discussion to
be consistent with other patterns and it lets me cross reference things
too. And, with long code examples, I've found you can keep reader
attention by explaining what they should be looking for in the example,
so I might add some comments to this later. - <a href="#ScottWalters"><b>Scott Walters</b></a> 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>Added to <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> so it'll be part of the next CPAN distro
 and show up in the <a href="http://www.perldesignpatterns.com/?PatternIndex">Pattern Index</a> thingie. - <a href="#ScottWalters"><b>Scott Walters</b></a> - <i>Tue Aug 26 11:15:16 2003 216.190.249.92</i> 
<br><br>
 <!-- cut - end comments --> 
<br><br>
 <br><br> <a name="FlyweightPattern"></a><h2><a href="#FlyweightPattern"><b>Flyweight Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>A class of very
light weight objects are being used in large numbers. Reusing objects
by sharing references would save a lot of memory. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Instead of creating thousands of identical copies of objects, keep a  cache, and hand out references to existing copies. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>You're passing a
lot of simple objects around. You're using objects as a sort of
enumeration. You've just gone OO overboard and made everything an
object. <br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>Object Oriented programming is at odds with memory usage.  
<br><br>
 A Flyweight is a permutation of an <a href="#AbstractFactory"><b>Abstract Factory</b></a>. A million tiny objects can weigh a ton. By keeping only one copy of each, memory usage can be dramatically reduced. 
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?FooFlyweight">Foo Flyweight</a>;

  my $objectCache;

  sub new {
    my $type = shift;
    my $value = shift;  # just a scalar
    if(exists $objectCache-&gt;{$type}-&gt;{$value}) {
      return $objectCache-&gt;{$type}-&gt;{$value};
    } else {
      my $this = { value =&gt; $value, moonPhase=&gt;'full' };
      bless $this, $type;
      $objectCache-&gt;{$type}-&gt;{$value} = $this;
      return $this;
    }
  }</pre>
<br><br> This example returns an object if we have one for that type
and value. If not, it creates one, and caches it. An observant reader
will note that if we cache objects, give it to two people, and one
person changes it, the other will be affected. There are two solutions:
pass out read-only objects, or preferably, use Immutable Objects<a href="http://www.perldesignpatterns.com/?ImmutableObjects">+</a>. 
<br><br> As an alternative, Perl lets you bless scalars, which weigh
about the same as an object reference. Blessed scalars aren't subject
to the requirement that they be shared copies. Blessing a scalar into a
package gives you an OO interface to a single value. If needed, you can
later upgrade the implementation to a full blown hash, and keep the
same interface. <br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?TinyNumberOb">Tiny Number Ob</a>;

  sub new {
    my $type = shift;
    my $value = shift; # scalar value
    my $this = \$value; # scalar reference
    bless $this, $type;
  }

  sub getValue {
    my $self = shift;
    return $$self;
  }

  sub setValue {
    my $self = shift;
    $$self = shift;
    return 1;
  }</pre>
<br><br> This is kind of like Perl's Autovivication of variables and
hash and array entries: things spring into existance at the moment a
user asks for them. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ImmutableObject"><b>Immutable Object</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> Copy On Write<a href="http://www.perldesignpatterns.com/?CopyOnWrite">+</a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/FlyWeight/">http://hatena.dyndns.org/~jkondo/DesignPattern/FlyWeight/</a> </li><li> <a href="http://www.perl.com/pub/a/2003/06/13/design1.html?page=2">http://www.perl.com/pub/a/2003/06/13/design1.html?page=2</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Flyweight.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Flyweight.html</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perlmonks.org/index.pl?node=218992">http://www.perlmonks.org/index.pl?node=218992</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=219268">http://www.perlmonks.org/index.pl?node_id=219268</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node=flyweight&amp;go_button=Search">http://www.perlmonks.org/index.pl?node=flyweight&amp;go_button=Search</a> 
<br><br>
 <br><br> <a name="ImmutableObject"></a><h2><a href="#ImmutableObject"><b>Immutable Object</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Small objects that can or should be shared, but change state. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>You have a lot of
little objects that sometimes keep one value, but sometimes change
value. When someone changes the value of one, you don't want that
change to show up in all of the other objects that have a pointer to
that object, but you don't want to have to make a clone of that object
for each object that has it, either. <br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>Frequently copying objects and passing them out. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Lots and
lots of tiny objects can eat up memory. If you've gone so far as to
represent even little things as objects, you may find that your memory
isn't going as far as it used to when everything was just a scalar. You
would pass out the same object to everyone, but you really want
everyone to have a private copy of it. <br><br> With a small change in how your module is used, you can
declare that a given instance of it never changes values. If your
object computes a new value, it returns a new instance of itself with
that new value. <br><br>
 Instead of writing: 
<br><br>
 <pre>  $number-&gt;add(10);</pre>
<br><br>
 You'll write instead: 
<br><br>
 <pre>  $number = $number-&gt;add(10);</pre>
<br><br> Other modules using the old $number can continue doing so in
confidence, while every time you change yours, you get a brand new one
all your own. If your class is a blessed scalar, your add() method
might look like: <br><br>
 <pre>  sub add {
    my $me = shift;
    my $newval = $$me + shift;
    return bless \$newval, ref $me;
  }</pre>
<br><br>
 Returning new objects rather than changing ones that someone else might have a reference to avoids the problems of <a href="#ActionAtADistance"><b>Action At ADistance</b></a>
with pointers - so long as you're using variables which the correct
scope to store the pointers. [Explain this - scope for pointers?] <br><br> Returning new objects containing the new state is strictly
required for overloading Perl operators. Java's String class (different
than <a href="http://www.perldesignpatterns.com/?StringBuffer">String Buffer</a>)
are an example of this: you can never make changes to a String, but you
can ask an existing String to compute a new String for you. <br><br>
 <a href="#StatePattern"><b>State Pattern</b></a> talks about a mechanism for implementating state that consists of  one <a href="#ImmutableObject"><b>Immutable Object</b></a> taking another in itis constructor, and digesting it to initialize itself. Coupled with an <a href="#AbstractFactory"><b>Abstract Factory</b></a> to arbitrare which subtype  will be used for the next object, this is a powerful construct. 
<br><br>
 Used as the output of a Flyweight from <a href="#FlyweightPattern"><b>Flyweight Pattern</b></a>. 
<br><br>
 Important concept to <a href="#OverloadOperators"><b>Overload Operators</b></a>. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#CloningPattern"><b>Cloning Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?OperatorOverloading">Operator Overloading</a> </li><li> <a href="#OverloadOperators"><b>Overload Operators</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?OverloadPattern">Overload Pattern</a> </li><li> <a href="#FlyweightPattern"><b>Flyweight Pattern</b></a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> 
<br><br>

<br><br>
 <br><br> <a name="AbstractFactory"></a><h2><a href="#AbstractFactory"><b>Abstract Factory</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Code that decides which of several subclasses to instantiate is being cut and paste around the program. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Centralize that logic in an object. Return a subtype of some abstract type. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>Any time polymorphism is needed: the option of subclassing should be kept open. See <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>.
Based on circumstance, an object may be created from one of a number of
subclasses. The decision of which type of object to create doesn't seem
to belongs where the object is created, but rather somewhere neutral. <br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>Split a
class into two, or introduce a new or different implementation of a
class under a different name. Suddenly you find yourself going through
all of the code looking for references to the old package. You know
that if you make a similar change in the future, you'll have to go
through all of the code again. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br></li><li> An <a href="#AbstractFactory"><b>Abstract Factory</b></a> creates <a href="http://www.perldesignpatterns.com/?AbstractObject">Abstract Object</a> objects. </li><li> Abstract objects aren't real objects. They're empty. </li><li> This sounds pretty damn useless. </li><li> Contemplate that objects extending a class, empty or not, are considered to be of that type (IS-A). </li><li> Aha! We're creating real objects that implement a common subtype, or interface. </li><li> An interface just tells everyone the object is usable in a given role. </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> contains the logic to decide which object to create based on parameters... </li><li> ... Rather than spreading the logic around everywhere that something of that base class is created. 
<br><br> An Abstract Factory makes the decision of which class or
subclass to create when. This decision making logic is tucked away in
one place, rather than being spread around - think of it as <a href="http://www.perldesignpatterns.com/?CrossSectionalRefactoring">Cross Sectional Refactoring</a>. Centralizing the logic gives us: 
<br><br>
 </li><li> Now possible to refactor subclasses into smaller, more, or different subclasses without breaking everything. </li><li> Easily plug in more classes - only one point of change. </li><li> Easily swap out one class in favor of another - one point of change. </li><li> Good for when you're rewriting crummy code some lazy programmer left for you. 
<br><br>
 The return value for the method is the base class type or abstract class type (essentially the same in Perl). 
<br><br>
 <font size="+2"><b>Example</b></font><br><br><pre>  package Car::Factory;
  
  sub create_car {
    my $self = shift;
    my $passengers = shift;
    my $topspeed = shift;
    
    return new Car::Ford if $topspeed &lt; 100 and $passengers &gt;= 4;
    return new Car::Honda if $topspeed &lt; 120 and $passengers &lt;= 2;
    return new Car::Porsche if $topspeed &gt; 160 and $passengers &lt;= 2;
    # etc
  }

  # in main.pl:

  package main;

  use Car::Factory;

  my $car = Car::Factory-&gt;create_car(2, 175); $car-&gt;isa('Car') or die;
  </pre>To be <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> "pure", each kind of car should do <i>push @ISA, 'Car'</i>, so that they pass the <i>$ob-&gt;isa('Car')</i> test required by <a href="#TypeSafety"><b>Type Safety</b></a>. This lets programs know that it is a car (reguardless of kind) and can thus be used interchangably.  See <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>, <a href="http://www.perldesignpatterns.com/?PolymorphismConcept">Polymorphism Concept</a>, <a href="#TypeSafety"><b>Type Safety</b></a>. 
<br><br>
 <font size="+2"><b>Refactoring</b></font><br><br><a href="#RefactoringPattern"><b>Refactoring Pattern</b></a> may lead you to turn an object from a regular object into an <a href="#AbstractFactory"><b>Abstract Factory</b></a>. Break code down into subclasses of ourself, and  create those objects. This page is now <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a>. Before breaking up the code, create the subclasses.  
<br><br>
 <font size="+2"><b>Class AutoVivification</b></font><br><br>Before creating the subclasses, play with letting Perl do it for you.  <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a>
says that a classes primary type can be used to distinguish it as a
special case of a generic type, even if no implementation changes. This
will give us a chance t prototype working with subclasses and make sure
we aren't falling prey to <a href="#EmptySubclassFailure"><b>Empty Subclass Failure</b></a>. 
<br><br>
 <pre>  package Car::Factory;

  sub create_car {
    # this way we can do Car::Factory-&gt;create_car(...) or $carfactoryref-&gt;create_car(...)
    # see <a href="#NewObjectFromExisting"><b>New Object From Existing</b></a> 
    my $package = shift; $package = ref $package if ref $package;
  
    my $car = new Car::<a href="http://www.perldesignpatterns.com/?GenericAmericanCar">Generic American Car</a>;
  
    my $kind = ucfirst(shift());
  
    push @{$kind.'::ISA'}, 'Car', 'Car::<a href="http://www.perldesignpatterns.com/?GenericAmericanCar">Generic American Car</a>';
  
    return bless $car, 'Car::' . $kind;

  }</pre>
<br><br>
 There! No matter what kind of car the user requests, we create it - even if it didn't exist before we created it. We set the <i>@ISA</i> array to inherit from <i>Car</i> and <i>Car::<a href="http://www.perldesignpatterns.com/?GenericAmericanCar">Generic American Car</a></i>.
Even if the package was completely empty, it now contains the minimal
amount of definition to make it useful: an inheritance. You probably
don't want to do exactly this, unless you really want the same product
rebadged with a bizarre variety of different names. <br><br>
 <i>$kind</i> could be computed rather than taken verbatum
from input. In most cases, you will want to compute it, as in our first
example. Once computed, the package can be set up automatically. <br><br>
 <font size="+2"><b>And</b></font><br><br>Resist temptation to re <i>bless</i> or convert things except into subclasses: see <a href="#NoSexUntilMarriage"><b>No Sex Until Marriage</b></a>. 
<br><br>
 <a href="#StatePattern"><b>State Pattern</b></a> is similar: different objects fields requests. The state object, like the <a href="#AbstractFactory"><b>Abstract Factory</b></a>, has the criteria built in to decide which object to use. Rather than returning the selected object like the <a href="#AbstractFactory"><b>Abstract Factory</b></a>, it merely delegates requests to that object, holding onto references to a single instance of each type of object. 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>A good example
of an abstract factory would be building a system that worked with
mod_perl 1 and mod_perl 2. Eventually, I'll get round to giving you an
example of this - <a href="http://www.perldesignpatterns.com/?NigelWetters">Nigel Wetters</a> 
<br><br>
 Yes, a useful example would be nice indeed! - <a href="#ScottWalters"><b>Scott Walters</b></a> 
<br><br>
 This doesn't make it clear where the Car::Ford (etc) modules should get loaded, though. Wouldn't be better to say: <pre> 
  if ($topsped &lt; 100 and $passengers &gt;= 4) {
    require Car::Ford;
    return new Card::Ford ;
  }</pre>
<br><br>
 - <a href="http://www.perldesignpatterns.com/?WilCooley">Wil Cooley</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="#NoSexUntilMarriage"><b>No Sex Until Marriage</b></a> </li><li> <a href="#AdapterPattern"><b>Adapter Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?OnceAndOnlyOnce">Once And Only Once</a> </li><li> <a href="http://www.perldesignpatterns.com/?DynamicLanguage">Dynamic Language</a>, <a href="http://www.perldesignpatterns.com/?DynamicTypes">Dynamic Types</a> </li><li> <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/AbstractFactory/">http://hatena.dyndns.org/~jkondo/DesignPattern/AbstractFactory/</a>  </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=AbstractFactory.htm">ObjectArts:AbstractFactory.htm</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Abstract-factory.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Abstract-factory.html</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.google.com/search?q=abstract+factory+real+example&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;start=20&amp;sa=N">http://www.google.com/search?q=abstract+factory+real+example&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;start=20&amp;sa=N</a> 
<br><br> A real example? Code from real examples is far too long to
keep readers attention. I'll describe a real application, and if you
want the code, you can email me. A client has a cart. Items in the cart
are represented as objects. Initially, everything was an 'Item'.
Donations were introduced - the client is a not-for-profit corporation.
Tax and shipping is computed differently on donations added to the
cart. Re-using the cart for wholesale orders is on the horizon. Once
again, tax and shipping are computed differently: no tax, and shipping
is actual-cost. Rather than burdon 'Item' with the special logic of
examining its part number and deciding which of three personalities
each method should have, one object is given the duty of creating an
object of the right type from a selection of three. Each of the three
different subclasses of 'Item' implement the relavent methods
completely differently, while inheriting some common implementation.
Still want to see the code? - <a href="#ScottWalters"><b>Scott Walters</b></a> 
<br><br>
 </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA">http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA</a> 
<br><br>
 <br><br> <a name="PseudoHash"></a><h2><a href="#PseudoHash"><b>Pseudo Hash</b></a></h2><br> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br> Perl 5 gained the ability to treat arrays of a certain format
as hashes. This feature is depricated, and expected to be removed. For
classes, see <a href="http://www.perldesignpatterns.com/?UseFields">Use Fields</a>.  
<br><br>
 <pre>  @pseudohash = [
    { foo =&gt; 1, bar =&gt; 2, baz =&gt; 3, qux =&gt; 4},
    0, 
    0, 
    0,
    0, 
  ];

  $pseudohash{baz} = 10;</pre>
<br><br> The hash in the 0th element is used as an index into the rest
of the array. This magic engages when the array is treated as a hash,
and no true hash of the same name exists. The last statement is
equivilent to both of: <br><br>
 <pre>  $pseudohash[3] = 10;
  $pseudohash[$pseudohash[0]-&gt;{baz}] = 10;</pre>
<br><br> An array requires far less memory than a hash. A pseudohash
includes a hash, but it includes it by reference, so an arbitrary
number of arrays can share one hash. The storage requirements for each
new pseudohash are fixed at the cost of the size of the array. This is
an excellent idiom for implementing light-weight classes, and it has an
added benefit: attempting to access a hash key that doesn't exist in
the translation hash is an error. This prevents bugs where a typo or
inconsistent namin causes an empty field to be queried, or data to be
stored into a slot where it will never be read. <br><br>
 <pre>  $pseudohash{qxu} = 10;        # error
  print $pseudohash{bza}, "\n"; # error </pre>
<br><br>
 At a certain degree of complexity, a datastructure is better off as an object. The <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> is impossible without it. The object constructor, <i>new()</i>, is also a prime chance to move the work of setting up a <a href="#PseudoHash"><b>Pseudo Hash</b></a> to one place. 
<br><br>
 <pre>  package MyPHOb;

  my $lookup = { foo =&gt; 1, bar =&gt; 2, baz =&gt; 3, qux =&gt; 4 };

  sub new {
      bless [$lookup, (0) x length keys %$lookup], $_[0];
  }</pre>
<br><br> This creates a new anonymous array and blesses it. The first
element is the hash reference, which Perl uses as the lookup table. The
rest is populated with 0's - one for each key in the lookup table. <br><br>
 <pre>  sub get_foo {
    $_[0]-&gt;{foo};
  }

  sub set_foo {
    $_[0]-&gt;{foo} = shift;
  }</pre>
<br><br> Some sample accessors for you. Of course, you could neglect to
provide accessors at all, and tell people to use the hash syntax. This
goes against <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a>, but objects that are just glorified hashes aren't concerned with the warnings listed in <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a>.
These is no mechanary under the hood to be fouled up by people opening
the hood. You still get the benefit of having the thing created and
initialized for you in one place, and you can still add methods to work
on the data, possible methods that themselves delegate out. <a href="#GodObject"><b>God Object</b></a> has an elaborate example of interconnected objects of different types.  
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?UseFields">Use Fields</a> </li><li> Object::Lexical </li><li> <a href="http://www.perldesignpatterns.com/?FlyWeight">Fly Weight</a> </li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> 
<br><br>

<br><br>
 <br><br> <a name="InlineObjects"></a><h2><a href="#InlineObjects"><b>Inline Objects</b></a></h2><br> 
<br><br>

<br><br>
 <i>new()</i> might thought to be the creator of objects, but we know  <i>bless()</i> is how objects are really made. Objects creation is really little more than: 
<br><br>
 <pre>  my $ob = bless { color =&gt; 'yellow', size =&gt; 'large' }, 'GetAndSet';</pre>
<br><br>
 Of course, we need to back this up with some implementation: 
<br><br>
 <pre>  package GetAndSet;

  sub AUTOLOAD {
      my $this = shift;
      (my $method) = $AUTOLOAD =~ m/::(.*)$/;
      return if $method eq 'DESTROY';
      (my $request, my $attribute) = $method =~ m/^([a-z]+)_(.*)/;
      if($request eq 'set') {
        $this-&gt;{$attribute} = shift;
        return 1;
      }
      if(request eq 'get') {
        return $this-&gt;{$attribute};
      }
      die "unknown operation '$method'";
  }</pre>
<br><br>
 Of course, this is considered <a href="http://www.perldesignpatterns.com/?BadStyle">Bad Style</a>. You should always use <a href="http://www.perldesignpatterns.com/?ConstructorPattern">Constructor Pattern</a>. Okey, usually.  
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> - the table of contents </li><li> <a href="http://www.perldesignpatterns.com/?ConstructorPattern">Constructor Pattern</a> </li><li> <a href="#FlyweightPattern"><b>Flyweight Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ClassClassless">Class Classless</a>, Class::Classless </li><li> <a href="http://www.perldesignpatterns.com/?BadStyle">Bad Style</a> 
<br><br>
 <br><br> <a name="ExportingPattern"></a><h2><a href="#ExportingPattern"><b>Exporting Pattern</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Code is split between two modules, each module has a <i>package</i>
declaration, but now you can't get at data in one package from another.
Or, Creating an object to get at functionality is overkill for many
situations, and requires extra typing. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Export
functions that are implicitly attached to a single default object
instance. Users of the package need only call the function names, not
instantiate objects, or type the object name over and over. <br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Splitting code into two packages gives novices errors about undefined values and non-existant functions. The <i>$Package::variable</i> and <i>Package::method()</i>
syntax steps out of a package and into another to get at a variable or
method. This requires that variables be defined in the symbol table -
that is, using <i>our</i> or <i>local</i>. But there is a better way -
a way that doesn't involve hard-coding package names all over the
place, only making code more verbose and no less fragile. The Exporter
package that comes with Perl copies references to variables and
functions out into the namespace of any module that would dare <i>use</i>
your module. This may be done by hand as well, to understand the
process or to gain more control or power. Exporting in general is
discouraged - it is not a good substitute for using real inheritance
with <a href="http://www.perldesignpatterns.com/?UseBase">Use Base</a>, though people often misapply this feature to do so. This creates <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> and cases of the <a href="#GodObject"><b>God Object</b></a>. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Exporting is like extending the language with new keywords.  
<br><br>
 <a href="#CompositePattern"><b>Composite Pattern</b></a>
tells us to build complex objects out of simplier ones using
delegation. Some times complex relationships are expressed where one
object of one type can refer to several objects of another type. In the
simple case where we only need one instance of another object,
Exporting works fine. <br><br>
 <pre>  # a module that exports:

  use Foo;
  foo("module Foo does something with this");

  # a module that doesn't export:

  use Bar;
  my $bar = new Bar;
  $bar-&gt;do_something("module Bar does something with this");</pre>
<br><br>
 If you're only reasonably going to be using one instance of a "Bar" object, why go through the hassle of giving it a name (<i>$bar</i>)? Which object we're talking  about when we say <i>do_something("bar!")</i>
is unambiguous as well - we only have one Bar object to call it in. The
handiness of the first approach is so loved that many modules that
provide a strictly OO interface (as in the second example, Bar) also
provide a syntactical sugar, exporter interface as well (as in the
first example). This is accessed, by convention, as: <br><br>
 <pre>  use Bar qw(do_something);
  do_something("module Bar does something without a lot of typing, just like Foo!");</pre>
<br><br> Here, we tell Bar just to make the method do_something()
available to us. If Bar creates a single instance of an object behind
the scenes, so be it - we never have to know. <br><br>
 <pre>  package Bar;

  sub import {
    my $caller = caller;
    my $foo;
    my $bar;
    my %methods = (
      get_foo = sub { $foo;  },
      set_foo = sub { $foo = shift; },
      get_bar = sub { $bar; },
      set_bar = sub { $bar = shift; },
      do_something =  sub { $foo . ' and ' . $bar . ' sitting in a tree... ' },
    );
    foreach my $i (keys %methods) {
      *{$caller.'::'.$i} = $methods{$i};
    }
  }

  1;</pre>
<br><br>
 This example uses <a href="http://www.perldesignpatterns.com/?LexicallyScopedVariables">Lexically Scoped Variables</a> to generate a scalar for each package that imports our logic. In other words, if multiple packages <i>use Bar</i>, each gets copies of <i>set_foo()</i>, <i>get_foo()</i>, <i>do_something()</i>, and so on, but each package has its own private values for <i>$foo</i> and <i>$bar</i> used by these functions. One packages actions won't step on another packages data. 
<br><br> This example provides one unique set of data for each package
that uses it, but neglects the case where a package might want more
than one instance. It also neglects the <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> interface. Lets fix that: 
<br><br>
 <pre>  package Bar;

  sub new {
    my $type = shift;
    my $foo;
    my $bar;
    my $object = {
      get_foo = sub { $foo;  },
      set_foo = sub { $foo = shift; },
      get_bar = sub { $bar; },
      set_bar = sub { $bar = shift; },
      do_something =  sub { $foo . ' and ' . $bar . ' sitting in a tree... ' },
    };
    bless $type, $object;
  }

  sub import {
    my $caller = caller;
    my $methods = __PACKAGE__-&gt;new();
    foreach my $i (keys %$methods) {
      *{$caller.'::'.$i} = $methods-&gt;{$i};
    }
  }

  sub AUTOLOAD {
    my $me = shift; 
    (my $method) = $AUTOLOAD =~ m/::(.*)$/; 
    return undef if $method eq 'DESTROY';
    return wantarray() ? ($me-&gt;{$method}-&gt;(@_)) : scalar $me-&gt;{$method}-&gt;(@_);
  }

  1;</pre>
<br><br>
 We're coming in from a lot of angles at once here, but it still isn't very much code. Our former <i>import()</i> logic found its way into <i>new()</i>,
with a few changes: we're using a hash reference instead of a hash, and
we're blessing it as an object. This object is exceptional: instead of
merely containing variables, it contains anonymous code references.
These anonymous code references are lexically bound to their data,
exactly like our former example. Perl doesn't know how to use this kind
of an object, but thankfully we can teach it: the <i>AUTOLOAD()</i> method is used to look up methods on demand. This should be invoked for every method call except for <i>new()</i>,
since no other methods are defined. When it is invoked, we get our hash
reference passed in, and to get at our anonymous subroutine reference
we tucked away in the hash reference, use this syntax: <br><br>
 <pre>  $me-&gt;{$method}-&gt;(@_);</pre>
<br><br> This looks up the method, by name, in our hash reference, then
calls it as a subroutine, passing the current argument list. Viola! A
new sort of object that keeps a hash reference of code lexically bound
to data rather than just plain old boring data. <br><br>
 <i>import()</i> merely uses <i>new()</i> to cook up a hash full of code references for the module that is <i>use</i>ing
it. Even though an object comes back, we know how to probe the
internals of the object to extract the code references. We drop these
code references directly into our callers name space, thus giving them
names: <br><br>
 <pre>  *{$caller.'::'.$i} = $methods-&gt;{$i};</pre>
<br><br> Assinging to a glob (variables that start with an asterisk) is
special. Perl figures out what to do with the value we're assigning. If
we assign a scalar reference to <i>*whatever</i>,  it becomes available as <i>$whatever</i>. If we assign a hash reference to <i>*whatever</i>, Perl makes it available as <i>%whatever</i>. If we assign a code reference to <i>*whatever</i>, it appears as <i>whatever()</i>. We take advantage of this to define functions not in our namespace, but the namespace of the package calling our <i>import()</i> routine. If you examine <i>Exporter.pm</i>, you'll find that this is exactly what it does. 
<br><br>
 Lets review what we have here: 
<br><br>
 </li><li> Importing the module automatically creates one default object </li><li> Each package importing the module has its own private data </li><li> Multiple objects can be created and named </li><li> Heavy use of lexicals makes the code very concise 
<br><br> CGI.pm, a standard Perl module, does something similar with
reguards to creating a single default object and also providing an OO
interface. <a href="http://www.perldesignpatterns.com/?WritingPerlModulesForCPAN">Writing Perl Modules For CPAN</a>, page 166, "CGI.pm", has details, code excerpts, and background. 
<br><br>
 <hr><br><pre>  # UNIVERSAL should not contain any extra subs/methods beyond those
  # that it exists to define. The use of Exporter below is a historical
  # accident that can't be fixed without breaking code.  Note that we
  # *don't* set @ISA here, don't want all classes/objects inheriting from
  # Exporter.  It's bad enough that all classes have a import() method
  # whenever UNIVERSAL.pm is loaded.</pre>
<br><br>

<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?UseBase">Use Base</a> </li><li> <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicallyScopedVariables">Lexically Scoped Variables</a> </li><li> <a href="#OneToOneRelationshipsTurnIntoOneToManyRelationships"><b>One To One Relationships Turn Into One To Many Relationships</b></a> </li><li> <a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a> </li><li> <a href="#ImportPattern"><b>Import Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ExportingFunctionsWhichAreLexicallyBoundToGenerators">Exporting Functions Which Are Lexically Bound To Generators</a> </li><li> <a href="http://www.perldesignpatterns.com/?WritingPerlModulesForCPAN">Writing Perl Modules For CPAN</a> 
<br><br>

<br><br>
 <br><br> <a name="WrapperModule"></a><h2><a href="#WrapperModule"><b>Wrapper Module</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Want to use several modules across a collection of scripts, but don't want dozens of "use" lines at the top of each. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>There is
incentive not to split up bloated modules due to the need to go through
and edit all of the scripts to use each new module-spawn. This also has
all of the markings of a problem that resurfaces: should you refactor
again, you'll be changing all of your modules. Leaving everything in
one module is tempting. <br><br>
 In days of lore, Perl programmers would <i>require</i> a single <i>config.pl</i> that set up variables and <i>require</i>ed other modules for them. <i>use</i> doesn't automatically preclude this - merely leave off the <i>package</i> statement, and you'll continue operating in the namespace of the program that <i>use</i>d your module. 
<br><br>
 For example, in config.pm: 
<br><br>
 <pre>  # note: no package statement

  use DBI;
  use CGI;
  use Mail::Sendmail;</pre>
<br><br>
 Back in the main program: 
<br><br>
 <pre>  use config;

  my $userid = CGI::param('userid');
  # etc...</pre>
<br><br>
 <i>my</i> variables are file-global when declared outside of
any code blocks, which means that we can't easily declare lexical
variables in config.pm and have them show up in the main program. We
can co-opt the import() method of config.pm to create <i>local</i> variables in the main program, though: 
<br><br>
 <pre>  # back in config.pm:

  my %config = (
    maxusers =&gt; 100,
    retriespersecond =&gt; 2,
    loglevel =&gt; 5
  );

  sub import {
    my $caller = caller;
    foreach my $i (keys %config) {
      local ${$caller.'::'.$i};
      *{$caller.'::'.$i} = $config{$i};
    }
  }</pre>
<br><br> This will atleast squelsh any warnings Perl would otherwise
emit and let us return to importing configuration dependent values from
a configuration file. <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#CreatingCPANModules"><b>Creating CPANModules</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?PragmaticModule">Pragmatic Module</a> </li><li> <a href="#ExportingPattern"><b>Exporting Pattern</b></a> 
<br><br>

<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perlmonks.org/index.pl?parent=178518&amp;title=Re%3A%20Where%2FWhen%20is%20OO%20useful%3F&amp;lastnode_id=178518&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on">http://www.perlmonks.org/index.pl?parent=178518&amp;title=Re%3A%20Where%2FWhen%20is%20OO%20useful%3F&amp;lastnode_id=178518&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=265876">http://www.perlmonks.org/index.pl?node_id=265876</a> 
<br><br>
 <br><br> <a name="RevisitingNamespaces"></a><h2><a href="#RevisitingNamespaces"><b>Revisiting Namespaces</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Functionality
doesn't exist in a class, but should. Subclassing to add the
functionality isn't appropriate - the features are needed in all
existing objects retroactively. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Change over to its package temproarily to define some new methods in the existing package. 
<br><br>
 <font size="+2"><b>Scenarios</b></font><br><br></li><li> Adding set_ methods to a package that only has get_ methods.  </li><li> Enhancing classes to keep more information about their state.  </li><li> Base class needs to be extended rather than make a subclass and trying to talk other people into using the subclass. 
<br><br>
 <font size="+2"><b>Examples</b></font><br><br><pre>  *{'ExistingPackage::new_function} = sub {
     # new accessor
  };

  sub ExistingPackage::new_function {
    # new accessor
  };</pre>
<br><br>
 Any object created from <i>Existing Package<a href="http://www.perldesignpatterns.com/?ExistingPackage">+</a></i> will instantly have a method, <i>new_function()</i>,
after this code is run. Both examples do essentially the same thing.
The first is uglier, but allows closures to be taken. Perl still
considers the new function to be the package it was defined in
[B::Generate example to change <i>newstate</i> ops to fix this.]. This means that we can't use lexical data that was in scope when  <i>Existing Package<a href="http://www.perldesignpatterns.com/?ExistingPackage">+</a></i> was originally created, nor can we use <i>Use Vars<a href="http://www.perldesignpatterns.com/?UseVars">+</a></i> and <i>Our Variables<a href="http://www.perldesignpatterns.com/?OurVariables">+</a></i> that exist in <i>Existing Package<a href="http://www.perldesignpatterns.com/?ExistingPackage">+</a></i>. 
<br><br>
 Examples exist of using lexically scoped <i>my</i> variables
for the purpose of keeping people away from your data. While not
completely fool proof, it does make it inconvinient. <i>Use Vars<a href="http://www.perldesignpatterns.com/?UseVars">+</a></i> and <i>Our Variables<a href="http://www.perldesignpatterns.com/?OurVariables">+</a></i> are easier. 
<br><br>
 <pre>  sub ExistingPackage::new_function {
    my $self = shift;
    local *existing_var = \${ref($self) . '::existing_var'};
    # code here that uses $existing_var freely, as if it were in
    # out package scope.
    $existing_var++;
  }</pre>
<br><br>
 The <i>local *glob = selfref</i> idioms is, well, ugly. We compute the name of the variable - find the package that <i>$self</i>
was blessed into, concatonated with "::existing_var", and then used as
a soft reference. A reference is then taken to that soft reference
using the backslash operator. See <a href="http://www.perldesignpatterns.com/?ComputedReferences">Computed References</a>. 
<br><br>
 <pre>  local $ExistingPackage::new_variable;</pre>
<br><br>
 <i>$new_variable</i> will be static - individual objects won't have their own copy. See <a href="#StaticVariables"><b>Static Variables</b></a>. This is usually not the desired result. 
<br><br>
 To add, and initialize, a new variable to each instance of objects from this package, redefine the constructor, <i>new()</i>, before any objects are made from it: 
<br><br>
 <pre>  do {
    my $oldnew = \&amp;ExistingPackage::new;
    *ExistingPackage::new = sub {
      my $self = $oldnew-&gt;(@_);
      $self-&gt;{new_variable} = compute_value();
      $self;
    };
  };</pre>
<br><br>
 This defines a <i>new()</i> routine in <i>Existing Package<a href="http://www.perldesignpatterns.com/?ExistingPackage">+</a></i> that invokes the old <i>new()</i> routine using the reference we saved in <i>$oldnew</i>. This reference is passed all of the arguments given to the replacement <i>new()</i> routine. This assumes that the datastructure underlieing objects defined by <i>Existing Package<a href="http://www.perldesignpatterns.com/?ExistingPackage">+</a></i> is a hash reference: <i>$self-&gt;{new_variable}</i> would need to be changed to something similar to <i>$self-&gt;[num]</i> if it were an array. <i>compute_value()</i> is a place holder for whatever logic you really want to do.  We insert this value forcefully, disreguarding <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a>. Finally, we return the modified <i>$self</i>. The <i>return</i> operator breaks the <i>tie</i>ing on perl 5.6.1 and perhaps later, so we just let the last value of the block fall through. 
<br><br>
 Use the <i>x = sub { }</i> version of <i>sub</i>: it waits until run time to return the code reference, allowing a closure to be taken. See <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a>. We're taking a closure on <i>$oldnew</i>,
in this example: we have to wait to bind to this variable until the
specific instance of that variable we want has been created. This is
being done in side of a <i>do { }</i> block so as not to pollute our lexical context with variables that don't need to be in our scope. See <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a>. 
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Example&amp;word=%20B::Generate">Example: B::Generate</a> - [XXX code examples here from B modules] 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> Dynamic Languages<a href="http://www.perldesignpatterns.com/?DynamicLanguages">+</a> </li><li> <a href="http://www.perldesignpatterns.com/?ComputedReferences">Computed References</a> </li><li> <a href="#StaticVariables"><b>Static Variables</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> </li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a>, <a href="http://www.perldesignpatterns.com/?EqualsInterface">Equals Interface</a> </li><li> <a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a> 
<br><br>
 <br><br> <a name="AnonymousSubroutineObjects"></a><h2><a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Perl's <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming interface sucks. <a href="#InstanceVariables"><b>Instance Variables</b></a>
are slow to access, and require a special syntax that is unsightly and
prevents easily converting procedural code to OO code. Subclass data
can clobber superclass instance data unless manually prefixed with the
class name. Or, you just want to integrate the <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> style with the <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming style to harness their respective strengths. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Mix <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> and <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> styles to deal with the ugliness of Perl's <a href="#InstanceVariables"><b>Instance Variables</b></a>
syntax, write more concise program, and use scopes for implicit data
flow rather than manually passing to and reading from constructors. <br><br>
 <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a>'s
concept of automatically binding code to a perticular variable created
at a perticular time is the perfect replacement for using hashes or
arrays to contain instance data. Instead, routines magically hang on to
the normal scalars, hashes, arrays, and so forth that were defined with
<i>my</i> when the object was created. All that is needed is a block to set up the lexical context (define the <i>my</i> variables in) and a little glue. 
<br><br>
 <font size="+2"><b>Blessed Coderef</b></font><br><br>One of the strengths of the <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> style is ease of  doing things like <a href="#InnerClasses"><b>Inner Classes</b></a>.
Logic and data can be bundled without having to type out the name of
each variable to pass it to a constructor, and without having to read
it and assign it names in the constructor. Instead, the new object is
automagically coupled to the object that it was created in, and
variables that are in scope when the new object was created remain in
scope and available for use in future calls. <br><br>
 You should be familiar with this by now: 
<br><br>
 <pre>  package Preferences;

  sub new {
    my $class = shift;
    my %args = @_;
    bless {color=&gt;$args{'color'}, petname=&gt;$args{'petname'}, street=&gt;{'street'} }, $class;
  }

  sub query_color { return $_[0]-&gt;{'color'}; }
  sub set_color { return $_[0]-&gt;{'color'} = $_[1]; }
  # other accessors here

  1;

  package main;

  $| = 1;

  print "What's your favorite color? "; my $color = &lt;STDIN&gt;;
  print "What's your pets name? "; my $petname = &lt;STDIN&gt;;
  print "What street did you grow up on? "; my $street = &lt;STDIN&gt;;

  my $foo = new Preferences (color=&gt;$color, petname=&gt;$petname, street=&gt;$street);</pre>
<br><br> The string "color" appears ten times. Ten! In Perl, no less.
If I wrote out the named-argument fetch in the constructor for the
other arguments, this would be repeated for each variable. Shame. If we
trust the user to pass in the right things to the constructor, we can
get rid of two. Still, even typing each thing eight times is begging
for a typo to come rain on your parade. <br><br> If you're a LISP or Scheme programmer, you wouldn't even
consider writing an autocracy like this. You'd probably write something
like: <br><br>
 <pre>  package main;

  $| = 1;

  sub get_preferences {
    print "What's your favorite color? "; my $color = &lt;STDIN&gt;;
    print "What's your pets name? "; my $petname = &lt;STDIN&gt;;
    print "What street did you grow up on? "; my $street = &lt;STDIN&gt;;
    return <a href="http://www.perldesignpatterns.com/?MessageMethod">Message Method</a> sub {
      my $arg = shift;
      ({
        query_color =&gt; sub { return $color; }
        set_color =&gt; sub { $color = shift; return 1; }
        # etc
      }-&gt;{$arg} || sub { die "Unknown request: $arg" })-&gt;(@_);
    };
  }

  my $ob = get_preferences();
  print $ob-&gt;get_street(), "\n";</pre>
<br><br>
 First, the <i>{ query_name =&gt; sub { } }-&gt;{$arg}-&gt;(@_)</i>
is a sort of switch/case statement. It creates an anonymous hash of
names to functions, then looks up one of the functions by name, using
the first argument passed in. Once we have that code reference, we
execute it and pass it our unused arguments. Then we've added a default
case to it, so we don't try to execute undef as code. This could have
been coded using if/elsif/else just as easily. <br><br>
 Don't confuse the this case idiom <i>{name=&gt;sub{}}-&gt;{$arg}-&gt;(@_)</i> with <i>=8&gt;-()&lt;</i>, the  rubber chicken idiom. 
<br><br>
 The <i>get_preferences()</i> routine sets some variables, then returns a code reference.  <i>my</i>
variables get created when they're declared, and they don't get
destroyed until no one can see them any more. Since the code reference
we're returning when we say <i>return <a href="http://www.perldesignpatterns.com/?MessageMethod">Message Method</a> sub { }</i>
can see these variables, and we can see this code reference, Perl
doesn't get rid of them. They continue to live on, and keep their same
values, as if the subroutine they were created in had never returned.
What this means to us is that we don't have to copy the value from one
variable into a hash when we create an object! This saves us having
type the variable name as we pass it, specify what the variable should
be named in the hash that gets passed, then goes on to save us from
having to do the same steps in reverse once the object gets the hash
passed to it. With the same security, we've cut the use of the word
"color" in half, down to 5 uses. <br><br>
 If you think of Perl's <i>sub { }</i> feature as preserving the exact state of <i>my</i>
variables in a routine, you'll think of countless applications for
returning anonymous subroutines. Object Oriented object creation is
much more explicit, so you may find yourself getting lost in code like
this. If you figure out where an anonymous subroutine was defined, then
start reading the code leading up to it, you'll find where the
variables are declared, and where their values are set. The cost of the
reduced typing is reduced redundancy, which can make the program both
harder and easier to read at the same time. <br><br>
 Normal Objects: 
<br><br>
 </li><li> Copy data - new values are independent. </li><li> Passed via arguments to a method call to new(). </li><li> Method is called and evaluated when the object is created. 
<br><br>
 Lexically Defined Object: 
<br><br>
 </li><li> Share variables - changes to variables inside the object are reflected inside and vice versa. </li><li>
Never expicitly passed - instead, the rules of lexical scope are obeyed
- must be referenced inside the block they were defined in. </li><li> Method is created and returned when the object is created. It is not yet evaluated. 
<br><br>
 There is one little mystery left, though. Code references are dereferenced  using the <i>$ref-&gt;(@args)</i> syntax. <i>$ref-&gt;function(@args)</i> syntax is  reserved for objects. We shouldn't be able to call <i>$ob-&gt;get_street()</i>
in our example on a code reference -- unless that code reference has
been blessed into a package. It just so happens that that is exactly
what <i><a href="http://www.perldesignpatterns.com/?MessageMethod">Message Method</a></i> does. 
<br><br>
 <pre>  package <a href="http://www.perldesignpatterns.com/?MessageMethod">Message Method</a>;

  sub new {
    my $type = shift;
    return $type-&gt;new(@_) if ref $type eq __PACKAGE__;
    my $ref = shift; ref $ref eq 'CODE' or die;
    bless $ref, $type;
  }

  sub AUTOLOAD {
    my $me = shift;
    (my $method) = $AUTOLOAD =~ m/::(.*)$/;
    return undef if $method eq 'DESTROY';
    return wantarray ? ($me-&gt;($method, @_)) : scalar $me-&gt;($method, @_);
  }

  1;</pre>
<br><br>
 Given a code reference, <i><a href="http://www.perldesignpatterns.com/?MessageMethod">Message Method</a></i> blesses it into its own package. There  are no methods aside from <i>new()</i> and <i>AUTOLOAD()</i>. <i>AUTOLOAD()</i>
handles undefined methods for Perl, and since there are no methods, it
handles all of them. (There is an exception to that, where new() has to
pass off requests). <i>AUTOLOAD()</i> merely takes the name of the
function it is standing in for and sends that as the first argument to
a call to the code reference, along with the rest of the arguments.
We're translating <i>$ob-&gt;foo('bar')</i> into <i>$ob-&gt;('foo', 'bar')</i>. This does nothing  but let us decorate our code reference with a nice OO style syntax. 
<br><br>
 This is similar to Python's method lookup logic XXX, in that it returns the method as an object. 
<br><br>
 japhy appears to have beat me to this idea: <a href="http://japhy.perlmonk.org/modules/DynScalar/DynScalar-1.02/README">http://japhy.perlmonk.org/modules/DynScalar/DynScalar-1.02/README</a>  - he deserves mention here. Check out Dyn Scalar<a href="http://www.perldesignpatterns.com/?DynScalar">+</a> on CPAN. 
<br><br>
 <font size="+2"><b>Blessed Hash full of Coderefs</b></font><br><br>The previous example was simplicity itself. This one is usefullness itself. Doing <i>if</i> and <i>elsif</i> in a chain to inspect an argument to see which  clause to run to simulate methods is the <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> paradigm, but <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>'s
concept of automatically dispatching to methods is superior. Obviously,
a single code reference isn't enough to let OO do its dispatch magic.
We need something larger - something like a hashref that contains a
bunch of coderefs, one coderef per method. The normal thing to do in
Perl is to put all of the code directly in the package, using the
symbol table (or stash, or namespace, or what have you) to hold all of
the code references, and define the code references using a simple
named <i>sub</i> statement. This doesn't allow each instance of the object to have different code references lexically bound to different <a href="#InstanceVariables"><b>Instance Variables</b></a>. We need private storage for the code references and the anonymous version of the <i>sub</i> statement. We need <i>hashclosure.pm</i>. 
<br><br>
 <pre>  # place this code in hashclosure.pm

  # tell Perl how to find methods in this object - run the lambda closures the object contains

  sub AUTOLOAD {
      (my $method) = $AUTOLOAD =~ m/::(.*)$/;
      return if $method eq 'DESTROY';
      our $this = shift;
      if(! exists $this-&gt;{$method}) {
        my $super = "SUPER::$method";
        return $this-&gt;$super(@_);
      }
      $this-&gt;{$method}-&gt;(@_);
  } 
  
  1;</pre>
<br><br> This code translates method calls into invocations of
anonymous subroutines by the same name inside of a blessed hash: when a
method is called, we look for a hash element of that name, and if we
find it, we execute it as a code reference. <br><br>
 The flow of control goes something like: 
<br><br>
 /\/\/\/\ 
<br><br>
 graph: {  
<br><br>
 <pre>  title: "Dispatch Order"
  color: lightcyan
  manhattan_edges: yes
  edge.color: lilac
  scale: 90

  node: { title:"A" label: "$foo = new Foo(); \n$foo-&gt;bar();" }
  node: { title:"A1" label: "Foo::new()" }
  node: { title:"B" label: "Foo::AUTOLOAD()" }
  node: { title:"C" label: "$foo-&gt;{'bar'}-&gt;() runs" }
  edge: { sourcename:"A" targetname:"A1" anchor: 1}
  edge: { sourcename:"A" targetname:"B" anchor: 2}
  edge: { sourcename:"B" targetname:"C" }</pre>
<br><br>
 } 
<br><br>
 /\/\/\/\ 
<br><br>
 Dropping the above code verbatum into a .pm file it doesn't change package (there is no <i>package</i> statement),  so it defines an <i>AUTOLOAD()</i> method for the current package.  This is a <a href="#WrapperModule"><b>Wrapper Module</b></a> of sorts. <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> and our <i>AUTOLOAD()</i> method work together to provide <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>-like easy access to <i>$this</i> and <a href="#InstanceVariables"><b>Instance Variables</b></a>. We can use object instance specific field variables directly without having to dereference a hash. 
<br><br>
 <pre>  package Foo;

  sub new {

    my $class = shift;  
    my %args = @_;
    our $this;

    my $foo;
    my $bar;

    bless {

      get_foo =&gt; sub { return $foo },
      set_foo =&gt; sub { $foo = shift },
      get_bar =&gt; sub { return $bar },
      set_bar =&gt; sub { $bar = shift },

      get_foo_bar_qux =&gt; sub {
        return $this-&gt;get_foo(), $this-&gt;get_bar(), get_qux();
      },

      dump_args =&gt; sub {
        foreach my $i (keys %args) {
          print $i, '=', $args{$i}, "\n";
        }
      },

    }, $class;

  }

  sub get_qux { return 300; }</pre>
<br><br>
 This blesses an anonymous hash reference into our package, <i>Foo</i>. This hash reference contains method names as keys and anonymous subroutines as values. <i>AUTOLOAD()</i> knows how to look into our hash and find methods by name, and run them, rather than looking for methods in the normal place. 
<br><br>
 <i>our</i> is a strange beast. It gives us a <i>my</i> style lexical alias to a <i>local</i> style variable. We could use a <i>local</i> variable here, but <i>our</i> has a nicer syntax, and it keeps us in the lexical mode of thought.  
<br><br>
 <i>$foo</i>, <i>$bar</i>, <i>$this</i>, <i>$class</i> and <i>%args</i> are all lexical variables, and the subroutines we create with <i>sub { }</i> are <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> because they reference these variables. By referencing them, they bind to the one specific copy that was created when <i>new()</i> is entered. That means that each object has its own private <i>$foo</i>, for instance, and can access it directly. <i>get_qux()</i> is defined as a normal method in the preceding example. In any OO Perl code, failing to do something like <i>$this-&gt;method()</i>
to call other functions in your code prevents inheritance from
overriding those methods. Using this syntax keeps open the possibility
of creating <a href="#TemplateMethod"><b>Template Method</b></a>. Where we explicit don't want subclass redefinitions of methods to be used, way can use the <i>$this-&gt;Foo::method()</i> syntax, where <i>Foo</i> is the name of the class to search for <i>method()</i> in, usually our own package or our direct parent. 
<br><br>
 Methods may also be defined normally and placed next to <i>new()</i>. This is useful for utility methods, or <i>static</i> methods in C++ or Java. Methods must be defined this way to be called without using the <i>$this-&gt;method()</i> syntax. <i>$this-&gt;method()</i> is required to get the <i>AUTOLOAD()</i> logic to kick in as  otherwise Perl has no knowledge of how to locate the code responsible for handing your method.  
<br><br>
 This is my own personal favorite idiom for creating objects in <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Perl&amp;word=%20it">Perl: it</a> requires the least code to acheive, and the least work on my part, and the least chance of error.  
<br><br>
 <font size="+2"><b>Object::Lexical</b></font><br><br>Object::Lexical
- like the above examples - uses lexical binding and lambda closures
for instance data. Rather than using Perl code to slowly redispatch
calls, custom symbol tables (stashes, what have you) are created to
hold the closures. Perl itself does the lookup. All of the <i>@ISA</i> logic works, including the cache. This greatly speeds things up. Sub::Lexical cleans up the syntax when used in conjunction:  
<br><br>
 <pre>  use Object::Lexical;
  use Sub::Lexical;

  $| = 1; 

  sub new {

    print "What's your favorite color? "; my $color = &lt;STDIN&gt;;
    print "What's your pets name? "; my $petname = &lt;STDIN&gt;;
    print "What street did you grow up on? "; my $street = &lt;STDIN&gt;;

    my sub query_color { $color };
    my sub set_color { $color = shift };
    my sub query_petname { $petname };
    my sub set_petname { $petname = shift };
    my sub query_street { $street };
    my sub set_street { $street = shift };

    instance();
    
  }</pre>
<br><br>
 <i>Does it get any sweeter than this? Lexical instance data with Object::Lexical and Sub::Lexical </i> 
<br><br>
 <font size="+2"><b>CPAN class Package</b></font><br><br>In other news, <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=116725">PerlMonks:116725</a> defines a <i>class</i> package usable as such: 
<br><br>
 <pre>    my $class = new class sub{
        my $field = shift;
        $this-&gt;field = $field;
        $this-&gt;arrayref = [1,2,3];
        $this-&gt;hashref = {a =&gt; b, c =&gt; d};
        $this-&gt;method = sub{ return $this-&gt;field };
    };</pre>
<br><br>
 ...allowing the anonymous, inline construction of classes.  
<br><br>
 <font size="+2"><b>Abagail's Inside-Out Objects</b></font><br><br>Qouting Abagail: 
<br><br>
 <pre>  package BaseballPlayer::Pitcher; {
      use vars '@ISA';
      @ISA = 'BaseballPlayer';
 
      my (%ERA, %Strikeouts);
   
      sub ERA        : lvalue {$ERA        {+shift}}
      sub Strikeouts : lvalue {$Strikeouts {+shift}}
      sub DESTROY {
          my $self = shift;
          delete $ERA {$self}, $Strikeouts {$self}
      }
  }</pre>
<br><br> Taking this apart, lexical data is used instead of nametable
variables, which doesn't seem to make any difference. Rather than
indexing the blessed reference by a constant field name to come up with
a per-object, per-field storage slot, one of these lexicals is indexed
by the stringified object reference. <br><br>
 See <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=178518">PerlMonks:178518</a> for more 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryExpert">Category Expert</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?FakingDelegationUsingAutoload">Faking Delegation Using Autoload</a> </li><li> <a href="#WrapperModule"><b>Wrapper Module</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> <a href="#PassingPattern"><b>Passing Pattern</b></a> </li><li> <a href="#TemplateMethod"><b>Template Method</b></a> </li><li> Object::Lexical </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=ExternalMethodSelectors.htm">ObjectArts:ExternalMethodSelectors.htm</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=116725">PerlMonks:116725</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=Blessables+--+What+Can+You+Make+Into+Objects%3F">PerlMonks:Blessables+--+What+Can+You+Make+Into+Objects%3F</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=178518">PerlMonks:178518</a> - inside out objects </li><li> <a href="http://japhy.perlmonk.org/modules/DynScalar/DynScalar-1.02/README">http://japhy.perlmonk.org/modules/DynScalar/DynScalar-1.02/README</a> </li><li> LISP::Lambda </li><li> <a href="http://theoryx5.uwinnipeg.ca/CPAN/data/rubyisms/rubyisms.html">http://theoryx5.uwinnipeg.ca/CPAN/data/rubyisms/rubyisms.html</a> 
<br><br>
 <br><br> <a name="OverloadOperators"></a><h2><a href="#OverloadOperators"><b>Overload Operators</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>When</b></font><br><br>Comparing objects for equality, or taking string representations of them. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br><pre>  use overload
    '&lt;=&gt;' =&gt; sub { 
      my $me = shift;
      my $them = shift;
      # return -1 to indicate we go before them
      # return 1 to indicate we go after
      # 0 means logically same
      return $me-&gt;foo &lt;=&gt; $them-&gt;foo;
    },
    '""' =&gt; sub {
      my $this = shift;
      return join '.' map {
        $this-&gt;{$_}
      } qw(field1 field2 field3);
    };</pre>
<br><br>
 Your object now knows how to stringify itself, and can be sorted and compared to like objects: 
<br><br>
 <pre>  my @obs = sort $ob1, $ob2, $ob3;</pre>
<br><br> More importantly, you can test objects for equality using a
benchmark other than rather or not the two pointers reference the exact
same object. <br><br> More operations can be overloaded as well: most require that
a new object be created and returned. For example, overloading addition
requires this be done. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=overload">PerlDoc:overload</a> </li><li> <a href="#ImmutableObject"><b>Immutable Object</b></a> </li><li> <a href="http://www.perl.com/pub/a/2003/07/22/overloading.html">http://www.perl.com/pub/a/2003/07/22/overloading.html</a> 
<br><br>

<br><br>
 <br><br> <a name="ClassAsTypeCode"></a><h2><a href="#ClassAsTypeCode"><b>Class As Type Code</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Values from a
definitive list of permissiable values are needed. In Perl, hashes of
possible valid values are commonly used, and enums are used in C. These
permissiable values must be packaged with their behavior [code,
implementation, what have you], or we're trying to apply to this idea
in an <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> way. Or, each object is a special <a href="http://perldesignpatterns.com/intermap.cgi?wiki=MagicCookie&amp;word=unique,">MagicCookie:
unique,</a> impossible to recreate without being given it, and therefore later usable as proof of having been given the cookie. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Centralize creation, containment, and distribution of the objects. 
<br><br> The container of the objects also plays the roles of both the
creator and distributor. The creator aspect makes one of each when it
itself is created, like the <a href="#SingletonPattern"><b>Singleton Pattern</b></a> applied to multiple objects. The distributor aspect descides to whom and on what basis the objects are distributed. 
<br><br>
 The idea of <a href="#TypeSafety"><b>Type Safety</b></a>
allows us to validate that these objects probably came from our pool
without having to have an explicit list of all of the members of the
pool: <br><br>
 <pre>  # using <a href="#TypeSafety"><b>Type Safety</b></a>:

  sub set_day {
    die unless $_[0]-&gt;isa('Day');
    $day = shift;
    return 1;
  }

  # using a plain old hash:

  sub set_day {
    die unless exists $daysref-&gt;$_[0];
    $day = shift;
    return 1;
  }</pre>
<br><br>
 Everything from this set passes the "isa" test, so we can use <a href="#TypeSafety"><b>Type Safety</b></a>
to check our arguments. In any other language, it would be impossible
to add to the set after being created this way, but we could do revisit
the package (see <a href="#RevisitingNamespaces"><b>Revisiting Namespaces</b></a>) or redefine the constructor in Perl, so this shouldn't be considered secure. <pre>  
  package Day;
  
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();

  $mon = new Day 'mon';
  $tues = new Day 'tues';

  my @days;

  sub new { 
    die unless caller eq __PACKAGE__;
   my $me = { id=&gt;$_[1] }
    bless $me, $_[0];
    push @days, $me;
    return $me;
  }

  sub get_id { return $id };

  sub get_days { return @days; }

  # in Apopintment.pm:
  
  package Appointment;
  
  my $day;

  sub set_day {
    die unless $_[0]-&gt;isa('Day');
    $day = shift;
    return 1;
  }
  </pre>XXX examples of use, what you can and cannot do, etc. 
<br><br>
 Java's API, AWT especially, has numerous examples of this. <i>AWT.Color</i> contains <i>AWT.Color.RED</i>,  <i>AWT.Color.BLUE</i>, and so forth. This provides a symbolic name for objects, where each object is unique. There will never be two different <i>BLUE</i> objects floating around. This allows us to compare them for equality using their pointers: 
<br><br>
 <pre>  $mon eq $mon;        # true
  $mon eq $tues;       # false</pre>
<br><br>
 This behavior, too, is shared with the <a href="#SingletonPattern"><b>Singleton Pattern</b></a>. The same effect could be acheived using <a href="#OverloadOperators"><b>Overload Operators</b></a>. This approach is simplier and more clear. 
<br><br>
 If we give someone <i>AWT.Color.BLUE</i>, and then they later give it back to us, we can use the <i>eq</i> test to decide with certainty whether or not we gave them <i>BLUE</i>
as there is no other way they could possibly obtain it [Although they
could have created a factory for producing objects with overloaded <i>eq</i>
operators that return the correct package name and each possible memory
address, attempting to use a brute force attack. Since memory addresses
are fairly predictable between runs, this approach would be fairly
effective. Again, Perl and Security don't really go together at the
source code level. See also <a href="http://www.perldesignpatterns.com/?PerlSecurity">Perl Security</a>]. 
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Credits&amp;word=%20Unknown%21">Credits: Unknown!</a> Dates back a long time, though... XXX 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ContainerPattern"><b>Container Pattern</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="#SingletonPattern"><b>Singleton Pattern</b></a> </li><li> <a href="#RevisitingNamespaces"><b>Revisiting Namespaces</b></a> </li><li> <a href="#OverloadOperators"><b>Overload Operators</b></a> </li><li> <a href="http://www.onjava.com/pub/a/onjava/2003/04/23/jenum.html">http://www.onjava.com/pub/a/onjava/2003/04/23/jenum.html</a> 
<br><br>
 <br><br> <a name="StatePattern"></a><h2><a href="#StatePattern"><b>State Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Checks litter
the code. Nearly every method checks one specific instance variable to
decide how to behave. The possible values of this variable are finite
in number and well understood: on and off, or north, south, west, east,
for example. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Make each
possible state of the object into a subclass. Leave the general case
and the general logic in the parent object. Consider the state variable
to be a constant in each subclass and optimize it away in your code. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>What
happens when a light switch is thrown depends on its current state: on
or off. Its new state is the opposite. A light switch has to be capable
of dealing with all of the complexities of being either on or off,
which isn't a lot of complexity, really. However, some machines have
dozens or hundreds of states. This one machine has to know how to be in
each state. In reality, few machines serve a large number of purposes.
Attempts have been made to combine cell phones and PDAs, cell phones
and MP3 players, PDAs and MP3 players, MP3 players and portable storage
devices, PDAs and portable storage devices, audio recorders and MP3
players, audio recorders and PDAs, audio recorders and cell phones...
in thousands of combinations... there is not currently an example of
all three of those things in one device. It is complex to have a pocket
full of devices, but it also complex to <s>license all of the patents needed to implement</s>
design a device that serves every purpose. Design simplicity wins, for
now. Likewise, when implementing a complex virtual object, sometimes it
is best to represent it as a collection of simple objects, each of
which knows exactly what its purpose is and cares nothing for the
purposes of the other objects, not even able to agree on a common flash
media format. When you wish to switch from one mode of the object to
another, you simply replace it with the other object. No complex
internal state change occurs, just one broad over all state change.
States are each clearly defined and seperate. <br><br>
 <pre>  package Pocket::Computer;

  sub record_audio {
    # implemented in some subclasses but not others
  }

  sub take_a_memo {
    # that we can do
  }

  sub make_a_call {
    die "don't know how, and the FCC would have a cow";
  }

  package Pocket::Phone;

  sub record_audio {
    # some do, some don't. most don't.
  }

  sub take_a_memo {
    die "i'm not a PDA";
  }

  sub make_a_call {
    # this we can do
  }</pre>
<br><br> Some devices can do some things, others can do other things.
Each device does not have to check to see if it is the kind of device
that can - it just knows, because thats what it is, and identity is a
large part of <a href="http://www.perldesignpatterns.com/?ObjectOrientation">Object Orientation</a>. <pre>  </pre>At a certain level of complexity the concept of a <a href="http://www.perldesignpatterns.com/?StateChange">State Change</a>
is introduced. Cars suffer from this complexity. You may go from parked
to idling, or you may go from idling to accelerating, but not from
parked to accelerating. Going from accelerating to parked is also known
as an insurance claim. Each state knows the states that are directly,
immediately attainable. <a href="http://www.perldesignpatterns.com/?BreadthFirstRecurssion">Breadth First Recurssion</a> or <a href="http://www.perldesignpatterns.com/?DepthFirstRecurssion">Depth First Recurssion</a> is needed to plan out anything more complex. 
<br><br>
 XXX - <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> parser as an example 
<br><br>
 <a href="http://www.perldesignpatterns.com/?ConstructorPattern">Constructor Pattern</a> and <a href="#ImmutableObject"><b>Immutable Object</b></a> coupled with <a href="#AbstractFactory"><b>Abstract Factory</b></a>
describe an alternative arrangement: when a state change is needed, the
existing object is passed as an argument to the factory along with the
any information needed to decide what the next object will be. The <a href="#AbstractFactory"><b>Abstract Factory</b></a> returns an <a href="#ImmutableObject"><b>Immutable Object</b></a>,
initialized with the existing objects data, to replace the existing
object. One object is swapped for another not through delegation and a
facade, but through an <a href="#AbstractFactory"><b>Abstract Factory</b></a> that spits out instances of <a href="#ImmutableObject"><b>Immutable Object</b></a>.  
<br><br>
 <a href="http://www.perldesignpatterns.com/?WritingPerlModulesForCPAN">Writing Perl Modules For CPAN</a>,
page 258, has a very good example of creating a simple web BBS using
CGI::Application . CGI::Application models a users web experience as a <a href="http://www.perldesignpatterns.com/?StateMachine">State Machine</a>. Each screen is a  state that takes you to other states. The state transitions are  buttons and so forth on the screens. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#PassingPattern"><b>Passing Pattern</b></a> </li><li> <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?StateMachine">State Machine</a> </li><li> <a href="http://www.perldesignpatterns.com/?BreadthFirstRecurssion">Breadth First Recurssion</a> </li><li> <a href="http://www.perldesignpatterns.com/?DepthFirstRecurssion">Depth First Recurssion</a> </li><li> <a href="http://www.perldesignpatterns.com/?UseDiagrams">Use Diagrams</a> </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/146262">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/146262</a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/State/">http://hatena.dyndns.org/~jkondo/DesignPattern/State/</a>  </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/State.html">http://www.tml.hut.fi/~pnr/GoF-models/html/State.html</a> </li><li> <a href="http://www.perldesignpatterns.com/?WritingPerlModulesForCPAN">Writing Perl Modules For CPAN</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perlmonks.org/index.pl?parent=246322&amp;title=Dynamicly%20controlling%20%40ISA%20and%20namespaces&amp;lastnode_id=246322&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on">http://www.perlmonks.org/index.pl?parent=246322&amp;title=Dynamicly%20controlling%20%40ISA%20and%20namespaces&amp;lastnode_id=246322&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=246685">http://www.perlmonks.com/index.pl?node_id=246685</a> 
<br><br>
 <br><br> <a name="MomentoPattern"></a><h2><a href="#MomentoPattern"><b>Momento Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Objects are left in an inconsistant state in a failure scenario. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Checkpoint the object and restore it in the event of failure. 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>You need an "Undo" behavior. Delegate an object to be the keeper of another. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>You are starting something you may not be able to finish. An operation might abort, leaving data in an inconsistent state. 
<br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>Querying values from an object and conditionally restoring them. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>XXX Generic example with a deep-copy algorithm. 
<br><br>
 Easily implemented by wrapping one object inside of another and using Clone. 
<br><br>
 <pre>  package Memento;
  
  sub new {
    my $type = shift;
    my %opts = @_;
    die __PACKAGE__ . " requires an object passed on its constructor: new Memento object=&gt;\$obj"
      unless $opts{'object'};
    my $this = { object=&gt;$opts{'object'}, checkPoint=&gt;undef };
    bless $this, $type;
  }
  
  sub mementoCheckPoint {
    my $this = shift;
    $this-&gt;{'checkPoint'} = $this-&gt;deepCopy($this-&gt;{'object'});  
  }
  
  sub mementoRestore {
    my $this = shift;
    $this-&gt;{'object'} = $this-&gt;{'checkPoint'};
  }
  
  sub AUTOLOAD {
    my $this = shift;
    (my $method) = $AUTOLOAD =~ m/.*::(\w+)$/;
    return if $method eq 'DESTROY';
    return $this-&gt;{'object'}-&gt;$method(@_);
  }
  
  sub deepCopy {
    my $this = shift;
    my $ob = shift;
    die unless caller eq __PACKAGE__; # private
    return $ob if(!ref $ob);
    if(ref $ob eq 'SCALAR') {
      my $value = $$ob; return \$value;
    }
    if(ref $ob eq 'HASH') {
      my %value = %$ob; return \%value;
    }
    if(ref $ob eq 'ARRAY') {
      my @value = @$ob; return \@value;
    }
    # FILEHANDLE, GLOB, other cases omitted
    # assume its an object based on a hash
    # XXX man perlfunc say that $ob-&gt;isa('HASH') works...?
    my $type = ref $ob;
    my $newself = { };
    foreach my $i (keys %$ob) {
      $newself-&gt;{$i} = $this-&gt;deepCopy($ob-&gt;{$i});
    }
    return $newself;
  }</pre>
<br><br> While this is a generic Memento package, it cannot possibly
know how to correctly deal with objects contained inside the object
given it. A version of this (possibly subclassed) tailored to a
specific package would handle this situation correctly. Here, we
replicate objects mercilessly. This code also violates the
encapsulation rules of OO. Use it as a starting point for something
that doesn't. <br><br>
 <font size="+2"><b>Credits</b></font><br><br><a href="http://www.perldesignpatterns.com/?GangOfFour">Gang Of Four</a> 
<br><br>
 <font size="+2"><b>Category</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TransactionObject">Transaction Object</a> </li><li> <a href="http://www.perldesignpatterns.com/?TransactionPattern">Transaction Pattern</a> </li><li> <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a> </li><li> Clone on CPAN </li><li> <a href="#CloningPattern"><b>Cloning Pattern</b></a> </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/Memento/">http://hatena.dyndns.org/~jkondo/DesignPattern/Memento/</a>  </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=Undoable+objects">PerlMonks:Undoable+objects</a> </li><li> <a href="http://www.tml.hut.fi/%7Epnr/GoF-models/html/Memento.html">http://www.tml.hut.fi/~pnr/GoF-models/html/Memento.html</a> 
<br><br>

<br><br>
 <br><br> <a name="RunAndReturnSuccessor"></a><h2><a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Flow control
is spread all over the place. Understanding and modifying flow requires
knowledge of many modules, which is error prone. Instead, you
centralize transitions in flow, and represent state transitions as
objects. Each state object knows how to create an object representing
any state immediately accessible from itself. <br><br>
 <font size="+2"><b>When</b></font><br><br>Applications, or modules that perform many functions at different times. 
<br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>Programs that people are scared of editing for fear of inserting  terminal bugs. Programs that stop unexpectedly. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>"The Halting
Problem" is a subject of much research. No technique exists for
predicting when an arbitrary program will suddenly stop running and
bail out. Programmers of critical systems are deeply concerned with
whether or not their programs contain unexpected conditions that would
cause sudden, catastrophic termination. Modeling the program flow isn't
a complete answer, but it addresses two important problems: <br><br>
 </li><li> If we find out that the state we're in in
unexpected, we can abort, and go to the previous state. Thus, any error
that can be caught has an easy, generic solution. <br><br>
 </li><li> Users causing fatal situations by doing two or
more unexpected things in sequence is minimized, as the state of the
program between each transition is clearly defined. Global information
is minimized: while a program is in code related to a specific state,
information specific to that state can live somewhere inside that
state. When transitioning to the next state, the information that can
be passed to the next state is limited to well defined object types
accepted by the new state. <br><br> Each state would have a method that, given user input or the
result of a computation, would return another state object, to be
executed. Queues and Stacks can extend the possibilities: the basic
idea is only to model the transitions. <br><br>
 <pre>  # Non <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>:

  my $parser = do {
    my $html;             # HTML to parse
    my $tag;              # name of the current HTML tag
    my $name;             # name of current name=value pair we're working on
    my $namevalues;       # hashref of name-value pairs inside of the current tag
    my $starttag = sub {
      if($html =~ m{\G(&lt;!--.*?--&gt;)}sgc) {
        return $starttag;
      }
      if($html =~ m{\G&lt;([a-z0-9]+)}isgc) {
        $tag = $1;
        $namevalues = {};
        return $middletag;
      }
      if($html =~ m{\G[^&lt;]+}sgc}) {
        return $starttag;
      }
      return undef;
    };
    my $middletag = sub {
      if($html =~ m{\G\s+}sgc) {
        return $middletag;
      }
      if($html =~ m{\G&lt;(/[a-z0-9]*)&gt;}isgc) {
        $name = $1;
        return $middlevalue;
      }
      if($html =~ m{\G&gt;}sgc) {
        $namevalues-&gt;{$name} = 1 if $name;
        return $starttag;
      }
      return undef;
    };
    my $middlevalue = sub {
      if($html =~ m{\G=\s*(['"])(.*?)\1}isgc) {
        $namevalues-&gt;{$name} = $1 if $name;
        return $middletag;
      }
      if($html =~ m{\G\s+}sgc) {
        return $middlevalue;
      }
      return $middletag;
    };
    return sub {
      $html = shift;
      return $starttag;
    };
  };

  open my $f, 'page.html' or die $!; read my $f, my $page, -s $f; close $f;

  $parser = $parser-&gt;($page);
  $parser = $parser-&gt;() while($parser);</pre>
<br><br>
 Of course, rather than iterating through <i>$parser</i> and using it as a generator,  we could blow the stack and make it do the recursive calls itself. In general, <i>return $foo;</i> would be replaced with <i>return $foo-&gt;();</i>. 
<br><br>
 XXX I wonder if parser could do $_[0] = <i>next object</i> so that merely saying $parser-&gt;(foo) would work in place of $parser = $parser-&gt;(foo).. that would be nifty! 
<br><br> The observant reader will notice that each anonymous
subroutine we define represents a state in our grammar. At any given
moment, there are only a few things which are valid, so there is no
point in looking for everything. Doing so would lead to confusion and
bugs. We could rewrite this to be cleaner and use fewer variables, but
I choose this presentation because of its extremely regular structure. <br><br>
 XXX <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> example. 
<br><br>
 </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wiki&amp;word=RunAndReturnSuccessor">Wiki:RunAndReturnSuccessor</a> - implement the state transitions in your program as objects 
<br><br>
 <font size="+2"><b>Credits</b></font><br><br><a href="http://www.perldesignpatterns.com/?DesignPatternsElementsOfReusableSoftware">Design Patterns Elements Of Reusable Software</a> / <a href="http://www.perldesignpatterns.com/?GangOfFour">Gang Of Four</a> 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryExpert">Category Expert</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> <a href="#ImmutableObject"><b>Immutable Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?StrategyObject">Strategy Object</a> </li><li> <a href="#MomentoPattern"><b>Momento Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TransactionObject">Transaction Object</a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wiki&amp;word=RunAndReturnSuccessor">Wiki:RunAndReturnSuccessor</a> </li><li> <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> </li><li> <a href="http://perl.plover.com/Stream/stream.html">http://perl.plover.com/Stream/stream.html</a> 
<br><br>
 <br><br> <a name="ObjectsAndRelationalDatabaseSystems"></a><h2><a href="#ObjectsAndRelationalDatabaseSystems"><b>Objects And Relational Database Systems</b></a></h2><br> 
<br><br>

<br><br> Its useful to borrow the idea of relationships from Relational
Database Management Systems (relational databases). In fact, many large
enterprise applications are actually collections of specialized
applications all built around one large data warehouse. Records in the
database are represented in software by objects. These objects can be
queried for things they related to: other objects representing records.
<br><br>
 </li><li> One to one correspondence between two different
things: a person has one social security number and a social security
number refers to one (living) person. </li><li> One object may refer to several others: a person may oven several pets.  </li><li>
An intersection of sets: many people have tried many flavors of ice
cream. Asking a person which ice cream flavors they have tried returns
a list; asking which people have tried a flavor of ice cream also
returns a list. <br><br> In the same way, object oriented systems that aren't backed
by a database still have one to one, one to many, and many to many
relationships between the objects. It can be useful exercise to sit
down with pencil and paper and map out which kinds of relationships
which kinds of objects are going to have. This often exposes design
limits in a system where the things can happen in reality that the
software isn't prepared for. <br><br>
 [XXX Package that database result records from DBI can be blessed into to give methods to query neighbors, etc? Untested.] 
<br><br>
 <pre>  package DBI::Record;
  
  my $foreign_keys = {};
  
  sub import {
    # read foreign key information
    # translates a foreign column name to a table to its table
    # $foreign_keys{'<a href="http://www.perldesignpatterns.com/?FooID">Foo ID</a>'} = 'Foo';
    while(my $i = shift) {
      $foreign_keys{$i} = shift;
    }
  }
  
  sub new {
    my $type = shift; $type = ref $type if ref $type;
    my $me = { };
    my $usage = 'usage: new DBI::Record $dbh, $sql | ($sth, $sth-&gt;fetchrow_hashref())';
    my $dbh = shift; ref $dbh or die $usage;
    my $rs = shift; my $sth; my $sql;
    die $usage unless @_;
    if(ref $_[0]) { 
      $sth = shift;
      $rs = shift or $rs = $sth-&gt;fetchrow_hashref();
    } else {
      $sql = shift;
      $sth = $dbh-&gt;prepare($sql); $sth-&gt;execute(); $rs = $sth-&gt;fetchrow_hashref();
    }
    $me-&gt;{'database_handle'} = $dbh;
    $me-&gt;{'record_set'} = $rs;
    $me-&gt;{'statement_handle'} = $sth;
    # generate accessors
    foreach my $i (keys %$rs) {
      *{$i} = sub {
        my $me = shift;
        my $sth = $dbh-&gt;prepare("select * from $foreign_keys{$i} where $i = $rs-&gt;{$i}");
        $sth-&gt;execute();
        my $newrs = $sth-&gt;fetchrow_hashref;
        return $me-&gt;new($dbh, $newrs, $sth); 
      }
    }
    bless $me, $type;
  }
  
  sub next {
    my $me = shift;
    my $sth = $me-&gt;{'statement_handle'} or return undef;
    my $newrs = $sth-&gt;fetchrow_hashref() or return undef;
    return $me-&gt;new($me-&gt;{'database_handle'}, $sth, $newrs);
  }
  
  package main;
  
  use DBI::Record
    <a href="http://www.perldesignpatterns.com/?CustomerID">Customer ID</a> =&gt; Customers,
    <a href="http://www.perldesignpatterns.com/?BillID">Bill ID</a> =&gt; Bills;
  
  use DBI;
  
  my $dbh = DBI-&gt;connect("<a href="http://perldesignpatterns.com/intermap.cgi?wiki=DBI&amp;word=Pg:dbname=geekpac" ,="">DBI:Pg:dbname=geekpac",</a> 'ingres', '') or die $dbh-&gt;errstr;
  
  my $customer = new DBI::Record $dbh, "select * from Users limit 1";
  
  my $bill = $customer-&gt;<a href="http://www.perldesignpatterns.com/?BillID">Bill ID</a>();
  while($bill) {
    print $bill-&gt;{'<a href="http://www.perldesignpatterns.com/?BillID">Bill ID</a>'}, " ", $bill-&gt;{'Amount'}, "\n";
    $bill = $bill-&gt;next();
  }</pre>
<br><br> This makes it easy to navigate relationships in a relational
database system, but doesn't do a lot for us in the way of reporting. <br><br> [XXX Relational Principles - Todo - dr e f codd created
relational model. normalization protects database from inconsistent
state... 2. every non-column key must depend entirely on the key. 3. no
nonkey column may depend on another nonkey column. 4. no 1:many
relationships within a record.] <br><br>
 <a href="http://www.objectarchitects.de/ObjectArchitects/orpatterns/index.htm">http://www.objectarchitects.de/ObjectArchitects/orpatterns/index.htm</a> - design patterns of objects and relational database systems 
<br><br>
 <a href="http://www.martinfowler.com/eaaCatalog/singleTableInheritance.html">http://www.martinfowler.com/eaaCatalog/singleTableInheritance.html</a>
is actually somewhat interesting, and begins to touch on the idea of
data cubes - flattening and restoring hyperdimentional data structures
into two dimentions. <br><br>
 <a href="http://www.martinfowler.com/eaaCatalog/concreteTableInheritance.html">http://www.martinfowler.com/eaaCatalog/concreteTableInheritance.html</a> is prevelent, though not insightful, and should be illustrated here in depth. It ties in with <a href="http://www.perldesignpatterns.com/?BeanPattern">Bean Pattern</a>,
too. If a relational database and an object system each match up part
to part - table for class - the object system will work through normal
delegation and composition. The database will also "just work", though
newbies will need to learn how to write large-ish queries that do lots
of outter joins. Detecting NULL for key fields replaces <i>-&gt;can()</i>, or is used when constructing queries that build systems of objects, and <i>-&gt;can()/-&gt;isa()</i> information is needed. This gets into datacube stuff, too. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a>, <a href="http://www.perldesignpatterns.com/?CategoryExpert">Category Expert</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> Class::DBI on CPAN </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="#ManyToManyRelationship"><b>Many To Many Relationship</b></a> </li><li> Self Joing Data<a href="http://www.perldesignpatterns.com/?SelfJoingData">+</a> </li><li> <a href="http://www.perldesignpatterns.com/?BeanPattern">Bean Pattern</a> </li><li> <a href="#OneToOneRelationshipsTurnIntoOneToManyRelationships"><b>One To One Relationships Turn Into One To Many Relationships</b></a> </li><li> DBI::FAQ  </li><li> <a href="http://www.objectarchitects.de/ObjectArchitects/orpatterns/index.htm">http://www.objectarchitects.de/ObjectArchitects/orpatterns/index.htm</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/identityField.html">http://www.martinfowler.com/eaaCatalog/identityField.html</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/foreignKeyMapping.html">http://www.martinfowler.com/eaaCatalog/foreignKeyMapping.html</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/associationTableMapping.html">http://www.martinfowler.com/eaaCatalog/associationTableMapping.html</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/singleTableInheritance.html">http://www.martinfowler.com/eaaCatalog/singleTableInheritance.html</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/concreteTableInheritance.html">http://www.martinfowler.com/eaaCatalog/concreteTableInheritance.html</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/inheritanceMappers.html">http://www.martinfowler.com/eaaCatalog/inheritanceMappers.html</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/metadataMapping.html">http://www.martinfowler.com/eaaCatalog/metadataMapping.html</a> </li><li> <a href="http://tangram.sourceforge.net/pod/Tangram.html">http://tangram.sourceforge.net/pod/Tangram.html</a> 
<br><br>
 <br><br> <a name="SelfJoiningData"></a><h2><a href="#SelfJoiningData"><b>Self Joining Data</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Reporting on a database with only one table, or a self-referential data structure. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Use relational database capabilities to <i>join</i> anyway, joining the data to itself. For datastructures, use loops, temporarily hashes, and <a href="http://www.perldesignpatterns.com/?BreadthFirstRecurssion">Breadth First Recurssion</a> to make sense of the data [todo: example of reporting on complex self-referential datastructures]. 
<br><br> Or, write queries to normalize the data [todo: example of
writing a query to normalize a flat database], and refactor the
database. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br><a href="#SelfJoiningData"><b>Self Joining Data</b></a>
refers to data not spread across objects or tables or different types.
Instead, everything is of the same type or in the same table, and this
data forms a web of internal references. Sometimes powerful, usually
applied incorrectly. In the database world, refered to as
"non-normalized" or "flat". <br><br>
 When relational data isn't normalized, you get something like: 
<br><br>
 <pre>  select self1 as foo, self2 as bar
  from   self as self1,
         self as self2
  where  self1.name = self2.param</pre>
<br><br>
 Note how the table <i>self</i> is being joined against the table <i>self</i>. This is where the name "self joining data" comes from. 
<br><br>
 For datastructures, you'll get something like: 
<br><br>
 <pre>  foreach my $i (keys %hash) {
    if(exists $hash{$i} and exists $hash{$hash{$i}}) {
      push @results, [$i, $hash{i}, $hash{$hash{$i}}];
    }
  }</pre>
<br><br> Ugly, slow, crude, effective. People have been known to write
code generators and SQL generators when faced with degenerate cases
like these that automate ugliness production. I guess you could
categories this as an <a href="http://www.perldesignpatterns.com/?AntiPattern">Anti Pattern</a> in the form of a <a href="http://www.perldesignpatterns.com/?CodeSmell">Code Smell</a>. 
<br><br>
 The more fields you want back from the database, the more times you have to self-join the data.  
<br><br>
 Pretend you have a database that stores form submits. <i>forms</i> has one record per post, but since an HTML form has any number of name-attribute pairs, several entries in <i>parameters</i> reference the entry in <i>forms</i> for any given post. Given a <i>formid</i>, we want to extract a few named parameters: "email", "name", and "gender": 
<br><br>
 <pre>  select  p1.value as email,
          p2.value as name,
          p3.value as gender
  from    form
          parameters as p1,
          parameters as p2,
          parameters as p3
  where   form.formid = ?
  and     p1.formid = form.formid
  and     p1.name = 'email'
  and     p2.formid = form.formid
  and     p2.name = 'name'
  and     p3.formid = form.formid
  and     p3.name = 'gender'</pre>
<br><br>
 Each additional field requires 4 additional lines in our query. If we were  joining the additional tables in, it would take 2: 
<br><br>
 <pre>  select emails.email   as email, 
         names.name     as name, 
         genders.gender as gender
  from   forms, emails, names, genders
  where  forms.formid  = ?
  and    forms.nameid   = names.nameid
  and    forms.emailid  = emails.emailid
  and    forms.genderid = gender.genderid</pre>
<br><br> Lumping everything in one table would simplify further, and in
this case would be perfectly acceptable. When not all of the columns
describe the primary key and only the primary key, the database design
degenerates. <a href="#SelfJoiningData"><b>Self Joining Data</b></a> usually comes about as a means to cope with trying to report on such degenerate databases.  
<br><br>
 Cases where <a href="#SelfJoiningData"><b>Self Joining Data</b></a> is acceptable: 
<br><br>
 </li><li> Data is being logged in a raw format, and is yet
to be mined and converted into a normalized format. Mining is a
hueristic second stage. Actual reporting will be done from the
normalized data. </li><li> Meta application requires soft references.
A database administration tool that allows for editing of or reporting
on arbitrary table structures will need to store "soft references" to
table and column names. Custom designed tools are far less complex and
error prone. <br><br> In all other cases, Different kinds of things should be
placed in different tables. The structure (which table references which
IDs in which other tables) shows the relationship between the different
kinds of things. One to many relationships require two tables; many to
many relationships require three. <br><br>
 <font size="+2"><b>One Large Table as a God Object</b></font><br><br>Not
wanting to have to join tables in that are expected to contain data
that is always wanted, programmers will instead the data add column
after column to the one existing table (or the primary table, off of
which all other tables are hung). The code <a href="#GodObject"><b>God Object</b></a> exactly resembles this, and the problems are the same. 
<br><br>
 <font size="+2"><b>Stubborn, Stubborn Programmer</b></font><br><br>So, you won't budge? You program is one large object and your database is one large table. Whatever. Here are some tips: 
<br><br>
 Solutions: 
<br><br> Given a litter of things all alike, it is helpful to think of
them as a sort of "object". Each object has no parts, but the same
tests can be performed on them. Invdivisible, but observeable, they may
all be treated the same. <br><br>
 </li><li> They may reference each other, perhaps for
multiple distinct reasons. They may have "next", "previous",
"contains", "sits on", "extends", "painted with" or whatever other
fields, each containing an ID of another object. </li><li> Because any
object may contain the ID of any other object for any field, any object
may be painted with, sitting on top of, or extending any other object.
If this is difficult to deal with, turn back now, and normalize your
database. I recommend the <a href="http://www.perldesignpatterns.com/?PracticalSQLHandbook">Practical SQLHandbook</a>. </li><li> Write recursive (or atleast iterative) code: define methods that call methods in neighbor objects. See <a href="#IteratorInterface"><b>Iterator Interface</b></a>
for an example of an iterator that recurses across all objects in a
network. To navigate a network of objects, call the appropriate
methods. Consider (strongly consider) usering Class::DBI. [XXX
example?] <br><br> XXX this place is a placeholder. You can fix it up yourself,
or you can wait for me to do it. If you are here expecting a finished
version of something, stick to <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=assemble.cgi?PerlDesignPatterns">TinyCGI:assemble.cgi?PerlDesignPatterns</a> and don't wander off the path. 
<br><br>
 <pre>  &lt;TakeFive&gt; <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Juerd&amp;word=%20I">Juerd: I</a> think I'm going to go with multiple tables after all.
             It will save me headaches in the future.
             And I can pull them (assuming the 'header' record is in %h) with:
             "select value from $h{datatype} where id = $h{id} order by sequence"

  &lt;Juerd&gt; subqueries, subqueries, subqueries, joins.
          subqueries, subqueries, subqueries, joins.

  &lt;TakeFive&gt; :)

  &lt;Juerd&gt; Ideally, you don't use a query just to have enough information to do the next

  &lt;scrottie&gt; Except for meta applications like database admins, usually you 
             don't want a variable table name.
 
  &lt;Juerd&gt; That is correct.
          Same goes for column names.

  &lt;Juerd&gt; <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TakeFive&amp;word=%20Think">TakeFive: Think</a> symbolic references

  &lt;scrottie&gt; If all of your things are of essentially of the same type, put atleast
             the parts of them that describe the primary key in one table. You
             can always <a href="http://www.perldesignpatterns.com/?OutterJoin">Outter Join</a> a lot of other tables, so you get kind of an 
             <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> like thing going on - everything "is a" foo, but 
             you have CompositionConcept going as well.  It is kind of the same idea.

  &lt;TakeFive&gt; scrottie: the problem is (going back to the oceanographic implementation)
             right now, with the dataset I have, all the actual data is floating 
             point numbers --

  &lt;scrottie&gt; I've always said we should dump our problems in the ocean =)

  &lt;TakeFive&gt; Salinities, depths, current speeds and such.
             But now i've been told i need to support character fields, 
             latitude/longitude pairs, and timestamps, and ultimately, I'll
             need to be able to generate pictures of buoys as they float, or 
             purely text output.
             If I use a single table, I'll always have to check what kind of data 
             I have.

  &lt;scrottie&gt; n:1 relationships break out into another table,
             so if you have a bunch of buoys for one given primary record (what 
             is the primary record anyway?), then throw them all in another
             table.
             If you have an arbitrary number of other things of types that you can't 
             anticipate, you could promote everything to the same object type
             and allow recurisve references between objects ;)
             Perlers tend to write databases like that... like <a href="http://www.perldesignpatterns.com/?PerlMonks">Perl Monks</a>'s 
             codebase... but it is best not to talk of such things

  &lt;Juerd&gt; It's called Everything

  &lt;scrottie&gt; If you have a lot of different things, you can set up an attribute-value 
             pairs table. Think of HTML forms. Someone posts a form. That
             gets a record in a Posts table, lets say. it has a bunch of name value 
             pairs. Each of those gets a record in the Attribute table,
             where each record references the Posts table entry.

  &lt;scrottie&gt; Yeah. You lose the ability to cleanly join at that point - 
             everything is nested subqueries with another self-join for each 
             record you want from Attributes. Ugly. So, that way is 
             sometimes - seldom but sometimes - better. 

  &lt;TakeFive&gt; scrottie: ah, add a column like: "datatype" for each record.

  &lt;Juerd&gt; subqueries, subqueries, subqueries, joins.

  &lt;scrottie&gt; Well, the value in the attribute-value pair will always be the 
             largest thing - if you're holding binary data, it will be a blob. 
             Few databases index blobs.

  &lt;scrottie&gt; You probably don't want <a href="#SelfJoiningData"><b>Self Joining Data</b></a>, and you don't want to 
             promote all records to the same type. That leaves creating a lot
             of tables, one for each type of thing, and doing a lot of joins
             and OutterJoins. It kind of sucks, but it is powerful, and a lot
             less ugly in the end than any alternative. 
             The relation between tables is based purely on references
             between fields. Never list table names in a database as a means
             of creating references.</pre>
<br><br> Juerd is right. Use lots of joins and subqueries to pull your
data together from multiple different tables. As Juerd says, ideally,
you should get your result in one query. Use only IDs in auxiliary
tables or Hinge Tables<a href="http://www.perldesignpatterns.com/?HingeTables">+</a>.
You can easily create more auxiliary tables and reference the primary
table from them. Only queries that want this information will know
about and know to ask for it to be joined in. [This conversion
essentially took place. However, it has been edited, and everyone and
their dog has access to Wiki, so it should be considered ficticious at
this point. Characters are real, words are not.] <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#ObjectsAndRelationalDatabaseSystems"><b>Objects And Relational Database Systems</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?BreadthFirstRecursion">Breadth First Recursion</a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="#SoftrefsToHash"><b>Softrefs To Hash</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?PracticalSQLHandbook">Practical SQLHandbook</a> 
<br><br>

<br><br>
 <br><br> <a name="ManyToManyRelationship"></a><h2><a href="#ManyToManyRelationship"><b>Many To Many Relationship</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Objects of one type don't each simply belong to objects of another type.  They're shared.  
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Model the data
with three tables rather than two, or with three kinds of objects
rather than two. Introduce a concept of membership. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Individual people each having a distinct set of traits can be expressed cleanly with three tables. Any fewer would lead to <a href="#SelfJoiningData"><b>Self Joining Data</b></a>
and an ever increasing number of columns holding primary, secondard,
trinary, and so on indefinately, positional attributes, which can only
be used in queries with great pain and modifications each time a new
slot is added. Any more tables leads to the same problem, but with
constant introduction of tables rather than attributes. <br><br>
 The <i>People</i> table exists exactly as expected: a list of people, with columns for things that each and every person has. 
<br><br>
 All attribute tables need to be generalized into one. Any further attribute specific data may <a href="http://www.perldesignpatterns.com/?OutterJoin">Outter Join</a> to the <i>Attribute</i>
table but should not be included in the attribute table itself: only
the columns which describe the each and every attribute and nothing
else. <br><br>
 Normalize the <i>People</i> table so that <i>Attribute ID<a href="http://www.perldesignpatterns.com/?AttributeID">+</a></i>s
don't exist in it. The rules of normalization state that any time we're
attempting to hold an array of data in one record, we really want a 3rd
independent table. This is exactly what we need to do. <i>People</i> contains <i>People ID<a href="http://www.perldesignpatterns.com/?PeopleID">+</a></i>.  <i>Attribute</i> contains <i>Attribute ID<a href="http://www.perldesignpatterns.com/?AttributeID">+</a></i>. <i>People To Attribute<a href="http://www.perldesignpatterns.com/?PeopleToAttribute">+</a></i> contains one <i>People ID<a href="http://www.perldesignpatterns.com/?PeopleID">+</a></i> and one <i>Attribute ID<a href="http://www.perldesignpatterns.com/?AttributeID">+</a></i> per record. Each <i>People ID<a href="http://www.perldesignpatterns.com/?PeopleID">+</a></i> may occur any number of times, and each <i>Attribute ID<a href="http://www.perldesignpatterns.com/?AttributeID">+</a></i> may occur any numbers of times, and these may occur in any combination.  <i>People To Attribute<a href="http://www.perldesignpatterns.com/?PeopleToAttribute">+</a></i> is a hinge table. Hinge tables can and should contain data specific to the combination of the two IDs.  
<br><br> Badly designed databases often require repeated application of
this concept. A database may list wholesale and retail prices, primary
product category, and secondary category, should be turned into a table
listing <i>Product</i>s, one listing <i>Category</i>, one listing <i>Price Option<a href="http://www.perldesignpatterns.com/?PriceOption">+</a></i>, and two hinge tables. <i><a href="http://www.perldesignpatterns.com/?ProductToCategory">Product To Category</a></i> shows the membership of each produce in each category by virtue of having a record making the connection: 
<br><br>
 <pre>  select count(*) as isDongle
  from   Product, Category, <a href="http://www.perldesignpatterns.com/?ProductToCategory">Product To Category</a>
  where  Product.ProductID = <a href="http://www.perldesignpatterns.com/?ProductToCategory">Product To Category</a>.ProductID
  and    <a href="http://www.perldesignpatterns.com/?ProductToCategory">Product To Category</a>.CategoryID = Category.CategoryID
  and    Category.Name = 'Dongle'</pre>
<br><br>
 This query returns the number of dongles in the database. Replacing <i>count(*)</i> with a specific field list would return details of each dongle.  
<br><br>
 <i>Price Option<a href="http://www.perldesignpatterns.com/?PriceOption">+</a></i>
contains records "Wholesale" and "Retail", but cannot contain the
actual prices. Attempting to do so would be no better than putting the
prices directly into <i>Product</i>. <i>Product To Price Option<a href="http://www.perldesignpatterns.com/?ProductToPriceOption">+</a></i> not only connects <i>Product</i> to the pricing options available for it as listed in <i>Price Option<a href="http://www.perldesignpatterns.com/?PriceOption">+</a></i>,
but for each pricing option, contains the actual price. Normalization
dictates that each and every column in a table depend (that is, be
specific to) the key, the entire key, and nothing but the key. The
price depends on more than <i>Product ID<a href="http://www.perldesignpatterns.com/?ProductID">+</a></i> in <i>Product</i> because it also depends on <i>Price Option ID<a href="http://www.perldesignpatterns.com/?PriceOptionID">+</a></i> in <i>Price Option<a href="http://www.perldesignpatterns.com/?PriceOption">+</a></i>. Likewise, it does not depend on just <i>Price Option ID<a href="http://www.perldesignpatterns.com/?PriceOptionID">+</a></i>, but also <i>Product ID<a href="http://www.perldesignpatterns.com/?ProductID">+</a></i>. <i>Product To Price Option<a href="http://www.perldesignpatterns.com/?ProductToPriceOption">+</a></i> is keyed by both <i>Price Option ID<a href="http://www.perldesignpatterns.com/?PriceOptionID">+</a></i> and <i>Product ID<a href="http://www.perldesignpatterns.com/?ProductID">+</a></i>, so each record it contains is specific to both values. 3.95 may be the Retail price for "The Moon is a Harsh Mistress". 
<br><br> Understanding object relationships is impossible without
understanding the rules of data normalization. Failing to do so so will
result in obnoxiously complex object structures with no apparent
solution for making sense of them. It is critical to deciding when to
create objects, and where to place data in them. <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryConcept">Category Concept</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?PracticalSQLHandbook">Practical SQLHandbook</a> </li><li> <a href="http://www.perldesignpatterns.com/?OutterJoin">Outter Join</a> </li><li> <a href="#SelfJoiningData"><b>Self Joining Data</b></a> 
<br><br>

<br><br>
 <br><br> <a name="OneToOneRelationshipsTurnIntoOneToManyRelationships"></a><h2><a href="#OneToOneRelationshipsTurnIntoOneToManyRelationships"><b>One To One Relationships Turn Into One To Many Relationships</b></a></h2><br> 
<br><br>

<br><br> One to many relationships become many to many as original
design assumptions are relaxed. This lets us model more complex
situations. Objects that contained one instance of a kind of another
object may find themselves holding an array. Methods that operated on
this object explicitly now need to be told which one to operate on.
Defining an iterator and moving the interface to the iterator lets us
keep our concept of one and only object, but adds the concept of moving
to the next object in the list. Places where the single object was
implicitly manipulated need only be wrapped in a loop. <br><br>
 [XXX code! Example!] 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#ObjectsAndRelationalDatabaseSystems"><b>Objects And Relational Database Systems</b></a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="#CompositePattern"><b>Composite Pattern</b></a> </li><li> <a href="#ObjectsAndRelationalDatabaseSystems"><b>Objects And Relational Database Systems</b></a> </li><li> <a href="#BiDirectionalRelationshipToUnidirectional"><b>Bi Directional Relationship To Unidirectional</b></a> 
<br><br>
 See also: UML, SQL, <a href="http://www.perldesignpatterns.com/?PracticalSQLBook">Practical SQLBook</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <br><br> <a name="BiDirectionalRelationshipToUnidirectional"></a><h2><a href="#BiDirectionalRelationshipToUnidirectional"><b>Bi Directional Relationship To Unidirectional</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Relationship between objects is confusing. Responsbility is ambigious, or calls bounce back and forth. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Apply <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a>, <a href="#InnerClasses"><b>Inner Classes</b></a>, <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a>, or a <a href="#ConstraintSystem"><b>Constraint System</b></a> as necessary. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>In it's most basic form: 
<br><br>
 <pre>  my $output = new Output;
  my $backend = new Backend($output);
  $output-&gt;set_backend($backend);</pre>
<br><br>
 Or: 
<br><br>
 <pre>  my $output = new Output($this);</pre>
<br><br>
 Refactor as a: 
<br><br>
 </li><li> <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a> - make the link less circular and more triangular </li><li> Vistor Pattern<a href="http://www.perldesignpatterns.com/?VistorPattern">+</a> or <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="#ConstraintSystem"><b>Constraint System</b></a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> - rather than pass the entire parent, pass a special callback object 
<br><br>
 Should <i>$output</i> know about <i>$backend</i> or <i>$this</i>? Does it make sense for <i>$backend</i> to place a call into <i>$output</i> that requires a call back into <i>$output</i>?  
<br><br>
 </li><li> Since any method could call any other method,
calls could bounce back and forth indefinately for all we know. You'd
feel better knowing that infinite, or
finite-but-excesive-to-the-point-of-silly loops, aren't possible. </li><li> Each object's API is burdoned with the needs of the other object. </li><li> Each object is more concerned with the other objects data than its own - you have an <a href="#ObjectOrgy"><b>Object Orgy</b></a>. </li><li> Should you decide at runtime to do away with <i>$output</i>
and replace it with something else, the procedure for notifying it to
drop its reference to you is odd and error prone, especially if this
relationship repeats. <br><br>
 <font size="+2"><b>WholeObject</b></font><br><br>Contention for data of exactly this sort is a strong hint at a  <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a> refactoring: move the data that is of common interest into a <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a> and passed whole, negating the need for a callback. See <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a>, <a href="#PassingState"><b>Passing State</b></a>, <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a> 
<br><br>
 <font size="+2"><b>InnerClasses</b></font><br><br>Using <a href="#InnerClasses"><b>Inner Classes</b></a>,
the parent class need not have its API burdoned with the special needs
and interfaces of its child, and the scope of the circular reference
can be greatly reduced. An object created inside of the parent object,
attached to its lexical data, can be sent off in place of <i>$this</i>. 
<br><br>
 <pre>  my $output = new Output;
  my $backend = new Backend($output-&gt;get_backend_adapter());
  $output-&gt;set_backend($backend-&gt;get_output_adapter());</pre>
<br><br>
 Or... 
<br><br>
 <pre>  my $output = new Output($this-&gt;get_output_adapter());</pre>
<br><br>

<br><br>
 <font size="+2"><b>ModelViewController</b></font><br><br>As <a href="http://www.perldesignpatterns.com/?ObjectOrientedDesignHeuristics">Object Oriented Design Heuristics</a>
says, books don't shelve themselves, nor do shelves put the books on
them, but there must exist a librarian. Considering mapping the problem
as a <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a>. This is more of interest to dealing with too much complexity in the logic rather than too much complexity in the code. 
<br><br>
 <font size="+2"><b>ConstraintSystem</b></font><br><br>An odd web of objects that participate in group-think is unavoidable or desireable. Bite the bullet and do it right. See <a href="#ConstraintSystem"><b>Constraint System</b></a>. 
<br><br>
 <font size="+2"><b>Resources</b></font><br><br><font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ManyToManyRelationship"><b>Many To Many Relationship</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a> </li><li> Class Vs State<a href="http://www.perldesignpatterns.com/?ClassVsState">+</a> </li><li> <a href="http://www.perldesignpatterns.com/?ValueObject">Value Object</a> </li><li> <a href="#PassingPattern"><b>Passing Pattern</b></a> </li><li> <a href="#PassingState"><b>Passing State</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="#ObjectOrgy"><b>Object Orgy</b></a> </li><li> <a href="#ClassNaming"><b>Class Naming</b></a> 
<br><br>

<br><br>
 <br><br> <a name="NamedArguments"></a><h2><a href="#NamedArguments"><b>Named Arguments</b></a></h2><br> 
<br><br>

<br><br> When adding and removing arguments, it can be difficult to
remember the order you wanted them in. Using a hash, you can do away
with arbitrary ordering. <br><br>
 <pre>  sub foo {
    my %args = @_;
    my $color = $args{color};
    my $number = $args{number};
    # ...
  }
  
  foo(color=&gt;'red', number=&gt;13);
  
  The || operator lets you easily provide defaults and error checking:
  
  sub foo {
    my %args = @_;
    my $color = $args{color} || 'red';
    my $number = $args{number} || die 'number=&gt; paramer required';
    # ...
  }
  
  Or, you may explicitly list the argument names and defaults, providing a self-documenting framework:
  
  sub foo {
    my %args = (
      Arg1        =&gt; '<a href="http://www.perldesignpatterns.com/?DefaultValue">Default Value</a>',
      Blah        =&gt; 42,
      Bleh        =&gt; 60*60*24,
      Hostname    =&gt; undef,
      @_
    );
    # Handle error-checking here
    defined $args{Hostname} or die 'Required parameter "Hostname" not defined';
  }
  </pre><font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#SoftrefsToHash"><b>Softrefs To Hash</b></a> </li><li> <a href="#TooManyArguments"><b>Too Many Arguments</b></a> </li><li> <a href="#TooManyVariables"><b>Too Many Variables</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>

<br><br>
 <br><br> <a name="FunctionTemplating"></a><h2><a href="#FunctionTemplating"><b>Function Templating</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Creating a custom compliment of code cleans crufty object access syntax. 
<br><br>
 <font size="+2"><b>When</b></font><br><br>Your code is bloating due to another cumbersome interface.  
<br><br>
 Forth Language<a href="http://www.perldesignpatterns.com/?ForthLanguage">+</a>
teaches that no language will be well suited to every problem, so the
best language is one that is well suited to creating languages for
expression solutions in general. Huh? Instead of attaching the problem
head on, step back and formulate a plan involving intermediate steps to
the goal. We've designed data structures using objects. We've
engineered programs using objects as building blocks. Whens the last
time we've designed a language to solve a problem? Any language lets
you create functions, but Forth lets you create functions that create
other functions (Forth calls functions "words"). We don't need to cook
up a VM and a syntax to do this, though we could. Perl's VM and syntax
will work. <br><br> This is kind of a like an Abstract Factory. Objects
certainly give you a way to generalize a solution, but they don't give
you a mechanism to express a solution. If the solution involves making
lots of method calls, the algorithm can get swamped down in OO syntax
to the point where it is hidden. Removing the excess syntax is one way
of refactoring code. Everyone benefits from the clarity, especially
when you're trying to formulate a language as an intermediate step to
solving a tough problem. <br><br> Lets take template processing as an example. Lets say you've
got various sorts of templates: templates representing HTML fragments,
templates representing email templates, database queries, and so on.
You could create objects to represent each type of thing, and give each
a stringify() method that requires a hash argument of values to
template in. You would then write a huge amount of code, mostly method
calls, loops, and string concatenations. <br><br>
 Or... XXX untested code.: 
<br><br>
 <pre>  # defining our mini language:

  # format of our macro escapes. returns the name of the macro.
  $macro = qr{([A-Z][A-Z0-9]{2,})};
  sub fetchvalue() {
    my $symbol = lc(shift());
    my $ob = shift;
    return $ob-&gt;{$symbol} if defined $ob-&gt;{$symbol};
    return $symbol-&gt;($ob) if defined &amp;{$symbol};  # if its available as a function, recurse into it
    return $$symbol;                                              # assume its a scalar
  }

  sub createtemplate {
    my $name = shift; 
    my $text = shift;
    *{$name} = sub {
      my $ob = shift;
      my $text = $text; # private copy, so we don't ruin the original
      $text =~ s{$macro}{ fetchvalue($1, $ob); }oges;
      return $text;
    };
  }

  sub createquery {
    my $name = shift;    # name of function to create 
    my $sql = shift;        # query this function will execute
    my $inner = shift;     # name of function to call with each result, optional
    my @queryargs; $sql =~ s{('?)$macro\1}{push @queryargs, lc($2);'?'}oges;
    my $sth = $dbh-&gt;prepare($sql, @queryargs);
    *{$name} = sub {
      my $ob = shift;
      my $row;
      my $ret;
      $sth-&gt;execute(map { fetchvalue($1, $ob); } @args);
      my @names = @{$sth-&gt;{'NAME'}};
      while($row = $sth-&gt;fetchrow_arrayref()) {
        # store each item by its column name
        for(my $i=0;$i &lt; @names; $i++) {
          $ob-&gt;{$names[$i]} = $row-&gt;[$i];
        }
        # if we're supposed to send each record to someone, do so.
        $ret .= $inner-&gt;($ob) if($inner);
      }
      $sth-&gt;finish();
      return $ret;
    };
  }

  # writing code in our mini language:

  createquery('readnames', qq{
    select Name as name from Users where Name is not null
  });

  createquery('readnumberbyageinstate', qq{
      select count(*) as number, Age as agearoup
      from Users where State = STATE
      group by Age 
  }, 'drawbargraph');

 createtemplate('drawbargraph', qq{
    &lt;div align="left"&gt;&lt;img src="reddot.png" height="20" width="NUMBER"&gt;&lt;/div&gt;
  });

  print readnames();
  print readnumberbyageinstate({state=&gt;'MD'});</pre>
<br><br>
 Lets take a look at what we've factored out in this example: 
<br><br>
 </li><li> Preparing queries. </li><li> Iterating over results. </li><li> Templating HTML or text snippits. </li><li> Reading and passing arguments. </li><li> Recursion. 
<br><br> createtemplate() is a simple example. createquery() is more
advanced. A simple example appeared in Chapter XXX 3 where we created
accessors for ourself. <br><br> For any task that is suited our mini language, we've
completely factored out several tedious syntactical things. We're now
free to work in a very concise, expressive, short-hand language. Yet,
we still have all of the power of Perl available - we haven't given up
anything. <br><br>
 The key elements are: 
<br><br> The returned code reference is lexically bound to the data you
passed to it. The data passed to it could be any datatype, including
objects, scalars, and most importantly, code references. Logic is
factored out of the main program into the inner part of the "create"
routine, inside of the anonymous subroutine block. <br><br> Creating a symbol table entry (assigning the anonymous
subroutine to a glob of the given name) is optional. This skip can be
stepped and done manually if you find yourself mostly creating
functions to pass to other functions: <br><br>
 <pre>  print createquery($readnumberbystatesql, {drawpiechart =&gt; createpiechart() }, 'drawpiechart');</pre>
<br><br>
 It is traditional in languages like Lisp and Scheme to skip naming things unless actually necessary. 
<br><br> Next time you're getting bogged down in syntax, ask yourself
if a function generator could be written that would take care of the
tedious busy work. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?AcmeTemplate">Acme Template</a> </li><li> <a href="#CurryingConcept"><b>Currying Concept</b></a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?CrossSectionalRefactoring">Cross Sectional Refactoring</a> 
<br><br>

<br><br>
 <br><br> <a name="ReturnYourself"></a><h2><a href="#ReturnYourself"><b>Return Yourself</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br><a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> code tends to be large sequences of method calls, and  does not readily form expressions. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>When returning nothing else, or after successfully updating internal state, return the object. 
<br><br>
 Help people who want to write consice expressions: return your reference back instead of nothing. 
<br><br>
 <pre>  ($foo = $bar) * 100;</pre>
<br><br> In Perl, the result of an assignment is the variable that got
assigned to. This lets you chain operations. It is pleasant to be able
to do the same thing objects: <br><br>
 <pre>  $fooOb-&gt;setBar($bar)-&gt;multiply(100);</pre>
<br><br>
 Instead of returning "1", we return $fooOb back, to be used again. 
<br><br>
 Inside of the method, it looks like: 
<br><br>
 <pre>  sub setBar {
    my $self = shift;
    $self-&gt;{Bar} = shift;
    return $self;
  }</pre>
<br><br>
 The <i>return</i> is for clarity - to make <i>lvalue</i> methods work, it must be omitted - a corner case, but keep it in mind.  
<br><br>
 Sometimes returning yourself isn't the best thing to do:  
<br><br>
 </li><li> When a secondary interface is being presented to serve as an adapter: see <a href="#InnerClasses"><b>Inner Classes</b></a>, <a href="#AdapterPattern"><b>Adapter Pattern</b></a>, and <a href="#NoSexUntilMarriage"><b>No Sex Until Marriage</b></a>. </li><li>
The object never mutates - its internal state never changes. In that
case, a new instantance of the class should be returned - this has the
same advantages to syntax. See Immutable Objects<a href="http://www.perldesignpatterns.com/?ImmutableObjects">+</a>. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ImmutableObject"><b>Immutable Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#OverloadOperators"><b>Overload Operators</b></a> </li><li> <a href="#AccessorPattern"><b>Accessor Pattern</b></a> 
<br><br>
 <br><br> <a name="AssertPattern"></a><h2><a href="#AssertPattern"><b>Assert Pattern</b></a></h2><br> 
<br><br> Die early, die often, get closer to the root of the problem.
Don't let an error in one part of the program trigger problems much
later in a distant, unrelated part of the program. Check arguments
types, provide accessors to enforce policies and handle state changes
in objects there so that they are responsible for keeping themselves
consistent. <br><br>
 </li><li> Die early and die often. 
<br><br>
 Have <i>or die $!;</i> appear after each statement whose
failure you aren't prepaired to handle otherwise. These clauses should
absolutely litter your program. <br><br>
 </li><li> Die before the damage spreads beyond from the source. 
<br><br> Should something fail unexpectedly, execution will stop at the
exact point of failure, and the diagnostic will be fresh and useful. <br><br>
 </li><li> "or die" documents what isn't supposed to happen. 
<br><br>
 Things that a program assumes it can count on are called <i>invarients</i>. These are the basic assumptions that the program was written under. <i>or die</i> documents these in your code for all to see. 
<br><br>
 </li><li> Don't let people call things you don't want them to. 
<br><br> People resort to the printed documentation only when they
can't figure out the interface for themselves. This applies equally to
video games, digital time pieces, and software APIs. Diagnostics are
more helpful than the manual, in this sense. <br><br>
 </li><li> ...or else you'll have to support a busted interface long after you you want to get rid of it. 
<br><br> This is part of "encapsulation" or "data hiding". Making part
of your interface public is committing to support that design
indefinately. Don't do this lightly. <br><br>
 </li><li> Use <i>eval {}</i> for error trapping 
<br><br> Sometimes you want your application to die with a useful
diagnostic should an invarient by deviated from, for example when
you're first installing and configuring an application, or when you're
debugging it. Othertimes, you want it to do its absolute best to keep
on trucking, for instance when that program is running as a mission
critical service. Making no attempt to trap errors acheives the first
case. For the second case, wrap <i>eval {}</i>
around calls. Where you apply this technique depends on how much
recovery logic you're willing to write. The more recovery logic, the
closer the protective <i>eval {}</i> can be to the possible failure points. Less recovery logic means that fewer <i>eval {}</i> statements are needed. 
<br><br>
 <pre>  eval {
    run_query();
  };
  if($@) {
     $dbh = DBI-&gt;connect("<a href="http://perldesignpatterns.com/intermap.cgi?wiki=DBI&amp;word=Pg:dbname=blog;host=localhost;port=5432" ,="">DBI:Pg:dbname=blog;host=localhost;port=5432",</a> 'scott', 'foo');
     run_query();
  }</pre>
<br><br>
 <font size="+2"><b>Assertions in Perl</b></font><br><br>Subroutine (and method) assertions have been implemented as pre- and postconditions in the Sub::Assert module on CPAN at <a href="http://search.cpan.org/author/SMUELLER/Sub-Assert/">http://search.cpan.org/author/SMUELLER/Sub-Assert/</a>.
The module also offers to pose some restrictions on calling context.
(Eg. one needn't call a no-side-effects accessor in void context.) <br><br>
 <font size="+2"><b>Other Forms of Asserts</b></font><br><br>In
the process of debugging, to find the source of the problem, you'll
knowingly or unknowingly add asserts to track down where things go
wrong. This idea takes many guises: <br><br>
 </li><li> Print statements: human operator manually checking output values for expected values. </li><li> Perl <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Debugger&amp;word=%20inserting">Debugger: inserting</a> breakpoints and manually inspecting data, or conditional breakpoints. </li><li> Using static types with <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TypeSafety&amp;word=%20asserting">TypeSafety: asserting</a> at compile-time what datatypes will be passed, returned, and assigned. </li><li> Of course, using the <i>or die</i> construct. See <a href="#ErrorReporting"><b>Error Reporting</b></a> and <a href="#ErrorHandling"><b>Error Handling</b></a>. 
<br><br>
 <font size="+2"><b>Type Safety and Asserts</b></font><br><br>Asserts are useful to make sure that the current program state is what is expected. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="#TypedVariables"><b>Typed Variables</b></a> </li><li> <a href="#AccessorPattern"><b>Accessor Pattern</b></a> </li><li> <a href="#BigBallOfMud"><b>Big Ball Of Mud</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> </li><li> <a href="http://www.perldesignpatterns.com/?DaemonPattern">Daemon Pattern</a> </li><li> <a href="#ErrorReporting"><b>Error Reporting</b></a> </li><li> <a href="#ErrorHandling"><b>Error Handling</b></a> </li><li> <a href="#DebuggingPattern"><b>Debugging Pattern</b></a> 
<br><br>
 <br><br> <a name="CodeAsData"></a><h2><a href="#CodeAsData"><b>Code As Data</b></a></h2><br> 
<br><br>
 Code and data, time and space, lo... 
<br><br> What follows is a rant on the nature of programs. While not
suitable for consuption in any format, it is a thought I need to
develop further, as it affects every explaination in this text. <br><br> Some declarations run as they are encountered; some affect
future behavior. Run time programing modification - self modifying code
- is an example of affecting future behavior; so are lambda closures
and object instantiations. Some languages are purely sequential: C.
Some are purely declarative: Ocaml. <br><br> For many people, datastructures are seen as influencing
future behavior only, likewise code is always seen as executing
immediately. <br><br>
 Tied data, for example in our <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a>,
and using object accessors to fetch and stow data give datastructures
the property of executing immediately. Changing the implementation on
the fly by using the polymorphic nature of objects makes linear
comprehension of code impossible. So do lambda closures. <br><br> B::Generate lets you inspect and modify the bytecode tree.
Creating amusements to search and replace literal strings in a running
program, replace segments of code, and whatever else is possible. Using
B::Deparse, regexes, and <i>eval()</i>, existing code could also be modified and executed in a less elegant style. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> B::Generate </li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> </li><li> <a href="#FunctionalProgramming"><b>Functional Programming</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AbstractObject">Abstract Object</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicallyScopedVariables">Lexically Scoped Variables</a> </li><li> Scheme Language<a href="http://www.perldesignpatterns.com/?SchemeLanguage">+</a> 
<br><br>

<br><br>
 <br><br> <a name="NonReenterable"></a><h2><a href="#NonReenterable"><b>Non Reenterable</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Work is handled
through recursion or delegation. Sometimes it is delegated back, or
recursion never terminates due to a problem out of our control. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Use a re-entrance lock to detect and gracefully handle the situation. Set the lock on entrance and clear it on exit. 
<br><br>
 <pre>  my $lock;

  sub notify_all {
    if($lock) {
      warn "Don't respond to an event with an event!";
      $lock++;
    }
    foreach my $listener (@listeners) {
      $listener-&gt;send_event(@_);
    }
    $lock = 0;
  }</pre>
<br><br> In most cases, it is never an error to be called back by the
object that you just called. Some times re-entry isn't an error at all,
and you can silently refuse it. <a href="#ConstraintSystem"><b>Constraint System</b></a>
uses this idea to propogate values across a network where some nodes
are willing to budge and others aren't. Usually this manifests as a
list of notification recipients that receive a notification, and one
needs to send yet another notice to all of them except the sender of
the original message, but doesn't happen to know which originated. This
situation crops up with the Gnutella protocol, where nodes replay
messages to every peer except the originating one, but the mesh of
connections can cause the message to be accidentally routed to the
originator anyway. Simpily tracking which messages you originated yours
and ignoring requests to forward them again pervents a condition where
a host transmits the same message out onto the net over and over. <br><br> In yet another case, the one illustrated above, we're flatly
denying recursion. If one node responds to events of type "A" with
events of type "B", and another node responds to events of type "B"
with events of type "A", and we did no reentry checking, Perl would
explode. It would use up all of the memory the OS would allow it, grind
away for a while, blow up like a big grinding balloon, and just pop.
Nobody wants that. Putting rules in place for which events may be
replied to with another event will prevent this situation as well. If
you do opt for policy, you may elect to put some limits in place for
testing purposes. These kind of arbitrary limits can never be set
correctly: what you consider an impossibly large value becomes
unworkably small in a few years. For debugging, detecting what looks
like a run away condition can be a life saver: <br><br>
 <pre>  sub notify_all {

    if($testing) {
      # never do this in production code!
      my $calldepth = 0;
      $callerdepth++ while(caller($calldepth));
      die "arbitrary limit exceeded: stack depth too deep, possible runaway recursion detected"
        if $callerdepth &gt; 100;
    }
    
    foreach my $listener (@listeners) {
      $listener-&gt;send_event(@_);
    }

  }</pre>
<br><br>
 <font size="+2"><b>Recursion and Locking on User Data</b></font><br><br>Recursing
through user data. Sends chills up your spine, doesn't it? User data is
notorious for kiniving, minipulation, and being just plain old abusive,
contreived rubbish. Why do users write HTML files that include a second
HTML file that includes the first? To piss you off, thats why. <br><br>
 <pre>  # expand includes in HTML templates
  # eg, &lt;!-- #include virtual="/includes/header_logo.html" --&gt;

  my $numfound;

  FOUNDSOME: 

  $numfound = 0;

  $tmpl =~ s{&lt;!--\s*#include\s*virtual\s*=\s*('")(.*?)\1\s*--&gt;}{
    die "invalid include path: '$2'" if $2 =~ m{\/\.\./\/};
    open my $f, "$inputdir/$2" or die "include not found: $inputdir/$2 $!";
    read $f, my $repl, -s $f;
    close $f;
    $numfound++;
    return $repl;
  }gie;

  goto FOUNDSOME if($numfound);</pre>
<br><br>

<br><br> This would run indefinately (if permitted by the universe) if
a user tried the A includes B, B includes A attack. Preventing reentry
into some method wouldn't work. If we created a method, we would need
to be able to reenter it to include more than one file deep. Of course,
we could make it non-recursive, but it wouldn't do <a href="http://www.perldesignpatterns.com/?TheRightThing">The Right Thing</a>. Things that seem like they should work, don't. 
<br><br>
 Limiting the stack depth is another option, but it is a violation of the <a href="#BusySpin"><b>Busy Spin</b></a>
antipattern: no correct value can possibly be chosen that is large
enough for extreme, but valid cases, but too small to shut out denial
of service attacks. Someone fetching a malicious construct over and
over will easily take the server out. <br><br>
 Refusing to include the same page twice would also fail to do <a href="http://www.perldesignpatterns.com/?TheRightThing">The Right Thing</a>,
and would throw cold water on most template arrangements that sites
actually, really use. It is, however, simple to implement. Limiting the
number of times that a single file may be included helps but the breaks
on things, but violates the above pragmas concerning <a href="#BusySpin"><b>Busy Spin</b></a> as well: 
<br><br>
 <pre>  my $numfound;
  my %done;  # added this

  FOUNDSOME: 

  $numfound = 0;

  $tmpl =~ s{&lt;!--\s*#include\s*virtual\s*=\s*('")(.*?)\1\s*--&gt;}{
    die "invalid include path: '$2'" if $2 =~ m{\/\.\./\/};
    die "file '$2' included entirely too many times" if $done{$2}++ &gt; 30;   # added this
    open my $f, "$inputdir/$2" or die "include not found: $inputdir/$2 $!";
    read $f, my $repl, -s $f;
    close $f;
    $numfound++;
    return $repl;
  }gie;

  goto FOUNDSOME if($numfound);</pre>
<br><br>
 Another solution is to maintain a stack, perhaps a <a href="http://www.perldesignpatterns.com/?SimpleStack">Simple Stack</a>, and continiously examine it for repeated sequences. Such attempts are prone to occurance of a <a href="#RaceCondition"><b>Race Condition</b></a>,
and there is usually an upper limit on how large of the stack segment
it will compare to the rest of the stack. For example, if the code only
checks for repeated patterns of two through 300 stack frame entries,
someone need only create a circulation inclusion attack that 301 pages.
D'oh! <br><br> Correctly solving this problem could be done by computing
routes between pages and make a map of which pages include which
others. See <a href="http://www.perldesignpatterns.com/?DepthFirstRecursion">Depth First Recursion</a>.
This is far too complex for most people to stomache. If you happen to
write a solution to this, please, by all means, post it here. It should
be a stright forward adaptation of <a href="http://www.perldesignpatterns.com/?DepthFirstRecursion">Depth First Recursion</a> to use the example above. Yes, I'm just too lazy to do it myself right now. 
<br><br>
 <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/118845">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/118845</a> is an example of recursion in perl that checks for recursive traps. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ConstraintSystem"><b>Constraint System</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?EventListeners">Event Listeners</a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlSecurity">Perl Security</a> </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/118845">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/118845</a> 
<br><br>
 <br><br> <a name="SelectPollPattern"></a><h2><a href="#SelectPollPattern"><b>Select Poll Pattern</b></a></h2><br> 
<br><br>

<br><br>
 Stand in for threads. Much more efficient in Unix. Named for the use of <i>select()</i>. 
<br><br> A single inner loop waits for either a timeout, signal, or a
filehandle to become available for read or write. Coordination of
reading and writing and responding to other events is handled in a
single, centralized, and often massive central loop. Contrast with
threads where each thread has its own loop and blocks waiting for
exactly one thing at any given time: an object lock, input, another
thread to wake it, and so on. <br><br>
 Many <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> systems are built on top of a <i>select()</i> and its style. AWT, the Java Abstract Windows Toolkit<a href="http://www.perldesignpatterns.com/?AbstractWindowsToolkit">+</a> builds an <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> facde on top  of the event oriented X11 platform on Unix-like hosts. 
<br><br>
 The <a href="#SelectPollPattern"><b>Select Poll Pattern</b></a>
is counter-intuitive for most people to use. It requires manual
management of the CPU, and each task has to completely return to the
inner loop and then be called fresh. [Continuations, promised in Perl 6
but lacking in 5, allow each line of execution to have their own stack
and not have to return all the way out in order to surrender the CPU -
CPU management is still manual, but much easier, and the manual control
comes with great power.] <br><br>
 <pre>    my $shbit = 1 &lt;&lt; fileno($sh);
    my $sibit = 1 &lt;&lt; fileno($si);

    my $inbitmask = $shbit | $sibit;

    # select(readtest, writetest, exceptiontest, max wait)
    select($inbitmask, undef, undef, 0);

    if($inbitmask &amp; $shbit) {
      # $sh is ready for read
    }

    if($inbitmask &amp; $sibit) {
      # $si is ready for read
    }</pre>
<br><br> Done in a loop, several sources of input - perhaps the
network, a GUI interface, pipes connected to other processes - could
all be managed. The last argument to <i>select()</i> is typically 0 or <i>undef</i>, though it is sometimes other numbers. If it is <i>undef</i>, <i>select()</i> will wait indefinately for input. If it is 0, <i>select()</i>
will return immediately, input ready or not. Any other number is a
number of seconds to wait, floating point numbers accepted. As soon as
a any monitored input or output handle becomes ready, <i>select()</i> will return.  <i>select()</i> doesn't return a value in the normal sense: it motifies the bit mask, turning off any bits that correspond to <i>fileno()</i>
bit positions that aren't ready. Each bit that we set must be tested to
see if it is still on. If it is, that filehandle is ready for read or
write. Filehandles that we want to monitor for read are passed as a
bitmask in the first argument position of <i>select()</i>. The second argument of <i>select()</i> is the filehandles to monitor for write, and the third, for exceptions. 
<br><br>
 <pre>    if($inbitmask &amp; $sibit) {
      $si-&gt;process_input();
    }</pre>
<br><br> Filehandles may be blessed into classes [a subclass of
IO::Handle would be an intelligence choice], and then methods called to
handle the event where input becomes available for read. This is easy
to implement, simple, and sane - to implement. Using it is another
story. <br><br>
 <pre>  package IO::Network::GnutellaConnection;

  use base 'IO::Handle';

  sub process_input() {
    my $self = shift;
    $self-&gt;read(...);
  }</pre>
<br><br> Each access must promptly return for other handles to be
served. This is a big requirement. Unheaded, a user interface could
repeatedly cause network traffic to time out, or one unresponsive
process reading on a pipe to lock up the process writing on the pipe -
see <a href="http://www.perldesignpatterns.com/?PerlGotchas">Perl Gotchas</a> for more. These cases are more numerous and insideous than thread CPU starvation issues.  
<br><br> To effectively cope with not having a return stack of its own,
each line of processing associated with an IO handle must take pains to
keep track of where it was in its code, what is doing, and what it
expects to do next. See <a href="#StatePattern"><b>State Pattern</b></a> for an implementation of this and more discussion. 
<br><br>
 <font size="+2"><b>Non-Blocking I/O</b></font><br><br>Sometimes <i>select()</i>
will tell you that an I/O channel is ready to read from, but attempting
to read still blocks. Non-blocking I/O can be used as a safety net. <br><br>
 When accepting connections on a TCP/IP socket, non-blocking I/O is a must: 
<br><br>
 <pre>  use Socket;
  use Fcntl qw(F_GETFL F_SETFL O_NONBLOCK);
  use POSIX qw(:errno_h :fcntl_h); 

  my $proto = getprotobyname('tcp');
  socket($server, PF_INET, SOCK_STREAM, $proto)                 or die "socket: $!";
  setsockopt($server, SOL_SOCKET, SO_REUSEADDR, pack("l", 1))   or die "setsockopt: $!";
  bind($server, sockaddr_in($port, INADDR_ANY))                 or die "bind: $!";
  listen($server, SOMAXCONN)                                    or die "listen: $!";

  # non blocking listens:

  fcntl($client, F_SETFL, fcntl($server, F_GETFL, 0) | O_NONBLOCK) or die "fcntl: $!"; 

  while(1) {

    my $paddr = accept($client, $server);
    (my $remoteaddress, my $remoteport) = sockaddr_in($paddr);
    my $remotehostname = gethostbyaddr($iaddr,AF_INET);

  }</pre>
<br><br>
 XXX - very dubious, could be written cleaner, probably doesn't work. 
<br><br>
 <i>accept()</i> will try to accept a new connection, but it won't wait to do so. It returns immediately, and when <i>$paddr/ is marked ready for read according to </i>select()<i>,
then we know a new connection has actually arrived. This integrates
listening for new connections into the select-poll service loop. </i>
<br><br>
 This code is based on code in <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlipc">PerlDoc:perlipc</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ThreadsPattern">Threads Pattern</a> </li><li> IO::Select </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=select">PerlDoc:select</a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlGotchas">Perl Gotchas</a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlipc">PerlDoc:perlipc</a> 
<br><br>

<br><br>
 <br><br> <a name="JournalingPattern"></a><h2><a href="#JournalingPattern"><b>Journaling Pattern</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Slow updates and corrupt files. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Don't change when you can append updated information, and never leave data in an indeterminate state. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br><pre>  package Xfor;
  
  sub new {

    my $pack = shift;
  
    my $filecache;       # holds all of the name-&gt;value pairs for each item in each file
    my $buffered;        # same format: data to write to file yet
  
    bless {

      # open a flatfile database. create it if needed.

      open =&gt; sub {
        my $fn = $_[0]; 
        unless(-f $fn) {
          open F, '&gt;&gt;'.$fn or return 0;
          close F;
        }
        $self-&gt;openorfail($fn);
      },
  
      # open a flatfile database. fail if we are unable to open an existing file.

      openorfail =&gt; sub {
        my $file = shift;       # which file the data is in
        open my $f, $file or die $!;
        my $k; my $v;
        while(&lt;$f&gt;) {
            chomp;
            %thingy = split /\||\=/, 'key='.$_;
            while(($k, $v) = each %thingy) {
              $filecache-&gt;{$file}-&gt;{$thingy{'key'}}-&gt;{$k} = $v;
            }
        }
        close $f;
        return 1;
      },
  
      # fetch a value for a given key
  
      get =&gt; sub {
        my $file = shift;   #    which file the data is in
        my $thingy = shift; #    which record in the file - row's primary key
        my $xyzzy = shift;  #    which column in that record
        $logic-&gt;openflatfile($file) unless(exists $filecache-&gt;{$file});
        return $filecache-&gt;{$file}-&gt;{$thingy}-&gt;{$xyzzy};
      },
  
      keys =&gt; sub {
        my $rec = $filecache;
        while(@_) {
          $rec = $rec-&gt;{$_[0]}; shift;
        }
        if(wantarray) {
          keys %{$rec};
        } else {
          $rec;
        }
      },
  
      set =&gt; sub {
        my $file = shift;   #    which file the data is in
        my $thingy = shift; #    which record in the file - row's primary key
        my $x = shift;      #    which column in that record
        my $val = shift;    #    new value to store there
        $filecache-&gt;{$file}-&gt;{$thingy}-&gt;{$x} = $val;
        $buffered-&gt;{$file}-&gt;{$thingy}-&gt;{$x} = $val;
        1;
      },
  
      close =&gt; sub {
        my $file = shift;       # which file the data is in
        my $thingy;             # which record in the file - row's primary key
        my $x;                  # which column in that record
        my $val;                # new value to store there
        my $line;               # one line of output to the file
        open my $f, '&gt;&gt;'.$file or die "$! file: $file";
        foreach $thingy (keys %{$buffered-&gt;{$file}}) {
          $line = $thingy;
          foreach $x (keys %{$buffered-&gt;{$file}-&gt;{$thingy}}) {
            $line .= '|' . $x . '=' . $buffered-&gt;{$file}-&gt;{$thingy}-&gt;{$x};
          }
          print F $line, "\n";
        }
        $buffered-&gt;{$file} = ();
        close $f;
      },
   
      recreate =&gt; sub {
        my $file = shift;       # which file the data is in
        my $thingy;             # which record in the file - row's primary key
        my $x;                  # which column in that record
        my $val;                # new value to store there
        my $line;               # one line of output to the file
        open my $f, "&gt;$file.$$" or die "$! file: $file.$$";
          foreach $thingy (keys %{$filecache-&gt;{$file}}) {
          $line = $thingy;
          foreach $x (keys %{$filecache-&gt;{$file}-&gt;{$thingy}}) {
            $line .= '|' . $x . '=' . $filecache-&gt;{$file}-&gt;{$thingy}-&gt;{$x};
          }
          print $f $line, "\n";
        }
        close F;
        rename "$file.$$", $file or die "$! on rename $file.$$ to $file";
      },

    } , $pack;

  }
  
  </pre>To use, do something like:  
<br><br>
 <pre>  use Xfor;
  my $hash = new Xfor;
  $hash-&gt;open('carparts.nvp');

  # read:

  $hash-&gt;get('carparts.nvp', 'xj-11', 'muffler');   # which muffler does the xj-11 use?

  # write:

  $hash-&gt;set('cartparts.nvp', 'xj-11', 'muffler', 'c3p0');

  # then later:

  $hash-&gt;close('carparts.nvp');

  # or... 

  $hash-&gt;recreate('carparts.nvp');</pre>
<br><br>

<br><br> Xfor.pm reads files from beginning to end, and goes with the
last value discovered. This lets us write by kind-of journeling: we can
just tack updated information on to the end. we can also regenerate the
file with only the latest data, upon request. Since we read in all
data, we're none too speedy. Reading is as slow as Storable or the
like, but writing is much faster. <br><br>
 Data is written to the end of the file when the <i>-&gt;close()</i>
method is called. There are no fixed record lengths. We never go into
the middle of a file and try to insert data. We don't move and
regenerate the file unless explicitly asked to, and we only do that to
keep it from getting too large. <br><br> A tied-hash interface could be provided for persistant
journaled storage without the clumbsy method interface. If a single
value is needed, the entire file need not be read into memory - this
case could be optimized. We use the vertical bar as a field deliminator
- this is bound to cause problems unless either we escape them in
strings, in which case the escape character must also be escaped when
it occurs normally. Taking a Binary Clean<a href="http://www.perldesignpatterns.com/?BinaryClean">+</a> approach is usually better than trying to escape things: include an explicit length and then use <i>read()</i> to read exactly that much data.  
<br><br>
 <a href="#ExportingPattern"><b>Exporting Pattern</b></a>
talks about creating a single default instance that can be used without
explicitly naming an object, only using the correct methods. <br><br> This example should also take a few arguments to the
constructor and pass them to each method so that a default file or
default file and default record can be specified. It isn't useful as a
module as it stands, but illustrates the trade off between read time
and write time that simple journaling approaches offer. <br><br>
 [XXX is there actually a CPAN module that does a clean, fast job of all of this that I can refer people to?] 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perltie">PerlDoc:perltie</a> </li><li> <a href="http://www.perldesignpatterns.com/?FakingAccessorsUsingTiedData">Faking Accessors Using Tied Data</a> </li><li> <a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?StorablePattern">Storable Pattern</a> 
<br><br>
 <br><br> <a name="ApplicationGenerator"></a><h2><a href="#ApplicationGenerator"><b>Application Generator</b></a></h2><br> 
<br><br>

<br><br>
 <i>I'd rather write programs that write programs than write programs</i> - <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=BradAppleton">WikiWiki:BradAppleton</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?OnceAndOnlyOnce">Once And Only Once</a>
says we should do something in only one place. In accordance with
keeping our secret bits hidden away and not duplicated all over the
place like a scandle on the tabloid front page. A Perl module would be
expected to export these values and routines when <i>use</i>d. A Java
package would be expected to give an object reference that can be
prodded with method calls and examination of package global and object
instance fields. A Bourne shell script would spit out another shell
script which it would then execute. Thats what I want to talk about. <br><br> A lot of language rheteric tells us not to worry about the
size of our applications. We should load all of the modules we need
rather than ever thinking of copying and modifying a program or module.
Like anything that says "always" or "never", this is dangerous. Rather
than writing a clean implementation that loads a bazzilion modules,
we'll sheepishly dumb down the specs, and set our expectations of the
application low. We'll hardcode things for fear of creating modules. In
short, we'll deal with module explosion problem by developing a
neurotic adversion to creating more of the bastards. Each new candidate
for modulehood seems to pale in comparison to the last 3 or 4 hundred
modules that were endorced. <br><br> The heart of the problem is with diverging applications, the
kind we make when we copy one program to reuse it for another client,
for instance. Conventional wisdom says to copy the entire thing and add
on to it, in essence, without removing anything. There are two cross
sections we're trying to cut the same application into at once: the
cross section of the functionality we need for this client, and the
cross section of how functionality within the application. <br><br> Organizing the entire application by which logic may or may
not be needed for future projects assumes knowledge we don't have, and
it completely neglects organizing the objects by their relationship
with each other - our primary reason for using objects. <br><br> Organizing the entire application by its fuctional structure
includes an undue amount of dependence between building blocks in an
environment where the very purpose of the application can go two or
more ways at once, as different clients have an application customized.
In face, it is very rare it is even attempted that diverging versions
will track each other. <a href="http://www.perldesignpatterns.com/?NetBSD">Net BSD</a>, <a href="http://www.perldesignpatterns.com/?OpenBSD">Open BSD</a> and <a href="http://www.perldesignpatterns.com/?FreeBSD">Free BSD</a>
selectively adapting code from each others projects is a good example.
Even so, each BSD has gone in a different direction, introducing a very
real element of manual labor in adapting code, dispite the histric
common origins. <br><br> C automatically generates assembly for you; GUI builders
automate writing C code for creating graphical interfaces [The Glade
project comes to mind]; report generators automate creation of user
interfaces. One thing builds on the next. <br><br> Another exmaple is GNU autoconf. If you've ever installed
Unix software from source code (Perl, perhaps?), you've probably
downloaded a tarball, typed <i>tar -xzvf foo.tar.gz</i>, <i>chdir</i>ed into the directory, typed <i>./configure</i>, then <i>make</i>. <i>configure</i>
is a shell script, generated by GNU autoconf. Every time anyone needs
to test for a new feature which may or may not be present in POSIX like
operating environments as part of the build process the test for that
feature is added to GNU autoconf. Okey, not every time, but this is the
secret to GNU autoconf's success. Every application running the same
configure script, which tested for <b>everything</b> would be
unworkable. It would take hours to run on a fast computer, and do all
sorts of work not needed. Configuring certain tests off would help, but
you're still forcing poor bash [bash is the Bourne Again Shell, also
available from the GNU Project. See <a href="http://www.gnu.org]/">http://www.gnu.org]</a>
to read a several thousand line (several hundred thousand line long?)
script when only a few may be needed. With open source software,
programmers may be tolerant of lots of unrelated code or hooks kicking
around. In the real world, clients don't want to know about each other.
They're just happier that way [Kind of like ex girlfriends. Clients can
be very catty. They want someone experienced who knows the industry,
but they'll question your motives, and make you sign all sorts of
things certifying that you have no intellectual property. I once got a
job because I released my shopping cart code under the GNU GPL license
and it was obvious I knew my way around credit card processing
gateways. I was then denied the job because I had intellectual property
that represented a conflict of interest with the company - since I had
released my code to the public and could not retract it if I wanted to,
I couldn't work there. Some people.]. <br><br>
 Writing an application to write applications lets you put everything where it belongs, score high on <a href="http://www.perldesignpatterns.com/?OnceAndOnlyOnce">Once And Only Once</a>
tests, structure your code according a natural, logical criteria, and
not bog clients down with a beast that is the sum of the size of all of
its copies. This idea is nothing new. The concept of returning code is
cornerstone of the Lambda programming style, and is also known as <a href="http://www.perldesignpatterns.com/?FirstClassData">First Class Data</a>. We could, and otherwise should, use <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a>,
but we're trying to exclude the code from ever going out the door. The
idea is similar to generating a string of code and using <i>eval</i> on it, but once again, we're trying to keep the code from ever disgracing their harddrive. 
<br><br>
 Using <a href="http://www.perldesignpatterns.com/?AutoSplit">Auto Split</a> and Auto Loader<a href="http://www.perldesignpatterns.com/?AutoLoader">+</a> breaks your module up into individual functions (methods) that are loaded on demand from strings stored past the <i><u>END</u></i> of your program. 
<br><br>
 XXX quick hack to look at an <a href="http://www.perldesignpatterns.com/?AutoSplit">Auto Split</a> module and spit out select sections either as Auto Loader<a href="http://www.perldesignpatterns.com/?AutoLoader">+</a> ready or as regular Perl code. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> - round this out, proof it, give it a few examples. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CvsIntro">Cvs Intro</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=AutoSplit">PerlDoc:AutoSplit</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=AutoLoad">PerlDoc:AutoLoad</a> 
<br><br>

<br><br>
 <br><br> <a name="MinimizeBlockNesting"></a><h2><a href="#MinimizeBlockNesting"><b>Minimize Block Nesting</b></a></h2><br> 
<br><br>

<br><br>
 Write: 
<br><br>
 <pre>  if(! $value) {
    die "no value"; # failure
  } 

  $sth-&gt;execute( $value );</pre>
<br><br>
 Instead of: 
<br><br>
 <pre>  if( $value ) {
    $sth-&gt;execute( $value );
  } else {
    die "no value"; # failure
  }</pre>
<br><br> The first is less cluttery for the lack of dangling clauses.
The first also has a more logical order: error conditions are handled
immediately, rather than some time after the success condition. This is
important as the success condition block grows longer and longer.
Humans will forget what the test was by the time they get to the error
handling logic. This pattern reduces how much code is indented, as
well. In general, structure if/else blocks so that simple cases and
exceptional cases are taken care of first, and the normal flow of code
execution isn't nested in side of tests which should always be true if
errors and anomolies can be delt with before hand. <br><br>

<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> 
<br><br>

<br><br>
 <br><br> <a name="WebAuthentication"></a><h2><a href="#WebAuthentication"><b>Web Authentication</b></a></h2><br> 
<br><br>

<br><br>
 </li><li> New-User Registration 
<br><br>
 Do you want to send them an email with a generated password in it to validate their email address? 
<br><br>
 </li><li> User Validation 
<br><br>
 <ul><li> .htaccess
</li></ul> Suited for a small number of users, each of which has the
same permissions. User creation and maintenance involves modifying the
file directly. <br><br>
 <ul><li> Cookies
</li></ul> There are lots of formulas, but the winning one is: issue a
cookie with an authorization token. Store the token in the database
along with an expiration time seperate of the cookie. The token should
be random generated and completely seperate from the password but
handed out when the password is validated. This is the best case; if
your porn addicted friend comes over and uses your computer, and steals
your cookies.txt file when you aren't looking, cookies generated this
way can't be used to discover the username or password used. The
password change form could be used as a loophole though: if the token
is still valid and the password change script doesn't explicitly double
check the old password before letting you change it, a new password
could be put in place for the account without your friend knowing the
old one. It is best to always check that the user knows the old
password before allowing them to change it to avoid this problem. <br><br> Our example here doesn't do any of this. It merely hands out
cookies that contain the literal username and password. Our passwords
aren't stored encrypted in the database. See <a href="http://www.perldesignpatterns.com/?OneWayHash">One Way Hash</a> for an example of that. The examples are at the bottom of this section. 
<br><br>
 <ul><li> Munged links.
</li></ul> Sometimes users don't have cookies turned on. In this case,
you've got two options: tracking them by IP and including the session
ID in all forms and links. Tracking users by IP is error prone, since
entire companies traffic is often filtered through a firewall that uses
network address translation to present all of the internal computers
traffic as coming from one IP address. Inexpensive home "modem sharing"
devices do exactly the same thing. Munging links requires that the
session ID be constantly passed back to the scripts at every link or
form: <br><br>
 <pre>  # go out of our way to include sid=$sid:

  print qq{&lt;a href="otherprog.cgi?foo=bar&amp;color=red&amp;sid=$sid"&gt;Go To Otherprog&lt;/a&gt;};

  print qq{
    &lt;form action="anotherprog.cgi" method="post"&gt; 
      &lt;input type="hidden" name="sid" value="$sid"&gt;
      Enter answer: &lt;input type="text" name="answer"&gt;&lt;br&gt;
      &lt;input type="submit"&gt;
    &lt;/form&gt;
  };
  </pre>Forgetting
to do this in even one link or form causes the site to forget any and
all information about a user as soon as they click it. Additionally,
since the sessionid is part of the HTML, it lives on in the browser
cache. For this reason, session id tokens should be expired after a
period of time by the server. This means having the server simply
record the date that it issued a session id number and refusing to
honor it after a period of time has elapsed, forcing the user to
re-login. <br><br> One dirty little trick that a programmer friend of mine
(okey, it was me) used once (okey, several times) on mod_perl sites was
having the handler parse .html files with embedded perl, and munge all
of the links - from both the .html and the perl output: <br><br>
 <pre>  $oOo =~ s/&lt;(a|frame)([^&gt;]*) (src|href)=(['"]?)(?!javascript)([^'"]+\.htm)(l)?(\?)?([^'"&gt;]*)?\4(?=\w|&gt;&gt;)/&lt;$1$2 $3="$5$6\?$8\&amp;sid=$sid"/ig;
    
  # $1: 'a' or 'frame'
  # $2: any random name=value pairs (exa 'name="mainFrame"')
  # $3: 'src' or 'href'
  # $4: any begin qouting character, be it ' or "
  # $5: whatever.htm
  # $6: optional 'l'
  # $7: optional '?' (discarded)
  # $8: optional cgi get string
  # $9: 0-width lookahead assertion: &gt; or space isn't matched but is looked for
    </pre></li><li> Other Stuff 
<br><br> You prolly want to plan from the beginning to have a bunch of
small .cgi scripts instead of one huge monolithic one... so you'll want
to make a sort of "validateuser.pm" file and "use validateuser.pm;" at
the top of each .cgi. <br><br>
 <hr><br><pre>  # Sample validateuser.pm:
  
  use CGI;
  use CGI::Carp qw/fatalsToBrowser/;
  use DBI;
  
  use lib "/home/scott/cgi-bin/DBD";
  
  BEGIN {
  
    $dbh = DBI-&gt;connect("<a href="http://perldesignpatterns.com/intermap.cgi?wiki=DBI&amp;word=Pg:dbname=sexcantwait;host=localhost;port=5432" ,="">DBI:Pg:dbname=sexcantwait;host=localhost;port=5432",</a> 'scott', 'pass')
      or die $DBI::errstr;
  }
  
  use <a href="http://www.perldesignpatterns.com/?TransientBaby">Transient Baby</a>::Postgres;
  use <a href="http://www.perldesignpatterns.com/?TransientBaby">Transient Baby</a>;
  
  createquery('validateuser', qq{
    select   <a href="http://www.perldesignpatterns.com/?UserID">User ID</a> as userid
    from     Users
    where    Name = [:username:]
    and      Pass = [:userpass:]
  });
  
  sub validated {
    $userid = -1;
    my $sid=CGI::cookie(-name=&gt;"sid");
    return 0 unless $sid;
    ($username, $userpass) = split /,/, $sid;
    validateuser();
    return $userid == -1 ? 0 : 1;
  }
  
  sub is_guest {
    return $username =~ /^guest/;
  }

  sub offer_login {
    print qq{
      Sorry, you aren't logged in. Please enter your name and password:&lt;br&gt;&lt;br&gt;
      &lt;form action="login.cgi" method="post"&gt;
        &lt;input type="hidden" name="action" value="login"&gt;
        User name: &lt;input type="text" name="username"&gt;&lt;br&gt;
        <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Password&amp;word=%20%3Cinput">Password: <input></a> type="password" name="password"&gt;&lt;br&gt;
        Are you a new user? &lt;input type="checkbox" name="newuser"&gt;&lt;br&gt;
        &lt;input type="submit" value="Log in"&gt;&lt;br&gt;
      &lt;/form&gt;
    };
    exit 0;
  }
  
  1;
  </pre>Instead
of declaring a package and using Exporter, we're merely continuing to
operate in the namespace of the module that invoked us. The methods we
define - validated(), validateuser(), offer_login() and is_guest() show
up in their package, ready for use. As a side effect, we're using
CGI.pm and DBI.pm on behalf of our caller, letting us list all of the
modules we want in only one place, rather than in every .cgi script.
This module could be used with: <br><br>
 <pre>  print qq{Content-type: text/html\n\n}; 
  use validateuser;
  validated() or offer_login();

  # rest of the script here, for users only</pre>
<br><br>
 offer_login() never returns once we call it. It handles exiting the script for us. 
<br><br>
 <hr><br><pre>  #!/usr/bin/perl

  # example login/create user script that uses validateuser.pm.
  # this should be named login.cgi to match the form in validateuser.pm, unless of course
  # that form's action is changed.
  
  use validateuser;
  
  createquery('userexists', qq{
    select count(*) as num
    from   Users
    where  Users.Name = [:name:]
  });
  
  createquery('createuser', qq{
    insert into Users
    (Name, Pass, <a href="http://www.perldesignpatterns.com/?CreationIP">Creation IP</a>)
    values
    ([:name:], [:pass:], [:creationip:])
  });
  
  my $action = CGI::param('action');
  my $newuser = CGI::param('newuser');
  
  if(!$action) {

    offer_login();

  } elsif($action eq 'login' and !$newuser) {
  
    $username = CGI::param("username");
    $userpass = CGI::param("userpass");
  
    validateuser();
  
    if($userid != -1) {
  
      my $cookie=CGI::cookie(
        -name=&gt;'sid', -expires=&gt;'+18h', -value=&gt;qq{$username,$userpass},
        -path=&gt;'/', -domain=&gt;'.sexcantwait.com'
      );
      print CGI::header(-type=&gt;'text/html', -cookie=&gt;$cookie);
  
      print qq{Login successful.\n};

    } else {
      
      sleep 1; # frustrate brute-force password guessing attacks
      
      print qq{Content-type: text/html\n\n};
      
      print qq{Login failed! Please try again.&lt;br&gt;\n};

      offer_login();
      
    } 
    
  } elsif($newuser and $action eq 'login') {
    
    local $name = CGI::param("username");
    local $pass = CGI::param("userpass");
    
    userexists(); if($num) {
      print qq{User already exists. Please try again.&lt;br&gt;\n};
      offer_login();
    }
  
    local $creationip = $ENV{REMOTE_ADDR};
  
    createuser();
    validateuser(); # sets $userid
  
    print qq{Creation successful! Click on "account" above to review your account.&lt;br&gt;\n};
  
  }
  </pre>These examples make heavy use of my <a href="http://www.perldesignpatterns.com/?TransientBaby">Transient Baby</a>.pm
module. That module creates recursive routines that communicate using
global variables - ick. I need to change that, and then this example.
Then I'll put that code up. XXX. Guess I'm leaning towards
Acme::Template. <br><br>
 Back to <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a>. 
<br><br>
 $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Id&amp;word=%20WebAuthentication,v">Id: WebAuthentication,v</a> 1.11 2003/07/28 22:46:05 phaedrus Exp $ Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment --> </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA">http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/SOA</a> 
<br><br>
 <br><br> <a name="FileUpload"></a><h2><a href="#FileUpload"><b>File Upload</b></a></h2><br> 
<br><br>

<br><br>
 Common application feature, for CGI applications. 
<br><br> Users select files, using a form element in their web browser,
and when they submit, that file is uploaded to the server with the rest
of the form data. <br><br>
 <hr><br><pre>  &lt;gogamoga&gt; well, i`ll ask: how do i fetch attached file from the query?
  &lt;scrottie&gt; ask to ask?
  &lt;Perl-fu&gt; Don't ask to ask. Don't ask if anybody can help you with x. 
            Just ask!  Omit any irrelevant details. If nobody answers then we 
            don't know or are busy for a few minutes. Wait and don't bug us. 
            If you must ask again wait until new people have joined the channel.
  &lt;scrottie&gt; my $fh = CGI::upload($fn); my $buffer; while (read($fh,$buffer,length($buffer)) { }; 
  &lt;scrottie&gt; where $fn is the name of the CGI param. make sure the from has the right enctype. 
  &lt;scrottie&gt; i don't remember the enctype, but "perldoc CGI" will tell you
  &lt;scrottie&gt; unless the form uses that special enctype, file uploads won't be uploaded, rather mysteriously
  &lt;gogamoga&gt; THANK YOU SOOOOOOOOO MUCH
  &lt;gogamoga&gt; i got lost in cgi.pm reference :(
  &lt;scrottie&gt; heh, you're welcome. let me know if you get stuck.
  &lt;scrottie&gt; yeah, someone really needs to slim that down.
  &lt;gogamoga&gt; i use only jpg enctype so i wont even check it
  &lt;gogamoga&gt; just fetch the file and save it
  &lt;scrottie&gt; you don't understand.
  &lt;scrottie&gt; hang on. let me find it.
  &lt;gogamoga&gt; ok
  &lt;scrottie&gt; if your form doesn't say 
             &lt;form method="post" enctype="multipart/form-data"&gt;, then 
             &lt;input type="file"&gt; tags wont work. they won't upload the file.
  &lt;scrottie&gt; reguardless of the type of the file, the file won't be uploaded.
  &lt;scrottie&gt; Netscape 2 introduced the ability to upload files, and in order to 
             support this feature, they had to introduce a
             new format for sending data to the server - the old 
             application/x-www-form-urlencoded one couldn't handle large
             blocks of arbitrary data
  &lt;gogamoga&gt; ah
  &lt;gogamoga&gt; damn, it wont upload it but it still takes ages as it uploads it :)
  &lt;gogamoga&gt; ah, sorry i am dumb
  &lt;scrottie&gt; no, we all have to work through the standard mistakes ;)
  &lt;gogamoga&gt; dreamweaver adds multipart/form-data by default
  &lt;gogamoga&gt; :)
  &lt;scrottie&gt; good. no one uses Netscape 1 anymore ;)</pre>
<br><br>
 <hr><br><a href="http://www.perldesignpatterns.com/?NetPBM">Net PBM</a>
has an example of serving binary objects as images from a CGI script.
This can easily be coupled with database BLOBs to store images in the
database, and serve them as normal images from a CGI script. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> 
<br><br>
 <br><br> <a name="WebScraping"></a><h2><a href="#WebScraping"><b>Web Scraping</b></a></h2><br> 
<br><br>

<br><br> "WebScraping" is extracting information from the Web. Picking
out information from web pages and using it in an appliction is said to
be scraping the data. Usually refers to harvesting live data feeds or
minipulating specific applications via the Web. Also known as <a href="http://www.perldesignpatterns.com/?WebMining">Web Mining</a> or <a href="http://www.perldesignpatterns.com/?WebHarvesting">Web Harvesting</a>, especially when one type of information is sought across the entire web.  
<br><br>
 Use LWP to fetch web pages using URLs. See example HTML parser in <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a>. 
<br><br>
 <pre>  use <a href="http://www.perldesignpatterns.com/?TransientBaby">Transient Baby</a>::Forms;
  use <a href="http://www.perldesignpatterns.com/?TransientBaby">Transient Baby</a>;

  my $accessor;
  my %opts;

  my @table;
  my $tablerow;
  my $tablecol = -1;

  parse_html($document, sub {

    $accessor = shift;
    %opts = @_;

    if($opts{tag} eq 'tr') {

      # create a new, blank array entry on the end of @table
      $tablerow++; $table[$tablerow] = [];
      $tablecol = 0;

    } elsif($opts{tag} eq 'td') {

      # store the text following the &lt;td&gt; tag in $table[][]
      $table[$tablerow][$tablecol] = $accessor-&gt;('trailing');
      $tablecol++;

    }

  });</pre>
<br><br>
 I've gone out of my way to avoid the nasty push @{$table[-1]} construct as I don't feel like looking at it right now. <i>$tablerow</i> and <i>$tablecol</i> could be avoided otherwise. This code watches for HTML table tags and uses those to build a 2 dimentional array. 
<br><br> Data taken from a database and presented in HTML tables was
normalized in the database, but is denormalized for display. When it is
denormalized, data from several relational tables is presented as one
table. In this case, there may be different views of the data, each
driven by a differenet query or different query parameters. See <a href="#ObjectsAndRelationalDatabaseSystems"><b>Objects And Relational Database Systems</b></a> for more on normalization. 
<br><br>
 If we're putting the harvested data back into a database to report on, it suits us to reconstruct some structure to it.  
<br><br>
 <pre>  select table1.a, table2.b, table3.c
  from table1, table2, table3
  where table1.id = table2.id
  and   table2.param = table3.id
  order by table1.a, table2.b, table3.c</pre>
<br><br>
 We can't recover the <i>id</i> or <i>param</i> fields from the output of this query, but we can generate our own.  
<br><br> Joining between three tables flattens the extracted data down
to one. This sort of joining has a tell-tale pattern in its output, in
that the columns appear to count. The first <i>n</i> columns are from <i>tablea</i>, second so many from <i>tableb</i>, and so on.  
<br><br>
 <pre>  aaa
  aab
  aac
  aad
  aba
  aca
  ada
  baa
  bab
  (And so on...)</pre>
<br><br> Add this clause to the if statement in the sub passed to
parse_html() above, remembering to declare the introduced variables in
the correct scope: <br><br>
 <pre>    } elsif($opts{tag} eq '/tr') {

      if(!$tablerow or $table[$tablerow][0] ne $table[$tablerow-1][0]) {
        $dbh-&gt;execute("insert into tablea (a) values (?)", $table[$tablerow][0]);
        $table_a_id = $dbh-&gt;insert_id();
        # else $table_a_id will retain its value from the last pass
      }

      if(!$tablerow or $table[$tablerow][1] ne $table[$tablerow-1][1]) {
        $dbh-&gt;execute("insert into tableb (b, id) values (?, ?)", $table[$tablerow][1], $table_a_id);
        $table_b_id = $dbh-&gt;insert_id();
        # else $table_b_id will retain its value from the last pass
      }

      if(!$tablerow or $table[$tablerow][2] ne $table[$tablerow-1][2]) {
        $dbh-&gt;execute("insert into tablec (c) values (?, ?)", $table[$tablerow][1], $table_b_id);
        $table_c_id = $dbh-&gt;insert_id();
        # else $table_c_id will retain its value from the last pass
      }

    }
      </pre>This code depends on <i>$dbh</i> being a properly initialized database connection. I'm using <i>-&gt;insert_id()</i>, a <a href="http://www.perldesignpatterns.com/?MySQL">My SQL</a>
extention, for clarity. Unlike the previous code, this code is
data-source specific. Only a human looking at the data can deturmine
how best to break the single table up into normalized, relational
tables. We're assuming three tables, each having one column, aside from
the <i>id</i> field. Assuming this counting pattern, we insert records into <i>tablec</i> most often, linking them to the most recently inserted <i>tableb</i> record. <i>tableb</i> is inserted into less frequently, and when it is, the record refers to the most recently inserted record in <i>tablea</i>. When a record is inserted into <i>tablea</i>, it isn't linked to any other records.  
<br><br>

<br><br>
 XXX Todo: 
<br><br>
 </li><li> Simple examle of extracting an array-of-arrays from an HTML table - done </li><li> <a href="http://www.perldesignpatterns.com/?GeekPac">Geek Pac</a> example, new <a href="http://www.perldesignpatterns.com/?TransientBaby">Transient Baby</a> interface </li><li> Talk about normalizing data - done </li><li> Sample HTTP code </li><li> Pointed to LWP </li><li> Link to LWP examples 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> HTML::Toke Parser<a href="http://www.perldesignpatterns.com/?TokeParser">+</a> </li><li> <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a> </li><li> <a href="#ObjectsAndRelationalDatabaseSystems"><b>Objects And Relational Database Systems</b></a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> 
<br><br>
 <br><br> <a name="ReadingAFile"></a><h2><a href="#ReadingAFile"><b>Reading AFile</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Perl gives so many ways to read a file, so many of them bad. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Know the bad ones. 
<br><br>
 <font size="+2"><b>//An Old Idiom in Poor Style//</b></font><br><br><pre>  {
    local $/ = undef;
    open FH, "&lt;$file";
    $data = &lt;FH&gt;;
    close FH;
  }</pre>
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Pros&amp;word=%20Everyone">Pros: Everyone</a> seems to know this one. Reads in entire file in one gulp without an array intermediary.  
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Cons&amp;word=%20//$data//">Cons: //$data//</a> cannot be declared with <i>my</i> because we have to create a block to localize the record seperator in. Ugly. 
<br><br>
 <font size="+2"><b>//A Short and Sweet Idiom//</b></font><br><br><pre>  @ARGV = ($file);
  my $data = join '', &lt;&gt;;</pre>
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Pros&amp;word=%20Short.">Pros: Short.</a> Sweet.  
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Cons&amp;word=%20Clobbers">Cons: Clobbers</a> <i>@ARGV</i>, poor error handling, inefficient for large files. 
<br><br>
 <font size="+2"><b>//Shell-Holdout Idiom//</b></font><br><br><pre>  my $data = `cat $file`;</pre>
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Pros&amp;word=%20Very">Pros: Very</a> short. Makes sense to <i>sh</i> programmers.  
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Cons&amp;word=%20Security">Cons: Security</a>
problem - shell commands may be buried in filenames. Creates an
additional process - poor performance for files small and large. No
error handling. Is not portable. <br><br>
 <font size="+2"><b>//Read/Sysread Idiom//</b></font><br><br><pre>  open my $fh, '&lt;', $file or die $!;
  read $fh, my $data, -s $fh or die $!;
  close $fh;</pre>
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Pros&amp;word=%20Good">Pros: Good</a> error handling. Reasonably short. Efficient. Doesn't misuse Perl-isms to save space. Uses lexical scoping for everything.  
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Cons&amp;word=%20Could">Cons: Could</a> be less idiomatic.  
<br><br>
 <font size="+2"><b>//FileHandle Idiom with Do-Block//</b></font><br><br><pre>  my $data = do {
    local $/; 
    FileHandle-&gt;new( $file, "r" )-&gt;getline
  };</pre>
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Pros&amp;word=%20Looks">Pros: Looks</a> like what it does. Use of <i>do</i> allows <i>$data</i> to be declared with <i>my</i> and be assigned value from scoped block.  
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Cons&amp;word=%20You">Cons: You</a> must <i>require File Handle<a href="http://www.perldesignpatterns.com/?FileHandle">+</a>;</i>
somewhere in your code. Uses global config variables, which are
considered obsolete in favor of per-filehandle configuration. <br><br>
 <font size="+2"><b>//Mmap Idiom//</b></font><br><br><pre>  use Sys::Mmap;
  new Mmap my $data, -s $file, $file or die $!;</pre>
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Pros&amp;word=%20Very">Pros: Very</a>
fast random access for large files as sectors of the file aren't read
into memory until actually referenced. Changes to the variable
propogate back to the file making read/write, well, cool. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Cons&amp;word=%20Requires">Cons: Requires</a> use of an external module such as Sys::Mmap, file cannot easily be grown. Difficult for non-Unix-C programmers to understand. 
<br><br>
 <font size="+2"><b>//FileHandle Object Idiom//</b></font><br><br><pre>  my $data = join '', FileHandle-&gt;new( $file, "r" )-&gt;getlines;</pre>
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Pros&amp;word=%20Straightforward">Pros: Straightforward</a>
object-oriented interface supported in Perl core. Looks like what it
does. One line. This is the authors recommended idiom for most
purposes. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Cons&amp;word=%20You">Cons: You</a> must <i>require File Handle<a href="http://www.perldesignpatterns.com/?FileHandle">+</a>;</i> somewhere in your code. Pointless splitting and joining of lines.  
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>Yay! Everyone vote for your favorite or least favorite idiom. I 
 did work on Sys::Mmap, so I'm biased ;) - <a href="#ScottWalters"><b>Scott Walters</b></a> - <i>Thu Aug 21 23:53:08 2003 216.190.249.170</i> 
<br><br>
 <!-- cut - end comments --> 
<br><br>
 <br><br> <a name="ConfigFile"></a><h2><a href="#ConfigFile"><b>Config File</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Reading configuration data from a file that users can edit and have written back to disc. Using <i>require</i>
to read config files is handy, but many people feel they've outgrown
using it, so they write elaborate modules to handle configuration. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>You must
require a file with a valid Perl syntax if you just do require. You
must provide the full path to it, quote its name, and if you're
defining global variables in it, you mustn't change the package name in
the required file. <br><br>
 Hot-rod <i>require</i> with advanced features to the degree it makes sense before resorting to complex or do-it-yourself replacements. 
<br><br>
 <pre>  require 'config.pl';</pre>
<br><br> We've all seen it a million times. It's as old as Perl itself.
You make a little Perl program that does nothing but assign values to
variables. Users can "easily" edit the file to change the values
without having to wade through your source code. It is extremely easy
to read configuration files of this format, and you can store complex
datastructures in there, along with comments. <br><br> Configuration is one of those sore spots that the limits of
are continuously pushed by users. Most Perl programmers give up their
old config.pl when requirements specify a spiffy Web or Tk interface
for users to change settings. No more! <br><br>
 <pre>  # config.pl:

  $config = {
    widgets=&gt;'max',
    gronkulator=&gt;'on',
    magic=&gt;'more'
  };

  # configTest.pl:

  use Data::Dumper;
  require 'config.pl';

  $config-&gt;{gronkulator} = 'no, thanks';

  open my $conf, '&gt;config.pl' or die $!;
  print $conf Data::Dumper-&gt;Dump($config);
  close $conf;</pre>
<br><br>
 Data::Dumper.pm comes with Perl, and can even store entire objects. In fact, it can store networks of object. 
<br><br> Security may be a concern. If you don't want Perl in
configuration files to gain the priviledge of your program, use the
Safe module or <a href="http://www.perldesignpatterns.com/?UseOps">Use Ops</a>. If the program is running as a <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a> as the superuser, <a href="http://www.perldesignpatterns.com/?UseOps">Use Ops</a> or the Safe module. If the program is setuid and the people running it don't have access to edit it, use the Safe module or <a href="http://www.perldesignpatterns.com/?UseOps">Use Ops</a>.  
<br><br>
 <font size="+2"><b>Finding the Config or Data Directory</b></font><br><br>Something
that is reasonably portable between Unix and Win is to look for an
environment variable telling you where to go for the data. <i>msconfig.exe</i>
lets you set startup environment variables and a lot of unix programs
(cvs, postgres, etc) use environment variables to find their data if it
isn't passed on the command line. Polluting the environment in Unix is
considered bad form by many, and dropping something in <i>/etc</i> isn't portable, so go fish. 
<br><br>
 <font size="+2"><b>Active Config</b></font><br><br>Closures are useful for doing config options that have behavior: 
<br><br>
 <pre>  $dumping = "xterm -display $display";</pre>
<br><br>
 You could (if you wanted) make that a closure. That would let you use the multiple arg version of <i>system()</i>, which is good security practice, and the closure would  bind to <i>my</i> variables, so if the config changes at run time, they change there too. 
<br><br>
 <pre>  $dumping = sub { system 'xterm', $arg, $arg; };</pre>
<br><br>
 XXX <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> - dumping active config using B::Deparse 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ExtensibilityPattern"><b>Extensibility Pattern</b></a> </li><li> Data::Dumper </li><li> <a href="http://www.perl.com/language/style/slide34.html">http://www.perl.com/language/style/slide34.html</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="#WrapperModule"><b>Wrapper Module</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ObjectPersistance">Object Persistance</a> 
<br><br>
 <br><br> <a name="ErrorHandling"></a><h2><a href="#ErrorHandling"><b>Error Handling</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Die Early, Die Often</b></font><br><br>Catch errors before you get far away, or unrelated code will appear to malfunction, as a horrible form of <a href="#ActionAtADistance"><b>Action At ADistance</b></a>.
In the process of debugging, you're going to need to insert lots of
tests anyway, so why not do it neatly from the beginning and integrate
it into your program? When the program is in production is when error
reporting is most needed, if users or logs are going to communicate the
nature of the problem to you to be fixed. See <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a> and <a href="http://www.perldesignpatterns.com/?MementoPattern">Memento Pattern</a> for a description of checkpointing an application to recover from otherwise fatal errors. <i>eval { }</i> is used for trapping errors - see <a href="#AssertPattern"><b>Assert Pattern</b></a>. 
<br><br>
 <pre>  open my $f, 'file.txt' or die $!;</pre>
<br><br>
 <i>or die</i> should litterally dot your code. Thats how you
communicate to Perl and your readership that it is not okey for the
statement to silently fail. Most languages make such error geeration
default; in Perl, you must request it. This is no excuse for allowing
all errors to sneak by silently. <br><br>
 Should you not have the constitution to speckle your code with <i>or die</i> clauses, or you're a minimalist, striving for elegance, there is a solution: 
<br><br>
 <pre>  # from the Fatal.pm perldoc:

  use Fatal qw(open close);

  sub juggle { . . . }
  import Fatal 'juggle';</pre>
<br><br>
 <i>Fatal.pm</i> will place wrappers around your methods or
Perl built in methods, changing their default behavior to throw an
error. A module which does heavy file IO on a group of files need not
check the return value of each and every <i>open()</i>, <i>read()</i>, <i>write()</i>, and <i>close()</i>.
Only at key points - on method entry, entry into worker functions, etc
- do you need to handle error conditions. This is a more reasonable
request, one easily acheived. Should an error occur and be cought, the
text of the error message will be in <i>$@</i>. 
<br><br>
 <pre>  use Fatal qw(open close read write flock seek print);

  sub update_data_file {
    my $this = shift;
    my $data = shift;
    my $record;
    local *filename = \$this-&gt;{filename};
    local *record = \$this-&gt;{record};

    eval {

      open my $f, '&gt;+', $filename;
      flock $f, 4;
      seek $f, $record, 0; 
      print $f, $data;
      close $f;

    };

    return 0 if $@;   # update failed
    return 1;         # success

  }</pre>
<br><br>
 Alternatively, rather than using <i>eval { }</i> ourselves, following <a href="#AssertPattern"><b>Assert Pattern</b></a>, we could trust that someone at some point installed a <i><u>DIE</u></i> handler. The most recently installed <i>local</i> handler gets to try to detangle the web.  
<br><br>
 <pre>  sub generate_report {
    local $SIG{__DIE__} = { 
      print "Whoops, report generation failed. Tell your boss it was my fault. <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Reason&amp;word=" ,="">Reason: ",</a> @_;
    }
    foreach my $i ($this-&gt;get_all_data()) {
      $data-&gt;update_data_file($i);
    }
  }

  sub checkpoint_app {
    local $SIG{__DIE__} = { 
      print "Whoops, checkpoint failed. Correct problem and save your data. <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Reason&amp;word=" ,="">Reason: ",</a> @_;
    }
    $data-&gt;update_data_file($this-&gt;get_data());
  }</pre>
<br><br>
 Using <i>local</i> scoped handlers this way allows you to
provide context-sensitive recoverory, or atleast diagnostics, when
errors are thrown. This is easy to do and all that is required to take
full advantage of <i>Fatal.pm</i>. <pre> </pre><i>Fatal.pm</i> was written by Lionel.Cons@cern.ch with prototype updates by Ilya  Zakharevich ilya@math.ohio-state.edu. 
<br><br>
 <font size="+2"><b>Time-Outs</b></font><br><br>Use <i>alarm()</i> with <i>eval()</i>: 
<br><br>
 <pre>  RETRY:

  eval {
    alarm 30; # send a $SIG{ALRM} after 30 seconds - default is death
    # do something that might time-out
    alarm 0;  # disable alarm
  };

  if($@) {
    # there was an error - error text is in $@ - do what you will - perhaps retry:
    goto RETRY;
  }</pre>
<br><br>
 <i>select()</i> provides an alternative for timeouts on I/O, and is especially safe when coupled with non-blocking I/O. See <a href="#SelectPollPattern"><b>Select Poll Pattern</b></a>. 
<br><br>
 <a href="http://www.perl.com/pub/a/2002/11/14/exception.html">http://www.perl.com/pub/a/2002/11/14/exception.html</a> - OO style error handling - also <a href="http://www.perldesignpatterns.com/?TryCatch">Try Catch</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ErrorReporting"><b>Error Reporting</b></a> </li><li> <a href="#DebuggingPattern"><b>Debugging Pattern</b></a> </li><li> <a href="#ActionAtADistance"><b>Action At ADistance</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TryCatch">Try Catch</a> </li><li> <a href="http://www.perldesignpatterns.com/?UseFatal">Use Fatal</a> </li><li> Carp Module<a href="http://www.perldesignpatterns.com/?CarpModule">+</a> </li><li> <a href="http://www.perldesignpatterns.com/?PadWalker">Pad Walker</a> on CPAN </li><li> Exception::Class </li><li> <a href="http://www.perldesignpatterns.com/?UnitTests">Unit Tests</a> </li><li> Devel::Coverage </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="#AssertPattern"><b>Assert Pattern</b></a> 
<br><br>
 <br><br> <a name="ErrorReporting"></a><h2><a href="#ErrorReporting"><b>Error Reporting</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Use die()</b></font><br><br>Avoid temptation to write a new death-handler and call it by name in  place of <i>die()</i>: 
<br><br>
 <pre>  # don't do this

  sub barf {
    print "something went wrong!\n", @_;
    exit 1;
  }

  # ...

  barf("number too large") if($number &gt; $too_large);</pre>
<br><br>
 <i>die()</i> has a useful default behavior that depends on
no external modules, but can easily be overriden with a handler to do
more complex cleanup, reporting, and so on. If you don't use <i>die()</i>, you can't easily localize which handler is used in a given scope. 
<br><br>
 <font size="+2"><b>Every Error, Great And Small</b></font><br><br><i>warn()</i> provides a reasonable default for reporting potential errors. Programs run at the command line get <i>warn()</i> messages sent to stderr. CGI programs get <i>warn()</i> messages sent to the error log, under Apache and thttpd [thttpd rocks - <a href="http://www.acme.com/">http://www.acme.com</a> - one process, arbitrary number of concurrent requests]. Using CGI::Carp, warnings are queued up for display in the event of a <i>die()</i>, thus making important debugging information available. 
<br><br> Even reasonable defaults aren't always what you want. Without
changing your code [and this book is really about changing your code as
little as possible], the behavior of <i>warn()</i> and <i>die()</i> can be changed: 
<br><br>
 <pre>  # send diagnostic output to the end of a log

  open my $debug, '&gt;&gt;bouncemail.debug';
  $SIG{__WARN__} = sub { print $debug $_, join(" - ", @_); };
  $SIG{__DIE__} = sub { print $debug $_, join(" - ", @_); exit 0; };</pre>
<br><br> Some logic will want to handle its own errors - some times a
fatal condition in one part of code doesn't really matter a hill of
beans on the grand scale of the application. A command line print
utility may want to die if the printer is off line [or cought fire -
Linux will print "lp: /dev/lp0 on fire!" under some circumstances. See <a href="http://www.dorje.com:8080/netstuff/jokes/prog.errors">http://www.dorje.com:8080/netstuff/jokes/prog.errors</a> for a great list of error messages.] -  a word processor probably does <u>not</u> want to exit with unsaved changes merely because the document couldn't be printed. So, do this: 
<br><br>
 <pre>  local $SIG{__DIE__} = sub {
    # yeah, whatever
  };

  # or...

  local $SIG{__DIE__} = 'IGNORE';</pre>
<br><br>
 ...or, do the error processing of your choice. Perhaps set a lexically bound variable flag - see <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a>. 
<br><br>
 <i>eval { }</i> may also be used to trap errors raised with <i>die()</i> and <i>warn()</i>,
including errors that Perl throws, such as divide by zero errors. Given
a word process that shouldn't exit with unsaved data because an attempt
to print fails, this is the sane idiom. Registering a handler can be
used in conjunction to provide diagnostics, debugging, feedback,
explanation, or so forth, but <i>eval { }</i> should be used to actually trap the error and prevent it from becoming fatal. 
<br><br>
 <font size="+2"><b>Report Everything</b></font><br><br>In the event of a fatal error, display as much information as possible about the current execution context. <pre>  
  # intercept death long enough to scream bloody murder

  $version = '$<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Id&amp;word=%20ErrorReporting,v">Id: ErrorReporting,v</a> 1.22 2003/08/08 23:53:43 phaedrus Exp $'; # CVS will populate this if you use CVS

  $SIG{qq{__DIE__}} = sub {

    local $SIG{qq{__DIE__}}; # next die() will be fatal

    my $err = '';

    $err .= "$0 version $version\n\n";

    # stack backtrace

    $err .= join "\n", @_, join '', map { 
      (caller($_))[0] ? sprintf("%s at line %d\n", (caller($_))[1,2]) : ''; 
    } (1..30);

    $err.="\n";

    # report on the state of global variables. this includes 'local' variables 
    # and 'our' variables in scope. see <a href="http://www.perldesignpatterns.com/?PadWalker">Pad Walker</a> for an example of inspecting
    # lexical 'my' variables as well.

    foreach my $name (sort keys %{__PACKAGE__.'::'}) {
      my $value =  ${__PACKAGE__.'::'.$name};
      if($value and $name ne 'pass' and $name =~ m/^[a-z][a-z0-9_]+$/) {
        $err .= $name . ' ' . $value . "\n" 
      }
    }

    $err .= "\n";

    foreach my $name (sort keys %ENV) {
      $err .= $name . ' ' . $ENV{$name} . "\n";
    }

    $err .= "\n";

    # open the module/program that triggered the error, find the line
    # that caused the error, and report that.

    if(open my $f, (caller(1))[1]) {

      my $deathlinenum = (caller(1))[2];
      my $deathline;

      # keep eof() from complaining:
      &lt;$f&gt;; 

      $deathline = &lt;$f&gt; while($. != $deathlinenum and !eof);

      $err .= "line $deathline reads: $deathline\n";

      close &lt;$f&gt;;

    }

    # send an email off explaining the problem
    # in text mode, errors go to the screen rather than by email

    require Mail::Sendmail;
    sendmail(To=&gt;$errorsto, From=&gt;$mailfrom, Subject=&gt;"error", Message=&gt;$err) unless($test);

    print "&lt;pre&gt;\n", CGI::escapeHTML($err), "&lt;/pre&gt;\n" if($test);

    # reguardless, give the user a way out. in this case, we display what was in their
    # shopping cart and give them a manual order form that just sends an email, and we
    # call them back for payment info.

    $|=1;
    # print "Those responsible for sacking the people that have just been sacked, have just been sacked.&lt;br&gt;&lt;br&gt;\n";
    print "A software error has occured. Your order cannot be processed automatically. ";
    print "At the time of the error, your cart contained:&lt;br&gt;&lt;br&gt;\n";
      
    open my $cart, $cartdir.$sid;
    print "$_&lt;br&gt;\n" while(&lt;$cart&gt;);
    print qq{
      &lt;script language="javascript"&gt;
        window.open($errororderpage);
      &lt;/script&gt;
    };
    close $cart;

    # finally, give up 

    exit 0;

  };</pre>
<br><br>
 <i>A software error has occured.</i> Give the user an out. I
wish I could remember what book this was from - the St. Thomas
University library in St. Paul, Minnesota had it, but the author quoted
a conversation that went something like... <br><br>
 <i>I noticed a contingency in the code, so I went to the
client and asked him how I should handle it. He said, "Oh, that won't
happen, it doesn't matter". Dumbfounded, knowing full well that it
might happen, I said, "Oh, so if the program reaches this point, it is
okey to drop the database, delete all of the data, lock up, and stop
responding without printing any diagnostic message? The client reeled
back aghast and exclaimed, "No! You can't do that!". I said, unless we
put some code in here to handle this situation, thats exactly what
might happen! Now, when the code reaches this point, how should we
handle it?</i> 
<br><br> Poping up a form that asked for contact information rather
than a credit card, and transmits it insecurely along with the contents
of the cart is our Fail Over<a href="http://www.perldesignpatterns.com/?FailOver">+</a> solution. Perhaps their order wasn't complete - thats okey. Atleast the system knew it failed and did something reasonable. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a>, <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ErrorHandling"><b>Error Handling</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?PadWalker">Pad Walker</a> on CPAN </li><li> <a href="#ActionAtADistance"><b>Action At ADistance</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TryCatch">Try Catch</a> </li><li> <a href="http://www.perldesignpatterns.com/?UseFatal">Use Fatal</a> </li><li> Carp Module<a href="http://www.perldesignpatterns.com/?CarpModule">+</a> </li><li> <a href="http://www.perl.com/pub/a/2002/11/14/exception.html">http://www.perl.com/pub/a/2002/11/14/exception.html</a> - OO style error handling </li><li> <a href="http://www.stonehenge.com/merlyn/LinuxMag/col14.html">http://www.stonehenge.com/merlyn/LinuxMag/col14.html</a> - get CGI errors as emails </li><li> <a href="#DebuggingPattern"><b>Debugging Pattern</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=Error">PerlDoc:Error</a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="#AssertPattern"><b>Assert Pattern</b></a> 
<br><br>

<br><br>
 <br><br> <a name="ExtensibilityPattern"></a><h2><a href="#ExtensibilityPattern"><b>Extensibility Pattern</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Supporting
features, such as protocols, that don't yet exist. Solving general
problems without concern for the specifics of details. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Provide a framework certain kind of task.  
<br><br>
 <font size="+2"><b>Frameworks</b></font><br><br>A
"framework" uses other modules. Normal modules have a fixed set of
dependencies and are only extended through subclassing, as per <a href="#AboutInheritance"><b>About Inheritance</b></a>. A framework may consist of several parts that must be inherited to be used much like several cases of <a href="#AbstractClass"><b>Abstract Class</b></a>. It may also be  passed references to other objects, as would a class thats sets up a <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a>. It may read names of classes from a <a href="#ConfigFile"><b>Config File</b></a> or from the user, as in <a href="http://www.perldesignpatterns.com/?BeanPattern">Bean Pattern</a>.
Instead of code being used by other code, it will use other code on the
fly. It is on top of the food chain instead of the bottom. <br><br>
 XXX examples of these cases as "extensibility". 
<br><br>
 <font size="+2"><b>Configuration Files as Extentions</b></font><br><br>A <a href="#ConfigFile"><b>Config File</b></a>
may be enough to customize the module for reasonable needs. It may also
specify modules by name to be created and employed in a framework. <br><br>
 <pre>  # the config.pl file defines @listeners to contain a list of class names
  # that should receive notices from an <a href="http://www.perldesignpatterns.com/?EventListener">Event Listener</a> broadcaster, 
  # referenced by $broadcaster. 

  require 'config.pl';

  foreach my $listener (@listeners) {
    require $listener;
    my $list_inst = $listener-&gt;new();
    $broadcaster-&gt;add_listener($list_inst);
  }</pre>
<br><br>
 See <a href="http://www.perldesignpatterns.com/?EventListener">Event Listener</a>
for the broadcaster/listener idiom. This avoids building the names of
listener modules into the application. An independent author could
write a plug-in to this application: she would need only have the user
modify <i>config.pl</i> to include mention of the plug-in. Of course, modification of <i>config.pl</i> could be automated. The install program for the plug-in would need to ask the user where the <i>config.pl</i> is, and use the <a href="#ConfigFile"><b>Config File</b></a> idiom to update it. 
<br><br>
 <font size="+2"><b>Extending Through Scripting</b></font><br><br>A
major complaint against GUIs is that they make it difficult to script
repetitive tasks. Command line interfaces are difficult for most humans
to work with. Neither give rich access to the API of a program. A well
designed program is a few lines of Perl in the main program that use a
number of modules - see <a href="#CreatingCPANModules"><b>Creating CPANModules</b></a>.
This makes it easier to reuse the program logic in other programs.
Complex programs that build upon existing parts benefit from this,
without question. How about the other case - a small script meant to
automate some task? This requires that the script have knowledge about
the structure of the application - it must know how to assemble the
modules, initialize them, and so on. It is forced to work with aspects
of the API that it almost certainly isn't concerned with. It must
itself be the framework. This is a kind of <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a>
- where something abstract is graphed onto something concrete, or
something simple is grafted onto the top of something complex. It would
make more sense in this case for the application to implement a sort of
<a href="#VisitorPattern"><b>Visitor Pattern</b></a>, and allow itself
to be passed whole, already assembled, to another spat of code that
knows how to perform specific operations on it. This lends itself to
the sequential nature of the script: the user defined extention could
be a series of simple calls: <pre>  
  pacakge <a href="http://www.perldesignpatterns.com/?UserExtention">User Extention</a>1;

  # we are expected to have a "run_macro" method

  sub run_macro {
    my $this = shift;
    my $app = shift;

    $app-&gt;place_cursor(0, 0);
    $app-&gt;set_color('white');
    $app-&gt;draw_circle(radius=&gt;1);
    $app-&gt;set_color('red');
    $app-&gt;draw_circle(radius=&gt;2);
    # and so on... make a little bull's eye

    return 1;
  }</pre>
<br><br> The main application could prompt the user for a module to
load, or load all of the modules in a plug-ins directory, then make
them available as menu items in an "extentions" menu. When one of the
extentions are select from the menu, a reference to the application -
or a <a href="#FacadePattern"><b>Facade Pattern</b></a> providing an interface to it - is passed to the run_macro() method of an instance of that package. 
<br><br> Many applications will have users that want to do simple
automation without being bothered to learn even a little Perl (horrible
but true!). Some applications (like Mathematica, for instance) will
provide functionality that doesn't cleanly map to Perl. In this case,
you'd want to be able to parse expressions and minipulate them. In
these cases, a <a href="http://www.perldesignpatterns.com/?LittleLanguage">Little Language</a> may be just the thing.  
<br><br>
 XXX - move this to <a href="http://www.perldesignpatterns.com/?LittleLanguage">Little Language</a>. 
<br><br>
 A <a href="http://www.perldesignpatterns.com/?LittleLanguage">Little Language</a>
is a small programming language created specifically for the task at
hand. It can be similar to other languages. Having something clean and
simple specifically targetted at the problem can be better solution
than throwing an overpowered language at it. Just by neglecting
unneeded features, user confusion is reduced. <br><br>
 <pre>    place_cursor(0, 0)
    set_color(white)
    draw_circle(radius=1)
    set_color(red)
    draw_circle(radius=2)</pre>
<br><br> A few options exist: we can compile this directly to Perl
bytecode using B::Generate (suitable for integrating legacy languages
without performance loss), or we can munge this into Perl and <b>eval</b> it. Lets turn it into Perl. 
<br><br>
 <pre>  # read in the users program
  my $input = join '', &lt;STDIN&gt;;

  # 0 if we're expecting a function name, 1 if we're expecting an argument,
  # 2 if we're expecting a comma to seperate arguments
  my $state = 0;

  # perl code we're creating
  my $perl = '
    package <a href="http://www.perldesignpatterns.com/?UserExtention">User Extention</a>1;

    sub run_macros {
      my $this = shift;
      my $app = shift; 
  ';

  while(1) {
    # function call name
    if($state == 0 &amp;&amp; $input =~ m{\G\s*(\w+)\s*\(}cgs) {
      $perl .= '  $app-&gt;' . $1 . '(';
      $state = 1;
 
    # a=b style parameter
    } elsif($state == 1 &amp;&amp; $input =~ m{\G\s*(\w+)\s*=\s*([\w0-9]+)}cgs) {
      $perl .= qq{$1=&gt;'$2'};
      $state = 2;

    # simple parameter
    } elsif($state == 1 &amp;&amp; $input =~ m{\G\s*([\w0-9]+)}cgs) {
      $perl .= qq{'$1'};
      $state = 2;

    # comma to seperate parameters
    } elsif($state == 2 &amp;&amp; $input =~ m{\G\s*,}cgs) {
      $perl .= ', ';
      $state = 1;

    # end of parameter list
    } elsif(($state == 1 || $state == 2) &amp;&amp; $input =~ m{\G\s*\)}cgs) {
      $perl .= ");\n";
      $state = 0;

    # syntax error or end of input
    } else {
      return 1 unless $input =~ m{\G.}cgs;
      print "operation name expected\n" if $state == 0;
      print "parameter expected\n" if $state == 1;
      print "comma or end of parameter list expected\n" if $state == 2;
      return 0;
    }
  
  }

  $perl .= qq&lt;
      return 1;
    }
  &gt;;

  eval $perl; if($@) {
     # display diagnostic information to user
  }</pre>
<br><br> We're using the \G regex metacharacter that matches where the
last global regex on that string left off. That lets us take off
several small bites from the string rather than having to do it all in
one big bite. The flags on the end of the regex are: <br><br>
 </li><li> g - global - needed for the \G token to work </li><li> c - not sure, but it makes g work </li><li> s - substring - treat the entire string as one string. Newlines become regular characters and match whitespace. 
<br><br> Out of context, the string "xyzzy" could be either a parameter
or the name of a method to call. The solution is simply to keep track
of context: that is where $state comes in. Every time we find
something, we update $state to indicate what class of thing would be
valid if it came next. After we find a function name and an opening
paranthesis, either a hash style parameter or a single, lone parameter,
or else a close paranthesis would be valid. We aren't even looking for
the start of another function [Though perhaps we should be. If changed
this in our code, it would allow us to nest function calls inside of
each other. We would have to track our level of nesting if we wanted to
report errors if there were too many or too few right-paranthesis.
Exercise left for the reader.]. After a parameter, we're looking for
either the close paranthesis or another parameter. <br><br> Every time we match something, we append a Perl-ized version
of exactly the same thing onto $perl. All of this is wrapped in a
package and method declaration. Finally, $perl is evaluated. The result
of evaluating should be to make this new package available to our code,
ready to be called. <br><br>
 XXX a B::Generate exmaple! ... but in Little Languages<a href="http://www.perldesignpatterns.com/?LittleLanguages">+</a> 
<br><br>
 <font size="+2"><b>Beans as Extentions</b></font><br><br>XXX a B::Generate exmaple! 
<br><br>
 <font size="+2"><b>Hacks as Extentions</b></font><br><br>When
a base application, or shared code base, is customized in different
directions for different clients. Making heavy use of Template Methods<a href="http://www.perldesignpatterns.com/?TemplateMethods">+</a> and <a href="http://www.perldesignpatterns.com/?AbstractFactories">Abstract Factories</a>,
localizing client specific code into a module or tree of modules under
a client-specific namespace rather than "where it belongs". See <a href="http://www.perldesignpatterns.com/?HacksModule">Hacks Module</a>. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?PerlPaint">Perl Paint</a> </li><li> <a href="#ConfigFile"><b>Config File</b></a> </li><li> <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a> </li><li> <a href="#VisitorPattern"><b>Visitor Pattern</b></a> </li><li> <a href="#FacadePattern"><b>Facade Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?StateMachine">State Machine</a> </li><li> <a href="http://www.perldesignpatterns.com/?TwoVersionNumbers">Two Version Numbers</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/plugin.html">http://www.martinfowler.com/eaaCatalog/plugin.html</a> 
<br><br>

<br><br>
 <br><br> <a name="CutAndPasteProgramming"></a><h2><a href="#CutAndPasteProgramming"><b>Cut And Paste Programming</b></a></h2><br> 
<br><br>

<br><br> When programming, you take a generic algorithm and customize
it for a task. Sometimes you have a copy of an implementation of that
algorithm laying around that you can copy. OO tells us not to do that.
Someone once said, "If you're going to make a mistake, make it in a big
way". Keeping one sacred copy that must be correct could certainly
accomplish that. However, it makes it possible to fix a problem once
instead of having it spread around the code. Having code replicated is
a huge commitment. You're banking that nothing is wrong with it, that
your program will never change how the data it works on is represented,
and that people like looking at endless permutations of a single piece
of code. <br><br> Object Orientation proposes to eliminate this. The act of
separating your program into objects creates a ripe new area for
endless duplication: sequences of setting, querying, and passing data.
A common situation: <br><br>
 <pre>  $money = $player-&gt;query_money();
  if($player-&gt;query_max_money() &lt; $x + $payout) {
    $player-&gt;set_money($money + $payout); 
    $nickels_on_floor = 0;
  } else {
      $nickels_on_floor =  $money + $payout - $player-&gt;query_max_money();
      $player-&gt;set_money($player-&gt;query_max_money());
  }</pre>
<br><br>
 No matter which way we make the <i>set_money()</i> function
work, we're doomed. If it enforces a ceiling, then we have to query
again to see if the ceiling was enforced. If it doesn't enforce a
ceiling, then we have to check each and every time we access the value
and enforce it ourselves. The result is one or two of these sequences
of logic will get strewn around the program. The problem is that the
client needs something slightly more complex than the server is
prepared to provide. We could, and perhaps should, make the object
we're calling, $player, return an array, including success or failure,
how much money actually changed hands, how much more they could carry.
This would go with the approach of providing way more information than
could ever be needed. This leads to bloated code and logic that we
aren't sure whether or not is actually being used, leading to untested
code going into production and becoming a time-bomb for the future,
should anyone actually start using it. Less dramatically, we could
modify the target object to return just one more piece of information
when we realize we need it. This leads to a sort of feature envy, where
the server is going out of its way to provide things in terms of a
certain clients expectations, causing an API that is geared towards a
particular client and incomprehensible to all else. Also, there is
temptation to write something like: <br><br>
 <pre>  package Util;</pre>
<br><br> Beware of Utility, Helper, Misc, etc packages. They collect
orphan code. The pressure to move things out of them is very low, as
they all seem to fit by virtue of not fitting anywhere else. They grow
indefinitely in size because the class of things that don't seem to
belong anywhere is very large. The effect snowballs as the growth of
other objects is stymied while the "Utility" package booms. <br><br> Snafus like this cause the number of accessors to grow to
accommodate all of the permutations of accessing the data. You'll often
see a <i>set_</i> function, a  <i>query_</i> or <i>get_</i> function, and <i>add_</i> function, for each value we encapsulate. 
<br><br>
 <pre>  package Casino;
  use <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>; <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>::imply();

  sub pay_out {

    # this method would go in $player, since it is mostly concerned with $player's variables,
    # but we don't want to clutter up $player's package, and we don't know if anyone else
    # will ever want to use this code.

    my $player = shift;
    my $payout = shift;

    my $money = $player-&gt;query_money();
    if($player-&gt;query_max_money() &lt; $money + $cost) {
      $player-&gt;set_money($money + $payout); 
      $nickels_on_floor = 0;
  } else {
      $nickels_on_floor =  $money + $payout - $player-&gt;query_max_money();
      $player-&gt;set_money($player-&gt;query_max_money());
    }
  }</pre>
<br><br> Associating methods with our client object that reasonably
belong in the server object ($player, in our case), isn't always the
worst solution. In fact, if you put them there and leave them until it
is clear that they are needed elsewhere, you'll find that either they
are globally applicable, they only apply to this client, they apply to
a special case of the client, or they apply to a special case of the
server. <br><br>
 </li><li> Applies only to this particular client: Leave the server's accessors in the client, in this case, Casino. </li><li> Nearly every client can benefit from this code: Put the logic in the server, in this case, $player. </li><li> Applies to a special case of clients: Consider a Facade for $player. Not worth it? Toss up between #1 and #2. </li><li> Applies to a special case of servers: Subclass $player's package. 
<br><br> It's okay to do it "wrong". Each new thing that gets built
will give you more and more insight into how things really need to be
able to work. The important thing is to continue to incorporate these
lessons into the code, to keep the code in line with reality, and never
be afraid of breaking your code. If you're afraid of breaking your code
in name of making it better, it has you hostage. If you're afraid of
breaking it because you think it'll take too long to fix it to work
again after the change, it has already grown rigid, and only frequently
breaking and fixing it will allow it to regain its flexibility. Take
Jackie Chan, for instance. Having broken countless bones, he's only
gotten stronger, braver, and apparently, more skilled at walking on a
broken leg, more knowledgeable about his limits, and adept at healing.
Alternatively, if you're afraid of subtle bugs creeping in undetected,
you've got murky depths syndrome. Perhaps a lot of it is poorly
understood Lava Flow code, that was laid down once, built on top of,
and has become permanent for it. Reading through the dark murky code is
a good start. A pass now and then keeps the possibilities and
implications fresh in your mind. However, this is time consuming and
will ultimately miss implications. There is no substitute for knowledge
of the code, and neither is there substitute for testing. There is a
special class of code where every bit of logic is exersized every
execution. Mathematical modeling applications that work on large, well
understood, datasets fit this description. Any subtle bug would give
dramatic bias in the output as soon as the buggy program were run.
Normal programs doesn't have this luxury - their bugs lurk for ages,
possibly until maintaince headaches dictate it be abandoned and
rewritten. We can't understand everything in a large program, but we
can contrived data sets and test applications that work out every
feature of our module. Writing artificial applications that use our
modules, and coming up with bizarrely improbably-in-every-way datasets
simulates the "luxury" case where all of the dark murky depths are used
every run, in our case, every test run. The only time dark murky depths
and Lava Flow code, the code most in need of a refactor, can be
attacked is when we have a definitive method for discovering whether or
not we've broken it. "Measure twice, cut once". If you're anything like
me, you like flying by the seat of your pants. If you go to the movies
or watch the tele, you know that every fighter pilot struggles with
this issue: do I trust my intuition and wing it, or do I go by the
book? Luke Skywalker destroyed the Death Star without that damn useless
targeting computer. The architects that built skyscrapers certainly
have to think outside of the box, so to speak, to come up with
techniques and ideas for building beyond the bounds of what is believed
possible, but no one would trust an architect that couldn't back up his
gut instincts with cold, hard math. Solution? Code with your heart, but
be the first to know when you make the inevitable wrong guess. Write
seat of your pants code, but write first class scientific tests. <br><br>
 Cut and paste code is a sign of larger problems.  
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> - remove the rant, clean this up - important section. </li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#TemplateMethod"><b>Template Method</b></a> </li><li> <a href="#FacadePattern"><b>Facade Pattern</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a>  </li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> </li><li> <a href="#ErrorHandling"><b>Error Handling</b></a> </li><li> <a href="#BigBallOfMud"><b>Big Ball Of Mud</b></a> </li><li> <a href="#FeatureEnvy"><b>Feature Envy</b></a> </li><li> <a href="#LavaFlow"><b>Lava Flow</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?OrphanCode">Orphan Code</a>  </li><li> <a href="http://www.perldesignpatterns.com/?AdaptToAdapt">Adapt To Adapt</a> </li><li> <a href="#CurryingConcept"><b>Currying Concept</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CrossSectionalRefactoring">Cross Sectional Refactoring</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://scarecrow.fmrp.usp.br/%7Emavcunha/public/anti-patterns.php">http://scarecrow.fmrp.usp.br/~mavcunha/public/anti-patterns.php</a> 
<br><br>
 <br><br> <a name="PrematureOptimization"></a><h2><a href="#PrematureOptimization"><b>Premature Optimization</b></a></h2><br> 
<br><br>

<br><br>
 Premature optimization is the root of all evil. 
<br><br> Don't optimize for bugs. Don't optimize for poor
implementations of language interpreters. Don't optimize a naive
implementation. All of these things will change right out from under
you. Code that is dependent on something broken for speed will run
slower when the real problem is fixed. <br><br>
 </li><li> Writing code in hand optimized x86 assembly
created a backwards compatability rat race. Half the logic on recent
Pentium chips is dedicated to decoding x86 instructions into something
the internal VLIWC processor can execute natively. Heat disipation and
signal propogation length, and cache size are limiting factors to
speed. These chips would run much faster if the x86 decode logic were
replaced with cache, more ALUs, or removed entirely. Optimization code
to x86 rather than writing good clean algorithms in C is a case of
optimizing for a broken implementation, an implementation that should
have been considered to be "subject to change". </li><li> The effort
being spent by Java programmers optimizing away objects manually
defeats the purpose of object orientation. This energy would be better
spent building a compiler that knows how to do this safely and
invisibly. </li><li> Using C to write large applications because of
the need for speed makes the job of writing that large application much
more difficult and time consuming. The temptation to cut corners on
algorithms is very strong. Implementating optimized memory allocation,
over allocation, common object size pools, hashing, and so forth, is
tedious, and takes up the bulk of a code of an application. It makes
sense to put them off until the program is running, but at that point,
you've probably lost interest in the project. Those optimizations, and
thousands of other things, you get automatically when writing in
languages like Perl. <br><br> Optimization isn't evil - only premature optimization is. In
each of these examples, if the more general case is optimized rather
than specific cases, everything is right in the world. People failing
to see the bigger picture are the ones causing grief. If you think you
see the bigger picture, you almost certainly don't. Like a good
security consultant, a good programmer is pessimistic about everything.
<br><br> I won't bore you with statistics about computers becoming
faster faster than you can change your code. The fact is, there is a
niche for squeezing the last drop of performance out of an application.
This nitche shows people what they could do if only their computer were
a little faster, and it drives hardware performance. <br><br> The conclusion to draw from this is: If there is a quicker
way to do something in Perl that is less readable or requires jumping
through hoops, it is a bug in the more readable implementation, and the
more readable implementation will soon be fixed. <font size="+2"><b>Write good Perl. Let Perl do its thing.</b></font><br><br>There are some optimizations which are considered good style, and therefore aren't premature: 
<br><br>
 </li><li> <i>use fields</i> - base a class on an array ref rather than a hashref, and save memory. Access times to <a href="#InstanceVariables"><b>Instance Variables</b></a> are also quicker than with a hash. See also <a href="#AnonymousSubroutineObjects"><b>Anonymous Subroutine Objects</b></a>. </li><li> <i>map EXPR</i> rather than <i>map { EXPR }</i> - saves creating an execution context, when only a expression is required. </li><li> <i>$foo</i> rather than <i>"$foo"</i> - the second is just ugly, anyway, and redundant. Perl converts things to strings as it needs to. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=162863">PerlMonks:162863</a> 
<br><br>

<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://scarecrow.fmrp.usp.br/%7Emavcunha/public/anti-patterns.php">http://scarecrow.fmrp.usp.br/~mavcunha/public/anti-patterns.php</a> 
<br><br>
 <br><br> <a name="BlindFaith"></a><h2><a href="#BlindFaith"><b>Blind Faith</b></a></h2><br> 
<br><br>

<br><br>
 "If I use the Object Oriented features, I must be benefiting from them". 
<br><br> OO is no silver bullet. It isn't a cure all and it isn't
impossible to do more harm than good with it. Its a good indication
that something has gone wrong if it is adding complexity rather than
removing. Remember, keep it simple. When it becomes clear how to
refactor your code, do so then, not before. <br><br> Can interchangeable objects be used interchangeably? Can one
object be replaced with several objects? If not, consider adding a
common Interface Type to the like objects, and creating an Abstract
Factory to create and return the correct one for any given situation.
Think of saving files using one of many filters. <br><br> Are objects being used purely to hold values? You've
probably got one or two big fat Big Ball Of Mud objects. Start moving
logic out into the package that contains the data it most closely
identifies with. Insert shims to keep everything running, that delegate
the method call to the object, if you must, and experiment with
removing the shim over time. If nothing else, this sets a precedent,
and new code can be written immediately in the new, correct way, rather
than more and more code accumulating using the old, ugly approach. <br><br> Can you remove an object from the system without breaking
every other object? If not, they are too interdependent, with very few
exceptions. Even with the Microsoft Windows operating system, something
like "the registry" sounded like a great idea at first. Any program, as
well as the operating system, could store configuration and run time
data in a central database. In practice, it creates a single point of
failure, frequently sustaining damage that causes the entire system to
need to be restored from backup or reinstalled. The file grows too
large and the operating system fails on any attempt to grow it beyond
the limit of the max file size. Windows was designed with the register
being a core, unchanging idea, but in retrospect, it may have been
better if it weren't an absolute. Examining your code for objects which
absolutely cannot be removed provides great insight into over
dependence. If every object is dependent on every other object, object
orientation is doing nothing for you. If any object can be removed with
minimal damage to the overall structure, you have something healthy and
organic. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> Object Orgy </li><li> Layering Pattern </li><li> Functions to Objects </li><li> Polymorphism </li><li> Abstract Factory </li><li> Interface Type 
<br><br>

<br><br>
 <font size="+2"><b>Comments</b></font><br><br>This is more of an introduction than a pattern or anti-pattern. 
 It is supporting background, not worthy of inclusion in a pattern
 catalog itself. No template for this one? - <a href="#ScottWalters"><b>Scott Walters</b></a> - <i>Tue Aug 26 10:25:48 2003 216.190.249.92</i> 
<br><br>
 <!-- cut - end comments --> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://aolsearch.aol.com/aol/search?encquery=C0913E991AA78C87CD810F7C768B4C5FE6A5181CD34B53FC&amp;invocationType=keyword">http://aolsearch.aol.com/aol/search?encquery=C0913E991AA78C87CD810F7C768B4C5FE6A5181CD34B53FC&amp;invocationType=keyword</a> 
<br><br>
 <br><br> <a name="BigBallOfMud"></a><h2><a href="#BigBallOfMud"><b>Big Ball Of Mud</b></a></h2><br> 
<br><br> Procedural code converted to OO lends itself to one main
object with lot of little objects hung off of it. The interdependency
in the code doesn't change, and objects don't become noticeably
autonomous. Like things may be grouped together, but for the wrong
reasons: historically they have been used in sequence, or they form an
implementation and interface wrapped together. <br><br>
 <i>A BIG BALL OF MUD is haphazardly structured, sprawling,
sloppy, duct-tape and bailing wire, spaghetti code jungle. We've all
seen them. These systems show unmistakable signs of unregulated growth,
and repeated, expedient repair. Information is shared promiscuously
among distant elements of the system, often to the point where nearly
all the important information becomes global or duplicated. The overall
structure of the system may never have been well defined. If it was, it
may have eroded beyond recognition. Programmers with a shred of
architectural sensibility shun these quagmires. Only those who are
unconcerned about architecture, and, perhaps, are comfortable with the
inertia of the day-to-day chore of patching the holes in these failing
dikes, are content to work on such systems.</i> - <a href="http://www.perldesignpatterns.com/?PatternLanguageOfProgramDesign">Pattern Language Of Program Design</a> 4 
<br><br> Also known as a Stove Pipe System, as apparently stove pipes
were prone to corrosion and needed frequent repair with whatever was at
hand, creating a discombobulated kludge. <br><br>
 <i>An ill-assorted collection of poorly matching parts, forming a distressing whole.</i> - Jackson Granholme 
<br><br> The problem with retrofits is they are typically hastily done
and never improved before the next story is built. They come under an
immediate pressing concern that overwhelms any reasonable ability to
think of the future. Indeed, the future won't exist at all for the
project if the retrofit isn't done. Not even in Las Vegas are floors
built so aggressively. <br><br> Reguardless of whether you're in the Windows camp or the
Unix camp, you're using an operating system built for a 16 bit system
that has been retrofit, but never actually completely rewritten. Other
operating systems have equally as interesting stories - <a href="http://www.perldesignpatterns.com/?MacOS">Mac OS</a>
1 through 9 were written for a 32 bit native address space, but memory
protection was retrofit, while Unix was written for a 16 bit address
space and retrofit for 32, but incorporated memory management from the
beginning. <a href="http://www.perldesignpatterns.com/?AmigaOS">Amiga OS</a>
was originally Tripos, but was written in BCPL, a language that had one
data unit - the machine word - making the conversion to a 32 bit
processor and system bizarrely easy, while making mundane programming
tasks bizarrely painful. C later grew out of BCPL, where it cleaned up
the syntax, introduced subscripts on arrays of different sized units of
memory, then later structs, unions, and countless other modern marvels
- but all of this is neither here nor there. <br><br>
 <i>Refactor mercilessly</i> - <a href="http://www.perldesignpatterns.com/?RefactoringImprovingTheDesignOfExistingCode">Refactoring Improving The Design Of Existing Code</a> 
<br><br> Systems can effectively be adapted, and in order to build very
far at all, you almost have to adapt an existing system. Adaption
cannot be sustained without time spent making fundamental changes - see
<a href="http://www.perldesignpatterns.com/?InvariantsArentAlwaysConstants">Invariants Arent Always Constants</a>
- but fundamentally it is a better investment to maintain and adapt
existing systems rather than rewrite them. Most spectacular software
industry failures arose from failure to maintain systems followed by an
attempt to rewrite them from scratch. Most successes can trace their
code back to the 1970s: The SAS system, Unix, DB2, and Signaling System
7, for example. <a href="http://www.perldesignpatterns.com/?JoelOnSoftware">Joel On Software</a>
states that it takes 10 years to write a program. I'd place that as a
minimum. Most software starting life in the 1970s is now rock solid,
mature, and portable. Most programs that started life in the mid-1980s
are still having growing pains, stability problems, and their owners
can't bare the expense of porting them. <br><br>
 Perl allows you to quickly create applications. Perl itself could be considered a <a href="#BigBallOfMud"><b>Big Ball Of Mud</b></a>,
with complexity oozing out every pore. Perl has been around longer than
10 years. A large part of the code reuse of a script is from the
interpreter itself. Writing an interpereter is one way of writing an
API for code reuse. This gives significant lead time on small scripts,
but growing and changing applications hit a ceiling even quicker
because of this accelerated start. Perl scripts quickly reach the point
where they need to be detangled. <br><br>
 <a href="#GodObject"><b>God Object</b></a> has specific steps for migrating code and data out of a monolithic object. 
<br><br>
 <s>This exhibits <a href="#LayeringPattern"><b>Layering Pattern</b></a>, Polymorphism, <a href="#LooseCoupling"><b>Loose Coupling</b></a>, <a href="#CommandObject"><b>Command Object</b></a>, Routing,  and <a href="http://www.perldesignpatterns.com/?EventListener">Event Listener</a> patterns. </s> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 See <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> for the table of contents 
<br><br>

<br><br>
 <br><br> <a name="SpaghettiCode"></a><h2><a href="#SpaghettiCode"><b>Spaghetti Code</b></a></h2><br> 
<br><br> No one understands it, so no one refactors it. Just as it is
almost impossible to untangle a plate of spaghetti, code with no
visible structure and no logical structure is daunting. Structured
Programming contributed to the world the idea that the code should
visibly reflect its logical structure: this was the birth of indenting.
Previously, a goto would bounce back a few lines in flow, and another
one somewhere in the middle would bounce you past the last goto. <br><br>
 <pre>  10 let a=a+1
  20 if a &gt; 10 then goto 50
  30 print a:print "\n"
  40 goto 10
  50 stop

  foreach my $a (1..10) {
    print "$a\n";
  }</pre>
<br><br> Despite the systematic banishment of these languages [This
first example is BASIC. BASIC still lives on today. What gives? Well,
its been retrofit.], people still find ways to write code that has this
problem on a large scale: <br><br>

<br><br> 1. Side effects: Each method called seems to do countless
unrelated unexpected things, making the normal flow difficult to
understand or discover. When writing new code, it is often impossible
to reuse existing code because of the unfathomed grouping of unrelated
tasks. <br><br> 2. Dark heart: The heart of each routine, object, module,
etc is buried somewhere deep in its bowels, poorly or not marked, and
reached through an obscure path, kind of like an Egyptian pyramid. <br><br> 3. Ransom transaction: Data is communicated through global
variables, or stashing data in some remote object. This is akin to
conducting a ransom transaction by demanding that money be thrown into
a dumpster in an abandoned industrial complex to be picked up by
someone who will presumably flee and kill the kidnapee should either
cops be there or money not be. This is an entirely unwholesome way to
conduct a transaction. <br><br> 4. Three cups and nut: Large amounts of unrelated things are
grouped together without regard for when, how, by whom, in what order,
under what conditions, or why they are used. Since they all look alike
and any be used at any time, getting lost is easy. Which one actually
gets used may well be a slight of hand anyway. <br><br> 5. Wheel factory: Reinventing the wheel, or stack, or
program control constructs, or parameter passing mechanisms, or
anything else which should be both standardized throughout a language
and completely factored out of the language. This clutters the program
with difficult to understand, repeated idiom. <br><br> If Spaghetti code is needed, it can take on a life of its
own. Most large projects have some legacy code that forms the heart of
their project that is no longer represented by a human who wrote it. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#LavaFlow"><b>Lava Flow</b></a> </li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="#ObjectOrgy"><b>Object Orgy</b></a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.google.com/search?q=untangle+goto+c&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;start=10&amp;sa=N">http://www.google.com/search?q=untangle+goto+c&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;start=10&amp;sa=N</a> 
<br><br> Thats a thought. Some common goto idioms, documented in the
interest of untangling them. Linux kernel uses a goto-on-failure idiom
where error return codes are set just in case, but that is the actual
result code only when an error causes a goto to exit the function.
Other program simulate stacks using temporary variables that they stash
things in - the Web Wanker<a href="http://www.perldesignpatterns.com/?WebWanker">+</a> sure suffered from that.  
<br><br>
 <br><br> <a name="LavaFlow"></a><h2><a href="#LavaFlow"><b>Lava Flow</b></a></h2><br> 
<br><br> When code just kind of spews forth and becomes permanent, it
becomes an architectural feature of the archeological variety. Things
are built atop the structure without question and without hope of
changing what is beneath them. The existing code is seen as an
historical curiosity. <br><br> XXX There is a tale of a computer manufacturer, back in the
days when each vendor had their own CPU. There was a bug in their new
processor, and production schedules didn't give them time to work it
out. The department responsible for coding the system software
(operating system) for the thing was instructed to work around it. The
system software dutifully avoided tickling the bug, and documented the
presence of it for anyone writing applications for the machine.
Software was ported to the machine, and unsure what to make of the bug
warned end users that certain feature of the applications didn't
function correctly on this machine. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <br><br> <a name="BoatAnchor"></a><h2><a href="#BoatAnchor"><b>Boat Anchor</b></a></h2><br> 
<br><br>

<br><br> Hardware or software that serves no useful purpose that is
kept around for political reasons. Often, everyone is secretly waiting
for it to be used again, so it is no longer a derelict eyesore. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 Not sure this antipattern really fits with the motif of this text. 
<br><br>
 <br><br> <a name="BusySpin"></a><h2><a href="#BusySpin"><b>Busy Spin</b></a></h2><br> 
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Problem&amp;word=%20Using">Problem: Using</a> 100% of the CPU to wait for an event. 
<br><br>
 <pre>  while(1) {
    if(@queue) {
      dosomething();
    }
  }</pre>
<br><br>
 This example applies to threaded code, but non threaded code can fall prey as well: 
<br><br>
 <pre>  while(! -f $file) { }
  # do something with $file here</pre>
<br><br> Both of these examples attempt to use 100% CPU resources. In
the best case, you make everything sluggish. Worst case, you never
release the CPU so the thing you're waiting for happens. On different
systems, the results are different, too. Some threads preempt. Others
never take the CPU back until you call yield() or an IO function!
Writing code like this is the quickest way to make things work on some
systems but not others. <br><br> Using sleep() and yield() from the threads package is an
improvement. Sometimes polling is unavoidable. When you wrote the code
you're waiting on, using thread::shared::semaphore lets you easily and
efficiently communicate readiness between threads. Unix programs have
no way of being notified when a file shows up, so polling may be the
only solution: just sleep() so others can get work done. <br><br>
 <font size="+2"><b>Non-Blocking I/O</b></font><br><br>IO::Socket::INET has a <i>-&gt;blocking(0)</i>
method to disable blocking. Blocking halts the program until data is
available to read. In a program running as a daemon or server - see <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a> - that needs to service I/O on multiple channels, this is unacceptable - blocking must be disabled. 
<br><br>
 Code like this will be written: 
<br><br>
 <pre>  # this program attempts to use 100% of CPU time

  use IO::Socket::INET;
  my $sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; 'www.perl.org',
                                   PeerPort =&gt; 'http(80)',
                                   Proto    =&gt; 'tcp');
  $sock-&gt;blocking(0);

  while(1) {
    read $sock, my $buffer, 8192;
    do_something_with_data($buffer);
  }</pre>
<br><br>
 The program should sleep, waiting for data to arrive, rather than looping constantly and trying over and over again. See <a href="#SelectPollPattern"><b>Select Poll Pattern</b></a> for a solution using the <i>select()</i> call.   
<br><br>
 <font size="+2"><b>Signals to Wake By</b></font><br><br><i>sleep()</i>
and I/O operations are aborted by incoming signals, as sent from the
shell with the "kill" command or from another process using the <i>kill()</i> function on your PID. 
<br><br>
 When I/O is aborted, it returns a zero-length string, not undef. Read-loops using <i>while()</i> work correctly: 
<br><br>
 <pre>  while(&lt;$fh&gt;) {
    print;
  }</pre>
<br><br>
 This may print zero length strings sometimes, but no one will ever know. <i>while(&lt;$fh&gt;)</i> continues looping. 
<br><br>
 Sometimes you want to sleep for a fixed period, no matter what. 
<br><br>
 <pre>  my $waketime = scalar(time()) + 60*60*8.5; # longer on the weekends
  while(scalar time() &lt; $waketime) {
    sleep $waketime - scalar time(); # sleep the rest of the duration - probably
  }</pre>
<br><br>
 <a href="#DebuggingPattern"><b>Debugging Pattern</b></a> has a tiny example of dumping stack when a signal comes in.  
<br><br>
 When <i>fork()</i>ing, children send <i>CHLD</i> signals to their parent when the child dies. The parent should have a signal handler set  up to reap these: see <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a>. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#SelectPollPattern"><b>Select Poll Pattern</b></a> </li><li> <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a> </li><li> <a href="http://www.perldesignpatterns.com/?EventListeners">Event Listeners</a> </li><li> <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a> 
<br><br>

<br><br>
 <br><br> <a name="RaceCondition"></a><h2><a href="#RaceCondition"><b>Race Condition</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Multitasking
operating systems change tasks at unexpected times, such as between two
lines of the program, or half way through a statement. This creates
subtle bugs that pop up "now and then". <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Use <i>flock()</i> and semaphores to guard access to things accessed by more than one process or thread. 
<br><br>
 <font size="+2"><b>Nature of the Race Condition</b></font><br><br><hr><br><pre>  Malak tells you: wee! :-)  ok here is the question.  if i have two
  copies of a script downloading the same set of files (to make it go faster) i
  want to make sure that one script doesnt try to download the same file as the
  other.  right now i'm using a -e check to see if the file exists but im not
  sure if this will ever cause a problem if both scripts happen to hit the same
  file at the same time

  Yes, there is a race condition between the time that you test for the file
  with //-e// and when you create the file with //open()//. It could well
  happen that you test to see if the file, is there, it isn't, you go to
  open it for write and over write another process.

    if(! -e $file) {
      open my $f, '&gt;', $file;
      download($f);
    }

  You tell <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Malak&amp;word=%20yes.">Malak: yes.</a> use sysopen(). open for write but not create. if
  it returns error status, the race condition bit ya, move on to the next file

  Malak tells you: not sure if i can do that. im calling an external
  program to actually do the download...

  You tell <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Malak&amp;word=%20why">Malak: why</a> don't you use threads, then? then you can create
  a hash that is shared between all threads and use it to do locking

    use threads::shared;
    my :shared %locks;

  Malak tells you: i wonder if the race condition matters though...  
  which ever process finishes downloadig last should write the file and replace
  whatever the other file wrote, right?

  You tell <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Malak&amp;word=%20yeah">Malak: yeah</a>

  Malak tells you: i dont care if that happens, all i care about is
  that no files get corrupted, seemingly downloaded good when they arent

  You tell <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Malak&amp;word=%20actually,">Malak: actually,</a> on unix, what would happen is the same
  would be downloaded, twice, at the same time, but only one of the inodes would
  actually exist on the filesystem, so when the other processed closes its
  filehandle, the filesystem will deallocate the blocks</pre>
<br><br>
 <hr><br><font size="+2"><b>File-Access Race Conditions</b></font><br><br>Files
require coordinated access when there is any chance that multiple
processes could attempt to access the same file at the same time. It
could be two instances of the same application running (Mozilla, mutt,
gtk-gnutella), or it could be two <i>fork()</i>ed processes of the same application, or threads. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?PerlDesignPatterns">http://www.perldesignpatterns.com/?PerlDesignPatterns</a>
displays a web counter that I cooked up as a quick amusement some time
ago. It is a 1 bit animaged GIF that displays 30 iterations of Conways
Game of Life [no, not <a href="http://www.perldesignpatterns.com/?DamianConway">Damian Conway</a>] applied to the current hit number. At the time of this writing, it is at 3866. It uses <i>flock()</i>
to guard access to the "counter" file, which contains the current hit
number. Initially, I didn't bother, and every 1000 hits or so, it would
reset to 0. Ooops. Just as one process had opened the file for write
and truncated it, the other process went to read the value, and got
zero. The second process would finish after the first, and it would
increment zero to get one, and write that back. <br><br>
 All of these dire warnings apply to access to datastructures in memory, such as those using Sys::Mmap, and to <i>.dbm</i> files accessed with <i>dbmopen()</i> or a similar routine. This code depends on the fine <a href="http://www.perldesignpatterns.com/?NetPBM">Net PBM</a> package, available from <a href="http://www.acme.com/">http://www.acme.com</a> . 
<br><br> The lock should be established before reading, in cases where
a value is read, modified, then written back - cases including counters
like web counters. <br><br>
 <pre>  #!/usr/bin/perl
  
  print "Content-type: image/gif\n";
  print "<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Pragma&amp;word=%20no-cache%5Cn" ;="">Pragma: no-cache\n";</a>
  print "\n";

  my $pid = $$; # our pid, not the pid of some shell or something
  
  umask 000;
  local $ENV{PATH} = '/usr/local/bin';

  open my $f, '+&lt;', 'counter';
  flock $f, 2;
  $counter=&lt;$f&gt;;
  $counter++;
  seek $f, 0, 0;
  printf $f $counter + "\n";
  close $f;
  
  system "pbmtext $counter | pnmcrop 2&gt;/dev/null | pnmenlarge 3 &gt; counter10.$pid.pbm 2&gt;/dev/null ";
  for(my $i=10;$i&lt;30;$i++) {
    my $j = $i + 1;
    system "pbmlife counter$i.$pid.pbm &gt; counter$j.$pid.pbm 2&gt;/dev/null";
  }
  open my $gif, "ppmtogif -delay 40 -loop 100 counter??.$pid.pbm 2&gt;/dev/null|";
  while(read $gif, my $buf, 1024, 0) {
    print $buf;
  }
  close $gif;
  
  # this isn't working :(
  
  for(my $i=10;$i&lt;31;$i++) { 
    unlink "counter$i.$pid.pbm"; 
  }</pre>
<br><br>
 <i>Didn't anyone ever tell you web-page hit counters were
useless? They don't count number of hits, they're a waste of time, and
they serve only to stroke the writer's vanity. It's better to pick a
random number; they're more realistic.</i>  
<br><br>
 <i>Here's a much better web-page hit counter: </i> 
<br><br>
 <pre>           $hits = int( (time() - 850_000_000) / rand(1_000) );</pre>
<br><br>
 <i>If the count doesn't impress your friends, then the code might.  :-) </i> 
<br><br>
 - <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlfaq5">PerlDoc:perlfaq5</a> by <a href="http://www.perldesignpatterns.com/?TomChristiansen">Tom Christiansen</a> and <a href="http://www.perldesignpatterns.com/?NathanTorkington">Nathan Torkington</a> <pre>  </pre>Please
note that it's advisory. A lock only helps if everything that accesses
the file plays by the rules, which usually means that your Perl
application is the only thing using that file, and you consistently
lock the file using <i>flock()</i>.  
<br><br> When several processes are reading the current value (as it
stands at any given moment), and one process is independently
generating and storing new values, file I/O still has a race condition
where the file may be null, between the time the file is truncated and
the new data written. This also requires locking. <a href="http://www.perldesignpatterns.com/?NetPBM">Net PBM</a>
has an example of a multi-player Life game, where locking is not
needed. Single bits are modified in the Sys::Mmap 'd image during any
hit, and the current board is displayed. Since random memory access is
being used rather than file I/O, truncated files aren't a concern. SQL
engines want something like this, but the problem is far more complex.
They must use generational locks, where each "update" or "insert"
represents a generation. Only records marked at or earlier than the
current generation at the time a query is started are returned in a
query. "update" must add a new record with a newly incremented
generation number before removing the old one in order to let currently
executing queries run without garbled results. This arrangement lets
one "insert"/"update" or other write operation happen at the same time
as an arbitrary number of queries. Generational systems like this are
also used in garbage collection, to avoid race conditions between the
thread that is collecting unreferenced memory and the running program. <br><br>
 <font size="+2"><b>Thread Datastructure Race Conditions</b></font><br><br>XXX  
<br><br>
 <a href="http://www.perldesignpatterns.com/?ThreadsPattern">Threads Pattern</a> talks about using queues to move work units around. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a>, <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AccessCoherency">Access Coherency</a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlSecurity">Perl Security</a> </li><li> <a href="http://www.perldesignpatterns.com/?ThreadsPattern">Threads Pattern</a> </li><li> <a href="#BusySpin"><b>Busy Spin</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TooManyThreads">Too Many Threads</a> </li><li> <a href="#SelectPollPattern"><b>Select Poll Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DesignErrors">Design Errors</a> </li><li> <a href="#NonReenterable"><b>Non Reenterable</b></a> </li><li> <a href="#RaceCondition"><b>Race Condition</b></a> 
<br><br>

<br><br>
 <br><br> <a name="GodObject"></a><h2><a href="#GodObject"><b>God Object</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>The rule, make
things into objects so that things may have structural relationships
with each other, isn't being applied recursively as it should be. One
large object results, or one large object with several smaller objects
hung directly off of it, ignorant of each other. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Recursively
make things into objects when ever the conditions are ripe. Program
objects to delegate requests, so that objects are only dependent on the
interfaces of the objects they directly hold a reference to. This keeps
things working and makes busting out logic into a new object easier in
the future. See <a href="#LawOfDemeter"><b>Law Of Demeter</b></a>.
Complex datastructures, especially datastructures that reference each
other, should be made into objects. Move code that operates on those
datastructures into the package with the datastructure it works on.
Create methods for other objects to use to navigate from one object to
the next through the structure. This replaces code strewn around that
does complex array and hash subscripting to get at data. XXX - make an
example from this. See <a href="#MoveLargeDatastructuresToContainers"><b>Move Large Datastructures To Containers</b></a>. 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Anti-patterns
stereotype pathological, degenerate code. The God Object anti-pattern
afflicts Perl programs at a shocking rate. It is a hold over from <a href="http://www.perldesignpatterns.com/?TopDownDesign">Top Down Design</a> in procedural languages. When <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
methods are used for the wrong reasons (or atleast not for the right
reasons), a structure develops that is as fragile as the code it is
meant to replace. One single large object either contains all logic
including complex datastructures, or else it directly has references to
and knowledge of the internals of a large number of other objects. In
its stereotypical form, one "Manager" or "Controller" object creates
and holds references to numerous other objects of various types.
Objects are treated as arrays or hashes - stored by, controlled by, and
completely transparent to the code that uses them. No structure can
form between the smaller objects. It's the first trap aspiring <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programs fall into, so it's a suitable first <a href="http://www.perldesignpatterns.com/?AntiPattern">Anti Pattern</a>.  I assume that you know the basic syntax for creating objects in Perl. If not, go read the tutorial by <a href="http://www.perldesignpatterns.com/?TomChristiansen">Tom Christiansen</a> at  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perltoot">PerlDoc:perltoot</a> or see <a href="#BasicPerlOOSyntax"><b>Basic Perl OOSyntax</b></a> for a refresher. then come right back - this is the next thing you need to know. 
<br><br>
 <font size="+2"><b>Anti Patterns</b></font><br><br>[This is replicated in other parts of <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a>, but this was meant to be a stand-alone article] 
<br><br> Programming is fun. "Hacking on a program" is an expression of
the glee that comes from rapidly adding neat features to a program. <br><br> Programmers are optimisits. We assume that each feature in
the specification for a project can be added in a constant amount of
time even as the code grows, and we add each new feature just like we
added the last. In other words, that <i>programs are completed in linear time</i>.  The last half, recursively, takes twice as long. 
<br><br>
 Unchecked code growth destroys a program from the inside out.  Sure signs of unchecked growth are: 
<br><br>
 </li><li> Forced to make design comprimises.  </li><li> No obvious clean implementation for new functionality.  </li><li> Unclear consequences of adding more code.  
<br><br> Code degeneration causes lack of programmer interest, which
leads to forked Open Source projects, over budget or failed commercial
ventures, and most horrifically, loss of interest in working on a
program that used to be fun. <br><br> Reading difficult to comprehend code is work. If the quality
of the code is good, this work is rewarded. If the quality is poor, the
reader suffers the code with no joy or benefit. There are volumes full
of difficult to understand code that people willingly pour over.
Programming Pearls is one such book [Programming Pearls, by Jon
Bentley, <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200201657880">ISBN ISBN 0201657880</a>].
The readers patience in studying the algorithms is rewarded with deep
insight. Quality is difficult to put your thumb on and impossible to
quantify. Just because code is difficult to read doesn't mean it isn't
worth your time. It is our job to make it worth reading, worth keeping,
worth reusing, and worth hacking on. <br><br>
 <font size="+2"><b>God Object Anti-Pattern</b></font><br><br>Named for the conspicous centralization of control.  It is a hold over from procedural languages and top-down design.  <a href="http://www.perldesignpatterns.com/?TopDownDesign">Top Down Design</a>
states that the way to design a program is to start with a main
routine, and repeatedly break it into smaller and smaller peices until
each peice is obvious in function. The problem posed is that actions
must be explicitly sequenced by code near the main routine, even if the
program must take wildly different routes. A program designed by top
down design is in essence one huge routine that has been broken into
smaller ones. Top-down design busts up code into smaller reusable
parts, but it does nothing for creating a clean, reusable interface to
working with datastructures. <br><br> Put another way, the state of the program can be summerized
by the contents of variables (including hashes and arrays) and the
current location in the program being executed. In a proper <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
program, the state would include the network of relationships between
the objects in the system. Each object knows how to forward requests to
its neighbors, and can tell you which neighbors it has - neighbors
being other objects that it holds a reference to. There is no main
routine, as each object is autonomous. Delegating authority comes in
flavors: control of program flow, responsibility for knowing how to
retreive a data item, knowledge of a nodes place in a larger structure,
and so on. Delegating authority and propogating method calls are one
and the same idea. When a data item is stored deeply nested in a
structure, each object should do part of the work of fetching a data
item. Delegating the call to the next closest item is <i>definately</i> considered  to be doing work. 
<br><br> Other anti-patterns never farm out any data, or they contain
all code, or they have historical rather than practical boundries, or
break down encapsulation, or even suffer social influences on code. The
God Object scenario doesn't necessarily fall into any of these
pitfalls. The only required failing is that the code never lets go of
control. It is placed firmly into a position of coordinating all
events. It reads like a laundry list of actions to perform even if it
does use objects. <br><br> [Christians (and members of other religions) can argue that
God doesn't control every action in the universe, and doesn't even hand
out punishment and reward (yet). Granted. God's role in a programming
system might be closer modeled by the error catching, recovery system,
and the pre-exit clean up code, perhaps with some hooks into object
persistance, but that isn't material to this discussion.] <br><br> The God Object hoards power and is intimately involved with
every part of the program. Other situations spawning them include:
programmers preasured into using objects; management dictats objects
for the wrong reasons; each programmer on a team makes exactly one
object to contain all of their code; objects are used to look object
oriented. <br><br>
 <font size="+2"><b>Identifying the God Object in the Wild</b></font><br><br></li><li> Modules grow out of control. All of the resources are in the module, and placing code outside of it would mean exile. </li><li> Methods imply performing an action, but that action doesn't do one clear, well-defined thing.  </li><li> Internal datastructures aren't accessable from the outside, and outside code wouldn't comprehend how to use them anyway. </li><li>
Slight changes to a datastructure require large amounts of code to be
changed to match. Code to handle datastructures is spread around the
code. Or, code to handle datastructures is a function called without
the <i>-&gt;</i> syntax. </li><li> Arrays of arrays or hashes of arrays or hashes of hashes. </li><li> All resources are implicitly parts of the same object. </li><li> Knows how to get to every object in the system and how to use most of them. 
<br><br>
 [XXX each of these should be explained in some detail - maybe - maybe examples] 
<br><br>
 <font size="+2"><b>Understanding the Procedural Problem</b></font><br><br>While
collections of related data may be contained in objects, the only
useful location to place new logic in is the God Object - no other
module knows enough to track down the facilities it needs. Control
stays in the God Object, so the God Object must be included in all
operations. It, in turn, includes all other logic and data in the
system. Even when other objects are hung off of the God Object, there
is no modularity. Functionality cannot truely be split off from the
core as long as the core knows everything and controls everything. The
core is still dependent on every line of code in the program. <br><br> Worry about the the "when" aspect: when is the module in
control? Under what states, which events? What will execute before it,
what will it call, when will it return? The flow of time should make as
much sense as the flow of data. <br><br>
 <pre>  # procedural code gives exactly one possible definition for a function call - 
  # the code and data are mixed all over the place

  sub do_a { $thing-&gt;[0]++; }
  sub do_b { $thing-&gt;[1]++; }
  sub do_c { $thing-&gt;[2]++; }

  sub do_stuff {
    my $thing = shift;
    do_a($thing);
    do_b($thing);
    do_c($thing);
  }</pre>
<br><br> Because any data access methods are handled in functional way,
the data is dependent on the module and can't be returned or used
seperately. <br><br>
 I hinted at procedural code being unable to cope with changes to the way data is handled.  
<br><br>
 <pre>  sub do_a { $thing-&gt;[0]++; }
  sub do_b { $thing-&gt;[1]++; }
  sub do_c { $thing-&gt;[2]++; }

  sub do_a_neg { $thing-&gt;[0]--; }
  sub do_b_neg { $thing-&gt;[1]--; }
  sub do_c_neg { $thing-&gt;[2]--; }

  sub do_stuff {
    my $thing = shift;
    if($thing-&gt;[0] &lt; 0) {
    } else {
      do_a($thing);
    }
    do_b($thing);
    do_c($thing);
  }</pre>
<br><br>
 This is what has to be untangled [strange that we don't talk about untangling it] 
<br><br> Blessing the data structure into a package with methods
special just for it allows it to no longer be dependent on modification
routines defined in the god object. This unties the knot that keeps all
of the important code and data in one place. <br><br>
 <pre>  # object oriented code allows method calls to be defined any number of different ways -
  # the data has its own code

  package ThingOne;

  sub new { bless [], shift(); }
  sub do_a { my $thing = shift; $thing-&gt;[0]++; }
  sub do_b { my $thing = shift; $thing-&gt;[1]++; }
  sub do_c { my $thing = shift; $thing-&gt;[2]++; }

  package ThingTwo;

  sub new { bless [], shift(); }
  sub do_a { my $thing = shift; $thing-&gt;[0]--; }
  sub do_b { my $thing = shift; $thing-&gt;[1]--; }
  sub do_c { my $thing = shift; $thing-&gt;[2]--; }

  package main;

  sub do_stuff {
    my $thing = shift;
    $thing-&gt;do_a();
    $thing-&gt;do_b();
    $thing-&gt;do_c();
  } 

  my $t1 = new ThingOne();
  do_stuff($t1);

  my $t2 = new ThingTwo();
  do_stuff($t2);</pre>
<br><br>

<br><br>
 <b>Refactoring - Or, Getting From Here to There</b> 
<br><br>
 Perlers too often reserve objects for CPAN modules, and then provide exactly  one package.  
<br><br>
 Objects don't cure all of the programming worlds ills, but not knowing <i>when</i>
to use modules keeps programmers from using them. Knowing when, besides
just as a facade for CPAN modules, helps ward off the nasty stale code
syndrome. <br><br> The solution in any anti-pattern is always the same: healthy
doses of refactoring. Refactoring is the step by step process of
rearranging code and its structure, aimed at not breaking the code. Not
how, but when to refactor, is interesting. Object Oriented Design
Heuristics [Object Oriented Design Heuristics, by Arthur J. Riel, <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%20020163385X">ISBN ISBN 020163385X</a>] and <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Refactoring&amp;word=%20Improving">Refactoring: Improving</a> the Design of Existing Code  [<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Refactoring&amp;word=%20Improving">Refactoring: Improving</a> the Design of Existing Code, by Martin Fowler, <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200201485672">ISBN ISBN 0201485672</a>]
are good books on the subject [No, I'm not one of those authors that
waves my hands at books then assumes you're going to read them instead
while I talk to myself - reading the original is always worth while,
but articles like this are good enough if you're on a shoe string
budget]. Refactoring is what is all about. Anti-Patterns just match the
symptom to the cure. Anti-patterns are ultimately just case studies in
refactoring perticular flavors of degenerate code. Most required
refactoring is the same, so we will have to cover a few bases before we
get to the good stuff. I'll keep it brief. <br><br>
 <font size="+2"><b>Combine Related Variables</b></font><br><br>Groups
of related scalars require lots of typing to pass around together.
Resist the urge to keep them global for this reason - instead promote
them to be members of hash. Variables declared in a block is a good
sign. Variables with common prefixes in their names is a sure sign.
Michael Schwern first pointed out this idea. His fine talks are online
at <a href="http://www.pobox.com/%7Eschwern/talks/">http://www.pobox.com/~schwern/talks/</a> . 
<br><br>
 <pre>  my $treasure_location_x = 3;
  my $treasure_location_y = 10;
  my $treasure_value = 1000;
  my $treasure_weight = 30;

  # is better written:

  my $treasure = {};
  $treasure-&gt;{location}-&gt;{x} = 3;
  $treasure-&gt;{location}-&gt;{y} = 10;
  $treasure-&gt;{value} = 1000;
  $treasure-&gt;{weight} = 30;

  # or even:

  ($treasure-&gt;{location}-&gt;{x}, $treasure-&gt;{location}-&gt;{y}, $treasure-&gt;{value},
   $treasure-&gt;{weight}) = (3, 10, 1000, 30);</pre>
<br><br> There is almost never a time to use symbolic references.
Unless you are doing meta-muddling across modules, use hashes instead.
You can compute a hash index just as easily as a name table entry, and
two different hashes will never step on each other. <br><br>
 <pre>  ${$varname} = $value;

  # is better written:

  $table-&gt;{$varname} = $value;</pre>
<br><br>
 <font size="+2"><b>Promote References to Objects</b></font><br><br>You
may later discover that several objects are performing the same or
similar operations on this hash or array reference. Data isn't always
clearly associated with some routines and not others. This interdepency
prevents you from moving functions and their associated global data all
into one neat little isolated package. Promote the reference to an
object, and move the redundant code into this new object's package
where it can exist once and only once, accessiable by all (I'm half
serious - keep reading). <br><br> Each use of the datastructure as a plain old hash or array
should be changed to use the object accessor syntax - in an ideal
world. <br><br>
 <pre>  my @array = (1, 2, 3);
  $array[2]++;

  # all occurances of @array manually changed:

  my $array = new Array::Wrapper();     # our container for something that was an array
  my $value = $array-&gt;get_element(2); 
  $array-&gt;set_element(2, $value+1);</pre>
<br><br>
 Failing to rewrite all code that accesses this variable to use the object  oriented syntax violates I<encapsulation>.
An object encapsulates the logic about how it makes computations and
how it represents its data - the format things are stored in
internally. Having a large amount of legacy code that depends on
exactly one representation being used is a lot of momentum to shift.
Perhaps the code should be rewritten to protect the data encapsulation,
but this may not be the strongist motivating force. What if we want the
benefit of mnenomic names for the array slots, or we want to move some
code close to the data it works on? Future code can make use of the
data strucutre as an object even as legacy code continues to run. The
legacy code can be rewritten at your leisure. Don't refuse to use
objects because notions of purity insist that all old code first be
rewritten. <br><br>
 <pre>  # in your code:

  my @array;
  my $array = new Array::Wrapper(\@array);

  $array[3] = 10;     # this works
  $array-&gt;set(3, 10); # so does this

  # in Array::Wrapper.pm:

  sub new {
      my $type = shift;
      my $self = shift;
      bless $self, $type; 
  }

  sub get {
      my $self = shift;
      my $index = shift;
      return $self-&gt;[$index];
  }

  sub set {
      my $self = shift;
      my $index = shift;
      $self-&gt;[$index] = shift;
      return $self;
  }</pre>
<br><br>
 <i>Array::Wrapper::new()</i> blesses an existing array
reference into its package. The object returned and the existing array
both represent the same data: changes to one are mirrored by the other.
Subclass C<array::wrapper> and add more methods to do things specific to a given datastructure, or just copy the code and modify it. <pre>  </pre>Oregon
Health &amp; Science University holds a programming competition every
year: the International Functional Programming Competition. <a href="http://icfpcontest.cse.ogi.edu/">http://icfpcontest.cse.ogi.edu/</a>
has details. Last years competition involved writing a client
application to control a robot in a multi user maze. The robot had to
find and deliver packages, avoid water, and interact with other robots.
I got a late start, having missed a day for lack of seeing the
announcement in time, and fresh from studying object orientation, spent
two dreary sleepless days writing Perl. The code is quick, dirty, and
ugly. It was hastily written and serves as a fine example of how not to
write Perl. Mired down with a mesh of arrays, and without time to
rewrite code, I shoehored objects on top of the arrays. Reality tends
to be closer to a programming game than anything you'd call "real". <br><br>
 <pre>  # At the top of the main program:

  my @treasure;  # [x, y, bot, weight, destx, desty]

  # Logic that generates a status report with map, written before I knew what 
  # I was getting into:

  foreach my $i (grep {ref $_} @treasure)  { 
    push @objs, [$i-&gt;[0], $i-&gt;[1], 't'] unless $i-&gt;[2];
  }

  # In logic that reads updates from server, I was overcome with complexity,
  # created a helpful wrapper, and blessed my array into it:

  my $treasure = new Treasure::Chest(\@treasure) or die;

  # ... later in same area... 
 
  $treasure-&gt;get($t)-&gt;set_bot($bots[$curbot]);

  # In logic that considers possible actions:

  foreach my $i ($treasure-&gt;by_bot($bot)) {
      my $dropoff = $i-&gt;get_dropoff();
      my @coords = ($bot-&gt;[0], $bot-&gt;[1], $dropoff-&gt;x(), $dropoff-&gt;y());
      my $route = [$dropoff, sub { plot_route(@coords) }, undef ];
      $route-&gt;[2] = approx_cost(@coords);
      $route-&gt;[2] -= 100 if($cap &lt; $carry / 2);
      $route-&gt;[2] -= 100 if($cap &lt; $carry / 3);
      $route-&gt;[2] -= 100 if($cap &lt; $carry / 4);
      push @routes, $route;
  };

  # In another possible action agent:

  @goodies = SortPackages::go(
      $treasure, $blockbuilder, $carry-$bot-&gt;[2], $bot-&gt;[0], $bot-&gt;[1]
  );

  # Deliver everything destined for this spot:

  foreach my $i ($treasure-&gt;by_bot($bot)) {
    if($i-&gt;destx == $bot-&gt;[0] and $i-&gt;desty == $bot-&gt;[1]) {
      my $id = $i-&gt;id();
      return [90, sub {
          $treasure-&gt;zero($id);
          "1 Drop $id"   
      }];
    }
  }</pre>
<br><br>
 [XXX rewrite this mixed bag as a consistent OO example of going back and polishing the code if so desired] 
<br><br> Don't try too hard to understand the code. It is hallow. It
smells of chaos. Reality is actually much worse. Several other
datastructures got the same treatment, and they all referenced each
other. The <i>@treasure</i> and <i>$treasure[]</i> syntax was used initially. Later, <i>$treasure-&gt;x</i> and other method calls became the prefered way to access data. <i>$treasure-&gt;by_bot()</i>
was perticularly helpful, as it moved into the object logic that had
been repeated all over the program, or atleast prevented the logic from
having to be repeated any further. <br><br>
 <pre>  my $treasure = new Treasure::Chest(\@treasure) or die;</pre>
<br><br>
 ... is the heart of this trick. An object is a blessed reference. <i>@treasure</i> can't be blessed because it isn't a reference. We, can, however take a reference to that. We could say <i>bless \@treasure, Treasure::Chest</i>, but it is better to leave those details to <i>Treasure::Chest</i> itself. We just pass the array off there for blessing and immediate return. 
<br><br>
 <i>$treasure</i> and <i>@treasure</i> describe the exact
same data, but with two different interfaces: a complex datastructure,
and a clean mnenompic object style interface. <br><br>
 See <a href="#MoveLargeDatastructuresToContainers"><b>Move Large Datastructures To Containers</b></a> for more. 
<br><br>
 <font size="+2"><b>Whole Object or Custom Crafted Request?</b></font><br><br>Isolated
bits of information from different collections being passed to another
object presents a delimia: do you pass all of the numerous required
hash and array references, or do you first extract the needed values
and pass those directly? <br><br>
 <pre>  $fooLogic-&gt;doAnotherThing($stuff, $morestuff);
  # or...
  $fooLogic-&gt;doAnotherThing($stuff-&gt;{some_thing}, $morestuff-&gt;{some_other_thing});

  $blockbuilder-&gt;plot_route($bot, $i);
  # or...
  $blockbuilder-&gt;plot_route($bot-&gt;[0], $bot-&gt;[1], $i-&gt;[0], $i-&gt;[1]);

  # or a mixture...
  @goodies = SortPackages::go(
    $treasure, $blockbuilder, $carry-$bot-&gt;[2], $bot-&gt;[0], $bot-&gt;[1]
  );</pre>
<br><br> Go with your instricts, but be prepaired to change your mind
later. To paraphrase Arthur Riel, sometimes awkward interfaces are new
abstractions waiting to be discovered. Large numbers of seemingly
unreleated things passed together might suggest some unseen
relationship that can be used to further organize the data. Don't sweat
it though. <br><br>
 See <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> for more. 
<br><br>
 <b>Delegate - Migrate Functionality out of Core</b>  
<br><br> Start moving methods out, one by one, into another object.
Organize them however seems best at first - you'll learn otherwise
later and have to move stuff again, but at least then it'll be much
easier to move stuff. Each function you move out, replace it with a
stub function. This stub function turns the function call into a method
call into another object. Kicking requests off to another object is
called delegation - the object we're kicking them to is the delegate.
Our stub method will pass as much data as it needs to, which will be
all of the data passed to it plus possibly some global data as well.
Pass the data refences to whichever object wants them. At first, you
might be sending around several large, unrelated hash references. Many
things will need to go multiple places, so for now, they will need to
continue to live in the God Object. <br><br>
 <pre>  # other functions in the god object still think plot_route() is a local
  # function rather than a method in another object

  sub plot_route {
    my $sx = shift; my $sy = shift;
    my $fx = shift; my $fy = shift;
    # logic moved into $blockbuilder object
    return $blockbuilder-&gt;plot_route($sx, $sy, $fx, $fy);
  } </pre>
<br><br> Perl throws a monkey wrench into the works with the
requirement that object instance data (data that is independent from
one object of that type to another) be accessed with a funky syntax.
This effectively prevents cutting and pasting code out from the former
God Object into a clean, new object. <br><br>
 <pre>  # square foo when foo is a regular variable:
  $foo = $foo * $foo; 

  # square foo when foo is an object instance variable:
  $this-&gt;{'foo'} = $this-&gt;{'foo'} * this-&gt;{'foo'}; </pre>
<br><br>
 See Alias.pm or <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>.pm on CPAN, or live on the wild side of life (syntactically speaking) and make your own alias for <i>$foo</i>: 
<br><br>
 <pre>  sub setvalue {
    no strict 'refs';
    my $this = shift;
    local *foo = \$this-&gt;{foo};

    $foo = $foo * $foo;
  }</pre>
<br><br>
 Don't tell anyone you got this from me, what ever you do. I'd never hear the end of it. 
<br><br>
 See <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> for more. 
<br><br>
 <font size="+2"><b>Migrate Data Containment to Objects</b></font><br><br>The
God Object will eventually contain nothing but some core logic,
declaration of datastructures and these delegations - good! <br><br> Think for a moment of an object as an array element: there
are many of them to pick from for, and each has different data in it.
Several independent instances of an object can exist at once, each with
different values for its instance variables. <br><br> Reduce how much of this mess of data we have to pass around
by picking out data items that should be sent to a only once to a
sub-object. Simply make the hash or array reference permentaly visible
to the object at the time that the object is created. <br><br>
 <pre>  sub new {
      my $class = shift;
      my $hashref = shift;
      my $self = { 
          foo =&gt; 'bar',
          num =&gt; 10,
          hashref =&gt; $hashref,
      }; 
      bless $self, $class;
  }

  sub dog_years {
      my $self = shift;
      my $age = shift;
      # no need to take $hashref as an argument, we have it stashed in $self
      return $age * $self-&gt;{hashref}-&gt;{'dog_factor'};
  }</pre>
<br><br> This hash or array reference will be passed to the constructor
call of that object. It will be passed exactly once instead of for
every call into that object. This is not always the good and correct
thing to do - when not frequently used by that object, it is best to
pass data only when it is needed. <br><br> The art is limiting the scope of data - where it can be seen
at. If the scope is too narrow, you spend too much effort passing it
around. If the scope is too broad, it isn't clear how the data gets
around. If the data gets around everywhere, and it has far too close of
relationship with all of the objects, God would be displeased. <br><br> Data that is clearly only used in one object can be created
in that object and live there. Rather than creating the data object in
our former God Object and passing it to the constructor of our new
object, we need only define it in the constructor of the new object
itself. <br><br>
 <pre>  sub new {
      my $class = shift;
      my %options = @_;
      my $self = {
          foo =&gt; 'bar',
          num =&gt; 10,
          thing =&gt; $options{'thing'},
      };
      bless $self, $class;
  }</pre>
<br><br>
 See <a href="#MoveLargeDatastructuresToContainers"><b>Move Large Datastructures To Containers</b></a> for more. 
<br><br>
 <font size="+2"><b>Godless Objects</b></font><br><br>Objects
given enough state information, or the means to track it down, can be
returned and used without the God Object involved. The code is modular
when this is acheived. <br><br>
 <pre>  # which bot is holding treasure $x, if any?
  $treasure = $treasure_chest-&gt;get($x)-&gt;bot();  

  # which map region is bot $green standing on?
  $block = $block_builder-&gt;bounded_by($bots-&gt;get($green)-&gt;x(), $bot-&gt;get($green)-&gt;y());

  # what objects stand between us and where we want to be?
  @route = $block-&gt;solve_maze($x, $y);</pre>
<br><br>
 Build healthy relationships between objects: 
<br><br>
 </array::wrapper></encapsulation></li><li> The fields of an
object should be related to each other and support a single coherent
idea. [Composition is delegation - if you must create an object made of
several simplier things, delegate to them]. </li><li> Query objects directly to find the answer or find the object that knows the answer. </li><li> Return only an object of the required type. All of the rest of the code is then dissinvolved. </li><li> A single object may know about many objects if it has a relationship with them - but only then. </li><li> An Object can perform operations that require the help of other objects because it knows where to find them. 
<br><br> Since the object is now stand-alone, compatable objects that
provide different features can be created and used in their place - the
code is attached to the data - this is the beginning of polymorphism.
Polymorphism is what we really want, because it lets us use objects as
abstrctions, which is what they really are. True polymorphism is still
a ways off, but we're much closer now. See <a href="http://www.perldesignpatterns.com/?PolymorphismConcept">Polymorphism Concept</a>. 
<br><br>
 [XXX more of a case study of the reformed object - the above long snippit in moving data out to be rewritten and place here] 
<br><br>
 <hr><br><!-- Feedback from brian d foy to integrate: i read this the other night, and there is a lot of things going on in the article :) 
<br><br>
 i see several ways to go with this, and several articles that it might turn into.  don't' worry about the meatiness---say as much as you need to say.  if the article is really short, no worries (although example code tends to strech things out). 
<br><br>
 <ul><li> focus on the God Object---how a program ends up with a good
object, what a God object does, the consequences it has, and so on without
talking about refactoring necessarily.  after that discussion, you could
present a case study with a new design (without refactoring---just
starting over).  this is the one i'm excited about :)
</ul> there is no such thing as an anti-pattern that doesn't prescribe refactoring =) 
<br><br>
 <ul><li> forget about the anti-pattern angle and focus on the refactoring
(which is most of the article right now).  this could be an intermediate
to advanced level article.
</ul> hooks into doing refactorings as future articles? 
<br><br>
 <ul><li> i'm not excited about Alias and <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>, but the examples
with $treasure_foo going into a hash are really good.  i'd like to see a
lot of really simple things that beginners can understand. this would be a
beginner to intermediate level article.
</ul> --> 
<br><br>
 c2 wiki - 
<br><br>
 The "God Class" problem is described on page 32 of Arthur Reihl's excellent "Object-Oriented Design Heuristics" <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200-201-63385-X">ISBN ISBN 0-201-63385-X</a> . A "God class" is an object that controls a bunch of other objects in the system. It is a form of the Mediator Pattern<a href="http://www.perldesignpatterns.com/?MediatorPattern">+</a>, misapplied.  
<br><br>
 <hr><br><font size="+2"><b>Not An Object</b></font><br><br>[this should probably go much further down, after we've refactored code - it can be congradulatory] 
<br><br> [XXX - probably not the right place for this disucssion] CPAN
modules provide a simple, clean interface for using them - this is what
an abstraction is. You tell it what you want done, without worrying
about how - how exists in the abstract realm. More generally, an
abstraction is a layer between two parts to seperate the interface from
the implementation. Abstracting things conflicts with the top-down
mentality of control. One constant fixed peice of code is invoked
directly - the implementation. There is [all of this would be much
better illustrated with code] no chance to handle a request for a kind
of thing in a different way - everything is always handled the same
way, unless if statements are peppered through the entire program
listing at every turn the various ways it might be handled -
continueing to tie the program to the implementation. [place this
somewhere: objects don't just tie data and code together - well, they
do, but that description freezes the brain. objects give generic
options that can be used on a certain kind of datastructure, including
navigating the datastructure to find other objects. OO features of the
language make this easier and more natural, but aren't required,
strictly speaking. object style code is written in C for large projects
like the linux kernel and postgres database. every structure has a
suite of routines that minipulate it and transverse it and do
operations on it. the routines are specific to that datastructure. XXX
some toy examples of this without breaking out functions into objects
would rock - removing the part of a function that is dependent on the
structure of the datastructure out into a function that only
understands the structure and nothing else, then defining functions
that know how to perform operations on that structure - the first
routine is very hands off, non god-objecty, and doesn't know how the
task is to be done, only requests which task. explain "knows how to" -
its special. if something know how to do something, it has dependencies
built into it - these dependencies are a special feature of this code
because they don't exist anywhere else. if a whole program "knows how"
to access a datastructure, it is a bad thing. knowledge of personal,
sensitive matters belongs only in trusted hands. ] <br><br>
 <font size="+2"><b>Todo</b></font><br><br>Perhaps move the Oregon blurb near the top to give context to the examples - a robot collecting treasure.<br> 
<br><br>
 <hr><br><font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#SpaghettiCode"><b>Spaghetti Code</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a> </li><li> <a href="http://www.perldesignpatterns.com/?ExportingFunctionsLexicallyBoundToData">Exporting Functions Lexically Bound To Data</a> </li><li> <a href="#MoveCollectionsOfFunctionsToObjects"><b>Move Collections Of Functions To Objects</b></a> </li><li> <a href="#MoveLargeDatastructuresToContainers"><b>Move Large Datastructures To Containers</b></a>  </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?GodObjectProposal">God Object Proposal</a> </li><li> <a href="http://www.perldesignpatterns.com/?SharedData">Shared Data</a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="#SoftrefsToHash"><b>Softrefs To Hash</b></a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/lazyLoad.html">http://www.martinfowler.com/eaaCatalog/lazyLoad.html</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=85769">PerlMonks:85769</a> - references to array elements using slices and references </li><li> <a href="#SelfJoiningData"><b>Self Joining Data</b></a> 
<br><br>

<br><br>
 <font size="+2"><b>Comments</b></font><br><br>On the other hand, I might turn <a href="#GodObject"><b>God Object</b></a> into an appendix, since
 the problem is so prolific in Perl code - you could almost call it
 a "CPAN syndrome", where someone decides to OO, usually for the
 wrong reason, and makes one giant object. I guess you could say
 OO could be applied recurisvely. Still, a lot of the refactoring
 stuff should be moved. - <a href="#ScottWalters"><b>Scott Walters</b></a>
 <pre> - //Wed Aug 20 23:51:24 2003 216.190.249.110//</pre>
<br><br>
 <!-- cut - end comments --> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perlmonks.com/index.pl?parent=264874&amp;title=module%20advice&amp;lastnode_id=264874&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on">http://www.perlmonks.com/index.pl?parent=264874&amp;title=module%20advice&amp;lastnode_id=264874&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=264874">http://www.perlmonks.com/index.pl?node_id=264874</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=264874">http://perlmonks.org/index.pl?node_id=264874</a> </li><li> <a href="http://www.perlmonks.org/index.pl">http://www.perlmonks.org/index.pl</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=264874">http://www.perlmonks.org/index.pl?node_id=264874</a> </li><li> <a href="http://perlmonks.com/index.pl?node_id=264874">http://perlmonks.com/index.pl?node_id=264874</a> </li><li> <a href="http://phoenix.pm.org/wiki/assemble.cgi?PerlProjects">http://phoenix.pm.org/wiki/assemble.cgi?PerlProjects</a> </li><li> <a href="http://64.4.22.250/cgi-bin/linkrd?_lang=EN&amp;lah=e7f40c9e0d645c47d390069aaba03c22&amp;lat=1057548851&amp;hm___action=http%3a%2f%2fperldesignpatterns%2ecom%2f%3fGodObject">http://64.4.22.250/cgi-bin/linkrd?_lang=EN&amp;lah=e7f40c9e0d645c47d390069aaba03c22&amp;lat=1057548851&amp;hm___action=http%3a%2f%2fperldesignpatterns%2ecom%2f%3fGodObject</a> </li><li> <a href="http://perlmonks.com/index.pl?node_id=278729">http://perlmonks.com/index.pl?node_id=278729</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=278375">http://www.perlmonks.com/index.pl?node_id=278375</a> 
<br><br>
 <br><br> <a name="ObjectOrgy"></a><h2><a href="#ObjectOrgy"><b>Object Orgy</b></a></h2><br> 
<br><br>

<br><br>
 Not using encapsulation.  
<br><br>
 <i>Absence of data encapsulation. The data members may be
public (or might as well be because they are exposed to the world
through getters and setters), or the objects may hold references to
each other. In any case the objects do more tweaking of the other
objects data than their own, with ensuing confusion about who did what
to whom when.</i> - C2 <a href="#ObjectOrgy"><b>Object Orgy</b></a> 
<br><br> Have you ever attempted to disassemble a mechanical stopwatch?
While most aren't as bad, many things share one interesting trait: upon
removing the back cover, tiny springs, gears, cogs, plates, shafts,
sprockets, ratchets and dozens of unidentifiable pieces literally fly
out. The sensation of hopelessness is matched only by a programmer
assigned to make changes to a program designed to work exactly one and
never be changed. Building anew is far more likely than ever picking
the pieces up. <br><br> It is true that at some point things must be hardcoded. It
is expected that at the very top level many objects will be created,
and most passed to the constructors of others. An object shouldn't
assume the right to muck with the internals of another object, much
less assume its existence in the first place. Create objects at the top
level of a program, package, or class, where ever the scope is above
where the object is used, but not so far up it clutters an unrelated
space. Pass it down via constructors. Objects will be told about the
presence of each other in an organized way, and the flow of references
will be traceable. <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PassingPattern"><b>Passing Pattern</b></a> </li><li> <a href="#BigBallOfMud"><b>Big Ball Of Mud</b></a> </li><li> <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> 
<br><br>

<br><br>
 <br><br> <a name="FeatureEnvy"></a><h2><a href="#FeatureEnvy"><b>Feature Envy</b></a></h2><br> 
<br><br>

<br><br>
 <i>The whole point of objects is that they are a technique to package data with</i>  <i>the processes used on that data. A classic [code] smell is a method that seems </i> <i>more interested in a class other than the one it is in. The most common focus </i> <i>of the envy is the data.</i> - Fowler, <a href="http://www.perldesignpatterns.com/?RefactoringImprovingtheDesignofExistingCode">Refactoring Improvingthe Designof Existing Code</a>, Chap. 3, p. 80. 
<br><br> Placing code near the data it references, even if
responsibility must be divided, is a first step. Value objects are of
course an exception: see Class::Struct. When two objects do talk to
each, let them do so through interfaces. The act of writing an
interface will give you mental pause to consider whether or not it is a
reasonable interface to access that object by. It shouldn't give up too
much encapsulation, and the methods should reflect the purpose of the
object. <br><br>
 <i>... a method that seems more interested in a class than the one its in..</i> - <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=FeatureEnvy">WikiWiki:FeatureEnvy</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=FeatureEnvy">WikiWiki:FeatureEnvy</a> </li><li> <a href="#GodObject"><b>God Object</b></a> 
<br><br>

<br><br>
 <br><br> <a name="EmptySubclassFailure"></a><h2><a href="#EmptySubclassFailure"><b>Empty Subclass Failure</b></a></h2><br> 
<br><br>

<br><br> "Does your module pass the 'empty subclass' test? If you say
@SUBCLASS::ISA = qw(YOURCLASS); your applications should be able to use
SUBCLASS in exactly the same way as YOURCLASS. For example, does your
application still work if you change: $obj = new YOURCLASS; into: $obj
= new SUBCLASS; ? Avoid class name tests like: die "Invalid" unless ref
$ref eq 'FOO'. Generally you can delete the eq 'FOO' part with no harm
at all. Let the objects look after themselves! Generally, avoid
hard-wired class names as far as possible. Exports pollute the
namespace of the module user. If you must export try to use @EXPORT_OK
in preference to @EXPORT and avoid short or common names to reduce the
risk of name clashes." -- perlmodlib manpage <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#CreatingCPANModules"><b>Creating CPANModules</b></a> </li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://scarecrow.fmrp.usp.br/%7Emavcunha/public/anti-patterns.php">http://scarecrow.fmrp.usp.br/~mavcunha/public/anti-patterns.php</a> 
<br><br>
 <br><br> <a name="CheckingTypeInsteadOfMembership"></a><h2><a href="#CheckingTypeInsteadOfMembership"><b>Checking Type Instead Of Membership</b></a></h2><br> 
<br><br>

<br><br>
 This is a special case of <a href="http://www.perldesignpatterns.com/?VoodooChickenCoding">Voodoo Chicken Coding</a> that happens as a result of misguided  <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
zeal. Usually, all you want from an object is a Contract that they can
fill a role. It doesn't matter if they inherited the ability or if they
are the Base Class. Checking a callers package using ref() is the
correct thing for the very rare cases where you won't accept anything
but an instance of the base class itself. In all other cases, you want
-&gt;isa(). Failing to use -&gt;isa() when appropriate is essentially
confusing "protected" with "private". This is one case of the "Empty
Subclass Text". <br><br>
 <hr><br>Does your module pass the 'empty subclass' test? If you say <i>@SUBCLASS::ISA = qw(YOURCLASS);</i>  your applications should be able to use <i>SUBCLASS</i> in exactly the same way as <i>YOURCLASS</i>.  For example, does your application still work if you change: <i>$obj = new YOURCLASS</i>;  into: <i>$obj = new SUBCLASS;</i> ? 
<br><br>
 Avoid class name tests like: <i>die "Invalid" unless ref $ref eq 'FOO'</i>.
Generally you can delete the eq 'FOO' part with no harm at all. Let the
objects look after themselves! Generally, avoid hard-wired class names
as far as possible. <br><br>
 - from <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlmodlib">PerlDoc:perlmodlib</a> 
<br><br>
 <hr><br><a href="#TypeSafety"><b>Type Safety</b></a> argues that <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>
should be installed, so that type can be verified. Since type is being
verified, not class, we're happy with anything derived from a base
class, or even just implementing the features (interface) of that class
or <a href="#AbstractClass"><b>Abstract Class</b></a>. To test type instead of class, do: 
<br><br>
 <pre>  die "Invalid" unless $obj-&gt;isa('FOO');</pre>
<br><br>
 This will let <i>BAR</i>s by, if <i>BAR</i> inherits from <i>FOO</i>, or if <i>FOO</i> is an <a href="#AbstractClass"><b>Abstract Class</b></a> that <i>BAR</i>
implements. It is much more forgiving, and it correctly handles the
idea that types are complex structures, composed of other types. <br><br>
 <hr><br><font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <br><br> <a name="ExplicitTypeCaseAnalysis"></a><h2><a href="#ExplicitTypeCaseAnalysis"><b>Explicit Type Case Analysis</b></a></h2><br> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?ConditionalElimination">Conditional Elimination</a>
teaches us that we should implement varied behavior by putting the
behavior in side of objects and mixing and matching the objects.
Explicitly testing the type of an object is a form of this. Motivation
for resorting to this kind of cheesy coding boils down to capabilities:
some objects have some capabilities while others dont. There are a few
options: <br><br>
 </li><li> Factor out <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Handler&amp;word=%20If">Handler: If</a> there is logic that is common to some objects but not others, and you don't want to use <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a>,
create a seperate object that contains that logic. Store a reference to
it in objects that have that ability, and store a reference to another
similar object that defines the same interface but does little or
nothing. Like <a href="#VisitorPattern"><b>Visitor Pattern</b></a> in
that an external object contains the logic for minipulating the various
subclasses of another object. However, we add multiple visitor-like
things, and our various subclasses have hardcoded references to the
visitor-like thing that knows how to work on it. Minipulating an object
involves querying the handler from the object, and then calling the
correct method in it, passing it the object once again: <br><br>
 <pre>  my $appointment = $sunday-&gt;query_scheduler()-&gt;schedule_appointment($sunday, '9:00am');
  if(!$appointment) {
    warn "failed to book appointment. sorry, boss.";
  }</pre>
<br><br>
 </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=MarkerInterface&amp;word=%20Use">MarkerInterface: Use</a>
explicit cases to detect if a given interface is implemented by the
class. This uses inheritance as a sort of capability marker. Then, the
only test that needs to be made is the <i>-&gt;isa()</i> test to see if the object has the capability. See <a href="#AbstractClass"><b>Abstract Class</b></a>. This is like <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a>, but keeps the door to delegation open. 
<br><br>
 </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=VisitorPattern&amp;word=%20If">VisitorPattern: If</a>
you must do explicit type case analysis, confine it to one place.
Create an object that knows what to do with it. Normally a Visitor
doesn't violate the public API of a class, but if you're going to sin
this sin, thats where to do it. <br><br>
 </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=MixIns&amp;word=%20Compose">MixIns: Compose</a> the object of bits and pieices through inheritance. See Class::Sex. 
<br><br>
 Very genereally speaking: 
<br><br>
 </li><li> If two or more classes share only common data, not
behavior, that data should be placed in a container class that will be
inherited by both. </li><li> If two or more classes have common data
and behavior, they should inherit from a common subclass which in turns
inherits an abstract interface. </li><li> If two classes share a common interface, they should inherit from a common empty base class polymorpth. </li><li> Any time a feature is shared, move it up as high in the inheritance hierachy as  is useful.  </li><li> If objects have one of many differing implementations of one set of features, implement the features in a subclass. </li><li>
If objects differing implements from several different sets of
features, delegate the different sets of features to different objects,
where each delegate object knows how to implement one set of features. <br><br>
 <font size="+2"><b>Credits</b></font><br><br><a href="http://www.perldesignpatterns.com/?ObjectOrientedDesignHeuristics">Object Oriented Design Heuristics</a> 5.12 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?ConditionalElimination">Conditional Elimination</a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#CompositePattern"><b>Composite Pattern</b></a> 
<br><br>

<br><br>
 <br><br> <a name="AccumulateAndFire"></a><h2><a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a></h2><br> 
<br><br>

<br><br> Setting a number of values then invoking the method that uses
the data is a sign of a problem. Race conditions could emerge. Old
state could persist too long. The context the method is used in is
unclear, as is the context its variables are set in. Instead, consider
passing a value object, or moving the accumulation into a value
object-facade combination. Also consider turning the object into a
Value Object and passing it to a Visitor Object to perform the action. <br><br> An object often isn't the best place to store transient data
like this as it may be left in an inconsistent state. The global nature
of it can cause <a href="#ActionAtADistance"><b>Action At ADistance</b></a> problems, just as having a large number of globals can. 
<br><br>
 XXX - example code! 
<br><br>
 <i><b>Reduce preconditions</b> - Code which is very
persnickity about how it's invoked makes everything else harder to
maintain. Examples are requiring that methods be called in a certain
order, and requiring that a certain method be called only once. Try to
avoid those.</i> -- Bram, <a href="http://advogato.com/article/258.html">http://advogato.com/article/258.html</a>  
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#TooManyArguments"><b>Too Many Arguments</b></a> </li><li> <a href="#RaceCondition"><b>Race Condition</b></a> </li><li> <a href="#CurryingConcept"><b>Currying Concept</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="#ActionAtADistance"><b>Action At ADistance</b></a> </li><li> <a href="http://advogato.com/article/258.html">http://advogato.com/article/258.html</a> 
<br><br>
 <br><br> <a name="ActionAtADistance"></a><h2><a href="#ActionAtADistance"><b>Action At ADistance</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Someone is
doing something at the wrong time, or stomping on something they
shouldn't. Problem is, there is no way to track down who or where.
Local data isn't local, instance data isn't inside an object instance.
Side effects from innocent actions are putting the program in an
unknown state. Less innocently, communication may be intentionally
going through channels, such as namespaces, that are public by nature. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Decide who
should be talking to whom. Move communications to events or queues
rather than shaded state. Using events, if some unexpected happens,
everyone knows right away, because they have a chance to check values
and react immediately. Using queues, at least everyone knows which way
the data is flowing. <br><br> From physics, where particles may be created that cancel
each other out - such particles instantianiously communicate
information across space reguardless of distance in what Albert Einstien<a href="http://www.perldesignpatterns.com/?AlbertEinstien">+</a> called "spooky action at a distance". 
<br><br>
 From <a href="http://www.perl.com/pub/a/1999/11/sins.html">http://www.perl.com/pub/a/1999/11/sins.html</a> - 11 deadly sins of Perl by  <a href="http://www.perldesignpatterns.com/?MarkJasonDominus">Mark Jason Dominus</a>: 
<br><br>
 <i>Array indices normally begin at 0 because the value of $[
is normally 0; if you set $[ to 1, then arrays start at 1, which makes
Fortran programmers happy, and so we see examples like this in the
perl3 man page:// </i>
<br><br>
 <pre>        foreach $num ($[ .. $#entry) {
          print "  $num\t'",$entry[$num],"'\n";
        }</pre>
<br><br>
 <i>And of course you could set $[ to 17 to have arrays start
at 17 instead of at 0 or 1. This was a great way to sabotage module
authors.</i> 
<br><br>
 <i>Fortunately, sanity prevailed. These features are now
recognized to have been mistakes. The perl5-porters mailing list now
has a catchphrase for such features: they're called `action at a
distance'. The principle is that a declaration in one part of the
program shouldn't drastically and invisibly alter the behavior of some
other part of the program. Some of the old action-at-a-distance
features have been reworked into safer versions. For example, In Perl
5, you are not supposed to use $*. Instead, you put /m on the end of
the match operator to say that the meanings of ^ and $ should be
changed just for that one regex.</i> - <a href="http://oreilly.com/">http://oreilly.com</a> 
<br><br>
 <font size="+2"><b>Catching Action at a Distance in Scalars</b></font><br><br><pre>  package WhineyScalar;
  
  sub new { tie $_[1], $_[0]; }

  sub TIESCALAR {
    bless \my $a, shift;
  }

  sub FETCH {
    my $me = shift;
    $$me;
  }

  sub STORE {
    my $me = shift;
    my $oldval = $$me;
    $$me = shift;
    (my $package, my $filename, my $line) = caller; 
    print STDERR "value changed from $oldval to $$me at ", join ' ', $package, $filename, $line, "\n";
  }

  1;</pre>
<br><br>
 [XXX untested code] 
<br><br>
 Use this with: 
<br><br>
 <pre>  use WhineyScalar;
  new WhineyScalar my $foo;
  $foo = 30;  # this generates diagnostic output
  print $foo, "\n";
  $foo++;     # this generates diagnostic output
  </pre>Using <i>tie</i>
on a scalar, we can intercept attempts to store data, and generate
diagnostics to help us track down what unexpected sequence of events is
taking place. <br><br>
 <font size="+2"><b>Queues</b></font><br><br>[Todo XXX queue example in threaded and non-threaded programs.] 
<br><br>
 <font size="+2"><b>Action at a Distance Across Objects</b></font><br><br>The <a href="#LawOfDemeter"><b>Law Of Demeter</b></a>
states that objects should only diddle other objects near itself.
Should action in a distant part of the system be required, the message
should be propogated. This minimizes impact of changes to a program. <br><br>
 Preasure to create an <a href="#ObjectOrgy"><b>Object Orgy</b></a> arises from poor interface design, perhaps  taking the form of a <a href="#GodObject"><b>God Object</b></a>, not implementing <a href="#MoveCollectionsOfFunctionsToObjects"><b>Move Collections Of Functions To Objects</b></a>, or failing to heed the <a href="#LawOfDemeter"><b>Law Of Demeter</b></a>. 
<br><br>
 <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a> situations, where  should be replaced with a <a href="#CommandObject"><b>Command Object</b></a> or <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> arrangement, or a <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a> configuration. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> </li><li> <a href="#LooseCoupling"><b>Loose Coupling</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="#LocalVariablesReplaceGlobalVariables"><b>Local Variables Replace Global Variables</b></a> </li><li> Tie::Scalar  </li><li> <a href="http://www.perldesignpatterns.com/?FakingAccessorsUsingTiedData">Faking Accessors Using Tied Data</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perltie">PerlDoc:perltie</a> </li><li> <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a> </li><li> <a href="#ObjectOrgy"><b>Object Orgy</b></a> </li><li> <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> <a href="#GodObject"><b>God Object</b></a> 
<br><br>

<br><br>
 <br><br> <a name="InterfaceBloat"></a><h2><a href="#InterfaceBloat"><b>Interface Bloat</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>We've moved things up to the superclass where they are most useful, but now our interfaces are intolerably bloated. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br></li><li>
Create a new class to serve as a wrapper around it. Do the tedious work
there, and don't provide any method to do low level tasks. See <a href="#FacadePattern"><b>Facade Pattern</b></a>. </li><li> Factor out like logic and delegate it to another object. See <a href="#CompositePattern"><b>Composite Pattern</b></a>. </li><li>
Create different objects based on user critera, each object having a
different implementation but perhaps common base class. See <a href="#FactoryObject"><b>Factory Object</b></a>. </li><li> Fake accessors and handle missing accessors gracefully. See <a href="http://www.perldesignpatterns.com/?FakingAccessorsUsingAutoload">Faking Accessors Using Autoload</a>. </li><li>
Create a generic, catch-all or broad-usage methods. Pass the request
encoded as a string or object describing which action to take, along
with its arguments. Allow the object to delegate as needed, or just
handle whichever it happens to know how to. See <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a>. </li><li> Give up and use <i>-&gt;can('foo')</i> before ever calling <i>-&gt;foo()</i> to make sure that <i>foo()</i>
is a defined method for that given object. The contract laid down by
this interface would mere be that many functions may or may not exist.
Code that uses the object must be ware. <br><br>
 <a href="#StateVsClass"><b>State Vs Class</b></a> tells us
to allow objects to handle methods differently depending on their
state, rather than demand that every possibily behavior be exhibited by
a seperate object, an ultimately impossible proposition. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#CompositePattern"><b>Composite Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?FakingAccessorsUsingAutoload">Faking Accessors Using Autoload</a> </li><li> <a href="#ClassAsTypeCode"><b>Class As Type Code</b></a> </li><li> Class Vs State<a href="http://www.perldesignpatterns.com/?ClassVsState">+</a> </li><li> <a href="http://www.perldesignpatterns.com/?FactoryMethod">Factory Method</a> </li><li> <a href="#FacadePattern"><b>Facade Pattern</b></a> 
<br><br>
 <br><br> <a name="FatCommands"></a><h2><a href="#FatCommands"><b>Fat Commands</b></a></h2><br> 
<br><br> Controller logic creeps in to something that should be pure
state. When sending a message, you shouldn't be explaining how to
interpret the message. The point of a command object is to establish a
common language. If you're using the same abstraction to separate code,
you're asking too much of the abstraction. Make an extensible command
language: turn your base Command Object into an Abstract Class, and use
a <a href="http://www.perldesignpatterns.com/?PublisherSubscriber">Publisher Subscriber</a>
model to dispense the commands to listeners that may or may not know
how to deal with various subtypes. Rather than putting logic in the
Command Object directly, let it contain Visitor Objects that were for
some reason previously selected to do operations on that Command
Object. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?PublisherSubscriber">Publisher Subscriber</a> </li><li> <a href="http://www.perldesignpatterns.com/?DectoratorPattern">Dectorator Pattern</a> </li><li> <a href="#CommandObject"><b>Command Object</b></a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#VisitorPattern"><b>Visitor Pattern</b></a> 
<br><br>

<br><br>
 <br><br> <a name="HardcodesAreEvil"></a><h2><a href="#HardcodesAreEvil"><b>Hardcodes Are Evil</b></a></h2><br> 
<br><br>

<br><br> "Hardcodes are dirty" is an oft recited mantra. Unable to get
rid of them, you hide them. Everything must be hardcoded at a certain
point. Having each hardcode exist only once, and in a logical place, is
the only solution. For example, you need to know the users name in your
program, its already hardcoded into the passwords file or users
database. If you can query it from the operating system, you've
avoiding duplicating it. Second best would be to put it in a file in
their home directory or profile. Next worst would be to hardcode it at
the top of the program. Unacceptable would be to have it hardcoded all
over the program. <br><br>
 </li><li> <a href="http://www.perldesignpatterns.com/?InvariantsArentAlwaysConstants">Invariants Arent Always Constants</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> </li><li> <a href="#AboutObjects"><b>About Objects</b></a> </li><li> <a href="#AboutFlack"><b>About Flack</b></a> 
<br><br>
 <br><br> <a name="CachingFailure"></a><h2><a href="#CachingFailure"><b>Caching Failure</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>An error
condition resulted from an attempt to do something. You've set a flag
indicating that this isn't working. The user has corrected the problem,
but your program still refuses to work. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Only when
failure is very expensive and the error condition arises automatically
without user guidance should failure be cached. Caching failure creates
a situation where the user is unable to isolate the cause of the
failure: despite fixing everything he can think of, it still refuses to
work! When failure is cached, the system should give a clear indication
of what must be done to clear the flag so the system will try again, in
addition to a description of the cause of the error. <br><br>
 XXX BIND's cache failure timeout option 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <br><br> <a name="NoSexUntilMarriage"></a><h2><a href="#NoSexUntilMarriage"><b>No Sex Until Marriage</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Given an object of type <i>A</i>, you want one of type <i>B</i>. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Make them essentially synonymous. 
<br><br>
 <font size="+2"><b>Anti-Solutions</b></font><br><br></li><li> Create a converter object that knows the inner workings of both packages but is a member of neither. </li><li> Diddle with <i>@ISA</i>. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>If any given <i>A</i> may need to be converted to a <i>B</i> at some unknown point, then any distinction between <i>A</i> and <i>B</i> is moot. 
<br><br>
 There are correct ways to express this relationship [Bind them in the time-honored tradition of  <a href="#DesignContract"><b>Design Contract</b></a>, implementing an interface, and producing a new object.]: 
<br><br>
 </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> - Implement both <i>A</i> and <i>B</i> interfaces - make your object truely polymorphic.  See <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>. </li><li> <a href="#DecoratorPattern"><b>Decorator Pattern</b></a>  - talks at length about the problems of dynamic inheritance and mixins, ultimately arrives at the <a href="#DecoratorPattern"><b>Decorator Pattern</b></a>
as a means of getting everything you want in one clean, save package.
Dectoratrs stand-in for objects, delegating requests to them, but not
before adding in their two cents. This allows composition of complex
structures through chains of delegation. </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> - <i>A</i> sometimes needs to present itself as <i>B</i>, but the logic shouldn't be cluttered with <i>B</i>'s logic. Implement <i>B</i> as an inner class of <i>A</i> using <a href="#InnerClasses"><b>Inner Classes</b></a>. </li><li> <a href="http://www.perldesignpatterns.com/?FactoryMethod">Factory Method</a> - <i>A</i> may return a <i>B</i> upon request. This is a case of <a href="#CloningPattern"><b>Cloning Pattern</b></a>, when a stock object is created and then configured. Requires <i>A</i> to know about <i>B</i>'s interface without implementing it, so it is unrecommended for idealists: too many strange interdependencies. </li><li> <a href="#StatePattern"><b>State Pattern</b></a> - If <i>A</i> only becomes <i>B</i> under certain conditions, and doesn't go back,  except perhaps under other specific circumstances, implement <a href="#StatePattern"><b>State Pattern</b></a>.
Under the difference between state and class - a change in behavior
need not, and generally should not, be synonymous with a change in
class. See <a href="#StateVsClass"><b>State Vs Class</b></a>. </li><li>
Class::Classless - customize existing objects to serve as new objects.
Create new objects from existing objects as templates. New objects
inherit from the object used as the template. See <a href="http://www.perldesignpatterns.com/?JavaScript">Java Script</a>. </li><li> <a href="#RevisitingNamespaces"><b>Revisiting Namespaces</b></a> - extend a class without subclassing it. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?UseBase">Use Base</a> </li><li> <a href="#VisitorPattern"><b>Visitor Pattern</b></a> </li><li> <a href="#DecoratorPattern"><b>Decorator Pattern</b></a>  </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=227847">PerlMonks:227847</a> - modifying @ISA at runtime </li><li> <a href="#RevisitingNamespaces"><b>Revisiting Namespaces</b></a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/mapper.html">http://www.martinfowler.com/eaaCatalog/mapper.html</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perlmonks.org/index.pl?parent=246322&amp;title=Dynamicly%20controlling%20%40ISA%20and%20namespaces&amp;lastnode_id=246322&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on">http://www.perlmonks.org/index.pl?parent=246322&amp;title=Dynamicly%20controlling%20%40ISA%20and%20namespaces&amp;lastnode_id=246322&amp;displaytype=display&amp;type=superdoc&amp;node=Comment%20on</a> </li><li> <a href="http://www.perlmonks.com/index.pl?node_id=246685">http://www.perlmonks.com/index.pl?node_id=246685</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=246322">http://perlmonks.org/index.pl?node_id=246322</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=246685">http://www.perlmonks.org/index.pl?node_id=246685</a> </li><li> <a href="http://perlmonks.org/index.pl?node=246322">http://perlmonks.org/index.pl?node=246322</a> </li><li> <a href="http://scarecrow.fmrp.usp.br/%7Emavcunha/public/anti-patterns.php">http://scarecrow.fmrp.usp.br/~mavcunha/public/anti-patterns.php</a> 
<br><br>
 <br><br> <a name="AbstractionInversion"></a><h2><a href="#AbstractionInversion"><b>Abstraction Inversion</b></a></h2><br> 
<br><br>

<br><br> An abstraction is said to be "inverted" if something simple is
built on top of something complex [for example, a porta-potty on top of
a Mayan ruin]. <br><br> Usually implies an inefficient imlementation. For example,
disk files are used to implement an array, or data is sent over the
network to add two numbers. May also lead to deadlock - programmers
will assume that the simple operation requires few resources, when in
fact the depenencies are quite extravagent, even requiring exclusive
locks, or the object that originally invoked it! <br><br>
 Some core module stuggles with the availability of <i>Carp</i> for error reporting, but I can't remember which one. XXX, <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br> Don't build simpler layers on top of complex layers when
possible. Instead, refactor the monolithic complex layer. Fine
granularity will allow subclasses to inherit from the correct level of
abstraction. <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="#ThinWrappers"><b>Thin Wrappers</b></a> </li><li> <a href="#LayeringPattern"><b>Layering Pattern</b></a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://scarecrow.fmrp.usp.br/%7Emavcunha/public/anti-patterns.php">http://scarecrow.fmrp.usp.br/~mavcunha/public/anti-patterns.php</a> 
<br><br>
 <br><br> <a name="DllHell"></a><h2><a href="#DllHell"><b>Dll Hell</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Future versions
must maintain backwards bug-for-bug compatability with previous
versions, which may be awfully buggy, and you'd really like to fix some
of those bugs. Bug you can't. <br><br> Or, modules are distributed in interdependent sets. Mixing
modules from sets breaks things, reguardless of version numbers, as
each bundle is kind of its own fork. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Use a two-tiered versioning system. 
<br><br> Major version changes can change the API, including fixing
bugs that affect the API. Minor versions can add new functionality in a
backwards compatable way and fix bugs that don't affect the API. <br><br> Or, make minor versions backwards compataible, but break
compatability in minor versions. Programs dependent on modules need
only use one simple strategy: for whichever major version they depend,
find the most recent minor version. <br><br>
 Named for the problem afflicting Microsoft Windows<a href="http://www.perldesignpatterns.com/?MicrosoftWindows">+</a>,
where different departments would fix some bugs in system libraries and
write code dependent on other bugs, while at the same time another
department did exactly the same thing, but fixing and depending on
different bugs. For years, attempting to install Microsoft's
"VisualStudio" and "Office" suites on the same machine reliably created
a brain damaged, psychotic, mangled shell of a machine, as libraries
from one suite overwrote libraries from another. Unix's two tiered
versioning system clearly seperate backwards compatiable and
non-backwards compatiable fixes to prevent this sort of thing. In the
worst case, each incompatiable version would be assigned a different
major number, and each suite would use its own private libraries, never
needing to obliterate other peoples libraries. <br><br> Microsoft is not the only company to make this mistake - it
is more often made than avoided. Sun's Java language fixes bugs in
previous versions each version, but any Java program of any complexity
depends on the quirky behavior of the libraries. The result is, each
program written for Java is dependent upon the version of the virtual
machine it was developed on. To run three different Java programs, you
are likely to need different Java runtimes, and each program must be
associated with the correct runtime - an epic feat of configuration. If
Java programs were able to specify which version of the library they
wanted, and each new versions of the runtime came with all of the older
versions of the libraries, then only one runtime would be needed. By
denying the need for backwards compatability or arrogantly assuming
that no breaks will need to be made in the API, you set yourself up for
unplanned, uncoordinated breaks in the API. It ain't pretty. <br><br>
 <font size="+2"><b>Categories</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryAntiPattern">Category Anti Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TwoVersionNumbers">Two Version Numbers</a> 
<br><br>
 <br><br> <a name="CreepingFeaturism"></a><h2><a href="#CreepingFeaturism"><b>Creeping Featurism</b></a></h2><br> 
<br><br>
 Jabberwok nods non-chalantly. 
<br><br>
 You nod at Jabberwok. 
<br><br>
 You say in common: a category vanishes when nothing refences it. 
<br><br>
 Jabberwok says in common: excellent 
<br><br> You say in common: a stray category*.html file doesnt hurt
anything and i'm not going to be anal about eliminating them so please
dont stress about it either <br><br> You say in common: for the purposes of a category-category,
though, getting rid of disused categories is important, and that works <br><br>
 Jabberwok says in common: ideally those would be in subdirectories which would just be purged at the start of regen 
<br><br>
 You say in common: in the name of simplicity, we wont 
<br><br>
 You grin evilly. 
<br><br>
 Jabberwok says in common: chalk that up for Rev 3 
<br><br> You say in common: humans will delete stray category_*.html
files. otherwise, i'd have to introduce reference counts and the
complexity would balloon. as complexity increases, bugs increase, time
to make changes increases, etc. i'm trying to keep this thing
fundamentally simple <br><br>
 You shake your head. 
<br><br>
 You say in common: a seperate app maybe that cleans unref'd files. 
<br><br> You say in common: Thereviewzone.pm does one very, easy to
understand thing: it stores forms in a database, repopulates the form
from the database, and templates the information. okey, three things. <br><br> You say in common: this simplicity is power. the more i tie
it down with requirements, the harder it is to adapt, and the less
general it is <br><br>
 Jabberwok says in common: true 
<br><br> You say in common: deciding that some records turn into files
and counting refences to the files from the database records would be a
nightmare - in the core - but as a client specific app, its just
another stupid throw away admin utility <br><br> You say in common: as a client app, it comes into more
perspective: not unless either the client asks for it, or it would
demonstratibly save us time. <br><br> You say in common: at a very real point, it would be easier
to create this thing as a static site rather than try to "cheat" and
use gallery server. the more unrequired features we tack onto it, the
closer this points becomes <br><br>
 Jabberwok says in common: or just autokill any category* file without today's timestamp (shrug) 
<br><br> You say in common: sure! thats the right idea! its easy to get
lulled into the thought process of "x alreaady almost does y, so we
might as well add it to x". under that logic, humans would equiped with
garden rakes, sponges, rolodexes, cellphones, and mace glands at birth <br><br>
 Jabberwok stands quietly hoping no-one will notice his presence 
<br><br>
 You laugh hysterically. 
<br><br>
 You say in common: sorry 
<br><br> You say in common: i'm just bitter because i went through
waaay much of life with the attitude of "if i work extra hard, i'll do
everything everyone wants and everyone will be really happy" only to
realize that its easier to ask for something than to really want
something, so when they get it, it turns out that they don't care or
notice. i've wasted years of my life trying to do things for people
that didn't matter one whit <br><br>
 You say in common: i've got creapingfeaturismphobia 
<br><br>
 Jabberwok says in common: haha 
<br><br>
 Its like the faerie tale, the Old Man and the Sea. If you ask for too much, you may get nothing at all. 
<br><br>
 Jabberwok says in common: i'm happy with what you're doing 
<br><br>
 Phaedrus puts a used soapbox up for sale on eBay 
<br><br>
 You thank Jabberwok. 
<br><br>
 You say in common: we'll reasses once we get "done" (in the letter of the law) 
<br><br>

<br><br>
 <br><br> <a name="AboutRefactoring"></a><h2><a href="#AboutRefactoring"><b>About Refactoring</b></a></h2><br> 
<br><br>
 An <a href="http://www.perldesignpatterns.com/?ExtremeProgramming">Extreme Programming</a>, refactoring, design patterned guide to eeking an object out of your program. 
<br><br>
 Or, objects: the next step. 
<br><br> Anyone who has worked in the Real World for long suspects that
boss types exist to take the fun out of work. In the metaworld of
programming, management [...and it just trails off. What was I
thinking?] <br><br>
 Objects are mandated by boss types when: 
<br><br>
 <ul><li> The design isn't to be trusted to the programmer
</li><li> The program isn't to depend on a specific implementation by any one programmer
</li><li> Management desires a high-level view of the structure of the product that they can understand
</li></ul> It should be easy to see why objects conjure images of opression. 
<br><br>
 Objects are created willingly by Perl programmers when: 
<br><br>
 <ul><li> Returning a complex data structure from a module
</li><li> There is no procedural interface to a module
</li></ul> Objects should not be created by Perl programmers when: 
<br><br>
 <ul><li> Features are anticipated that would make an object useful
</li><li> Datastructures may have to expand in the future to hold more data
</li><li> This programmer is merely a designer, not involved in the actual programming
</li></ul> Human intuition is amazing. No matter how neurotic it
appears, there is always a motivating gem of truth buried below the
surface. <a href="http://www.perldesignpatterns.com/?TonyHoare">Tony Hoare</a>
is famous for saying, "premature optimization is the root of all evil".
Another saying has come into fashion: "premature generalization is the
root of all evil". <a href="http://www.perldesignpatterns.com/?ExtremeProgramming">Extreme Programming</a>
teaches us "don't code it; you won't need it". Being able to cleanly
and quickly make changes to a program is far more important than having
piled on dubious features in advance. Perlers, if anyone, should see
the wisdom here. Adding more features, more interfaces, more facilities
means more code and more complexity to try to adapt to what is really
needed. Implementing prematurely sacrifices valuable opportunity to
form insights into how to structure the code cleanly. If there is any
doubt, don't add the feature - yet. <br><br>
 Objects should be created by Perl programmers when: 
<br><br>
 <ul><li> There is too much data in a data structure
</li><li> There are too many functions in a program
</li></ul> I'm taking a hard line here by discounting 99% of the
reasons cited for creating objects. There are volumes and volumes of
formulistic texts describing how to design any sort of program, yet
doing so effectively remains a black art. These formulas are endorced
as being universally correct with the phrase "domain independent". In
reality, no solutions are domain independent. I've yet to see one
domain indepent solution capable of tieing shoes. <br><br> Recently, a new fad became fashionable: Refactoring. The
idea is simple and timeless: code cannot be written perfectly the first
pass. Nor can the first version include support for every feature that
might eventually be hacked on. The only solution is dedication to
ongoing improvements, iteratively learning from past shortcomings, a
willingness to break existing code. <br><br>
 Many programmers have been disguested by a large, but working, program and have resolved to rewrite the whole mess [<a href="http://www.perldesignpatterns.com/?NeverRewriteSoftware">Never Rewrite Software</a>].
This results in burn out quicker than any other practise in
programming. The reward of solving the problem and procuring a working
program has already been had. The only thing remaining is minor
bragging rights. Half way through the project, the real importance of
these bragging rights are realized. Refactoring's most important
contribution may well be techniques for migrating from sprawl to order.
<br><br>
 <hr><br>From <a href="http://www.perldesignpatterns.com/?WikiWiki">Wiki Wiki</a>: 
<br><br> Actually, I think it's the approach that is taken to
generalization. If you design something and it isn't general so you add
lots of hooks and conditionals to make it general that isn't a very
good approach. <br><br> What does make generalization handy is the removal of
special-case conditionals and hooks. Sometimes it's difficult to come
up with a true general solution, and in that case you may have to live
with specialized code. <br><br> Of course, when you do have a general solution that does
cover all cases (and even potentially the ones you haven't though of)
it usually ends up being quite elegant and maintainable. <br><br>
 Just my $0.02 worth. -- <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=MarkGrosberg">WikiWiki:MarkGrosberg</a> 
<br><br>
 <hr><br>Do exactly what you're doing, but go on to refactor.
I have to admit, I've joined the ranks of the refactoring zealots.
Learning to refactor lessens the fear of failure, encourages
experimentation, promotes testing and analysing the results repeatedly,
and puts an end to the baby-and-the-bathwater thing people do when they
decide to rewrite from scratch. Rewritting from scratch, people learn a
few lessons from the first attempt, but almost never all of them. The
rewritten code itself will need to be rewritten later when other major
infrastructure problems are encountered. <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> has undergone numerous serious changes and only slightly resembles the original 34 line <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a>.
Even though it is only 100 lines now, most lines have been replaced
numerous times. No rewrite could have packed so much action into so few
lines. Obscure code is a study in refactoring - the author has to be
willing to try hundreds of different ideas, which makes throwing the
baby out with the bath water every time infeasiable - it would take
fover. Instead, permutations of ideas and code are tried. The resolve
to continue to hack on existing code endlessly is key. <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> is <a href="http://perldesignpatterns.com/?self">http://perldesignpatterns.com/?self</a> 
<br><br>

<br><br>
 <hr><br><font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=HomePage">WikiWiki:HomePage</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=MarkGrosberg">WikiWiki:MarkGrosberg</a> 
<br><br>

<br><br>
 <br><br> <a name="RefactoringPattern"></a><h2><a href="#RefactoringPattern"><b>Refactoring Pattern</b></a></h2><br> 
<br><br>

<br><br> Refactoring is a collection of techniques for making code...
well, better. Different techniques have different goals: flexibility,
maintainability, understandability, and so on. The single guiding light
is simply to put things where they belong. Putting things where they
belong buys us loose coupling, where objects aren't attached together
so strongly that they might as well be the same object. It buys us ...
well. <br><br> The phrase is borrowed from mathematics, as is so much in
computer science. It is known in mathematics by another name as well:
"simplify". A simple case of simplifying being: <br><br>
 <pre>  x*5 + 10 = x*2 + 32</pre>
<br><br>
 Refactored: 
<br><br> Factoring itself refers to breaking terms down into the parts
which can be multiplied together. In effect, we un-multiply them: <br><br>
 <pre>  15 = 5 * 3</pre>
<br><br> When programming, the simplest thing you can break things down
into is a matter of opinion. Or rather, it is a matter of opinion what
programs are composed of. Instructions? Expressions? Functions?
Objects? Modules? Some languages represent everything with an object
(Smalltalk, for instance). This lets us abide by an executive ruling
that objects are the fundamental building block, which pleasantly
closes the question. Perl being pragmatic, programs are built in
strata. Packages are built on objects are built on functions are built
on expressions. Just like a polynomial expression, these combine in
different ways to create something more complex. <br><br>
 What does re-evaluating how we've assembled our programs buy us? Simplicity, I guess. 
<br><br>
 About <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Refactoring&amp;word=http://www.pobox.com/%7Eschwern/talks/Refactoring/slides/slide008.html">Refactoring:
http://www.pobox.com/~schwern/talks/Refactoring/slides/slide008.html</a> - by <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a> 
<br><br>
 Refactoring tools in <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Perl&amp;word=http://www.pobox.com/%7Eschwern/talks/Refactoring/slides/slide052.html">Perl:
http://www.pobox.com/~schwern/talks/Refactoring/slides/slide052.html</a> - by <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?RefactoringImprovingTheDesignOfExistingCode">Refactoring Improving The Design Of Existing Code</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=WikiPagesAboutRefactoring">WikiWiki:WikiPagesAboutRefactoring</a> </li><li> <a href="http://www.pobox.com/%7Eschwern/talks/Refactoring/slides/slide008.html">http://www.pobox.com/~schwern/talks/Refactoring/slides/slide008.html</a> </li><li> <a href="http://www.pobox.com/%7Eschwern/talks/Refactoring/slides/slide052.html">http://www.pobox.com/~schwern/talks/Refactoring/slides/slide052.html</a> 
<br><br>

<br><br>
 <br><br> <a name="PlanningIsNpComplete"></a><h2><a href="#PlanningIsNpComplete"><b>Planning Is Np Complete</b></a></h2><br> 
<br><br>

<br><br>
 <i>We begin with the part of the language which defines a
town or a community. These patterns can never be "designed" or "built"
in one fell swoop - but patient piecemeal growth, designed in such a
way that every individual act is always helping to create or generate
these larger global patterns, will, slowly and surely, over the years,
make a community that has these global patterns in it.</i> - A <a href="http://www.perldesignpatterns.com/?PatternLanguage">Pattern Language</a> 
<br><br> NP Complete problems take an exponential, relative to the
amount of input, to complete. Calling something "NP Complete" describes
it at a problem not worth trying to solve, or only trying to solve in a
very approximate fashion. See <a href="http://www.perldesignpatterns.com/?MasteringAlgorithmsWithPerl">Mastering Algorithms With Perl</a>. 
<br><br> Contrived interfaces result from arrogantly believing that
every aspect of the design of the program can be anticipated. This is
akin to playing out a game of chess without touching a piece. All of
the decision making in the world do a bit of good if it doesn't take
reality into account, and reality requires constant probing to
understand. <br><br>
 <i>Every program can be reduced by one instruction, and
every program has at least one bug. Therefore, any program can be
reduced to one instruction which doesn't work.</i> -- Unknown XXX 
<br><br> OO has been marketed as making planning easy. Planning without
feedback is easy but useless. Planning with hypothetical feedback is
both difficult and useless. I propose that planning to make design
changes is far more important than any other planning you will do.
Knowing when and how to restructure code applies equally to procedural
and OO code. OO discipline only helps make the process easier. <br><br>
 <i>No feedback means no quality in what you do.  A project without a prototype  is like a candle without a wick.</i> - <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wiki&amp;word=PeterMerel">Wiki:PeterMerel</a>  
<br><br> No feedback means no opportunity for improvement. Old timers
blame the disappearance of punch cards for the deterioration in
software quality [XXX]. Using punch cards forces you to stop and think
things through. Interactive programming lets you guess your way
through, often never really understanding the situation. A language
that makes you be explicit about your intentions in great detail is a
throw back to punch cards, in a way. Guessing has its place in sounding
out theories (and passing exams). Having a compiler that can give you
critical feedback may be a good trade off. Not having a product means
no feedback - no feedback from the compiler, or from sounding out the
design. <br><br>
 The only constant is change. 
<br><br>
 <i>An assault on large problems employs a succession of
programs, most of which spring into existence en route. These programs
are rife with issues that appear to be particular to the problem at
hand.</i> -- Alan J. Perlis, Foreword,  <a href="http://www.perldesignpatterns.com/?StructureAndInterpretationOfComputerPrograms">Structure And Interpretation Of Computer Programs</a>. 
<br><br>
 When asked what the most important tools of an architect are, Frank Lloyd Wright<a href="http://www.perldesignpatterns.com/?FrankLloydWright">+</a>  replied, <i>The eraser in the drafting room and the sledgehammer at the construction site</i>. 
<br><br> Good design comes from bad design eventually, if you learn
from your mistakes. This may be the only software engineering manual
that desn't beg and plead with you to "do it right the first time". You
have to pick your battles though: for any program, some problems are
design flaws, some are design trade-offs. How do you "fix" a trade off?
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?AccidentalHero">Accidental Hero</a> </li><li> <a href="http://www.perldesignpatterns.com/?UseDiagrams">Use Diagrams</a> </li><li> <a href="http://www.perldesignpatterns.com/?DeComposition">De Composition</a> </li><li> <a href="http://www.perldesignpatterns.com/?TopDownDesign">Top Down Design</a> </li><li> <a href="http://www.perldesignpatterns.com/?BottomUpDesign">Bottom Up Design</a> </li><li> <a href="http://www.perldesignpatterns.com/?DesignDocuments">Design Documents</a> </li><li> <a href="http://www.perldesignpatterns.com/?FlowCharts">Flow Charts</a> </li><li> <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a> </li><li> <a href="#AboutTheAuthor"><b>About The Author</b></a> </li><li> <a href="#AboutObjects"><b>About Objects</b></a> 
<br><br>
 <!-- <pre>  
  &lt;|dave|> you're right. OO can be useful. but the thing is, it gets forced down our throats
  > feel free to edit any page. there is a little "edit" link in the bottom left corner.
  &lt;|dave|> everyone tries to bend a project to make it OO
  &lt;|dave|> when some of them just arent suited to OO
  &lt;uri> |dave|: i didn't force it down my throat. i designed with it and not against it. my project needed polymorphism and OO perl does that.
  &lt;|dave|> few projects suit OO
  &lt;uri> |dave|: wrong. some do. 
  &lt;uri> many do.
  &lt;|dave|> &lt; 50%
  &lt;uri> but many projects are poorly architected in any paradigm
  > |dave| - there was an idea that modeling the project using OO/usecase etc would make the program scalable. that never happened. that failed
    horribly. not only cna't you plan for something that complex, but throwing objets in the mix doesn't help at all.
  &lt;uri> architecture is key. that is shitty all over
  > objects are much better used to clean up existing code incrementally than try to avoid the np-complete problem of predicting the future
  &lt;uri> scrottie: same there. architecture is key. always will be.
  &lt;uri> architecture is not OO. it is making a coherent whole out of parts
  > learning as you go is key. constant injetions of architecture rather than a poorly planned attempt up front is key.
  &lt;uri> no one does architecture at all.
  &lt;|dave|> when i look at OO code, i just cant stand it. so much overhead.... people work in micoarchitecture making so many tiny little
    improvements to squeeze as much performance as possible out of a computer, then people f*ck it away using OO
  &lt;uri> |dave|: you haven't seen good OO code then.
  > |dave| - trying to delegate everything "just in case" makes a special kind of speghetti code. you can't figure out the flow of the program, how
    things are constructed, where values come from - because it is so indirect
  &lt;uri> rare but good OO code makes sense. 
  > good OO code has abstraction removed as often as it has it added, and people hiding behind OO to make their code good aren't willing to do that
  &lt;|dave|> what do you mean scrottie
  &lt;|dave|> about "just in case" i mean
  > if a constructor gets called, and you have to dig through 30 different constructor calls, methods, delegations, etc to figure out where the hell
    the values came from, something is wrong
  > oh
  > people add a lot of delegation and abstraction "just in case it might be useful" to keeping things modular
  > which, as it turns out, is a complete rat race. it is impossible to add enough abstraction up front to have the exact right abstraction you end
    up needing
  &lt;|dave|> yeah
  > then, they refuse to remove any of it
  > leaving a tangled web as bad as any speghetti code
  > spaghetti? i can't spell
  &lt;|dave|> right on
  > <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> tries to expose aspiring OO programmers to as many *other* ideas as possible
  &lt;|dave|> one reason im anti-OO is that someone has to be
  </pre>--> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://c2.com/cgi/wiki?WikiInterchangeFormat">http://c2.com/cgi/wiki?WikiInterchangeFormat</a> </li><li> <a href="http://c2.com/cgi-bin/wiki?WikiInterchangeFormat">http://c2.com/cgi-bin/wiki?WikiInterchangeFormat</a> 
<br><br>
 <br><br> <a name="GeneralizePattern"></a><h2><a href="#GeneralizePattern"><b>Generalize Pattern</b></a></h2><br> 
<br><br>

<br><br> Actually, I think it's the approach that is taken to
generalization. If you design something and it isn't general so you add
lots of hooks and conditionals to make it general that isn't a very
good approach. What does make generalization handy is the removal of
special-case conditionals and hooks. Sometimes it's difficult to come
up with a true general solution, and in that case you may have to live
with specialized code. Of course, when you do have a general solution
that does cover all cases (and even potentially the ones you haven't
though of) it usually ends up being quite elegant and maintainable. --
Mark Grosberg, on <a href="http://c2.com/cgi/wiki/">http://c2.com/cgi/wiki/</a> 
<br><br> Your object will initially be custom crafted to do the exact
single thing that it needs to. As maintainability enter the picture,
you're faced with options of breaking it down into parts, subclassing
it to change things around, and creating a common interface type
between it and a new object. All of these techniques should be used in
combination, with generalization being the rule: It should only be
broken into parts if that aids in generalizing. When dividing the
objects, leave the simplest logic needed to implement the object in the
base class, and move your customizations to the subclass. If providing
a completely different implementation from the ground up, turn the old
implementation into an empty base class (interface), and move the old
code into a class that implements that interface, leaving open the
chance to implement a plug-in replacement. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a>, <a href="http://www.perldesignpatterns.com/?CategoryConcept">Category Concept</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> - put this somewhere 
<br><br>
 <br><br> <a name="ExpressionsBecomeFunctions"></a><h2><a href="#ExpressionsBecomeFunctions"><b>Expressions Become Functions</b></a></h2><br> 
<br><br> This is the simplest form of generalization, and the first a
programmer learns. Not long after prodding the computer to add two
numbers: <br><br>
 <pre>  print 10+32;</pre>
<br><br>
 You move on to write reusable pieces of code needed to build things just more complex than the simplest structures. 
<br><br>
 <pre>  sub indent {
    print '  ' x $_[0], $_[1], "\n";
  }</pre>
<br><br> Functions let you repeat a bit of logic without having to
repeat it in the program. This lets you repeat it an unknown number of
times, and makes it easy to run it or not run it under different
variable conditions. <br><br>
 <font size="+2"><b>Example</b></font><br><br>You might write some code that converts fahrenheit temperatures to celsius: 
<br><br>
 <pre>  print "It is now " . ($current_temp - 32) * 5 / 9;
  print "Yesterday's high was " . ($yesterday - 32) * 5 / 9;</pre>
<br><br>
 For additional flexibility, the common expressions are moved into a function: 
<br><br>
 <pre>  sub fahrenheit2celsius {
    my $fahrenheit = shift
    return ($fahrenheit - 32) * 5 / 9;
  }
  
  print "It is now " . fahrenheit2celsius($current_temp);
  print "Yesterday's high was " . fahrenheit2celsius($yesterday);</pre>
<br><br>

<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a>, <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>

<br><br>
 <br><br> <a name="BreakDownLargeFunctions"></a><h2><a href="#BreakDownLargeFunctions"><b>Break Down Large Functions</b></a></h2><br> 
<br><br>

<br><br> Functions that grow in use also grow in size. After a certain
point, it becomes clear that functions can benefit from using functions
themselves. Your eyes probe the function looking for a likely candidate
to relocate elsewhere. This candidate is chosen for being the largest
stretch of code that really has nothing to do with the enclosing
function. This lets us easily think up a name that explains what the
new function does without having to resort to something contrived just
to distinguish it from the original function. <br><br>
 </li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> </li><li> <a href="http://www.perldesignpatterns.com/?ArrowAntiPattern">Arrow Anti Pattern</a> </li><li> <a href="#CurryingConcept"><b>Currying Concept</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ConditionalElimination">Conditional Elimination</a> 
<br><br>

<br><br>
 <br><br> <a name="ReusableFunctions"></a><h2><a href="#ReusableFunctions"><b>Reusable Functions</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>You've broken
your program down into private functions in an object. Go one step
further by removing assumptions about the data they operate on. In
general, public methods in your code should decide what data the
private methods will work on, not the private methods themselves. <br><br>
 <font size="+2"><b>When</b></font><br><br>You're writing
private support methods for an object that both contains logic and
data, and the names of instance variables are coded into functions
you've factored out. <br><br> Putting related code and data in an object away from
unrelated code and data is often done to clean up a program. Not
everything is going to be a public method: your object will have
functions it uses. Consider the function almost an object of its own.
Don't let it attach to data, but rather provide the data to it. Instead
of having it access a field or global variable directly, pass the value
in, when reasonable. At some point, someone must reference the variable
directly. This should be done at the level that would cause it to be
done least often in the code. Accessing global and method variables by
name at the lowest level over and over again makes it difficult to
reuse the same code when assumptions built into the code change. <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> 
<br><br>

<br><br>
 <br><br> <a name="LocalVariablesReplaceGlobalVariables"></a><h2><a href="#LocalVariablesReplaceGlobalVariables"><b>Local Variables Replace Global Variables</b></a></h2><br> 
<br><br>

<br><br> Tasks are tied to data: they change data, examine data,
construct new data from data, answer questions about data, store data,
output data, input data, and so on. <br><br> I'd like to talk for a minute about how data gets around. As
it turns out, tracking the movements of data is much more difficult
than tracking the flow of code, and this difficulty shows up during
almost any debugging effort. There are two primary ways that data gets
around: </li><li> It is stashed somewhere, and by convention anyone who wants it knows where to look for it. </li><li> It is explicitly provided to any routine that needs data. 
<br><br>
 About 25 years ago, <a href="http://www.perldesignpatterns.com/?StructuredProgramming">Structured Programming</a>
set out to nail BASIC and similar languages into their coffins for two
reasons: it was impossible to follow the flow of code, and it was
impossible to follow the flow of data. The former method was used: data
was referenced by name. That means that should you want to use one
subroutine on a different variable than the one it was coded to use,
you can't. You had to work around that. You were forced to store the
current value of the variable into a new variable, change the variable
it operators on, call it, save the result, then restore the original
value. You had to dance the hookey-pookey just to get reuse a small bit
of common logic. <br><br>
 <pre>  100 OLDA=A
  110 A=50
  120 GOSUB 200
  130 PRINT "The result is: ";PRINT $A
  140 A=OLDA
  ...
  200 A=B*100
  210 RETURN</pre>
<br><br> What seems like the simple solution, stashing data somewhere
and giving it a name, turns out to be a nightmare. Subroutines couldn't
safely be written that that would perform a given operation on any give
piece of data. Later versions of BASIC of course changed this, but not
until a few new generations of langauges came and whooped it one. <br><br> Lets take another example. If you have a program that
iterates over files in a directory, performing some operation on each
in turn, you may find that you have a few subroutines and a main
routine, not unlike this: <br><br>
 <pre>  opendir my $d, "arts/" or die $!;

  my $processedflag = 0;
  my $file;

  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=FILE&amp;word=%20while%28$file">FILE: while($file</a> = readdir($d)) {
    # attempt to process the file, set $processedflag if successful
    handle_delete();
  }

  sub handle_delete {
    unlink $file if $processedflag;
    $processedflag = 0;
  }</pre>
<br><br> Later on, we decide to add the ability to handle all of the
subdirectories of the given directory, a change of heart brought on by
an interaction with an individual who expects you to code things he
can't even remember, much less communicate. <br><br>
 <pre>  sub process_directory {
    my $dir = shift;

    opendir my $d, $dir or die $!;

    my $processedflag = 0;
    my $file;

    <a href="http://perldesignpatterns.com/intermap.cgi?wiki=FILE&amp;word=%20while%28my">FILE: while(my</a> $file = readdir($d)) {
      if(-d $file) {
        process_directory($file); 
      } else {
        # attempt to process the file, set $processedflag if successful
        # we now have to explicitly pass our arguments!
        handle_delete($file, $processedflag);
    }
  }

  sub handle_delete {
    my $file = shift;
    my $processedflag = shift;
    unlink $file if $processedflag;
    $processedflag = 0;
  }

  process_directory('arts/');</pre>
<br><br> If we hadn't changed the call to handle_delete() to pass
arguments, and modified the subroutine handle_delete to use local
variables instead of global variables, $processedflag could hold left
over data, altered by a call made from process_directory() to
process_directory() that returned. It used to be that each instance of
a running programmer had one main loop that used these variables. Now,
this is a function that could be called several times, and even have
several copies running at the same time, as it calls itself. Data that
was specific to the program is now specific to an individual function
call. Our variable definitions reflect this change. <br><br> There are many ways that data can get around; I've discussed
only two so far: global variables and function arguments. To whe your
appetite, here are some more: </li><li> Passed to the constructor of an object </li><li> Contained in an object that was passed </li><li> Sent over the network, saved in a file, or passed through a threads::shared::queue </li><li> Bound to a <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?DesignPatternCatalog">Design Pattern Catalog</a> </li><li> <a href="#GlobalToLexical"><b>Global To Lexical</b></a>    </li><li> <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> </li><li> <a href="#ActionAtADistance"><b>Action At ADistance</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalVariablesMakeSense">Lexical Variables Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeRefactoringEasy">Lexicals Make Refactoring Easy</a> 
<br><br>
 <br><br> <a name="SoftrefsToHash"></a><h2><a href="#SoftrefsToHash"><b>Softrefs To Hash</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br><pre> Computing variable names. Period.</pre>
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Use hashes or other datastructures. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>The power
and the flexibility of having direct access to the symbol table is
alluring. However, nearly anything that can be done using it can be
done more cleanly using hashes, arrays, their references, and objects.
Name table abuse breaks down as soon as things start to get complicated
because of the requirement that everything have a unique name. This
problem is called namespace collision. Using hashes has the advantage
that each hash is seperate from the others. There are security
considerations in this kind of seperation as well. <br><br>
 <pre>  # store things in the correct array - ugly

  print "Who should get a cookie? "; my $name = &lt;STDIN&gt;;
  print "What kind of cookie should they get? "; my $cookie = &lt;STDIN&gt;;

  push @{'cookies_for_'.$name}, $cookie;  

  # store things in the correct array - clean

  my $peoples_cookies = {};

  print "Who should get a cookie? "; my $name = &lt;STDIN&gt;;
  print "What kind of cookie should they get? "; my $cookie = &lt;STDIN&gt;;
  
  push @{$peoples_cookies-&gt;{$name}}, $cookie;</pre>
<br><br>
 The already confusing reference syntax becomes even more confusing when you want to refer to something other than a scalar: 
<br><br>
 <pre>  # scalars are easy:

  my $cookie = $peoples_cookies-&gt;{'fred'}-&gt;[0];

  # but refering to an array or hash inside of a data structure is confusing:

  my @cookies = @{$peoples_cookies-&gt;{'fred'}};</pre>
<br><br> The syntax for using datastructures is remarkably like the
syntax for accessing the symbol table directly. The difference is what
goes inside of the request to dereference: <br><br>
 <pre>  @{...something...}        # this is how you dereference something as an array
  %{...something...}        # this is how you dereference something as a hash</pre>
<br><br>
 A "soft reference" or "symbolic reference" is a reference used this way with an expression that contains the <u>name</u> of the variable that contains the data.  
<br><br> A "hard reference" is a proper datastructure. The expression
inside of the dereference actually contains a perl reference of the
correct type. The backslash operator, \, creates these references from
regular <i>my</i> variables: 
<br><br>
 <pre>  open my $wordsfile, '/usr/share/dict/words' or die $!;
  my @words = &lt;$words&gt;; 
  close $wordsfile;

  my $something = \@words;

  print "The words I know are: ", @{$something}, "\n";</pre>
<br><br> The "my" in this example is important - otherwise our variable
will be overwritten if we do this in a loop, and if we exit out of a
block, it may vanish entirely. <br><br> In both cases, soft references and hardreferences, there is
one big pitfall: Perl automatically creates things as you refer to
them. It is hard to casually tell if you're using the wrong syntax, as
Perl considers them both valid. <br><br>
 <pre>  $peoples_cookies-&gt;{'fred'}-&gt;[0] = 'sugar cookie';
  print *{'cookies_for_fred'}, "\n";                    # theres nothing there, and no warning</pre>
<br><br>
 Perl will stop you if you use "soft" references (directly access the symbol table) while <i>use strict</i> is on. 
<br><br>

<br><br>
 <hr><br><pre>  &lt;Spike[y]&gt; does anyone know if theres a way to name a Hash like this:   %hash$i{$a} = $blah;   ?
  &lt;hull&gt; i dont understand:P
  &lt;hull&gt; cant you use %hash{$i}{$a} in your program?
  &lt;Spike[y]&gt; can you? i'm trying to make the name of a new hash go up each time it hits a certian thing (ie. go from %hash1 to %hash2)
  &lt;hull&gt; hmm
  &lt;hull&gt; like, in a for loop?
  &lt;hull&gt; for (my $i=0; $i&lt;$k; $i++) { $hashname{$i}{$k} = "R0xx0R!"; }
  &lt;hull&gt; you can do it like that:P
  &lt;Spike[y]&gt; yeah!
  &lt;Spike[y]&gt; i can?!
  &lt;Spike[y]&gt; wierd
  &lt;Spike[y]&gt; it tells me its an error
  &lt;Yaakov&gt; $ not %
  &lt;cp5&gt; ${"hash$i"}{$a} = $blah
  &lt;Spike[y]&gt; hm .. ok
  &lt;Yaakov&gt; NO!
  &lt;Yaakov&gt; NO NO NO
  * cp5 runs
  &lt;Yaakov&gt; DON'T USE SYMREFS!
  &lt;perl-fu&gt; ew... the green apple squirts
  &lt;Yaakov&gt; DEATH
  &lt;perl-fu&gt; AAAAAAAAAh!!
  &lt;Spike[y]&gt; ??
  &lt;Yaakov&gt; Use a hash of hashes
  &lt;Yaakov&gt; read perldoc perldsc
  &lt;hull&gt; <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Yaakov&amp;word=%20hash">Yaakov: hash</a> of hashes... sorta like multi-dimensional hash, uh?
  &lt;scrottie&gt; <a href="http://www.perldesignpatterns.com/?SoftrefsToHash">http://www.perldesignpatterns.com/?SoftrefsToHash</a>
  &lt;scrottie&gt; hull, you've been here before
 </pre>XXX do a writeup on English::Reference - lot of people don't understand reference syntax, and for good reason. Ugh. 
<br><br>
 <hr><br><font size="+2"><b>Credit</b></font><br><br><pre> First documented by <a href="http://www.perldesignpatterns.com/?TomChristiansen">Tom Christiansen</a></pre>
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perl.com/language/style/slide25.html">http://www.perl.com/language/style/slide25.html</a> </li><li> English::Reference </li><li> <a href="http://perl.plover.com/varvarname.html">http://perl.plover.com/varvarname.html</a> 
<br><br>

<br><br>
 <!-- no access log --> 
<br><br>
 <br><br> <a name="GlobalToLexical"></a><h2><a href="#GlobalToLexical"><b>Global To Lexical</b></a></h2><br> 
<br><br>

<br><br>
 Given a global variable that is only used in a few closely related functions, turn the variable into a lexical <i>my</i> variable, and define those functions lexically. 
<br><br>
 <pre>  # Before:

  use vars qw/$foo/;

  sub bar {
     do_something_with($foo);
  }

  sub baz {
    print $foo, "\n";
  }

  # more code...</pre>
<br><br>
 <i>$foo</i> is visiable anywhere in that package, even though it is only used in those two methods. Restrict its scope: 
<br><br>
 <pre>  # After:

  do {

    my $foo;

    sub bar { 
      do_something_with($foo);
    };

    sub baz { 
      print $foo, "\n";
    };
    
  };</pre>
<br><br> The enclosing block syntax is needed so that the functions are
generated in a sterile environment of our own device, and there tied to
their surrounding context - including the lexical variables. Only <i>bar()</i> and <i>baz()</i> can see <i>$foo</i> now. No other functions can.  You could say that they are the only things in <i>$foo</i>'s scope. The reduced scope makes the grouping visible, which makes the association obvious.  
<br><br>
 If there were another <i>do { }</i> block later on with some <i>my</i> variables in it,  those wouldn't spill over into this <i>do { }</i> block. After some adjustment, a quick glance at the code reveals all of the interdependencies. 
<br><br> This construct can be nested: One block of code can contain
another block, and so on. Multiple, nested scopes are acheived this
way. In fact, we can do this inside of the subroutines we create as
well, and keep propogating the context along. See <a href="#InnerClasses"><b>Inner Classes</b></a> for one such example. 
<br><br>
 Some common places to create lexicals are: </li><li> Inside <i>new()</i> </li><li> Inside <i>export()</i> </li><li> At the top level of the code 
<br><br>
 With <i>new()</i>, it doesn't make sense to define functions
inside of our own package: the second time someone creates an instance
of us, we overwrite the previous definitions of those subroutines. You
shouldn't have package global data in a module that lets people create
instances of it using new, anyway. See <a href="http://www.perldesignpatterns.com/?AnonymousSubroutineObject">Anonymous Subroutine Object</a>. 
<br><br>
 Co-opting <i>export()</i>, you have the perfect chance to export routines that are in the scope of the lexical <i>my</i> variables you've declared. See <a href="#ExportingPattern"><b>Exporting Pattern</b></a>. 
<br><br> At the top level of the code is a fine and dandy place, and an
incremental improvement for most modules. It doesn't get us the same
multiplicity as the other two cases though. <br><br>
 <i>640k should be plenty of memory for anyone.</i> - <a href="http://www.perldesignpatterns.com/?BillGates">Bill Gates</a> 
<br><br> Former global (or local) variables, converting to lexical buys
us something very special: it opens the door to having multiple
independent values exist at once. Deciding that only one of any given
will ever be needed is frequently the fatal assumption that stops a
growing program in its tracks. This is no different than saying that no
one will ever have two computers at home, so networking isn't
important, or there is no reason to virtualize resources because no one
will ever want to run more than one program at once, or the computer
need only support one video card because no one will ever attach two
displays to one computer. Its the job of refactoring to systematically
dispose of these rotten assumptions. See <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a>, <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a>, and <a href="http://www.perldesignpatterns.com/?AnonymousSubroutineObject">Anonymous Subroutine Object</a> for more. 
<br><br> As you write code, mentally draw a line between parts of it,
where data should flow. Be prepared to segregate sections of code into
lexically scoped blocks. Blocks may be placed in blocks, should one
grow too large. <br><br>
 Running... 
<br><br>
 <pre>  perl -BO=Concise &lt;file.pl&gt;</pre>
<br><br>
 You should see lines like such, scattered throughout: 
<br><br>
 <pre>  4        &lt;0&gt; padsv[$foo:515,516] sRM*/LVINTRO -&gt;5</pre>
<br><br>
 <i>padsv</i> references a scratchpad, used to store lexical
variables. B::Concise generates great summary information: in this
case, the name of the variable on the pad, and the sequence numbers
which it spands. Sequence numbers are assigned to each individual Perl
bytecode operation. The more it spans, the less effectively you've
limited the scope of your variables, and the closer you are to just
having a bunch of globals. The more restricted their scope is, the more
obvious the interdepencies are between parts of code, and the less
mysterious the dataflow is from one part of the program to another.
Consult B::Concise and <a href="http://www.perldesignpatterns.com/?PerlAssembly">Perl Assembly</a>
for more information. See B::Lint, while you're at it, for other
readability heuristics automatically done on your compiled program. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?AnonymousSubroutineObject">Anonymous Subroutine Object</a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> </li><li> <a href="#OneToOneRelationshipsTurnIntoOneToManyRelationships"><b>One To One Relationships Turn Into One To Many Relationships</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeRefactoringEasy">Lexicals Make Refactoring Easy</a> </li><li> <a href="#MoveCollectionsOfFunctionsToObjects"><b>Move Collections Of Functions To Objects</b></a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> <a href="#LocalVariablesReplaceGlobalVariables"><b>Local Variables Replace Global Variables</b></a> </li><li> B::Concise 
<br><br>
 <br><br> <a name="EvalToClosure"></a><h2><a href="#EvalToClosure"><b>Eval To Closure</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br><i>eval()</i>
is slow, wasteful of memory, prone to code-injection security
vulnerabilities, the wrong idiom for most purposes, and just plain
amature. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Convert <i>eval()</i> statements to <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a>. <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> provide an easy - once you grasp the concept - way to configure and reuse pieces of code. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Write the general case as an anonymous subroutine: 
<br><br>
 <pre>  my $code = sub {
    ...
  };</pre>
<br><br>
 Customize its behavior using lexically scoped variables - known as <i>my</i> variables in Perl: 
<br><br>
 <pre>  foreach (qw(red green blue orange white black)) {
    my $color = $_;
    *$color = sub { print qq{&lt;font color="$color"&gt;}, shift(), qq{&lt;/font&gt;} };
  }

  orange('Juicy');  # prints: &lt;font color="orange"&gt;Juicy&lt;/font&gt;
  red('Delicious'); # prints: &lt;font color="red"&gt;Delicious&lt;/font&gt;</pre>
<br><br>
 This example is based on my (somewhat shoody) memory of an example in the standard Perl documentation. 
<br><br>
 This is a replacement for: 
<br><br>
 <pre>  foreach (qw(red green blue orange white black)) {
    my $color = $_; 
    eval "sub $_ { print qq{&lt;font color=\"$color\"&gt;}, shift(), qq{&lt;/font&gt;} };";
  }</pre>
<br><br>
 Why is <i>eval()</i> slow? Perl has to fire up the language
parser again, initialize it, and start evaluating the grammar of the
input. The Perl language is quite extensive - full of all sorts of
constructs and ambigiouties - and it takes some doing to resolve all of
that and turn some code into a the interal format that Perl uses. <br><br> Why is it wasteful? Perl has no way of knowing that similar
code has already been compiled, so large amounts of similar internal
bytecode will accumulate. <br><br>
 And amature? An <i>eval()</i> may only return a value, modify global variables [or lexicals, I think? This is deep magic], and define functions. <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a>
let you pass around already compiled code, which can be evaluated over
and over, without having to recompile it each time. They can be nested
arbitrarily deep. No special syntax is required to quote and escape
things - the code is part of the main program and fits right in. Syntax
checking and compilation is done when the main program is compiled -
there is no chance of possible syntax errors later on, when an <i>eval()</i>
runs, and the compiler won't be fooled by malicious data placed into a
variable because the variable isn't expanded before compilation. <br><br>
 <font size="+2"><b>Security</b></font><br><br>What would happen if we read user input to create new colors? 
<br><br>
 <pre>  my $other_color = &lt;STDIN&gt;; chomp $other_color;

  foreach (qw(red green blue orange white black), $other_color) {
    my $color = $_; 
    eval "sub $color { print qq{&lt;font color=\"$color\"&gt;}, shift(), qq{&lt;/font&gt;} };";
  }</pre>
<br><br>
 And what if the color specified were... 
<br><br>
 <pre>  foo { } system('rm -rf /'); sub bar</pre>
<br><br>
 Perl would expand the scalar into the argument to <i>eval()</i> before parsing it, yielding: 
<br><br>
 <pre>  sub foo { } system('rm -rf /'); sub bar { print qq{&lt;font color="foo { } system('rm -rf /'); sub bar"&gt;}, shift(), qq{/font&gt;} };</pre>
<br><br>
 Bad Things would happen. Had this "code injection" been feed to a <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a>,
it would have been treated like a rather strangely named color, and
would work exactly like any of the other colors specified. <br><br>
 <font size="+2"><b>Callbacks</b></font><br><br>The result of creating a <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> using the <i>sub { }</i>
syntax can be passed as an argument to other methods, for them to
evaluate over and over as part of their work. CPAN's File::Find does
this. Any time a function or method asks for a code reference, a <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> will work. A <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> is a code reference by definition. <i>\&amp;my_function</i> just happens to be one also. When passing a <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a>, it takes its variables with it, and these variables remember their values. 
<br><br>
 <pre>  use File::Find;

  print "What ending should I find files having?\n";
  my @file_list;

  my $selector = do {
    my $ext = &lt;STDIN&gt;; chomp $ext;
    sub { push @file_list, $_ if $_ =~ m/$ext$/};
  };

  File::Find::find($selector, '.');

  print "I found these files: @file_list \n";</pre>
<br><br>
 When <i>$selector</i> is created, it latches on to and remembers <i>$ext</i>. The <i>sub { }</i>'s return value is returned through the <i>do { }</i> block and assigned to <i>$selector</i>. Even though <i>$ext</i> has gone out of scope, <i>$selector</i> maintains a reference to it, as long as <i>$selector</i> itself lives. When this code reference is passed to File::Find, it remembers its configuration. 
<br><br>
 <font size="+2"><b>Misc</b></font><br><br><a href="#AccessorPattern"><b>Accessor Pattern</b></a> has a better example, and <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> has a better explanation. 
<br><br>
 There are things that <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> can do that <i>eval()</i> can't, and there are also things that <i>eval()</i> can do that <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a> can't. It is possible - and clean - to write complex command interpreters and modular software using <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a>, but if you're parsing one language and converting it to Perl, writing <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a>
to represent each atom in this other language would be tedious, and
would increase memory usage over doing a stright translation to Perl
and <i>eval()</i>ing it. <i>eval()</i> can be useful for parsing expressions and config files, though these applications carry grave security caveats. Always <a href="http://www.perldesignpatterns.com/?ValidateInput">Validate Input</a>,
and use the Safe module when executing untrusted Perl code from strange
sources - and even then, be ware that Safe isn't perfect. It doesn't
protect you from many CPU and memory Denial Of Service<a href="http://www.perldesignpatterns.com/?DenialOfService">+</a> attacks, and there is always just one more way to coredump Perl. The only solution is to learn what <a href="http://www.perldesignpatterns.com/?LambdaClosures">Lambda Closures</a>
are and what they can do, and make your own decisions. Other examples
in this book make heavy use of them and I expect that they cover all
fascets of their use. <br><br>
 <font size="+2"><b>Categories</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 Category Security<a href="http://www.perldesignpatterns.com/?CategorySecurity">+</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> </li><li> <a href="#FunctionalProgramming"><b>Functional Programming</b></a> </li><li> <a href="#AccessorPattern"><b>Accessor Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ValidateInput">Validate Input</a> </li><li> <a href="http://www.perldesignpatterns.com/?BadStyle">Bad Style</a> </li><li> <a href="http://www.perldesignpatterns.com/?CallBack">Call Back</a> 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br><pre>  &gt; &gt; Using eval to make code more compact is too blatent of a case of
  &gt; &gt; obfuscation ;)
  &gt;
  &gt; Actually, I disagree with you here -- using eval to do code generation
  &gt; facilitates development of a layered system, and is one of the benefits
  &gt; of a dynamic language.
</pre>
 - from a discussion with <a href="http://www.perldesignpatterns.com/?SimonCavalletto">Simon Cavalletto</a> - <i><a href="#ScottWalters"><b>Scott Walters</b></a></i> - <i>Fri Aug 29 00:10:16 2003 216.190.249.178</i> 
<br><br>
 <!-- cut - end comments --> 
<br><br>
 <br><br> <a name="TooManyVariables"></a><h2><a href="#TooManyVariables"><b>Too Many Variables</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>Group related scalars into a hash. 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>As additional
features accumulate, new variables are added to support them. After a
period of growth, you notice that your code contains an confusing
number of separate variables. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Create one
or more hashes, and refactor the existing code that uses a scalar
variable to refer to a named value in a hash instead. <br><br>
 Group related values together in a single hash. Some signs that variables are related are: </li><li> Passed around together </li><li> Declared all at once </li><li> Only used by one function or a small set of functions 
<br><br>
 Grouping scalars into a hash: </li><li> Lets you later bless a reference to that hash if you want to associate methods with the data. See <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a>. </li><li> If you're passing around on average more than 2.5 of them together, you might as well pass around the <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a>, or the whole hash. </li><li> The code acknowledges the natural relationship of the variables.  
<br><br>
 <font size="+2"><b>Example</b></font><br><br><pre>  my $tests_skipped = 0;
  my $subtests_skipped = 0;

  sub runtests {
        my(@tests) = @_;
        my($test,$te,$ok,$next,$max,$pct,$totbonus,@failed,%failedtests);
        my $totmax = 0;
        my $totok = 0;
        my $files = 0;
        my $bad = 0;
        my $good = 0;
        my $total = @tests;
        ...

        foreach my $file (@tests) {
            $ok = $next = $max = 0;
            @failed = ();
            my %todo = ();
            my $bonus = 0;
            my $skipped = 0;
            my $skip_reason;
            ...
        }
  }

  # Refactored:

  sub runtests {

    my(@tests) = @_;
    my(%failedtests);

    # Test-wide totals.
    my(%tot) = (
                bonus    =&gt; 0,              # $totbonus
                max      =&gt; 0,              # $totmax
                ok       =&gt; 0,              # $totok
                files    =&gt; 0,              # $files
                bad      =&gt; 0,              # $bad
                good     =&gt; 0,              # $good
                tests    =&gt; scalar @tests,  # @tests
                sub_skipped  =&gt; 0,          # $subtests_skipped
                skipped  =&gt; 0,              # $tests_skipped
               );

    ...
    foreach my $file (@tests) {
        ...
        # state of the current test.
        my %test = (
                    ok          =&gt; 0,       # $ok
                    'next'      =&gt; 0,       # $next
                    max         =&gt; 0,       # $max
                    failed      =&gt; [],      # @failed
                    todo        =&gt; {},      # %todo
                    bonus       =&gt; 0,       # $bonus
                    skipped     =&gt; 0,       # $skipped
                    skip_reason =&gt; undef,   # $skip_reason
                   );
        ...
    }
    ...
  }</pre>
<br><br>
 <font size="+2"><b>Credits</b></font><br><br><a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a> 
<br><br>
 <a href="http://www.pobox.com/%7Eschwern/talks/Refactoring/slides/slide015.html">http://www.pobox.com/~schwern/talks/Refactoring/slides/slide015.html</a> by <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a> sparked this - the code is blatently stolen and my outline follows his - he'll prolly shoot me when he finds out 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br><a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?WholeObject">Whole Object</a> </li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> </li><li> <a href="http://www.pobox.com/%7Eschwern/talks/Refactoring/slides/slide015.html">http://www.pobox.com/~schwern/talks/Refactoring/slides/slide015.html</a> 
<br><br>
 <br><br> <a name="TooManyArguments"></a><h2><a href="#TooManyArguments"><b>Too Many Arguments</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>One large
function or method requires a large number of arguments to be passed to
it, making it difficult or error prone to use. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Create closures that fill in the arguments that tend to be the same and read the rest and pass them off. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>XXX most or all of this page should be combined with <a href="#CurryingConcept"><b>Currying Concept</b></a>. 
<br><br> Multiple implementations of a function is counter-intuitive.
We consider the function to be a failure if it can't handle all cases.
We grow the original function, and move more and more code to satellite
functions, and the original function grows in scope. As it grows, it
gains arguments. The arguments may signal which behaviors we want, and
may give data specific to different behaviors. <br><br> A function taking a lot of arguments tends to be called with
most of the arguments the same each time, as we tend to reuse certain
behaviors. You could create several wrapper functions, each of which
hardcodes a value, but this only has monomic value and doesn't scale. A
better solution is to create a small wrapper for the function or method
when we need it, that remembers some of the arguments. <br><br>
 <font size="+2"><b>Examples</b></font><br><br><pre>  my $a = new <a href="http://www.perldesignpatterns.com/?MapDaemon">Map Daemon</a>($mapob);
  my $i = shift();
  $a-&gt;send_region($i, 10, 15, $x2, $y2);</pre>
<br><br>
 ...would become... 
<br><br>
 <pre>  my $a = new <a href="http://www.perldesignpatterns.com/?MapDaemon">Map Daemon</a>($mapob);
  my $i = shift();
  my $send_region = sub { $a-&gt;send_region($i, 10, 15, shift(), shift()); };
  $send_region-&gt;($x2, $y2);</pre>
<br><br>
 In this example, <i>$i</i> and <i>$a</i> are lexically bound
to the variables of the same name created just before it. If you change
the value of these variables, it affects the code reference you've
created in <i>$send_region</i>. If you pass <i>$send_region</i>  off, or if you return it, <i>$i</i> and <i>$a</i>
will continue to hold their values. 10 and 15 will be hardcoded in and
cannot be changed. The two argument positions that contain the keyword
shift() will take their arguments from what is passed to the reference
that is created. This illustrates three different ways of getting
values into the code reference. Each has its purpose and its place. <br><br>
 <pre>  my $a = new <a href="http://www.perldesignpatterns.com/?MapDaemon">Map Daemon</a>($mapob);
  my $i = shift();
  my $send_region_x = sub { $a-&gt;send_region($i, $x1, $y, $x2, $y); };
  my $send_region_y = sub { $a-&gt;send_region($i, shift(), $y, shift(), $y); };
  foreach $x1 (1..100) {
    foreach $x2 (1..100) {
      $send_region-&gt;();
      # $send_region-&gt;($x1, $x2) would do exactly the same thing
    }
  }</pre>
<br><br>
 The advantage of the approach that uses <i>$send_region-&gt;()</i> is that we could set  values for <i>$x1</i> and <i>$x2</i>, and pass $send_region out to another routine that could  supply more arguments, without actually having to explicitly pass <i>$x1</i> and <i>$x2</i> along with <i>$send_region</i>.  
<br><br> Creating custom, special purpose code references that have
some of their arguments already filled, or have some of their arguments
attached to lexically defined data, is called "currying". <br><br>
 <font size="+2"><b>Resources</b></font><br><br>See Also <a href="#CurryingConcept"><b>Currying Concept</b></a> and <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> for more. 
<br><br>
 Objects can, and often should, do something similar to currying. Avoid temptation to <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a>
- don't set a bunch of values using accessors then call a method that
implicitly depends on that data. That amounts to global variables, and
ther interdependencies become difficult to track. Do use <a href="#FactoryObject"><b>Factory Object</b></a>, <a href="#AbstractFactory"><b>Abstract Factory</b></a>, <a href="http://www.perldesignpatterns.com/?InnerClass">Inner Class</a>, and <a href="#ImmutableObject"><b>Immutable Object</b></a>. 
<br><br>
 </li><li> <a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a> can reduce the number of arguments that need to be passed to a constructor by pre-creating partially configured objects. </li><li> <a href="#FactoryObject"><b>Factory Object</b></a>, <a href="http://perldesignpatterns.com/intermap.cgi?wiki=AbstractFactory&amp;word=%20Methods">AbstractFactory: Methods</a>
can return a custom-crafted object, configured from your arguments to
the factory method. The resulting object can be tickled and poked and
prodded, while we rest secure in the knowledge that the processes
whereby that object obtained its state is crystal clear. The methods we
call still work on essentially global data, but this global data is the
very essense of the object, not merely some globalized parameter data. </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=InnerClass&amp;word=%20A">InnerClass: A</a> special case of a <a href="#FactoryObject"><b>Factory Object</b></a>.
The only significant difference is that the returned object is defined
inline, right in middle of the "factory" code that creates it. Objects
with global state should have global state only specific to that
object. This makes for very small objects. Defining very small objects
right in middle of the function that creates them is really the way to
go. </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ImmutableObject&amp;word=%20Every">ImmutableObject: Every</a>
change to the object yeilds a new, updated copy. It won't sweep
excessive amounts of object-global data under the rug, but it'll
reaffirm the object as being the unique combination of its state. Most
importantly, we don't have to worry about another section of code
having a reference to the object and mucking up its state when we
aren't looking: every change creates a new, unique copy all our own. </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=AdapterPattern&amp;word=%20Not">AdapterPattern: Not</a>
wanting to modify an existing object, you can make an object that acts
as a wrapper around it, delegating requests, slightly translated, to
it. See <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a>. Think of it as currying, but on an object level rather than method level. </li><li> <a href="http://www.perldesignpatterns.com/?AnonymousSubroutineObject">Anonymous Subroutine Object</a> has an example of using lexical contexts to avoid having to explicitly pass information. 
<br><br>
 <font size="+2"><b>Pressures</b></font><br><br></li><li> <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a> - an undesireable situation - happens to avoid accepting too many arguments to any one call. </li><li>
XXX method overloading by type signature is slated to appear in Perl 6.
This lets you pass a reasonable collection of arguments and have the
method know what to do with them. <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a> </li><li> <a href="#FactoryObject"><b>Factory Object</b></a> </li><li> <a href="#ClonePrototypicalObjects"><b>Clone Prototypical Objects</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="#ImmutableObject"><b>Immutable Object</b></a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> <a href="#AccumulateAndFire"><b>Accumulate And Fire</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="#CurryingConcept"><b>Currying Concept</b></a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AnonymousSubroutineObject">Anonymous Subroutine Object</a> 
<br><br>
 <br><br> <a name="MoveLargeDatastructuresToContainers"></a><h2><a href="#MoveLargeDatastructuresToContainers"><b>Move Large Datastructures To Containers</b></a></h2><br> 
<br><br>

<br><br> Information changes according to events. Events dictate that
the internal representation of the world be brought up to date with the
state of the real world. You store representations in lists, hashes,
lists of lists, hashes of lists, and so on. As the datastructures
become more complex, you spend more and more time trying to remember
which order you have to dereference your references in. Then you have
to remember what order fields are stored in an array. <br><br>
 Trying to remember how to get from point A to point B across a network of references is error prone and tedious. 
<br><br>
 <pre>  #!/usr/bin/perl

  my $con = connect_to_server(@ARGV);

  my @treasure;
  my $x;
  my $y;
  my $bot;
  my @bots;

  # ...

  sub process_treasure {
    # build a list of treasure
    my $line = $con-&gt;('read');
    while($line =~ m/\G(\d+) (\d+) (\d+) (\d+) ?/g) {
      # read from server: id destx desty weight ..., eg: 17 133 28 50 89 11 57 78
      # add fields for the $x, $y location of the treasure and the (optional) object that holds it, if any
      push @treasure, [$x, $y, undef, $4, $2, $3, $1];
    }
  }

  sub available_treasure {
    # return a list of treasure at our location
    my @result;
    foreach my $treasure (@treasure) {
      # huh?
      push @result, $treasure if $treasure-&gt;[0] == $x and $treasure-&gt;[1] == $y and !$treasure-&gt;[2];
    }
    return @result;
  }</pre>
<br><br> Lets fancy for a moment that we have a whole bunch of code
that looks like this. We don't want to have to keep looking up which
fields represent what, but we don't have time right now to change all
of the code for the privilege of using symbolic names. In fact, if we
had to change the existing code in order to get symbol names for the
fields, we wouldn't bother. It would be more work than continuing on
this path. If we did convert it, our first intuition would be to turn
the arrays into hashes. Here is another approach: <br><br>
 <pre>  # in Treasure.pm:

  package Treasure;

  sub new { my $type = shift; bless [@_ || (0)x7], $type; }
  sub x :lvalue { $_[0]-&gt;[0] }
  sub y :lvalue { $_[0]-&gt;[1] }
  sub bot :lvalue { $_[0]-&gt;[2] }
  sub weight :lvalue { $_[0]-&gt;[3] }
  sub destx :lvalue { $_[0]-&gt;[4] }
  sub desty :lvalue { $_[0]-&gt;[5] }
  sub id :lvalue { $_[0]-&gt;[6] }

  1;

  package Treasure::Chest;

  sub new { bless $_[1] || [], $_[0]; }
  sub get { my $t = $_[0]-&gt;[$_[1]] ||= new Treasure; bless $t, 'Treasure'; $t-&gt;id() = $_[1]; $t; }
  sub all_treasure { my $self = shift; map { $self-&gt;[$_] ? $self-&gt;get($_) : undef } (0..scalar(@$self)-1); }

  1;

  # back in our main program:

  use Treasure; 
  my $treasurechest = new Treasure::Chest(\@treasure); 

  # lets see available_treasure() again, rewritten to use the named fields:

  sub available_treasure {
    # return a list of treasure at our location
    my @result;
    foreach my $treasure ($treasurechest-&gt;all_treasure()) {
      push @result, $treasure if $treasure-&gt;x == $x and $treasure-&gt;y == $y and !$treasure-&gt;bot;
    }
    return @result;
  }

  sub take_treasure {
    my $treasureid = shift;
    my $treasure = $treasurechest-&gt;get($treasureid);
    # associate the treasure with our bot:
    $treasure-&gt;bot = $bot;
    # add the treasures weight to our weight:
    $bot-&gt;[3] += $treasure-&gt;weight;
  }</pre>
<br><br> With just a few short lines of code, we've written an object
oriented wrapper for our data structure that doesn't get in the way of
using our data structure normally. The old functions continue to work,
and we can write new functions in the new style, or the old style, or a
mixture of styles. Of course, when we have time, we may want to go
clean up the old code. Perhaps we've been meaning to rewrite it all
anyway. Who has ever heard of object oriented programming where
introducing a new object type doesn't require changes to all of your
data reference? <br><br> How does this all work? We create our Treasure::Chest using
a reference to the @treasure array. The array of treasure records
becomes synonymous with the treasure chest. This is done in
Treasure::Chest's new() routine. The records in the array become
synonymous with individual treasure instances. This is done in
Treasure::Chest's <i>get()</i> routine. As we <i>get()</i>
objects, they are blessed into the Treasure package. When using the OO
accessor style, we need to go through the treasure chest container to
get the objects, instead of using the <i>@treasure</i>  array directly. Existing code can continue using the <i>@treasure</i>
array without knowledge of our trickery. We could have created proper
accessors, but our immediate goal was to attach names to the array
fields. To achieve this, we created subroutines that returned the
correct field of the array. We mark them :lvalue so that we can assign
a value back into them. Perl makes the parenthesis optional on method
calls, so we can write code that looks like we're assigning to a C
structure field or Java public instance variable. We use this to assign
to <i>$treasure</i>, when we say <i>$treasure-&gt;bot = $bot</i> in <i>take_treasure()</i>.  Perl understands this expression to mean: 
<br><br>
 <pre>  $treasure-&gt;bot() = $bot;</pre>
<br><br> ...which looks highly unnatural. We were assigning to a
function before, but it didn't look like it because the function call
didn't have parenthesis on the end. How can you possibly assign to a
function? ":lvalue" functions never return a string constant or the
result of an arithmetic expression. They do give as their result a
variable, or an expression that references a primitive variable. It is
this variable that is assigned to. The lvalue function can pick which
variable is assigned to, or even let the user assign to the result of
another function if that function is also lvalue. <i>substr()</i>, for instance, is lvalue. That means  both of these are legal: 
<br><br>
 <pre>  sub foo :lvalue { $_[0] ? $a : $b }
  foo(0) = 10; # assign 10 to $a
  foo(1) = 30; # assign 30 to $b

  sub bar :lvalue { substr($a, 10, 5) }
  bar() = "xyzzy";</pre>
<br><br>
 Note that we don't use return. Return makes a copy, and that would damage out  intentions. In other words, <i>return()</i> isn't lvalue. What is assigned to is the last expression in the block. 
<br><br> Returning to our wrapper class and container class, this
approach works for hashes as well, though there is less of a need to
name hash fields. Less, but not none. Creating an object wrapper
catches cases where we typo the hash subscript: <br><br>
 <pre>  $treasure-&gt;{'wegiht'} = 30; # this would go unnoticed by the compiler
  $treasure-&gt;wegiht = 30; # this would be caught the first time it ran</pre>
<br><br> Catching the error right away helps us quickly track down the
problem. Using a hash index, we might be confounded why the weight
wasn't updating correctly, and search all over the program, not knowing
which part of the code that accesses it to suspect. Some typos are hard
to notice, especially after you've been staring at code all day. I've
spent hours trying to find a logic error only to discover a subtle
typo. Its annoying. Another advantage of using the OO accessor approach
is that we can do value checking, to make sure the new value itself
isn't bogus or empty. We can also trigger side effects, and update
other global state of the object, or notify observer objects of the
state change, or countless other behaviors. <br><br>
 Put things together that change together.  
<br><br> You'll frequently face the decision of which data items to
lump together into an object. One rule is, if their values are
interdependent, then the code that enforces the relationship should
have easy access to all of the values. In other words, if the values
change together, put them together. If you wanted to be a purist, you
could borrow from relational database design: XXX all data fields
should describe the primary item, generally an ID. Databases need to be
purist, though: if you need to change the data representation of your
program, you can kill it, make the change, and start it up again.
Databases afford no such luxury: changing the structure of the data
would require changes to many other tables, reordering potentially
large amounts of information on disc, and requiring all applications
that use the database to be modified to reflect the change. With
databases, it pays to be overly cautious about breaking up data into
atomic collections. With applications, you can usually put it off until
the need arises. <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#VisitorPattern"><b>Visitor Pattern</b></a> </li><li> <a href="#GodObject"><b>God Object</b></a> 
<br><br>

<br><br>
 <br><br> <a name="MoveCollectionsOfFunctionsToObjects"></a><h2><a href="#MoveCollectionsOfFunctionsToObjects"><b>Move Collections Of Functions To Objects</b></a></h2><br> 
<br><br>

<br><br> When accessing the treasure object, you'll notice that certain
snippits of code are being repeated over and over. There are two cases
with the treasure object: <br><br>
 <ul><li> A robot, possibly ours, has it and is carrying it
around, and the location of the treasure is really the location of the
robot holding it.
</li><li> The treasure object is on the ground, and its location is correct.
</li></ul> Given that, you'll see this test over and over: 
<br><br>
 <pre>  if($treasure-&gt;bot) {
    $x = $treasure-&gt;bot-&gt;x;
    $y = $treasure-&gt;bot-&gt;y;
  } else {
    $x = $treasure-&gt;x;
    $y = $treasure-&gt;y;
  }</pre>
<br><br> This is error prone, and tedious. It doesn't fit at all with
our laziness. If we change the definition of the x() and y() methods in
Treasure.pm, we can write this <a href="http://www.perldesignpatterns.com/?OnceAndOnlyOnce">Once And Only Once</a>: 
<br><br>
 <pre>  sub x :lvalue { $_[0]-&gt;bot ? $_[0]-&gt;bot-&gt;x : $_[0]-&gt;[0]; }
  sub y :lvalue { $_[1]-&gt;bot ? $_[0]-&gt;bot-&gt;y : $_[0]-&gt;[1]; }</pre>
<br><br>
 In the future, asking for <i>$treasure-&gt;x</i> or <i>$treasure-&gt;y</i> gives the correct, expected value.  Since <i>:lvalue</i> methods behave just like variables, we can do things like this: 
<br><br>
 <pre>  $treasure-&gt;y-- if $dir eq 'north';
  $treasure-&gt;y++ if $dir eq 'south';
  $treasure-&gt;x++ if $dir eq 'east';
  $treasure-&gt;x-- if $dir eq 'west';</pre>
<br><br>
 Even though <i>x()</i> and <i>y()</i> are methods, the <i>++</i>, <i>--</i>,
and all other operators work on them as if they were a variable. Perl
actually performs those operations on the last variable mentioned in
the expression, before the method returns. An <i>:lvalue</i> function can itself be the last thing mentioned in an <i>:lvalue</i> function: these rules are recursive. See <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> for more examples of this technique. 
<br><br> If you later write a function to compute the polar coordinates
of the treasure (a distance and radius from a point), the natural place
to put it would be in the Treasure object, where the data is
immediately available. If the only time people are going to be using
that routine is with the treasure object, having it associated with the
treasure object itself makes it immediately available: it comes with
the data! Having functions associated with data does something else,
too: at least some of the arguments to the function are implied. If we
only used cartesian_to_polar() on treasure objects, it would be tedious
to write: <br><br>
 <pre>  ($angle, $distance) = Converter::cartesian_to_polar($treasure-&gt;x, $treasure-&gt;y);</pre>
<br><br>
 ... if instead we could write: 
<br><br>
 <pre>  ($angle, $distance) = $treasure-&gt;to_polar();</pre>
<br><br>
 The arguments are built in to the function! 
<br><br> The real beauty of object methods isn't implicitly operating
on the objects data, or giving names to array indices. Objects
represent collections of data that change together. Since people are
calling methods rather than changing the data directly, we control how
the data changes. We can put a serious dent in a whole class of logic
errors where data is handled inconsistently. Done correctly, we can
prevent one rogue, erroroneus part of the program from doing damage
that causing other, distant parts of the program from failing later. We
can put the object state change logic all inside the object and keep it
in one place. We can save other code from having to replicate that
logic all over the program. We can set requirements for accessing the
data that fail immediately, rather than some time later, pin pointing
bad code. <br><br> The way we have our accessor now, we're just handing out
access to the data. The problem is, since the treasure could be either
on the floor or in the clutches of our robot, some other lesser
programmer working on the project might forget to check if the treasure
is being carried before setting its location. This would change the
location of the robot and all of the other packages it holds! When the
robot started teleporting all over the place, we'd have no idea where
to look for the bad code. It could be anywhere. When this happens, its
time to tighten the reigns and institute some access control: <br><br>
 <pre>  sub set_x {
    if($_[0]-&gt;bot) {
      die "Cretin! I've TOLD you to check -&gt;bot() before trying to set the location! It is illegal to set the location on an object thats being carried!";
    }
    # "x" is the first array position
    $_[0]-&gt;[0] = $_[1];
  }

  sub query_x {
    return  $_[0]-&gt;bot ? $_[0]-&gt;bot-&gt;x : $_[0]-&gt;[0];
  }</pre>
<br><br>
 <i>query_x()</i> is almost exactly like our old <i>x()</i>, except it isn't an <i>:lvalue</i> function.  To change our X location, someone needs to first check <i>bot()</i>, and if there  isn't a value there, then set it using <i>set_x()</i>.
This is our procedure and we're enforcing it. A rogue programmer could
always meddle around inside of our datastructure and ignore the OO
interface, but we can only assume he knows what he is doing if he does
that. There is a technique for hiding your data using lexically scoped
variables that prevents this trick from working: see <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> for some examples. Even that  isn't secure: using <a href="http://www.perldesignpatterns.com/?PadWalker">Pad Walker</a>
module, people can investigate and alter lexicals that would otherwise
be hidden from them. If you truly want to enforce a strict policy for
using your code from untrusted code, use the Safe module. This locks
them into a sandbox and lets you define what they can do there. <br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#RefactoringPattern"><b>Refactoring Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?AccessorsPattern">Accessors Pattern</a> 
<br><br>

<br><br>
 <br><br> <a name="SuperClassAbstraction"></a><h2><a href="#SuperClassAbstraction"><b>Super Class Abstraction</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Competition between classes over a role leads to ambigious boundaries and confusing roles. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Given two
similar classes, create a super-class, and move common code there.
Rename methods as needed in the subclasses to present a consistent
interface. Use the new subclasses in place of the original classes. <br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Dissimilarities should be noted with the presence or abscence of various <a href="http://www.perldesignpatterns.com/?MarkerInterface">Marker Interface</a> - a <a href="http://www.perldesignpatterns.com/?MarkerInterface">Marker Interface</a> is a kind of <a href="#AbstractClass"><b>Abstract Class</b></a>. 
<br><br>
 When designing an interface, keep in mind: 
<br><br>
 </li><li> The base object is the general case. Subclasses
can and should create exceptions: subclasses are specific cases.
Do-nothing methods and methods that operate depending on some condition
or internal state are fair play. Don't confuse state with class: <a href="#StateVsClass"><b>State Vs Class</b></a>. </li><li> Features may be added directly to the base parent class in the future to introduce new features to all subclasses.  </li><li> Subclasses of the new base class may have different personalities. Some may be useful for things that others aren't. Create a <a href="http://www.perldesignpatterns.com/?MarkerInterface">Marker Interface</a> and brand individual subclasses to mark them as approprate for  operations specific to their personalities. [Bad prose.] </li><li>
Few is usually better than more. Should new functionality be needed in
the future, it can be defined by an additional interface. Not all of
the subclasses need implement it - only the ones for which it makes
sense. This avoids having to rewrite all of the subclasses every time a
new feature is introduced, and it prevents bloat. </li><li> The few
operations should combine well. This means creating and returning
objects that can be directly used by other accessors and other objects.
<br><br> Looking at successful real-world designs, the first version
provided detailed access to every nook and cranny, but did little in
the way of helping one use the object. Later versions augment the
generic methods with convinience methods. XXX - examples of these
so-called real-world designs. <br><br>
 <a href="#AbstractFactory"><b>Abstract Factory</b></a> has an exmaple of breaking down a large class into subclasses, and replacing it with a <a href="http://www.perldesignpatterns.com/?FactoryMethod">Factory Method</a>. 
<br><br> Define logic early on that subclasses are likely subclasses
are likely to be needed. This minimizes the need for Facades or
multiple inheritance to graft features on later, and they can always be
redefined in subclasses. Define data only when needed: it costs, and
ambigiously unneeded data creates room for inconsistant program state,
which is bad. Encapsulate the data in an object and use the <a href="#VisitorPattern"><b>Visitor Pattern</b></a>. [Imported from another page - clean up text XXX]. 
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Credits&amp;word=%20Opedyke">Credits: Opedyke</a> 1992, MIT OCW 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?MarkerInterface">Marker Interface</a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?MixIns">Mix Ins</a> </li><li> <a href="#FacadePattern"><b>Facade Pattern</b></a> </li><li> <a href="#ExplicitTypeCaseAnalysis"><b>Explicit Type Case Analysis</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> </li><li> <a href="http://www.perldesignpatterns.com/?ObjectOrientedDesignHeuristics">Object Oriented Design Heuristics</a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TemplateMethodFromSubclassCommonalities">Template Method From Subclass Commonalities</a> </li><li> <a href="#VisitorPattern"><b>Visitor Pattern</b></a> </li><li> <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a> 
<br><br>

<br><br>
 <br><br> <a name="ThinWrappers"></a><h2><a href="#ThinWrappers"><b>Thin Wrappers</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Too much
abstraction at once can add needless complexity and make it difficult
for a programmer to understand what is really going on under the hood. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Several thin wrappers, stacked on top of each other, allow programmers to find the right level of abstraction and convinience. 
<br><br> No one abstraction will suit all purposes. Attempts to make
such an abstraction will manage to create many abstractions but fail to
anticipate many important ones. Left to itself, code, like human
populations and government, can grow indefinately. <br><br>
 Abstractions themselves will need to be refactored over time. 
<br><br> Faced with an overreaching abstraction that doesn't even do
what you need to do, programs are often faced with the proposition of
gutting the existing implementation for ideas and information as they
reimplement a minimal or "Lite" version. Sometimes the "Lite" version
is just an interface on top of the "Heavy" version: this degenerate
situation is called <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a>. 
<br><br> The solution is to stack increasingly abstract interfaces on
top of more concrete ones. The programmer is free to choosse the level
of abstraction that suits his purposes, rather than <i>all or nothing</i>. There need not be twenty or even three; merely avoiding the <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a> issue opens the door to future refactoring  efforts. 
<br><br>
 To avoid <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a>,
and avoid making interfaces [... this is one of those places that I
just trailed off then later had no clue what I was thinking
originally]. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryPattern">Category Pattern</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#LayeringPattern"><b>Layering Pattern</b></a> </li><li> <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a> 
<br><br>

<br><br>
 <br><br> <a name="IntroduceNullObject"></a><h2><a href="#IntroduceNullObject"><b>Introduce Null Object</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Undef (null, 0)
is passed to methods in place of an object reference to communicate
default behavior. The programmer must always remember that the value
might be undef or it might be a reference. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>"null" is the object equivilent of 0. Even in systems with <a href="#TypeSafety"><b>Type Safety</b></a>,
null can be passed in where an object reference is expected. This
introduces special case checks into code, and is itself a special case
of Explict Type Case Analysis<a href="http://www.perldesignpatterns.com/?ExplictTypeCaseAnalysis">+</a>. 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br><pre>  sub foo {
    my $self = shift;
    my $bar = shift;
    if($bar) {
     $bar&gt;baz(); 
     # other stuff here too
    } else {
     # default case
    }</pre>
<br><br>
 Every access to <i>$bar</i> must be wrapped in side of an <i>if()</i>.  
<br><br> If "nothing" is a possibility, replace undef checks with a
null object. Remove "null" from being a special case. The null object
may define stubs for each method required by the interface - see <a href="#AbstractClass"><b>Abstract Class</b></a> for more on interfaces. Or, it may define default the behavior implied by sending undef into a method. <a href="#InnerClasses"><b>Inner Classes</b></a> may be imployed to create a default objects in-line: 
<br><br>
 <pre>  sub foo {

    my $self = shift;
    my $bar = shift;

    $bar ||= eval {
      package Foo::Defaut;
      use base 'Foo';
      sub baz {
        my $this = shift;
        # default behavior here
      };
      sub qux {
        my $this = shift;
        # you guessed it - default definition here
      };
      __PACKAGE__;
    }-&gt;new();

    # we can do this safely now, without concern for pesky nullnes
    $bar&gt;baz(); 

  }</pre>
<br><br>
 Asking the end user to create null objects to pass in to your module in place of <i>undef</i> is too much to ask. Once you have created one, pass it around between the different objects you've created.  
<br><br>
 See CPAN Class::Null, which is a null object, and singleton: 
<br><br>
 <pre>  package Class::Null;

  use vars '$VERSION';
  $VERSION = '1.02';

  my $singleton;

  sub new { $singleton ||= bless {}, shift }
  sub AUTOLOAD { *{$AUTOLOAD} = sub {}; undef }

  1;</pre>
<br><br>

<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#ExplicitTypeCaseAnalysis"><b>Explicit Type Case Analysis</b></a> </li><li> <a href="#InnerClasses"><b>Inner Classes</b></a> </li><li> <a href="#SingletonPattern"><b>Singleton Pattern</b></a> </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/68205">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/68205</a> 
<br><br>

<br><br>
 <br><br> <a name="AbstractRootClasses"></a><h2><a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a></h2><br> 
<br><br>

<br><br>
 Root classes should be abstract.  
<br><br> Root classes are any and every class that doesn't inherit from
something else. Each concrete implementation (a module that does
something) should inherit from an <a href="#AbstractClass"><b>Abstract Class</b></a> (a module that merely defines the interface).  
<br><br>
 When the class is handled, it should be referenced by the abstract type.  
<br><br> Doing otherwise defeats the primary purpose of using objects -
polymorphism. Polymorphism is your ticket to painlessly expanding your
application in the future. In a well designed program, adding features
amounts to adding classes. You can't easily add a class if the name of
one perticular implementation is hardcoded everywhere a class of that
type is used. Instead, hardcode the generic type name in, and use one
implementation of that type, keeping the door open for more
implementations. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Credit&amp;word=%20ObjectOrientedDesignHeuristics">Credit: ObjectOrientedDesignHeuristics</a> 5.7 
<br><br> On the other hand, when concrete functionality is actually
implemented in a concrete subclass, functionality should be implemented
as high on the inheritance tree as it is useful: see <a href="http://www.perldesignpatterns.com/?FunctionalityIsToBeShared">Functionality Is To Be Shared</a>. 
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryNovice">Category Novice</a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryIntermediate">Category Intermediate</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#EmptySubclassFailure"><b>Empty Subclass Failure</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?IntroductionPattern">Introduction Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?TemplateMethodFromSubclassCommonalities">Template Method From Subclass Commonalities</a> </li><li> <a href="#CheckingTypeInsteadOfMembership"><b>Checking Type Instead Of Membership</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?KeepYourOptionsOpen">Keep Your Options Open</a> </li><li> <a href="#LooseCoupling"><b>Loose Coupling</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="http://bioperl.org/Projects/SeqAlign/proposal.html">http://bioperl.org/Projects/SeqAlign/proposal.html</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=HandleBody.htm">ObjectArts:HandleBody.htm</a> </li><li> <a href="http://www.perldesignpatterns.com/?FunctionalityIsToBeShared">Functionality Is To Be Shared</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/separatedInterface.html">http://www.martinfowler.com/eaaCatalog/separatedInterface.html</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/layerSupertype.html">http://www.martinfowler.com/eaaCatalog/layerSupertype.html</a> 
<br><br>
 <br><br> <a name="LooseCoupling"></a><h2><a href="#LooseCoupling"><b>Loose Coupling</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br><i>Loose coupling means that the receiver and sender do not have to know about each other.</i> -- <a href="http://www.kuro5hin.org/story/2003/7/11/21859/2846">http://www.kuro5hin.org/story/2003/7/11/21859/2846</a> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Too much interdependency between objects defeats the purpose of using objects: 
<br><br>
 </li><li> Names of objects are hardcoded. </li><li> Types are hardcoded that aren't abstract interface types. </li><li> Most of the objects know about most of the other objects. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Loose Coupling
makes it easier to replace one part of the program without breaking the
entire program. The fewer changes that need to be made to accomodate
replacing or removing an object, the better. <br><br>
 </li><li> References to objects you depend on, or a
reference to an object that can find them for you, are passed up by
your constructor. See <a href="#PassingPattern"><b>Passing Pattern</b></a>. </li><li>
Speak of objects in terms of abstract types rather than concrete types.
Your code becomes tied to a general facility rather than one specific
implementation of it. See <a href="#AbstractClass"><b>Abstract Class</b></a>. Use <a href="#AbstractFactory"><b>Abstract Factory</b></a> to create objects of abstract type. </li><li>
Rather than mucking with an object directly, you deal with an interface
to a part of the program. This Facade is free to be implemented in a
single object or thousands. See <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a>, <a href="#FacadePattern"><b>Facade Pattern</b></a>. 
<br><br> Buildings that are overly tied to one perticular use tend to
be the first demolished. Changing them is expensive, difficult, and
potentially dangerous. Buildings which lend themselves to adaptation
have continued value, and this is acheived through a firm but
non-imposing structure clearly seperated from perticulars of the decor.
Each support holds its own weight while short lived adaptations of the
building support none. Each thing depends on things around it as little
as possible. Opening a wall shouldn't bring the structure down. <br><br>
 Supported <a href="http://perldesignpatterns.com/intermap.cgi?wiki=By&amp;word=%20LateBinding,">By: LateBinding,</a> <a href="http://www.perldesignpatterns.com/?PolymorphismConcept">Polymorphism Concept</a>, <a href="#PassingPattern"><b>Passing Pattern</b></a>, <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a>, <a href="http://www.perldesignpatterns.com/?KeepYourOptionsOpen">Keep Your Options Open</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> </li><li> <a href="#ObjectOrgy"><b>Object Orgy</b></a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a> </li><li> <a href="#FacadePattern"><b>Facade Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?ConceptsCrossReference">Concepts Cross Reference</a> </li><li> <a href="http://www.perldesignpatterns.com/?DeCouple">De Couple</a> 
<br><br>
 <br><br> <a name="DesignContract"></a><h2><a href="#DesignContract"><b>Design Contract</b></a></h2><br> 
<br><br>
 Polymorphism, the ability to use similar objects interchangably, rests on like objects providing same interfaces. 
<br><br> Intentionally deciding what the method names will be, and how
they will work, for a given type of object, is called a "design
contract". Creating an <a href="#AbstractClass"><b>Abstract Class</b></a> specifies such a design contract. Implementing the interface specified by an <a href="#AbstractClass"><b>Abstract Class</b></a> realizes this contract. 
<br><br> "Design by contract" means to design a system in terms of
APIs. The theory goes: if other objects can count on the API working as
described, then the entire program will function correct as long as
Concrete Class<a href="http://www.perldesignpatterns.com/?ConcreteClass">+</a> implementations of that API are correct. Whether or not an implementation is correct can easily be tested in isolation using <a href="http://www.perldesignpatterns.com/?UnitTests">Unit Tests</a>.
If the APIs are implemented correctly, the contract is met, and the
program works. Or, thats the theory. For this to work, the definitions
of how the APIs handle Corner Cases<a href="http://www.perldesignpatterns.com/?CornerCases">+</a> must be unambigious, and programmers must not interpret them incorrectly, or make Stupid Mistakes<a href="http://www.perldesignpatterns.com/?StupidMistakes">+</a>. Nothing can save a program from Stupid Mistakes<a href="http://www.perldesignpatterns.com/?StupidMistakes">+</a>.
The contract, or API specification, creates a focal point point for
testing and bickering over specifications, limiting the scope of places
where that perticular kind of lack of definition can impact the
program. <br><br> Design by contract usually imples that the language compiler
or interpreter is enforcing the contract to the degree that the
contract specifies object types and method names. <a href="http://www.perldesignpatterns.com/?JavaLanguage">Java Language</a>
goes as far as to validate that programmers are handling error
conditions that methods list as potential reasons for failure. Most <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
languages, including Java, have a concept of "visibility": private
visibility, public visibility, and various shades inbetween are
enforced at compile time, preventing even the mere mention of something
that you shouldn't have access to. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?DesignByContract">Design By Contract</a> </li><li> <a href="#AbstractClass"><b>Abstract Class</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="#AbstractFactory"><b>Abstract Factory</b></a>  </li><li> <a href="http://www.perldesignpatterns.com/?UseDiagrams">Use Diagrams</a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="#TypedVariables"><b>Typed Variables</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?UnitTests">Unit Tests</a> </li><li> <a href="#AccessorPattern"><b>Accessor Pattern</b></a> </li><li> <a href="#InterfaceBloat"><b>Interface Bloat</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LivingDocumentation">Living Documentation</a> </li><li> <a href="http://www.perldesignpatterns.com/?UseDiagrams">Use Diagrams</a> </li><li> <a href="http://www.perldesignpatterns.com/?ConceptCrossReference">Concept Cross Reference</a> </li><li> Class::Contract </li><li> <a href="http://www.perldesignpatterns.com/?DesignByContract">Design By Contract</a> 
<br><br>
 <br><br> <a name="LayeringPattern"></a><h2><a href="#LayeringPattern"><b>Layering Pattern</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Synopsis</b></font><br><br>You broke your
code up into different packages, where it logically belongs. However,
some new features were added, and you have to start using variables for
the packages to refer to each other by because it is no longer true
that they already know which other module to invoke. Or, some parts of
the code change frequently, so you've made it easy to swap the violate
bits in and out, distancing the flurry with an API, and placed it on an
outer-more layer. <br><br>
 <font size="+2"><b>When</b></font><br><br>The layout
seemed clear, but now it isn't so straight-forward. You're afraid that
even if you change it again, it wont be good enough, and you'll have to
come back later and change it all around as soon as another feature is
added. <br><br>
 <font size="+2"><b>Symptoms</b></font><br><br>One class
has the name of another class hard-coded into it, and it isn't using
this hard-code to do argument type checking or to inherit. <br><br> If you draw your object layout on a piece of paper, it is
easy to start thinking of the design as "flat". A good design is
anything but flat. Which objects i nherit from and implement which
others can be expressed accurately on a page of paper. Which objects
hold pointers to which other kinds of objects is another page, with
arrows going all over the place. When you consider both of these kinds
of relationships together, you get something much more involved. To
simplify it as much as possible, keep your objects general, so that
they work on types of objects, not specific objects, and certainly not
just packages whose names they have hard-coded into them. Rather than
thinking of objects holding references to other objects as random
arrows flying around a page, consider the references an object holds to
be very private things, to be protected and cherished. Generally
speaking, if you have a "has a" relationship with an object, you will
seldom want to pass out references to it, or share references to it
with more than one other object. Instead, you will want to use your own
interface, or another well understood interface, to present your
treasured object to the world. Simply put, consider your object to
contain objects that you hold references to, and communicate with the
highest level holding an object as possible, rather than going over
their heads. <br><br> This gives layers to go through to reach an object. The
layers present a chance to insert needed patterns, such as Adapters,
Facades, Mementos, and Aggregate Containers. Bypassing this
encapsulation robs designers of the chance to organize the layout.
Being able to introduce other machinery lets the program grow. Keeping
things at arms length lets you isolate other objects from violate code
and parts of the system that are prone to changing. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a> </li><li> Class::Delegation </li><li> <a href="http://www.perldesignpatterns.com/?UseDiagrams">Use Diagrams</a> </li><li> <a href="#PassingPattern"><b>Passing Pattern</b></a> 
<br><br>

<br><br>
 <br><br> <a name="FunctionalProgramming"></a><h2><a href="#FunctionalProgramming"><b>Functional Programming</b></a></h2><br> 
<br><br>
 <i>A programmer who hasn't been exposed to all four of the
imperative, functional, objective, and logical programming styles has
one or more conceptual blindspots. It's like knowing how to boil but
not fry. Programming is not a skill one develops in five easy lessons.</i> 
<br><br>
 -- <a href="http://www.perldesignpatterns.com/?TomChristiansen">Tom Christiansen</a> as quoted by <a href="http://www.perldesignpatterns.com/?PerlMonks">Perl Monks</a>::34786 
<br><br>
 <i>There is sometimes a game played with ALGOL 60 programs - rewriting them to avoid using</i> goto <i>statements.
It is part of a more embracing game - reducing the extent to which the
program conveys its information by explicit sequencing ... The games
significance is that it frequently produces a more "transparent"
program - easier to understand, debug, modify, and incorporate into a
larger program.</i> -- Peter Landin, at the ACM Programming Language and Pragmatics Conference, care of Knuth's Literate Programming 
<br><br>
 What is a program if not explicit sequencing? Webster's 1913 Unabridged dictionary says: 
<br><br>
 <i>Programme \Pro"gramme\, n. [L. programma a public
proclamation, manifesto, Gr. ?, fr. ? to write before or in public; ?
before, forth + ? to write; cf. F. programme. See Graphic.] That which
is written or printed as a public notice or advertisement; a scheme; a
prospectus; especially, a brief outline or explanation of the order to
be pursued, or the subjects embraced, in any public exercise,
performance, or entertainment; a preliminary sketch.</i> <pre>  </pre>"...a
brief outline or explanation of the order to be pursued...". The strong
analogy between the sequences of instructions given to computers and
the planned ordering of events in a musical or theatrical performance
lead early British coders to coin the phrase. <br><br> Think of FORTRAN. Mathematicians, interested in using
computers to compute results of formulas, manually translated the
functions into lines of FORTRAN. FORTRAN itself stands for "Formula
Translator". Expressions of one kind - formulas - had to be manually
translated into a simple, sequential steps that early computers could
understand. <br><br>
 <a href="#FunctionalProgramming"><b>Functional Programming</b></a>
purports to do away with explicit sequencing of steps in favor the more
implicit function computation. By naming the task to be done, and
defining the task, the language fosters a <a href="http://www.perldesignpatterns.com/?TopDownProgramming">Top Down Programming</a>
approach to designing and writing programs. The assignment operation
has been singled out for removal from functional languages. This
dramatically alters the concept of "global state". Just about
everything about the state of a running program can be summerized by
where you are in the execution of the code. This is very
algorithm-centric, as opposed to data-centric. <br><br>
 <pre>  # Haskell qsort:
  
  qsort []     = []
  qsort (x:xs) = qsort elts_lt_x ++ [x] ++ qsort elts_greq_x
                 where
                   elts_lt_x   = [y | y &lt;- xs, y &lt; x]
                   elts_greq_x = [y | y &lt;- xs, y &gt;= x]
  
  # perl qsort:
  
  sub qsort {
    !@_ ? () : (qsort(grep { $_ &lt; $_[0] } @_[1..$#_]),
               $_[0],
               qsort(grep { $_ &gt;= $_[0] } @_[1..$#_]));
  }
  
  print "output: ", join ' ', qsort(51,382,5,28,382,28,6,3,92,8), "\n";
  
  </pre>The
Haskell can reportedly be read as: define the result of qsort'ing the
empty set as the empty set itself. qsort'ing one or more elements puts
the first element in x and the rest in xs. qsort is defined
recursively. Each pass, it divides up the work. When it has been broken
down as far as it can be, all of the parts are reassembled, in order.
The basis for breaking it down at each stage is dividing xs into things
less than x and things greater than or equal to x. Each of these
subsets are themselves run through qsort, with x itself stuck in the
middle. <br><br> There are a few assignments. They aren't imparitive
instructions, but rather a general definition of a method for computing
values. It could be read as a function definition, in fact. "In
general, elts_lt_x is the set of things from xs such that each is less
than x". <br><br>
 The Perl version is intentionally similar. If passed no argument, the null set is returned: 
<br><br>
 <pre>  !@_ ? () : ...</pre>
<br><br> This is a matter of explicit test placed before the recursive
calls. I said it was similar, not identical. The Haskell version shuns
anything explicitly sequential. We don't built any local definitions
for elts_lt_x or elts_greq_x, though we could, using anonymous
subroutines. Instead, we just use a couple of grep calls inline to
filter our argument list, first for everything less than the first
argument, then everything greater than or equal to the first argument.
The first argument, $_[0], is sandwiched in the middle. @_[1..$#_] is
an array slice. It returns a new array created from @_ with specified
elements. Here, we're listing elements 1 through the number of elements
in the array. $#_ contains the number of elements in @_, and the ..
operator returns all of the integers between 1 and that. This just lets
us skip the first element, since we're explicitly using it as a middle
value and sandwiching it in the middle. <br><br>
 Using local subroutines, avoiding declaring variables, and depending heavily on the lexical nature of <i>my</i> variables, you can write a very nice emulation of functional code in Perl. Now the only question is, do we want to? 
<br><br> Large numbers of global variables, or even instance variables
in objects, creates a state explosion problem: there is an absolutely
huge number of possible states [When we say "possibles states our
program could be in", we don't mean Alaska, Alabama, Arizona, etc.
We're refering to a state of being. A program at any moment in time can
be summerized by its data and instructions. The instructions typically
don't change. They're constant. The data, then, represents its state of
being.] our program could be in at any given. Merely knowing where it
is currently executing in the code tells us very little about where it
is going to go. The code conditionally changes flow dependent on the
state. This causes problems for a number of reasons. Since there is
such a huge number of possibilities - billions and billions for a
program with a few integers - it is impossible to test every
combinations of values. The global state of the program may become
corrupt over time. One object may be locked or destroyed while another
part of the code is still using it, for instance. <br><br> The root cause is a kind of duality: code is expected to run
as it is encountered by the processor. This is the "here and now" of
it. The data of the program is minipulated by these instructions. The
data in the variables dictates what the program will do in the future.
Self modifying code - programs that change their own instructions - are
another example of current execution dictating what will happen in the
future. Altering code pointers (routinely and invisibly done in both OO
and lambda code) represent a very real sort of self modification: <br><br>
 <pre>  sub get_save_filter {
    my $ext = shift;
    my $stream = shift;
    return sub {
      # do something with $stream here
    } if $ext eq 'gif';
    return sub {
      # do something with $stream here for pngs
    } if $ext eq 'png';
    return sub {
      # do something with $stream here for jpgs
    } if $ext eq 'jpg';
  }

  print "Enter a filename to save the image:\n";
  my $filename = &lt;STDIN&gt;;
  
  # find file extention: png, jpg, gif, etc
  (my $ext) = $filename =~ m/\.([a-z]+)/;
  my $save_filter = get_save_filter($ext);

  open my $f, '&gt;', $filename;
  print $f $save_filter-&gt;($image_data);</pre>
<br><br> In this example, we're using data to pick a code pointer.
$save_filter-&gt;() executes whatevercode $save_filter refers to. Both
calling a polymorphic object method, and using Perl's eval on a string,
also have the same effect. The code that gets executed may not find all
of the data it wants in a suitable state, and we may not have realized
the possibility of the sequence of events that could lead to the
situation. <br><br>
 As another example, compare: 
<br><br>
 <pre>  $dispatch_table-&gt;{$request}-&gt;();</pre>
<br><br>
 ...and... 
<br><br>
 <pre>  GOTO REQUEST*1000</pre>
<br><br> In both cases, two things are clear. How we arrive at the
actual code we're shooting for depends on only one variable, not every
variable involved in the computation, and it isn't clear which
variables will be used, and what their acceptable ranges are, once we
arrive. Our data dictates the direction of the program, but our data
and our program keep each other at quite a distance. <br><br> Objects help a bit, as our global and instance data isn't
immediately visible to whomever we're calling, and we're forced to
explicitly pass it. This helps ensure that code doesn't wind up
depending on data we weren't counting on it using. See <a href="#PassingPattern"><b>Passing Pattern</b></a>
for some rote on bunding up state and passing that explicitly. In fact,
the only thing missing is being forced to use general algorithms rather
than explicit flow control change to define functionality. You're on
your own there, partner. <br><br>
 The hullmark of <a href="#FunctionalProgramming"><b>Functional Programming</b></a>
is generic algorithms that aren't conditional or explicitly looped, but
rather have their termination condition built in to the algorithm
itself. <br><br>
 <pre>  # procedural

  for(my $i=0; $i&lt;scalar @arr; $i++) {
    ...do something to $arr[$i]...
  }

  # functional

  @arr = map { ...do something to $_... } @arr; </pre>
<br><br>
 <i>map()</i> has it's own termination condition built in: when there are no more array elements to process. <i>map()</i>
also returns the output data as a list, avoiding the need for temporary
storage - avoiding temporary storage avoids explicit sequencing of
steps. Avoiding explicit sequencing of code avoids corner cases, and
more imporatantly, avoids invloving the state of the program in the
flow of the program - a sin I equated to the computed goto. <br><br>
 Out of a useful tradition, <a href="#FunctionalProgramming"><b>Functional Programming</b></a> typically uses <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a> to cope with infinite lists. 
<br><br>
 <pre>  @arr = grep { $_ % 3 == 0 } (1..10000000); # out of memory
  foreach my $i (@arr) {
    do_something($arr[$i]);
  }

  # ... would be implemented internally using <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a> something like...

  my @arr;
  my $gen;
  do {
    my $counter;
    $gen = sub { $counter++; };
  };
  while(my $i = $gen-&gt;()) { do_something($i); }
  </pre>Code wouldn't be written this way, but this demonstrates what goes on internally. Perl does implement <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a> in a few places, including the <i>(1..1000)</i> construct. <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a> makes dealing with "infinite lists" possible. 
<br><br>
 <font size="+2"><b>Language::Functional</b></font><br><br>Language::Functional introduces more operators like <i>sort()</i> and <i>map()</i>,
designed to build algorithms rather than "procedures". Barrowing from
Language::Functional documentation, some of the highlights are: <br><br>
 <pre>  # Until p f x
  # Keep on applying f to x until p(x) is true, and then return x at that point. eg:

  $x = Until { shift() % 10 == 0 } \&amp;inc, 1; # 10

  # iterate f x
  # This returns the infinite list (x, f(x), f(f(x)), f(f(f(x)))...) and so on. 
  # Outputs [1, 2, 4, 8, 16, 32, 64, 128]

  $x = take(8, iterate { shift() * 2 } 1);

  # And xs
  # Returns true if all the elements in xs are true. Returns false otherwise. 
  # Note the capital A, so as not to clash with the Perl command 'and'. You 
  # should not try to And an infinite list (unless you expect it to fail, as it
  # will short-circuit). 

  $x = And([1, 1, 1]); # 1

  # Or xs
  # Returns true if one of the elements in xs is true. Returns false otherwise.
  # Note the capital O, so as not to clash with the Perl command 'or'. You may 
  # try to Or an infinite list as it will short-circuit (unless you expect it 
  # to fail, that is). 

  $x = Or([0, 0, 1]); # 1

  # any p xs
  # Returns true if one of p(each element of xs) are true. Returns false 
  # otherwise. You should not try to use with an infinite list (unless you expect it
  # to fail, as it will short-circuit). 

  $x = any { even(shift) } [1, 2, 3]; # 1

  # all p xs
  # Returns true if all of the p(each element of xs) is true. Returns false 
  # otherwise. You may try to use with an infinite list as it will short-circuit 
  # (unless you expect it to fail, that is). eg:

  $x = all { odd(shift) } [1, 1, 3]; # 1

  # elem x xs
  # Returns true is x is present in xs. You probably should not do this with 
  # infinite lists. Note that this assumes x and xs are numbers. 

  $x = elem(2, [1, 2, 3]); # 1

  # minimum xs
  # Returns the minimum value in xs. You should not do this with a infinite list. 

  $x = minimum([1..6]); # 1

  # maxiumum xs

  $x = maximum([1..6]); # 6

  # sum xs

  $x = sum([1..6]); 

  # product xs

  $x = product([1..6]);</pre>
<br><br> List::Utils predates but runs in the same vien with some
overlap. List::Util is by Graham Barr. Documentation borrowed from
List::Util: <br><br>
 <pre>  # reduce BLOCK LIST
  # Reduces LIST by calling BLOCK multiple times, setting $a and $b each time. 
  # The first call will be with $a and $b set to the first two elements of the 
  # list, subsequent calls will be done by setting $a to the result of the 
  # previous call and $b to the next element in the list.

  $foo = reduce { $a &lt; $b ? $a : $b } 1..10       # min
  $foo = reduce { $a lt $b ? $a : $b } 'aa'..'zz' # minstr
  $foo = reduce { $a + $b } 1 .. 10               # sum
  $foo = reduce { $a . $b } @bar                  # concat</pre>
<br><br> Returns the result of the last call to BLOCK. If LIST is empty
then undef is returned. If LIST only contains one element then that
element is returned and BLOCK is not executed. <br><br>
 Other, now familiar, functions include: 
<br><br>
 </li><li> <i>first { }</i> returns the first defined value in a list. </li><li> <i>max()</i> returns the largest value in a list. </li><li> <i>min()</i> returns the smallest value in a list. </li><li> <i>maxstr()</i> returns the lexically last string value from a list. </li><li> <i>minstr()</i> returns the lexically first string value from a list. </li><li> <i>shuffle()</i> returns the list with each element placed in a random order. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PassingPattern"><b>Passing Pattern</b></a> </li><li> <a href="#PassingState"><b>Passing State</b></a> </li><li> Language::Functional </li><li> <a href="#SelectCPANModules"><b>Select CPANModules</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=FunctionalProgramming">WikiWiki:FunctionalProgramming</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=34786">PerlMonks:34786</a> 
<br><br>

<br><br>
 <br><br> <a name="LazyEvaluation"></a><h2><a href="#LazyEvaluation"><b>Lazy Evaluation</b></a></h2><br> 
<br><br>

<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Memory, CPU
time, or program simplicity may be sacrificied when large blocks of
data are computed in a single request and buffered in memory. <br><br>
 <font size="+2"><b>Solution</b></font><br><br>Generate
streams of data as the data is required rather than in advance.
Establish a means of requesting more data from the data generator, for
when more data is required. <br><br>
 <font size="+2"><b>When</b></font><br><br></li><li> Data is expensive to compute </li><li> The exact amount of data needed is unknown </li><li> Demand for the data may end suddenly without notice </li><li> Good, quick response from the program is important 
<br><br>
 <font size="+2"><b>Discussion</b></font><br><br>Code is not evaluated until it is needed. Rather than precomputing all potentially needed values,  closures are returned.  
<br><br>
 This is <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a> applied to <a href="#FunctionalProgramming"><b>Functional Programming</b></a>
- rather than each object returning the next object in a series from a
method, a closure, when run, returns the next closure in the series. <br><br> In the object sense, each object will return the next object
on demand. Think of a linked list, where each object knows the next in
the list. <br><br>
 In the functional sense, a code reference that returns a result value   of some sort, along with another code reference.  
<br><br>
 The <a href="#IteratorInterface"><b>Iterator Interface</b></a> may also be thought of as <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a>.
The next value in the series is only computed when - and if - it is
needed, and the means to get the first item in the series is different
than the means to get the next. <br><br>
 <font size="+2"><b>Examples</b></font><br><br><pre>  # set up the generator

  my $code = do {
    my $x = 1;
    my $y = 0;
    my $next;
    $next = sub {
      # compute ongoing sum of last two numbers
      ($y, $x) = ($x, $x + $y); 
      return ($next, $x);
    };
  };

  # read values from the generator

  my $value;

  while($code) {
    ($code, $value) = $code-&gt;();
    print "Next value in the series: $value\n";
  }</pre>
<br><br>
 <a href="#StatePattern"><b>State Pattern</b></a> has a more
complicated example that uses this same idea. In it, the same closure
isn't returned each time, but instead, different closures may be
returned by each other. <br><br>
 <font size="+2"><b>Pressures</b></font><br><br></li><li> Precomputation and buffering is often easier to implement. </li><li> <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a> may be prefered by those who want an <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> interface. </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> makes any generator or container polymorphicly interchangeable with any other by using a consistent interface. </li><li> <a href="#StatePattern"><b>State Pattern</b></a> is the result of more complexity, where the next value is computed by different methods  depending on state. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#RunAndReturnSuccessor"><b>Run And Return Successor</b></a> </li><li> <a href="#FunctionalProgramming"><b>Functional Programming</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a> </li><li> <a href="#IteratorInterface"><b>Iterator Interface</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaClosure">Lambda Closure</a> </li><li> <a href="#LazyEvaluation"><b>Lazy Evaluation</b></a> </li><li> <a href="#StatePattern"><b>State Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?StructureAndInterpretationOfComputerPrograms">Structure And Interpretation Of Computer Programs</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=LazyInitialization.htm">ObjectArts:LazyInitialization.htm</a> </li><li> <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a> </li><li> <a href="http://perl.plover.com/Stream/stream.html">http://perl.plover.com/Stream/stream.html</a> 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>Cleaned up. <a href="#IteratorInterface"><b>Iterator Interface</b></a> has a lot of potential but needs a lot of
 work, probably from me. - <a href="#ScottWalters"><b>Scott Walters</b></a> - <i>Tue Aug 26 10:55:32 2003 216.190.249.92</i> 
<br><br>
 <!-- cut - end comments --> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://theoryx5.uwinnipeg.ca/CPAN/data/Object-PerlDesignPatterns/PerlDesignPatterns.html">http://theoryx5.uwinnipeg.ca/CPAN/data/Object-PerlDesignPatterns/PerlDesignPatterns.html</a> 
<br><br>
 <br><br> <a name="LawOfDemeter"></a><h2><a href="#LawOfDemeter"><b>Law Of Demeter</b></a></h2><br> 
<br><br>
 From <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=LawOfDemeter...">WikiWiki:LawOfDemeter...</a> 
<br><br>
 <i>Peter Van Rooijen<a href="http://www.perldesignpatterns.com/?PeterVanRooijen">+</a> posted the following description of the <a href="#LawOfDemeter"><b>Law Of Demeter</b></a> to <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Usenet&amp;word=%20//">Usenet: //</a> </i>
<br><br>
 <ul><li> <i>You can play with yourself.</i>
</li><li> <i>You can play with your own toys (but you can't take them apart),</i>
</li><li> <i>You can play with toys that were given to you.</i>
</li><li> <i>And you can play with toys you've made yourself.</i>
</li></ul> To avoid <a href="#ActionAtADistance"><b>Action At ADistance</b></a> and <a href="#ObjectOrgy"><b>Object Orgy</b></a>,
speak only objects near you. Mass misinformation would be radically
reduced if we read online news according to our friends blogged
recommendations rather than from TV and radio news. <br><br>
 </li><li> Use your own resources. </li><li> Use resources your friends give you. </li><li> Create resources for you and your friends. 
<br><br>
 The entire program, or the bulk of the program, being dependent on a single class is a good sign that <a href="http://www.perldesignpatterns.com/?ObjectOrientation">Object Orientation</a> has broken down. The Law Of Demter<a href="http://www.perldesignpatterns.com/?LawOfDemter">+</a>
says to deal only with those in proximity to you. This sounds harsh -
how will you ever get anything done? You don't need to depend on the
interfaces of remote objects in the system. If classes near yours can't
or shouldn't delegate requests to them, then the structure is broken.
Mass interdependency isn't encapsulation and it isn't OO. <br><br>
 Delegation is the name of the game. 
<br><br>
 </li><li> <a href="#ActionAtADistance"><b>Action At ADistance</b></a> -  State changes in one object should have a specific, well defined sphere of influence. With <a href="http://www.perldesignpatterns.com/?EventListeners">Event Listeners</a>,
those affected by change are clearly classes implementing the listening
interface. Most typically, it will be just be classes that are known to
interact - creating instances of each other, acting as collections, and
so forth. </li><li> <a href="#ObjectOrgy"><b>Object Orgy</b></a> - The
code to tweak things stays near the thing being tweaked. Values don't
change because one object queried an object from one object, then used
that to query, another object, and has been hanging onto a reference to
that. Objects are diddled using their interface - collections of
objects forming a social sphere should be considered to have an
interface too. A sort of <i>secretary-boss</i> arrangement is
instigated - requests are handed to the secretary that are meant for
the boss because the boss can't be bothered with catering the needs of
the general public - access controls need be put in place. </li><li> <a href="#GodObject"><b>God Object</b></a>
- An object that affects the state of objects remotely and uses other
objects to do dirty work while not letting go of the CPU is a <a href="#GodObject"><b>God Object</b></a>.  
<br><br>
 <pre>  # in violation of the law:

  $a-&gt;get_b()-&gt;get_c();</pre>
<br><br> This example hard-codes dependencies of the programs
structures into the current object. When these dependencies are
shallow, there is no problem. When they are deep, the program becomes
fragile - no part can be changed without breaking thousands of cases of
this sort of dependency. <br><br>
 Before stringing accessors up like popcorn on a thread, ask yourself if your class really has any business knowing how to to <i>c</i> - it probably doesn't. <i>b</i> has much more business knowing how to get to <i>c</i> - move the dependency there. 
<br><br>
 <pre>  # instead, if it really is //$a//'s personally to know about and direct things to //c//, then
  # formalize it as part of //$a//'s interface:

  $a-&gt;get_c();</pre>
<br><br>
 Here, <i>$a</i> is providing access to <i>c</i> - but <i>how</i> it provides access is left up to the implementation.  
<br><br>
 Perhaps <i>$a</i>...  
<br><br>
 </li><li> goes through an <a href="#AbstractFactory"><b>Abstract Factory</b></a> to create one on the fly. </li><li> uses a <a href="http://www.perldesignpatterns.com/?FlyWeight">Fly Weight</a> to cache them.  </li><li> has to go through an accessor in another object to track it down.  </li><li> <i>$a</i> and <i>c</i> were merged, and <i>$a</i> need only return itself when asked for <i>c</i>. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?UseDiagrams">Use Diagrams</a> have strata that illustrate seperation of classes into their social spheres. This is the <a href="#LooseCoupling"><b>Loose Coupling</b></a> angle - because objects only interact with objects near themselves, remote parts of the system are not unduely bound together. 
<br><br>
 From <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=LawOfDemeter...">WikiWiki:LawOfDemeter...</a> 
<br><br>
 <i>LoD can be regarded as the principle of assuming "least structural knowledge"</i> <i>(something its creator calls "Structure-shy programming"). The idea is to</i> <i>assume knowledge of no object's internal structure other than your own immediate self.</i> 
<br><br>
 <i>When an object is encapsulating structural knowledge and you try to take</i> <i>advantage of that, your object method is making a rigid assumption about the </i> <i>traversal path to access that knowledge. Even if its well-encapsulated, the</i> <i>path to the information may later change (perhaps due to refactoring).</i> -- <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=BradAppleton">WikiWiki:BradAppleton</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#CompositePattern"><b>Composite Pattern</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DelegationConcept">Delegation Concept</a> </li><li> <a href="#PrivateFunctions"><b>Private Functions</b></a> </li><li> <a href="#ObjectOrgy"><b>Object Orgy</b></a> </li><li> <a href="#ActionAtADistance"><b>Action At ADistance</b></a> </li><li> <a href="#StateVsClass"><b>State Vs Class</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?UseDiagrams">Use Diagrams</a> </li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="#LooseCoupling"><b>Loose Coupling</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DeCouple">De Couple</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=LawOfDemeter">WikiWiki:LawOfDemeter</a> </li><li> <a href="http://www.martinfowler.com/eaaCatalog/lazyLoad.html">http://www.martinfowler.com/eaaCatalog/lazyLoad.html</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://perlmonks.org/index.pl?node_id=278729">http://perlmonks.org/index.pl?node_id=278729</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=278375">http://perlmonks.org/index.pl?node_id=278375</a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=278375">http://www.perlmonks.org/index.pl?node_id=278375</a> </li><li> <a href="http://perlmonks.com/index.pl?node_id=278375">http://perlmonks.com/index.pl?node_id=278375</a> 
<br><br>
 <br><br> <a name="LiterateProgramming"></a><h2><a href="#LiterateProgramming"><b>Literate Programming</b></a></h2><br> 
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=LiterateProgramming&amp;word=%20a">LiterateProgramming: a</a> book by <a href="http://www.perldesignpatterns.com/?DonaldKnuth">Donald Knuth</a> 
<br><br>
 <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200937073806">ISBN ISBN 0937073806</a> 
<br><br> Literate Programming explains that writing software to be read
by a human, rather than programming for the computer, leads to better
programs through the magic of exposition. Just as when explaining a
function to someone you will suddenly stop and realize a mistake you've
made, or that extra care is put into code that will be shown to other
programmers, writing all of your code to be consumed by humans leads to
better code. Your program is written in an order that makes sense to
understand it in, very often the order it is written in. Somewhat like
a <a href="#TemplateMethod"><b>Template Method</b></a>,
additional logic is added later in the program, rather than inserted
into an existing function - refactoring for understandability. This
naturally leads to an outline form, where the main points are at the
top and the detail is at the bottom. As the code progresses,
documentation is interspersed. The documentation can be processed to
generate an interface definition and/or explanation of internal
implementation, similar to javadoc and Perl's own POD system. <br><br>
 Written in the 1970's at a time when <a href="http://www.perldesignpatterns.com/?StructuredProgramming">Structured Programming</a> was vogue, Knuth bucked the system. Instead of <a href="http://www.perldesignpatterns.com/?TopDownDesign">Top Down Design</a>,
hes talking about refactoring a program to maintain order as the
program naturally grows. For example, he proposed that thought process
of the author of the program as the program is written is a good
canidate for the best order to consider the parts of the program in as
it is read by another individual. Each concept expounds on more basic
concepts, filling in detail. <br><br>
 <i>But there has been far too much emphasis on goto
elimination instead of on the really important issues; people have a
natural tendency to set up an easily understood quantative goal like
the abolition of jumps, instead of working directly for a qualatative
goal like good program structure</i> ... <i>What we really want is to
conceive of our programs in such a way that we rarely even think about
goto statements, because the need for them hardly ever arises. The
language in which we express our ideas has a strong influence on our
thought process.</i> - <a href="#LiterateProgramming"><b>Literate Programming</b></a>, <a href="http://www.perldesignpatterns.com/?DonaldKnuth">Donald Knuth</a>, p.40 
<br><br>
 <a href="http://www.perldesignpatterns.com/?WardCunningham">Ward Cunningham</a>, the father of Wiki, talks about work on "HyperPerl", a <a href="#LiterateProgramming"><b>Literate Programming</b></a> Perl platform, at <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wiki&amp;word=HyperPerl,">Wiki:HyperPerl,</a> but has yet to release anything resembling code.    
<br><br>
 <font size="+2"><b>Categories</b></font><br><br></li><li> <a href="#CategoryBook"><b>Category Book</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CategoryRefactoring">Category Refactoring</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?DonaldKnuth">Donald Knuth</a> </li><li> <a href="http://www.perldesignpatterns.com/?StructuredProgramming">Structured Programming</a> </li><li> <a href="http://www.perldesignpatterns.com/?TopDownDesign">Top Down Design</a> </li><li> <a href="#TemplateMethod"><b>Template Method</b></a> </li><li> <a href="http://www.perlmonks.org/index.pl?node_id=64793">http://www.perlmonks.org/index.pl?node_id=64793</a> - a very good essay </li><li> <a href="http://www.perl.com/pub/a/tchrist/litprog.html">http://www.perl.com/pub/a/tchrist/litprog.html</a> </li><li> <a href="http://www.eecs.harvard.edu/%7Enr/noweb/">http://www.eecs.harvard.edu/~nr/noweb/</a> </li><li> <a href="http://winnipeg.pm.org/newsletter/">http://winnipeg.pm.org/newsletter/</a> </li><li> <a href="http://winnipeg.pm.org/newsletter/pubcrawl/pqtangle">http://winnipeg.pm.org/newsletter/pubcrawl/pqtangle</a> </li><li> <a href="http://www.perl.com/pub/a/tchrist/litprog.html">http://www.perl.com/pub/a/tchrist/litprog.html</a> 
<br><br>
 <br><br> <a name="OtherStructuredSystems"></a><h2><a href="#OtherStructuredSystems"><b>Other Structured Systems</b></a></h2><br> 
<br><br>
 <font size="+2"><b>5 relational principles</b></font><br><br><pre>  ... XXX</pre>
<br><br>
 <font size="+2"><b>full-life cycle development</b></font><br><br><pre>  ... XXX</pre>
<br><br>
 <font size="+2"><b>OSI layers</b></font><br><br><pre>  ... XXX</pre>
<br><br>
 <font size="+2"><b>CVS</b></font><br><br><font size="+2"><b>FORK &amp; MERGE</b></font><br><br>Divirging
copies happen. Refactoring, taken to an extreme, says to refactor the
shared module into existance. Is what is good for one program good for
another? We don't know, not before hand. A top-down approach fails
here. <br><br> Copying the module and hacking it up lets us reevaluate the
assumptions the module was created under. Should it do more? Less?
Different? Making changes to the original is tedious when we haven't
yet decided exactly what changes need to be made, and we just want to
experiment. <br><br> CVS (the Concurrent Versioning System) models both of these
scenarios. You'll sometimes hear about the Linux kernel (for instance)
"forking". In reference to the CVS tree (as opposed to a process), a
decision has been made to go two seperate directions with the code at
once. This flies in the face of Refactoring conventional wisdom, where
only small, incremental, individually tested changes are made. We're
violating the more sacred principle: <a href="http://www.perldesignpatterns.com/?KeepItWorking">Keep It Working</a>.
We're breaking it apart and putting it back together. We're shuffing
the past. CVS lets you track exactly what has changed from two
divergent versions. Certain things will be moved to the "old" or
"stable" branch: security fixes, bug fixes, and things of that ilk.
Likewise, security and bug fixes in the old version are merged into the
new version. The "stable" branch isn't the newest, greatest version,
but it doesn't contain large amounts of new, realtively untested code.
Meanwhile, the new version starts to come together, passes its <a href="http://www.perldesignpatterns.com/?UnitTests">Unit Tests</a>, if it has them, and is slowly adopted by users (the brave at first, and then the rest). 
<br><br> Certainly any change can be made through incremental
refactoring improvements in code. The power of making radical, sweeping
changes or importing a large section of code that was developed
independently can often justify foregoing strict refactoring principles
temporarily. <br><br>
 <font size="+2"><b>BACKING OUT CHANGES AND THE LOG</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <br><br> <a name="DebuggingPattern"></a><h2><a href="#DebuggingPattern"><b>Debugging Pattern</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Problem</b></font><br><br>Code doesn't work as desired. 
<br><br>
 <font size="+2"><b>Solution</b></font><br><br>Rule out the obvious problems, then rule out the unlikely. 
<br><br>
 <font size="+2"><b>Essential Debugging Aids</b></font><br><br></li><li> Are you doing <i>use warnings;</i> and <i>use strict;</i>? </li><li> Don't understand them? Then <i>use diagnostics;</i>. </li><li>
Did your CGI script output headers? Does the log say anything? View the
source code of the outpage webpage. Does your CGI script pass syntax
check using <i>perl -c myprogarm.cgi</i>? Are you doing <i>use CGI::Carp 'fatalsToBrowser';</i>?
Run the program from the command line and make sure the headers
actually come first. See "Premature End of Script Headers" below. </li><li>
Do you know the exact datatype of each variable? If something is a
reference to a hash of references to scalars containing numbers, it is
essentially that you treat that variable in exactly that way, or else
data will mysterious disappear, and you'll get reference type errors. <i>use strict</i>
will complain about not being able to dereference things that aren't
references - this can save you. Assertions are an essential debugging
technique. States such as <i>ref($var) eq 'ARRAY'</i> assert that <i>$var</i>
is an array reference. If this assertion is false, things grind to a
halt. Languages with strict typing do this automatically. Perl can do
this too: see <a href="#TypedVariables"><b>Typed Variables</b></a>, <a href="#TypeSafety"><b>Type Safety</b></a>. 
<br><br>
 <font size="+2"><b>Good Style</b></font><br><br>I imagine
mechanics have the same problem, but people will show me code that is
broken in a hundred different ways, and it is amazing that it parses at
all, and remarkable that it does anything close to what it was meant to
do. In the mythos of <a href="#LiterateProgramming"><b>Literate Programming</b></a>,
this program should be shot. If the programmer can't figure out what
the program is supposed to do, the computer doesn't have a chance. <br><br>
 <i>How often have I said to you that when you have eliminated the</i> <i>impossible, whatever remains, however improbable, must be the truth?</i>  - Sherlock Holmes, The Sign of the Four  
<br><br>
 Using good style means fixing the obvious problems first. Some constructs are vulernable to <a href="#ActionAtADistance"><b>Action At ADistance</b></a>
problems, and make debugging hard even for a seasoned veteran. If you
don't fix the obvious problems, you'll never be able to narrow it down
to the subtle ones. You'll spend your days poking the program with a
stick, idlely - and ignorantly - speculating about what is wrong with
it. <br><br> When given a nasty ugly program and told to make it work, I
first start by removing dangerous, outdated, and ignorant constructs
and replacing them with what experience has shown to be much better
techniques. In 95% of the cases, the problem mysteriously went away
just as mysteriously as it came. In the other 5% of the cases, the bug
was eventually made obvious. Don't ask for help unless you're willing
to do the grunt work of smoking out bugs yourself. <br><br>
 </li><li> Is your program writting in a style (using <i>local</i> instead of <i>my</i> or other Perl 4 constructs) that is outdated and depricated? Clean it up - use good style. </li><li> Is the program too complex for you to understand? Clean it up - use good style. </li><li> Get rid of <a href="#CutAndPasteProgramming"><b>Cut And Paste Programming</b></a>, <a href="#ActionAtADistance"><b>Action At ADistance</b></a>, <a href="#GodObject"><b>God Object</b></a> problems. 
<br><br> Still doesn't work? Test your basic assumptions - anything
used as input - environment variables, whether or not files open
successfully, what arguments are passed in. Log them, trace the flow of
the program, and double check that the values coming in are valid. This
narrows the problem down to being inside or outside of a given point.
If the arguments are correct and the routine still doesn't work, the
problem is inside. Narrow it down further - insert more checkpoints.
Use trial and error to get as close as possible to the point of
malfunction. <br><br>
 <font size="+2"><b>Lock-Ups</b></font><br><br>Does the program lock up and not respond? 
<br><br>
 <pre>  $SIG{INT} = sub { require Carp; Carp::croak(); };</pre>
<br><br>
 From UNIX-like systems, sending an INT signal to the process will cause it to dump its stack: 
<br><br>
 <pre>  kill -INT 1032 # if 'ps' says the process id for perl is 1032</pre>
<br><br>
 <a href="http://www.perldesignpatterns.com/?PriorityInversion">Priority Inversion</a> and Thread Starvation<a href="http://www.perldesignpatterns.com/?ThreadStarvation">+</a> are two cause of lockups. Endless Loops<a href="http://www.perldesignpatterns.com/?EndlessLoops">+</a> and Busy Spins<a href="http://www.perldesignpatterns.com/?BusySpins">+</a> are two more. 
<br><br>
 <font size="+2"><b>Premature End of Script Headers</b></font><br><br>Put <i>use CGI::Carp 'fatalsToBrowser;</i> at the top of the script, right after the <i>#!/usr/bin/perl</i> line and before any other <i>use</i>
lines. CGI::Carp directs most run-time and compilation errors to the
web browser, so you can see them. This is easier than running the
script at the command prompt, as a command prompt may not be available
on a remote server, and the natural environment of the running script
is preserved. This may or may not solve the problem. If the script is
failing to generate headers because of a syntax error or run-time
error, this will probably save you. If the script simply fails to print
the headers, this won't. <br><br>
 Make sure send your headers <i>before</i> anything else.
Nothing else should be printed. Not debug information, nothing. People
have a really hard time with this, so I'll say it again: <i>nothing</i> should be printed to <i>STDOUT before the headers. If there is any doubt, send the content type header from a </i>BEGIN<i> block at the top of the program: </i>
<br><br>
 <pre>  #/usr/bin/perl
  use CGI::Carp 'fatalsToBrowser';
  BEGIN { print "Content-type: text/html\r\n\r\n"; }</pre>
<br><br>
 Almost every case of this error message is for one of the two reasons above. If both of those fail, then run <i>perl -c</i> on your program to check it's syntax, or test it from the command line. Check your <tt>error_log</tt> file, often <tt>/usr/local/etc/httpd/logs/error_log</tt> [The first hint of site configuration will change this, though. Most Linux distros heavily pre-configure things for you.]. 
<br><br>
 <font size="+2"><b>Executable Not Found</b></font><br><br>Using a DOS editor, or editing a DOS file with a Unix editor that hides the line feeds (control-M, usually printed as <tt>^M</tt>
on the screen) usually causes this. The script file is found just fine,
but when your Unix-like system tries to execute the interpeter for it
as specified on the she-bang line, it fails. Turn off DOS edit mode and
remove the <tt>^M</tt>, or add a space and two dashes after the Perl executable to make the <tt>^M</tt> harmless. 
<br><br>
 <pre>  #!/usr/bin/perl^M
  # Executable not found - Unix can't find "/usr/bin/perl^M" to run!

  #!/usr/bin/perl --^M
  # This is okay, the -- tells Perl that arguments to Perl itself end,
  # and the ^M will probably be ignored by the script itself in a normal
  # CGI application.</pre>
<br><br>
 <font size="+2"><b>Ghost New-Lines</b></font><br><br>Reading input from a file or pipe perpetuates the newline by default: 
<br><br>
 <pre>  my $input = &lt;STDIN&gt;; # input has a carrage return on the end!</pre>
<br><br>
 Use <i>chomp($input);</i> to remove the new-line. If none
exists, nothing bad will happen. Nothing will happen. You may wish to
use it "just in case" before using data of dubious origin. Of course,
you should Use Taint<a href="http://www.perldesignpatterns.com/?UseTaint">+</a> when dealing with any input - see <a href="http://www.perldesignpatterns.com/?ValidateInput">Validate Input</a> for why. 
<br><br>
 <font size="+2"><b>Premature End of Input</b></font><br><br>Signals
can interrupt requests to read data, causing "", the zero-length
string, to be returned. Reading a string of zeros ('0' or '0000') and
some other character sequences is interpeted by Perl as "false", and
will cause reading to abort if tested as a truth value. <br><br>
 <pre>  # this example suffers from the two problems explained above:

  while($line = read_input())) { };</pre>
<br><br>
 To correct this, insert the single keyword <i>defined</i>: 
<br><br>
 <pre>  while(defined $line = read_input())) { };</pre>
<br><br>
 <i>read_input()</i> is some generic function that reads data from input, perhaps using <i>read()</i> or <i>&lt;$fh&gt;</i>. 
<br><br>
 <i>defined()</i> tests whether or not its expression, in this case <i>read()</i>, returned a defined value. All of "false", "zero", and the empty string are considered "defined" - <i>defined()</i> will return a true value for any of those. Of course, any true value is defined. The only thing <i>not</i> defined is <i>undef</i> itself. I/O functions may return the special undefined value. The Perl keyword <i>undef</i> generates the undefined value on demand. 
<br><br>
 <pre>  # this will continue reading, even if a "false" value is read in, until the end of the file.
  # the end of the file is marked with an "undefined" value.

  while(&lt;$sh&gt;) { $output .= $_ }</pre>
<br><br>
 Perl has <i>while()</i> magic for this form: <i>while(&lt;&gt;)</i>. In cases like this, Perl tests definedness of the return value rather than truth - in other cases, <i>while()</i> only tests for true/false, and not definedness. 
<br><br>
 ( 
<br><br>
 Actually, Perl changes the code internally. B::Deparse shows that Perl does in fact add a defined operator and assigns to $_: 
<br><br>
 <pre>  $ perl -MO=Deparse -e'while (&lt;STDIN&gt;) { undef; }'
  while (defined($_ = &lt;STDIN&gt;)) {
          undef;
  }
  -e syntax OK</pre>
<br><br>
 ) 
<br><br>
 <pre>  # this will stop looping at the first "false" value:

  while($a) { $a = get_next_value(); }</pre>
<br><br>
 The <i>eof()</i> call is a common source of problems: it does not return a meaningful value until after the first read on a filehandle: 
<br><br>
 <pre>  # this won't read anything, and if it does, it's a fluke: don't do this:

  while(!eof($fh)) { $output .= &lt;$fh&gt;; }</pre>
<br><br>
 <i>eof()</i> is difficult to use. It doesn't return false
until after an attempt has been made to read past the end of the file,
so it offers no advantages over <i>read()</i> or the <i>&lt;$fh&gt;</i> construct for building loops. Confusion with stdio, buffering, ungetting, and so forth, make it worse. Use <i>read()</i> or <i>&lt;$fh&gt;</i> instead. 
<br><br>
 <font size="+2"><b>Undefined Method and Not a Foo Reference</b></font><br><br>If you can't keep datatypes stright in your head, Perl doesn't have a chance [<a href="http://www.perldesignpatterns.com/?MarkJasonDominus">Mark Jason Dominus</a>
has something to say about this]. A "reference to array of hashes
containg instances of CGI" is different than a "reference to a scalar
that contains the name of another scalar that holds an integer". Perl
not having strict type checking means you have to do it yourself. Use <a href="#AssertPattern"><b>Assert Pattern</b></a>
to make sure datatypes really are what you think they are. Data::Dumper
is useful for examining datastructures to check that they are as you
expect. <br><br>
 <font size="+2"><b>Unmatched //}// at End of File</b></font><br><br>I'm
sure that there is an Emacs equivilent, but vi defines the "%" key to
find what any given brace matches [It isn't smart about language
syntax, so it can be thrown]. For each level of indenting, check the
open brace to make sure it is closed where you expect. If your code
"cuddles", the close bracket will be in the same column as the line
that has the open braces: <br><br>
 <pre>  do {
    $something-&gt;something();
  };</pre>
<br><br>
 If your code doesn't cuddle, the open and close brace will be in the same column on your screen: 
<br><br>
 <pre>  do
  {
    $something-&gt;something();
  };</pre>
<br><br>
 ...which brings up an important point: 
<br><br> Indent your code! Indent it correctly. The braces are the
corner stone of indenting in a C-like language like Perl. In fact, if
you were to reliable indent your code, a language wouldn't even need
the braces to catch your meaning [Yes, I'm talking about Python]. In
side of your braces, which are aligned, is more code. This code will be
shifted over a few columns. This is a recursive process. Braces may
contain braces may contain braces... <br><br>
 <pre>  {
    {
      {
      }
    }
  } </pre>
<br><br> Closing a brace as soon as you open it, before writing code to
put inside, can be a good habit, especially if you have problems
remembering to close them. Failing to indent by a consistent number of
spaces will make it unclear whether or not an open brace wasn't closed,
or you indented extra spaces: <br><br>
 <pre>  {
    {
      {
        # further down the page...
      }
   }</pre>
<br><br> Python prevents human confusing errors stemming from indenting
not matching the code structure. Indentation and bracketing are forced
to match - they cannot get out of sync. You can't confuse the computer,
and the computer can't confuse you. Should you desire this kind of
stricture for yourself (or your employee), <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=Juerd">PerlMonks:Juerd</a> wrote a Perl source filter - see <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=266609">PerlMonks:266609</a> . 
<br><br>
 Before asking for help, and before getting frustrated, fix your indenting. You might just find your bug. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlGotchas">Perl Gotchas</a> </li><li> <a href="http://www.perldesignpatterns.com/?BadStyle">Bad Style</a> </li><li> <a href="http://www.perldesignpatterns.com/?AntiPatterns">Anti Patterns</a> </li><li> <a href="#ErrorReporting"><b>Error Reporting</b></a> </li><li> <a href="#ErrorHandling"><b>Error Handling</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?TestUnit">Test Unit</a> </li><li> <a href="#TypedVariables"><b>Typed Variables</b></a> </li><li> <a href="#ActionAtADistance"><b>Action At ADistance</b></a> </li><li> <a href="#AssertPattern"><b>Assert Pattern</b></a> </li><li> <a href="#TypeSafety"><b>Type Safety</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?GettingHelp">Getting Help</a> </li><li> <a href="http://www.perldesignpatterns.com/?UseFatal">Use Fatal</a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.bot-depot.com/framechat.pl?n=chat">http://www.bot-depot.com/framechat.pl?n=chat</a> </li><li> <a href="http://www.perlmonks.com/index.pl?displaytype=raw&amp;node=showchatmessages">http://www.perlmonks.com/index.pl?displaytype=raw&amp;node=showchatmessages</a> 
<br><br>
 <br><br> <a name="SelectCPANModules"></a><h2><a href="#SelectCPANModules"><b>Select CPANModules</b></a></h2><br> 
<br><br> [This should be a module API/inheritance thing like the second
half of "Java in a Nutshell", O'Reilly. Obviously, it isn't finished.
Each module should have a blurb of what it does, its public methods,
which modules accept it as an argument, which modules extend it, and
which modules it extends. This will be the most heavily used, valuable
thing in the book, if Java in a Nutshell is any indication.It has
recently come to my attention that such a thing does exist in Perl-land
- Perl In ANut Shell<a href="http://www.perldesignpatterns.com/?PerlInANutShell">+</a> has it. Well, we can still do it with a focus on OO crud.] 
<br><br>

<br><br>
 THREADS 
<br><br>
 <pre>  threads::shared::semaphore - thread::safe semaphores
    use threads::shared::semaphore;
    my $s = new threads::shared::semaphore;
    $s::&gt;up;     # Also known as the semaphore V ::operation.
    # The guarded section is here
    $s::&gt;down;   # Also known as the semaphore P ::operation.</pre>
<br><br>

<br><br>
 <pre>    # The default semaphore value is 1.
    my $s = new threads::shared::semaphore($initial_value);
    $s::&gt;up($up_value);
    $s::&gt;down($up_value);</pre>
<br><br>

<br><br>
 <pre>  threads::shared::queue - thread::safe queues

    use threads::shared::queue;
    my $q = new threads::shared::queue;
    $q::&gt;enqueue("foo", "bar");
    my $foo = $q::&gt;dequeue;    # The "bar" is still in the queue.
    my $foo = $q::&gt;dequeue_nb; # returns "bar", or undef if the queue was
                              # empty
    my $left = $q::&gt;pending;   # returns the number of items still in the queue</pre>
<br><br>

<br><br>
 B 
<br><br>
 <pre>  B::Xref - Generates cross reference reports for Perl programs
  perl ::MO=Xref[,OPTIONS] foo.pl</pre>
<br><br>
 SYSTEM 
<br><br>
 <pre>  <a href="http://www.perldesignpatterns.com/?PeekPoke">Peek Poke</a>
  Sys::CPU
  Mmap

  POSIX - Perl interface to IEEE Std 1003.1

    use POSIX;
    use POSIX qw(setsid);
    use POSIX qw(:errno_h :fcntl_h);
    printf "EINTR is %d\n", EINTR;
    $sess_id = POSIX::setsid();
    $fd = POSIX::open($path, O_CREAT|O_EXCL|O_WRONLY, 0644);
    # note: that's a filedescriptor, *NOT* a filehandle</pre>
<br><br>

<br><br>
 BUSINESS 
<br><br>
 <pre>  Barcode::Code128
  Business::UPS
  Date::Calc</pre>
<br><br>
 WEB 
<br><br>
 <pre>  CGI_Lite
  CGI</pre>
<br><br>
 DEBUGGING/TEST 
<br><br>
 <pre>  Carp::Assert
  traceFunc
  Test::<a href="http://www.perldesignpatterns.com/?MockObject">Mock Object</a>
  Test::Class
  Text::Balanced
  Test::FIR -- publish to web pass/fail status of tests
  Test::<a href="http://www.perldesignpatterns.com/?MockObject">Mock Object</a> - <a href="http://www.perl.com/pub/a/2002/07/10/tmo.html">http://www.perl.com/pub/a/2002/07/10/tmo.html</a></pre>
<br><br>

<br><br>
 MATH 
<br><br>
 <pre>  Math::LP::Solve
  Math::<a href="http://www.perldesignpatterns.com/?LinearCombination">Linear Combination</a>
  Math::<a href="http://www.perldesignpatterns.com/?SimpleVariable">Simple Variable</a>
  PDL::R::math              Routines from the "R" statistical language. "R" is like "S".
  Statistics::Regression 
  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=89236">PerlMonks:89236</a> - operations on vectors of X,Y,Z</pre>
<br><br>

<br><br>
 NATURAL LANGUAGE 
<br><br>
 <pre>  Text::Metaphone
  Text::English             Porter's stemming algorithm  
  Text::NLP
  Festival::Client
  Sort::Naturally 
  Text::Metaphone 
  WWW::Babelfish </pre>
<br><br>
 LANGUAGE &amp; SYNTAX 
<br><br>
 <pre>  Error                     Gives try { } catch { } finally { }
  Devel::Coverage
  Devel::Peek
  Inline
  Inline::Files
  Jvm 
  parrot_0.0.6.tgz
  Perl6::Currying
  Perl6::Variables
  <a href="http://search.cpan.org/author/ROBIN/Want-0.05/Want.pm">http://search.cpan.org/author/ROBIN/Want-0.05/Want.pm</a> - Perl6ish generic contexts
  Coy
  Safe::Hole
  Safe::b2.tar.gz
  Symbol::Approx::Sub       Call methods by approximate names
  Switch
  <a href="http://www.perldesignpatterns.com/?PadWalker">Pad Walker</a>                 Inspect lexicals from enclosing subroutines
  B::Graph
  Memoize
  Softref
  Sub::Uplevel
  Alias                     Like <a href="http://www.perldesignpatterns.com/?ImplicitThis">Implicit This</a>.pm, but they beat me to the punch =(
  <a href="http://www.perldesignpatterns.com/?AnyLoader">Any Loader</a>                 Automatic module loading on-demand
  Apache::Mmap              mmap interface, not sure about Apache assocation
  Attribute::Deprecated
  Attribute::Handlers
  English::Reference        Use words to dereference things - Jerrad Pierce 
  Language::Functional
  Sub::Approx - Exposed (with historical interest) on <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=24492">PerlMonks:24492</a>

  Scalar::Util
  List::Utils 

      blessed dualvar isweak readonly reftype tainted weaken Scalar keywords.
      Weak references, scalar attributes.
      Array::mode sum(), min(), max() etc methods.

  overload 

    Package for overloading perl operations - See <a href="#OverloadOperators"><b>Overload Operators</b></a>

    package <a href="http://www.perldesignpatterns.com/?SomeThing">Some Thing</a>;
    use overload
        '+' =&gt; \&amp;myadd,
        '::' =&gt; \&amp;mysub;
        # etc
    ...
    package main;
    $a = new <a href="http://www.perldesignpatterns.com/?SomeThing">Some Thing</a> 57;
    $b=5+$a;
    ...
    if (overload::Overloaded $b) {...}
    ...
    $strval = overload::<a href="http://www.perldesignpatterns.com/?StrVal">Str Val</a> $b;

  <a href="http://www.perldesignpatterns.com/?UseFields">Use Fields</a></pre>
<br><br>

<br><br>
 GRAPHICS 
<br><br>
 <pre>  perl::vgalib
  <a href="http://www.perldesignpatterns.com/?OpenGL">Open GL</a>
  SDL::sdlpl
  GDGraph3d
  ANSIColor
  Curses
  GD
  Tk
  X11::Protocol</pre>
<br><br>
 IO 
<br><br>
 <pre>  Compress::Zlib
  File::<a href="http://www.perldesignpatterns.com/?PathConvert">Path Convert</a>

  IO 

    Load various IO modules
    IO provides a simple mechanism to load some of the IO modules at one go. 
    Currently this includes:

    IO::Handle
    IO::Seekable
    IO::File
    IO::Pipe
    IO::Socket

  IPC::Open3

    open3 - open a process for reading, writing, and error handling

    $pid = open3(\*WTRFH, \*RDRFH, \*ERRFH, 'some cmd and args', 'optarg', ...);

  IPC::Open2

    open2 - open a process for both reading and writing

    use IPC::Open2;
    $pid = open2(\*RDR, \*WTR, 'some cmd and args'); # or
    $pid = open2(\*RDR, \*WTR, 'some', 'cmd', 'and', 'args');

  File::stat 

    By-name interface to Perl's built::in stat() functions

    use File::stat;
    $st = stat($file) or die "No $file: $!";
    if ( ($st::&gt;mode &amp; 0111) &amp;&amp; $st::&gt;nlink &gt; 1) ) {
        print "$file is executable with lotsa links\n";
    }
    use File::stat qw(:FIELDS);
    stat($file) or die "No $file: $!";
    if ( ($st_mode &amp; 0111) &amp;&amp; $st_nlink &gt; 1) ) {
        print "$file is executable with lotsa links\n";
    }

    File::LockDir
    File::Path
    File::Spec</pre>
<br><br>
 SECURITY <pre>  
  IO::Socket::SSL
  Crypt::SSLeay
  Crypt::<a href="http://www.perldesignpatterns.com/?OpenSSL">Open SSL</a>::Random
  Crypt::<a href="http://www.perldesignpatterns.com/?OpenSSL">Open SSL</a>::RSA
  Crypt::<a href="http://www.perldesignpatterns.com/?OpenSSL">Open SSL</a>::DSA</pre>
<br><br>
 NET 
<br><br>
 <pre>  Net::DNSServer        cnpOa Secure and Extensible Name Server
  Net::FTP              adpf? Interface to File Transfer Protocol
  Net::AIM              adpO? AOL Instant Messenger TOC protocol           ARYEH
  Net::AOLIM            RdpO? AOL Instant Messenger OO Interface (TOC)     RWAHBY
  Net::Gnutella         bdpO? Gnutella network (v0.4) interface
  Net::LDAP - <a href="http://www.perlmonth.com/perlmonth/issue11/ldap.html">http://www.perlmonth.com/perlmonth/issue11/ldap.html</a>
  Net::LDAPapi
  Net::NNTP
  Net::ICQ              bmpO? Client interface to ICQ messaging
  Net::IMAP             adpO? Interface to IMAP Protocol (RFC2060)
  Net::IRC              cdpO? Internet Relay Chat interface
  Net::Ident            RdpO? Performs ident (rfc1413) lookups
  Net::POP3             adpO? Client interface to POP3 protocol
  Net::Ping             <a href="http://www.perldesignpatterns.com/?SupOp">Sup Op</a> TCP, UDP, or ICMP ping
  Net::SFTP             bdpOp Secure File Transfer Protocol client
  Net::SMPP             cdpO? Protocol for sending SMS (to GSM or CDMA).   SAMPO
  Net::SMS              <a href="http://www.perldesignpatterns.com/?RdpOp">Rdp Op</a> Send SMS wireless text::messages.
  Net::SMTP             adpf? Interface to Simple Mail Transfer Protocol   GBARR
  Net::SNMP             <a href="http://www.perldesignpatterns.com/?MdpOp">Mdp Op</a> Object oriented interface to SNMP            DTOWN
  Net::SNPP             cdpO? Client interface to SNPP protocol            DREDD
  Net::SOCKS            cdcf? TCP/IP access through firewalls using SOCKS  SCOOPER
  Net::SSH              Rdphp Perl extension for secure shell              IVAN
  Net::SSL              RdcO? Glue that enables LWP to access https URIs 
  Net::ICQV5CD
  Net::IRC
  Net::Server
  Net::Telnet
  NNTPClient
  SNMP::Util
  Socket6
  X11::Protocol
  Math::ematica
  POP3Client
  Geo::<a href="http://www.perldesignpatterns.com/?WeatherNOAA">Weather NOAA</a>
  IPTables
  News::Article
  Mail::Header
  Mail::Internet
  Mail::Mailer
  Mail::Sendmail
  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=55320">PerlMonks:55320</a> - Decimal IP address to binary and company
  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=102506">PerlMonks:102506</a> - Detect machine endianness
  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=202181">PerlMonks:202181</a> - EDI - prolly a CPAN module that would surplant this though
  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=66135">PerlMonks:66135</a> - non-blocking TCP connections</pre>
<br><br>
 WEB 
<br><br>
 <pre>  CGI_Lite
  CGI
  URI
  URI::Escape
  Template
  HTML::Mason
  HTML::Parser
  HTML::Template
  CGI::Application
  CGI::Carp
  HTML::Form
  HTML::TokeParser
  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=240866">PerlMonks:240866</a> - pure perl image size decoder</pre>
<br><br>
 DATABASE 
<br><br>
 <pre>  DBI
  DBD::JDBC
  DBD::Pg
  DBD::mysql
  DBD::Oracle
  DBD::Sybase
  Sybase::DBlib
  DB_File</pre>
<br><br>
 DATA 
<br><br>
 <pre>  Storable
  SOAP                      cmpO? SOAP/Perl language mapping 
  SWF::File
  Archive::Any
  Archive::Tar
  Pod::<a href="#DocBook"><b>Doc Book</b></a>
  Roman
  <a href="http://www.perldesignpatterns.com/?ArrayHashMonster">Array Hash Monster</a>
  <a href="http://www.perldesignpatterns.com/?DateManip">Date Manip</a>
  Mail::<a href="http://www.perldesignpatterns.com/?MboxParser">Mbox Parser</a>
  Tie::CArray
  XML::Parser
  XML::QL                   An XML query language
  Spreadsheet::<a href="http://www.perldesignpatterns.com/?ParseExcel">Parse Excel</a> 
  Spreadsheet::<a href="http://www.perldesignpatterns.com/?ParseExcel">Parse Excel</a>::Simple
  MD5
  MIME::Base64
  MIME::Head
  Number::Format
  Crypt::Blowfish
  Date::Calc
  Date::Format
  Date::Parse
  Date::Simple
  Digest (and friendes SHA/MD5, etc)
  Compress::Zlib
  Archive::Tar
  Archive::Zip
  PerlDataLanguage
  Text::Balanced and Regexp::Common</pre>
<br><br>

<br><br>
 CLASS/OO 
<br><br>
 <pre>  Class::Classless
  Class::Container
  Class::Contract
  Class::DBI
  Class::Data::Inheritable
  Class::Date (high <a href="http://www.perldesignpatterns.com/?MilliGraham">Milli Graham</a> weight)
  Class::Delegation
  Class::Fields
  Class::Inner
  Class::Loader
  Class::<a href="http://www.perldesignpatterns.com/?MethodMaker">Method Maker</a>
  Class::Multimethods
  Class::Object
  Class::Object             adpO? Store Object definitions with Data::Dumper   VIPUL
  Class::<a href="http://www.perldesignpatterns.com/?ObjectTemplate">Object Template</a>
  Class::Observable
  Class::Privacy
  Class::Prototyped
  Class::<a href="#PseudoHash"><b>Pseudo Hash</b></a>
  Class::Singleton
  Class::Virtual
  Class::Visitor
  Clone                     idch? Recursive copy of nested objects             RDF
  Concurrent::Object       See <a href="http://www.perldesignpatterns.com/?MailOrder">Mail Order</a> - fires off a method call in the background
  Event                    Base implementation of channel/event listeners and daemon
  <a href="http://www.perldesignpatterns.com/?FreezeThaw">Freeze Thaw</a>                bdpf? Convert arbitrary objects to/from strings    ILYAZ
  Interface::Polymorphism  Gives "implements" and "interface" keywords.
  Marshal::Dispatch         cdpO? Convert arbitrary objects to/from strings    MUIR
  Marshal::Eval             cdpO? Undo serialization with eval                 MUIR
  Marshal::Packed           cdpO? Run::length coded version of Marshal module   MUIR
  Module::Reload
  Module::Require
  Module::Use
  NEXT                     Redispatch method lookups
  Persistence::
  Protect
  Storable                  Smcrp Persistent data structure mechanism          AMS
  Sub::Parameters - <a href="http://search.cpan.org/author/RCLAMP/Sub-Parameters-0.03/lib/Sub/Parameters.pm">http://search.cpan.org/author/RCLAMP/Sub-Parameters-0.03/lib/Sub/Parameters.pm</a>
  Tangram                   RmpO? Object persistence in relational databases   JLLEROY
  import                   use import qw( org::w3c::dom );  # Loads all .pm's in org/w3c/dom/*
  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=96780">PerlMonks:96780</a>          Curse - XS code example of diddling //bless// info on objects.</pre>
<br><br>
 PERSISTANCE 
<br><br>
 <pre>  Persistent::Base             bdpO? Persistent base classes (&amp; DBM/File classes) DWINTERS
  Persistent::DBI              bdpO? Persistent abstract class for DBI databases  DWINTERS
  Persistent::<a href="http://www.perldesignpatterns.com/?MySQL">My SQL</a>            bdpO? Persistent class for <a href="http://www.perldesignpatterns.com/?MySQL">My SQL</a> databases         DWINTERS
  Persistent::Oracle           bdpO? Persistent class for Oracle databases        DWINTERS
  Persistent::Sybase           bdpO? Persistent class for Sybase databases        DWINTERS
  Persistent::mSQL             bdpO? Persistent class for mSQL databases          DWINTERS
  Persistent::LDAP             bdpO? Persistent class for LDAP directories        DWINTERS
  Persistence::Database::SQL
  Persistence::Object::Postgres
  Storable
  CGI::Persistent

  CORBA::IOP::IOR              adpO? Decode, munge, and re::encode CORBA IORs      PHILIPA
  CORBA::IDLtree               Rdpf? IDL to symbol tree translator                OMKELLOGG</pre>
<br><br>

<br><br>
 JUST PLAIN FUNNY  
<br><br>
 <pre>  Bone::Easy
  Sex 
  Acme::Inline::PERL
  Class::Classless - <a href="http://search.cpan.org/author/SBURKE/Class-Classless-1.34/Classless.pm">http://search.cpan.org/author/SBURKE/Class-Classless-1.34/Classless.pm</a></pre>
<br><br>

<br><br>
 UNSORTED 
<br><br>
 <pre>        Authen::SASL
        Bit::Vector (broken)
        CPAN
        Devel::Cover
        Devel::Coverage (broken, but not sure since we got Devel::Cover)
        Devel::Peek
        Expect
        Event
        FCGI
        LWP
        Mon
        Pod::Man (used by Makefile generated by Makefile.PL)
        POE
        Time::HiRes
        <a href="http://www.perldesignpatterns.com/?WxPerl">Wx Perl</a>? (lots of XS, very chummy with <a href="http://www.perldesignpatterns.com/?MakeMaker">Make Maker</a>?)</pre>
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=Module+Reviews">PerlMonks:Module+Reviews</a> </li><li> <a href="http://www.pobox.com/%7Eschwern/cgi-bin/perl-qa-wiki.cgi?EssentialModules">http://www.pobox.com/~schwern/cgi-bin/perl-qa-wiki.cgi?EssentialModules</a> on <a href="http://www.perldesignpatterns.com/?MichaelScwern">Michael Scwern</a>'s Wiki </li><li> <a href="http://www.cpan.org/modules/01modules.index.html">http://www.cpan.org/modules/01modules.index.html</a> - module index on CPAN itself </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=54389">PerlMonks:54389</a> - most frequently mentioned modules on <a href="http://www.perldesignpatterns.com/?PerlMonks">Perl Monks</a> </li><li> <a href="http://www.perl.com/pub/a/2003/05/29/treasures.html">http://www.perl.com/pub/a/2003/05/29/treasures.html</a> </li><li> <a href="http://www.officevision.com/pub/p5ee/components.html">http://www.officevision.com/pub/p5ee/components.html</a> 
<br><br>
 $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Id&amp;word=%20SelectCPANModules,v">Id: SelectCPANModules,v</a> 1.35 2003/08/08 23:53:45 phaedrus Exp $ 
<br><br>
 <br><br> <a name="HowDoesPerlStackUp"></a><h2><a href="#HowDoesPerlStackUp"><b>How Does Perl Stack Up</b></a></h2><br> 
<br><br>
 How does Perl stack up against other OO languages? 
<br><br>
 <i>One test of whether someone is a good programmer is to
ask them to assess the tools they use -- languages, libraries, and
operating systems. Someone who cannot perceive flaws, who cannot
express an opinion about the low and high points of a design, is either
not accustomed to thinking analytically about the systems they
encounter or is blindly partisan in the service of their chosen
favorites. Computing, at least in the exploratory fields where I hang
out, is more of an art than a science, and inability to critique a
design is a serious liability.</i> - from <a href="http://www.amk.ca/python/writing/warts.html">http://www.amk.ca/python/writing/warts.html</a> - author unknown 
<br><br> We've all heard the flame wars. OO flame wars take the form
"Langauge Y isn't really OO because it doesn't do X". Since objects
were a new feature introduced in Perl 5, we can safely assume the
language wasn't designed them in mind. There are many language features
associated with objects. Some of them are critical. Some are handy.
Some of them are considered better excluded. <br><br>
 <font size="+2"><b>Polymorphic</b></font><br><br>Object's
methods are represented by different code. Perl does this. Objects may
be used interchangeably and each object defines how it responds to
different "messages" or method calls. This is perhaps the most
important OO feature, and the first an aspiring OO language implements.
Even if it doesn't help define, control, or verify interfaces, it
allows a programmer to manually decide on one, implement it, and later
create another interchangeable implementation. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wart&amp;word=%20Instead">Wart: Instead</a> of <i>$this</i> or <i>$self</i>
being magically provided in methods, you must read it manually. Other
OO language hide and automate this. Object::Lexical addresses this
problem. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wart&amp;word=%20Instance">Wart: Instance</a>
data requires extra syntax to get at, making using instance data
tedious, ugly, and unsafe. It is prone to accidential autovivication,
meaning that no warning or issued if you mistype a field name and use a
new null one. Differing syntax for instance and static (package global)
data makes it hard to refactor code - to turn a static method (one with
no instance data) into a true object method with per-object instance
data, you must go through and change large portions of the code.
Dispite the wartiness of this, Ruby attempts to emulate Perl. Python, I
think, requires a <i>this.</i> in front of instance data, not nearly
as bad as Perl, but still tedious. For Perl, Object::Lexical addresses
these problems, too. <br><br>
 <font size="+2"><b>Inheritance</b></font><br><br>Being
able to create generic prototypical objects and further define them
between classes is called inheritance. There are two aspects to it -
data inheritance and implementation inheritance. Most OO languages -
C++, Java, and Python implement both implementation and data
inheritance. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wart&amp;word=%20Perl">Wart: Perl</a>
implements implementation inheritance: subroutines defined in child
classes override those in parent classes, and those that aren't
overriden appear untouched in the child class. Classes defined in
children aren't visible to their parents. The same isn't true of data.
Child class and parent class data all gets lumped together in one big
pool. <br><br>
 <font size="+2"><b>Multiple Inheritance</b></font><br><br>Perl implements a simple version of this, with a  depth-first, left-hand-side recursion through the <i>@ISA</i>
array. Languages that implement multiple inheritance are faced with a
number of trade offs and problems when doing so: what if a class is
inherited by two separate parent classes? Perl assumes that the first
parent wins over the others in this case. C++ has a more complicated
system for solving these problems, while Java opts out of allowing it
at all. <br><br>
 <font size="+2"><b>Strongly Typed</b></font><br><br>Most
object oriented languages employ compile-time checking to make sure
that no code anywhere attempts to pass anything not explicit accepted
into any method. Generally, any compiled language will, but interpreted
languages usually don't. C++ and Java both offer this. Python does not.
This makes a large class of run-time errors vanish in a puff of logic.
Methods are assured that no unexpected object or data types will ever
be passed to them. It doesn't rule out the case where the type of the
object is expected but the range of the value or state of the object
isn't acceptable. For this reason, some OO zealots argue that each
possible state of an object should be a separate subclass of that
object, and of course, numbers should be objects, too. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wart&amp;word=%20Perl">Wart: Perl</a> does not, in the default distribute, offer even optional type safety, though a new module is available that adds it. See <a href="#ScottWalters"><b>Scott Walters</b></a> for a link to it on his (my) CPAN area. 
<br><br>
 <font size="+2"><b>Method Overloading</b></font><br><br>Most
OO languages allow you to write various implementations of methods
representing the different combinations of arguments that may be
supplied. This way, you may do completely different things when passed
a number, a string, an object of one type, an object of another type,
and so on. This avoids using explicit case logic, a big OO no no. <br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Wart&amp;word=%20Perl">Wart: Perl</a> doesn't offer this natively, but a module is available XXX. See <a href="http://www.perldesignpatterns.com/?DamianConway">Damian Conway</a>. 
<br><br>
 <font size="+2"><b>Operator Overloading</b></font><br><br>This
refers to assigning different means to operators. Usually when this is
done, an object may choose how it responds to having an operator used
on it (as a whole). What happens if you add two objects? Only those
objects can tell you. Perl lets the first object (the one on the left)
decide how to handle the operation. The object on the right is employed
if the thing on the left isn't an object. Perl does offer this feature,
as does C++. Java elects not to because of historic abuses of it.
Programs that use operators to perform operators across objects that
have nothing to do with arithmetic quickly become incomprehensible. <br><br>
 <font size="+2"><b>Pure OO</b></font><br><br>This is
considered extreme. Smalltalk and Ruby, for instance, pride themselves
on representing everything with objects - even numeric constants like
"3". This means you can make method calls into numbers. Languages that
don't do this suffer from a sort of duality. Every time objects and
non-objects interact, there are numerous possible scenarios describing
the interaction. Handling these cases with type membership is much
cleaner. Lacking this feature, programmers are steered in a mindset
where the explicit cases are the norm. This is an Anti-Pattern. For
example, <br><br>
 <pre>  my $res = $ob-&gt;call(); if(!$res) { ... } else { ... }. </pre>
<br><br> Java is not pure OO - primitive datatypes include numbers of
various sorts, booleans, arrays, as well as object references. Perl is
not pure OO. Nor is Python. <br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlSucks">Perl Sucks</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=8271">PerlMonks:8271</a> - "Why is it said that Perl does not implement true OO?" 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://ektoplas.ma.cx/%7Enfc/url/dev/index.php?count=25">http://ektoplas.ma.cx/~nfc/url/dev/index.php?count=25</a> 
<br><br>
 <br><br> <a name="PerlDoc"></a><h2><a href="#PerlDoc"><b>Perl Doc</b></a></h2><br> 
<br><br>
 <a href="#PerlDoc"><b>Perl Doc</b></a> - also known as <a href="http://www.perldesignpatterns.com/?PlainOldDocumentation">Plain Old Documentation</a> - is recognized by the Perl interpreter as comments, and is recognized by the <i>perldoc</i> program as documentation. <i>perldoc</i> generates manual pages from buried comments much as <i>javadoc</i> does for Java programs. 
<br><br>
 <pre>  //=pod//   Starts a chunk of documentation. The tags below are then valid.

  //=cut//   Ends a chunk of documentation, returns to code.

  //=head1 Heading//

       1st level header.

  //=head2 Heading// 

       2nd level header.

  //=over n//

       Starts an enumerated list indented //n// spaces. 

  //=item Text//

       A bullet item in an enumerated list.

  //=back//  

       Ends an enumerated list.

  //=begin FMT//

       Subsequent text up to a matching =end is only included when processed for formatter FMT.

  //=end FMT//

       End enumerated list.

  //=for FMT//

       Following paragraph is included conditionally if formatter FMT is used.

  //B&lt;text&gt;// Bold - for command-line switches and program names.

  //C&lt;code&gt;// Code

  //E&lt;escape&gt;// Escape - Character names from HTML escape sequences, eg lt, gt, amp

  //F&lt;filename&gt;// Filename

  //I&lt;text&gt;// Italics

  //L&lt;name&gt;// Link - Cross reference. 

      May be a URL, name of a man page, or the name of //=head1//, //=head2//, or //=item//.
      May contains optional quotes. A slash may be used to seperate the name of a man page from the section in the man page.

  //S&lt;name&gt;// Non-breaking string - will not linewrap on spaces

  //X&lt;index&gt;// Index entry.</pre>
<br><br>
 CPAN modules are expected to follow a certain format. <i>pod2man</i>, <i>pod2latex</i>, <i>pod2text</i>, <i>pod2html</i>, and <i>pod2usage</i>
take advantage of this format to translate the embedded documentation
into other standard formats. In this example, the lines starting with <i>=head1</i> are litteral and are not changed: the lines between them are. 
<br><br>
 <pre>  =head1 NAME

  Bleah::D::Bleah - Put the actual name of the program there give a 
  sentance about it here

  =head1 SYNOPSIS

  ..short usage example

  =head1 DESCRIPTION

  ..what it's used for. The body of the document is contained here or
  in subsections.

  =head1 EXAMPLES

  ..how to use it

  =head1 SEE ALSO

  ..related works: other modules, programs, RFCs

  =head1 AUTHORS

  ..names, email addresses of authors</pre>
<br><br>
 Things linked to using the  
<br><br>
 <pre>  L&lt;&gt;</pre>
<br><br>
 syntax may be man pages, URLs, or =head or =item sections. The <i>perldoc</i>
program that comes with Perl refuses to handle forward references as of
perl version 5.8.0 - attempting to link to a section that comes later
gives a warning message and no link is generated in the HTML. Guess I
should fix that, eh? <br><br>
 XXX - bridge between <a href="#PerlDoc"><b>Perl Doc</b></a> and Java Doc<a href="http://www.perldesignpatterns.com/?JavaDoc">+</a>? 
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Reference&amp;word=%20EffectivePerlProgramming">Reference: EffectivePerlProgramming</a> by Joseph N. Hall and <a href="http://www.perldesignpatterns.com/?RandalSchwartz">Randal Schwartz</a>, Addison Wesley<a href="http://www.perldesignpatterns.com/?AddisonWesley">+</a>, 1998, pp. 183-187. 
<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=CategoryToDo&amp;word=%20Pdoc">CategoryToDo: Pdoc</a> - extend POD format like <a href="http://perldesignpatterns.com/intermap.cgi?wiki=JavaDoc&amp;word=%20http://pdoc.sourceforge.net">JavaDoc: http://pdoc.sourceforge.net</a> and example: <a href="http://pdoc.sourceforge.net/Pdoc1.0/index.html">http://pdoc.sourceforge.net/Pdoc1.0/index.html</a> Pdoc documenting itself 
<br><br>
 See Also:  
<br><br>
 </li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#DocBook"><b>Doc Book</b></a> </li><li> <a href="#CreatingCPANModules"><b>Creating CPANModules</b></a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlpodspec">PerlDoc:perlpodspec</a> , the Perl POD specification for 5.8.0 </li><li> <a href="http://juerd.nl/site.plp/perlpodtut">http://juerd.nl/site.plp/perlpodtut</a> - a good POD tutorial </li><li> <a href="http://www.perlmonth.com/perlmonth/issue3/perldoc.html">http://www.perlmonth.com/perlmonth/issue3/perldoc.html</a> </li><li> Pdoc - extend POD format like <a href="http://perldesignpatterns.com/intermap.cgi?wiki=JavaDoc&amp;word=%20http://pdoc.sourceforge.net">JavaDoc: http://pdoc.sourceforge.net</a> and example: <a href="http://pdoc.sourceforge.net/Pdoc1.0/index.html">http://pdoc.sourceforge.net/Pdoc1.0/index.html</a> Pdoc documenting itself 
<br><br>
 <!-- no access log --> 
<br><br>
 <br><br> <a name="DocBook"></a><h2><a href="#DocBook"><b>Doc Book</b></a></h2><br> 
<br><br>
 <a href="#DocBook"><b>Doc Book</b></a> is a set of XML elements which describe the structure for books and  articles. <a href="#DocBook"><b>Doc Book</b></a> documents include markup that includes... 
<br><br>
 <pre>  &lt;book&gt;, &lt;chapter&gt;, &lt;section&gt;</pre>
<br><br>
 ... etc, but does not include extensive style markup. The <a href="#DocBook"><b>Doc Book</b></a>
source file is processed via tools to produce XHTML, HTML, and through
and intermediate form to PDF. This means that one source file can
produce both HTML for the Web and also PDF for documents that are
printable. If your company produces and/or uses many documents you
should consider this technology. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> [Some examples of the format, code to generate it, perhaps that Wiki parser I've been meaning to write] 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?LaTeX">La Te X</a> </li><li> <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> 
<br><br>
 <!-- no access log --> 
<br><br>
 <br><br> <a name="CvsQuickRef"></a><h2><a href="#CvsQuickRef"><b>Cvs Quick Ref</b></a></h2><br> 
<br><br>
 <i>file</i> may be "." to mean the current directory and everything below it. 
<br><br>
 All the time: 
<br><br>
 </li><li> cvs commit <i>file</i>    -      sends changes to repository </li><li> cvs update <i>file</i>     -     freshens your files <pre>  </pre>Useful too: 
<br><br>
 </li><li> cvs diff <i>files</i>       -    compare your files to repository </li><li> cvs log <i>file</i>          -   comments on changes in each file </li><li> cvs update <i>file</i>        -  merge in changes from the repository </li><li> cvs update -j <i>currentrev</i> -j <i>previousrev</i> <i>file</i>  - regress to a previous version <pre>  </pre>Not very often: 
<br><br>
 </li><li> cvs tag <i>string</i> <i>files</i> </li><li> cvs add <i>files</i>       -     introduce to repository pending commit </li><li> cvs remove <i>files</i>     -    nuke file from repository </li><li> cvs checkout <i>file</i>     -   get a file or project initially <pre>  </pre>
<br><br> CVS maintains tags in files in the archive, unless a given
file is marked "binary". CVS won't add these tags to files, but should
they appear, they will be kept up to date as file the checked in and
out. <br><br>
 <pre>  $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Id&amp;word=%20CvsQuickRef,v">Id: CvsQuickRef,v</a> 1.13 2003/06/15 23:11:50 httpd Exp $
  $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Author&amp;word=%20httpd">Author: httpd</a> $
  $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Revision&amp;word=%201.13">Revision: 1.13</a> $</pre>
<br><br> The entire tag does not need to be inserted into the file;
only the beginning dollar sign, the tag name, the color, a space, then
the ending dollar sign. Since this document itself is kept in CVS,
these tags have been coopted. <br><br> Perl programs will often want to report their version to the
user, especially in the case of an error. CVS can maintain a tag, and
Perl can read its current value. Webshops that practice code reuse
between clients need to track versions of deployed code. See also <a href="#ErrorReporting"><b>Error Reporting</b></a>. 
<br><br>
 <pre>  (my $version) = '$<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Revision&amp;word=%201.13">Revision: 1.13</a> $' =~ /([\d\.]+)/;</pre>
<br><br>
 XXX the following information needs to be merged in to this explaination, and I need to devise a solution to the <a href="http://www.perldesignpatterns.com/?MakeMaker">Make Maker</a> problem. 
<br><br>
 From perldoc perlmodstyle: 
<br><br>
 <pre>       If you want to release a 'beta' or 'alpha' version of a
       module but don't want CPAN.pm to list it as most recent
       use an '_' after the regular version number followed by at
       least 2 digits, eg. 1.20_01. If you do this, the following
       idiom is recommended:

         $VERSION = "1.12_01";
         $XS_VERSION = $VERSION; # only needed if you have XS code
         $VERSION = eval $VERSION;

       With that trick <a href="http://www.perldesignpatterns.com/?MakeMaker">Make Maker</a> will only read the first line
       and thus read the underscore, while the perl interpreter
       will evaluate the $VERSION and convert the string into a
       number. Later operations that treat $VERSION as a number
       will then be able to do so without provoking a warning
       about $VERSION not being a number.</pre>
<br><br>

<br><br>
 What actually gets put into files by h2xs: 
<br><br>
 <pre>  our $VERSION = '0.02';
  $VERSION = eval $VERSION;  # see L&lt;perlmodstyle&gt;</pre>
<br><br>
 From <a href="http://www.cpan.org/modules/00modlist.long.html">http://www.cpan.org/modules/00modlist.long.html</a> : 
<br><br>
 <pre>  To be fully compatible with the Exporter and <a href="http://www.perldesignpatterns.com/?MakeMaker">Make Maker</a> modules you should store 
  your module's version number in a non-my package variable called $VERSION. 
  This should be a valid floating point number with at least two digits after 
  the decimal (ie hundredths, e.g, $VERSION = "0.01"). See Exporter.pm for details.

  Don't use a "1.3.2" style version directly. If you use RCS or a similar system 
  which supports multilevel versions/branches you can use this (but put it all 
  on one line for <a href="http://www.perldesignpatterns.com/?MakeMaker">Make Maker</a> VERSION_FROM):

  $VERSION = do { my @r=(q$<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Revision&amp;word=%201.13">Revision: 1.13</a> $=~/\d+/g); sprintf "%d."."%03d"x$#r,@r };

  It may be handy to add a function or method to retrieve the number. Use the 
  number in announcements and archive file names when releasing the module 
  (ModuleName-1.02.tar.gz). See perldoc ExtUtils::<a href="http://www.perldesignpatterns.com/?MakeMaker">Make Maker</a>.pm for details.</pre>
<br><br>
 See <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Also&amp;word=%20CvsIntro,">Also: CvsIntro,</a> <a href="http://www.perldesignpatterns.com/?TinyWikiInstall">Tiny Wiki Install</a> 
<br><br>

<br><br>
 <br><br> <a name="ClassNaming"></a><h2><a href="#ClassNaming"><b>Class Naming</b></a></h2><br> 
<br><br>
 <i>People often make assumptions based on the object names alone.</i> - <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=WardCunningham">WikiWiki:WardCunningham</a> in <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=SystemOfNames">WikiWiki:SystemOfNames</a> 
<br><br>
 <font size="+2"><b>Idioms</b></font><br><br>Categories and
subcategories your module. The gross, generic category is the first
part. The second part is the subcategory. Both of these should already
exist. If they don't, you've probably made a mistake. The tie breaker
is whether or not anyone is likely to continue to extend this
namespace, placing other modules in it or under it. Archive::Tar has
Archive::Zip, a module similar in purpose, as a neighbor. Had it been
named Tar::Archive, it would pollute the root name space, and
Archive::Zip wouldn't be its neighbor. <br><br>
 Further suffixii distinguish the module further. A module that is... 
<br><br>
 </li><li> An interface, such as an <a href="#AbstractFactory"><b>Abstract Factory</b></a>, to a variety of modules which do the same <i>kind</i> of task but using different algorithms or file formats is often named <i>::Any</i>. For example, Archive::Any. </li><li> Easier to use than similar but more full-featured modules is often named <i>::Simple</i>. </li><li> Smaller and less memory demanding, with a smaller compile time, is named <i>::Lite</i>. </li><li> Written using only Perl as an alternative to a version that requires XS is named <i>::PP</i>. </li><li> Part of another module should still be reusable, according to the idea of <a href="http://www.perldesignpatterns.com/?LayingPattern">Laying Pattern</a>, and adds suffixii as needed to the right once it has distinguished itself in the first three parts. 
<br><br>
 <font size="+2"><b>Over General Namespaces</b></font><br><br><i>Don't
use the nouns "Object", "Manager", "Handler", or "Data" in class names.
These words say nothing about the responsibility of the class, leading
maintenance programmers to lump all kinds of irrelevant crap into the
class. Think instead about what the class is actually supposed to do
and name it after that.</i> -- <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DontNameClassesObjectManagerHandlerOrData">WikiWiki:DontNameClassesObjectManagerHandlerOrData</a>  
<br><br>
 <i>Rewriting an existing module? Don't just call it Foo2,
try to figure out what's actually distinctive about it and call it
that. If it's easier to use, call it Foo::Simple. If it's faster, call
it Foo::Fast. If it doesn't have a distinctive difference, why are you
writing/publishing it at all? </i> -- <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DontNameClassesObjectManagerHandlerOrData">WikiWiki:DontNameClassesObjectManagerHandlerOrData</a>  
<br><br>
 <i>Over Generalized Namespaces<a href="http://www.perldesignpatterns.com/?OverGeneralizedNamespaces">+</a>
are those which describe just about _everything_, depending how you
think about the problem, and include (in approximate order of
uselessness): Data, Object, Software, Text, Net, Sys.</i> <i>If you find yourself thinking of using an Over Generalized Namespace<a href="http://www.perldesignpatterns.com/?OverGeneralizedNamespace">+</a>, think about whether you can find somewhere more specific for it. For instance, a module called Data::Parse Somehow<a href="http://www.perldesignpatterns.com/?ParseSomehow">+</a> could instead belong in Parse::Somehow.</i> -- <a href="http://www.pobox.com/%7Eschwern/cgi-bin/perl-qa-wiki.cgi?ModuleNaming">http://www.pobox.com/~schwern/cgi-bin/perl-qa-wiki.cgi?ModuleNaming</a> 
<br><br>
 <i>Abstractions should be precise. Likewise, their names
need to be precise. Sometimes developers confuse abstraction (a precise
thing) with overgeneralization (which is sloppy). One way that this
shows up is in vague identifier names, and collections of similar
names. "Data", "Object", "Class" are words that shouldn't appear in
identifier names. Identifiers should never be differentiated by a
single character wart. If two class names are accidentally used
interchangeably by their author, they are too imprecise.</i> -- <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=SystemOfNames">WikiWiki:SystemOfNames</a> 
<br><br>
 <i>To generalize is to be an idiot.</i> -- William Blake 
<br><br>
 <font size="+2"><b>Evil Managers</b></font><br><br><i>Yes, a
class with Manager in the name is generally procedural code written in
an object-oriented language. It's code acting on data, which is why it
was called a manager. It's acting on something external rather than
acting on itself. To me, this is a <a href="http://www.perldesignpatterns.com/?CodeSmell">Code Smell</a>.</i> -- <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DontNameClassesObjectManagerHandlerOrData">WikiWiki:DontNameClassesObjectManagerHandlerOrData</a> 
<br><br>
 <i>I come to think of the -er-er principle, stated by <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=PeterCoad,">WikiWiki:PeterCoad,</a>
that is to challenge any class name that ends in -er. If it has no
parts, change the name of the class to what each object is managing. If
it has parts, put as much work in the parts that the parts know enough
to do themselves.</i>  -- <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DontNameClassesObjectManagerHandlerOrData">WikiWiki:DontNameClassesObjectManagerHandlerOrData</a> 
<br><br>
 A "manager" might be a sign of more serious trouble (a <a href="http://www.perldesignpatterns.com/?CodeSmell">Code Smell</a>) if:  
<br><br>
 </li><li> Tries to play two parts of a <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a>. The business logic gets all mired down with the user or programatic interface. Eww. </li><li> <a href="#GodObject"><b>God Object</b></a>, refusing to give up control of the CPU or knowledge of everythings interface.  Violates <a href="http://perldesignpatterns.com/intermap.cgi?wiki=NoSexUntilMarriage&amp;word=%20is">NoSexUntilMarriage: is</a> intimately tied to objects it has no business knowing about. Procedural code in disguise, as <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=PeterCoad">WikiWiki:PeterCoad</a> says.  </li><li> <a href="#VisitorPattern"><b>Visitor Pattern</b></a> that performs some operation on data, but without a well defined interface as prescribed by <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>.
The "manager" becomes overly tied to one implementation of an idea, and
an unrecognized but hard-coded relationship emerges between the
implementation and the "manager". Not good. </li><li> <a href="#SingletonPattern"><b>Singleton Pattern</b></a> acting as a <a href="#ContainerPattern"><b>Container Pattern</b></a>. Nothing wrong with containers, but there are definate and numerous reasons not to use singletons. </li><li> Command Processing Chain Of Responsbility<a href="http://www.perldesignpatterns.com/?CommandProcessingChainOfResponsbility">+</a>
may be needed if an arbitrary number of "filters", or steps of
processing, are to be applied to data as it comes and goes. Lumping
unrelated processing logic into a single object merely because it has
the unique role of "managing" the data is unacceptable. See also <a href="#DecoratorPattern"><b>Decorator Pattern</b></a>.  
<br><br>
 Or everything may be just peachy, but could be named better: 
<br><br>
 </li><li> <a href="#LayeringPattern"><b>Layering Pattern</b></a> and <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a>
call for glue between layers of a "stack" of modules that implement
successively more concrete logic. If the "manager" glues two such
layers together, pay hommage to them, and reflect this in the name. </li><li> <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a>
that performs some execuative or janitorial work. Be more specific. Use
an analogy with real life: Receptionist (queue management), Dockhand
(loading and unloading), Bean Counter<a href="http://www.perldesignpatterns.com/?BeanCounter">+</a> (resource management), Evil HRDirector<a href="http://www.perldesignpatterns.com/?EvilHRDirector">+</a> (attendance and sick leave?),  Middle Manager<a href="http://www.perldesignpatterns.com/?MiddleManager">+</a> (reporting), Tooth Faerie<a href="http://www.perldesignpatterns.com/?ToothFaerie">+</a> (resource reclaimation). 
<br><br>
 <font size="+2"><b>Resources</b></font><br><br></li><li> <a href="http://www.pobox.com/%7Eschwern/cgi-bin/perl-qa-wiki.cgi?ModuleNaming">http://www.pobox.com/~schwern/cgi-bin/perl-qa-wiki.cgi?ModuleNaming</a> - The collective wisdom of the modules@perl.org, the Perl Module Naming Gurus, written down for the first time by <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a>. Lots of examples of good and bad names, and plenty of simple, concrete rules to follow.  
<br><br>
 </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DontNameClassesObjectManagerHandlerOrData">WikiWiki:DontNameClassesObjectManagerHandlerOrData</a> - Touches on many design ideas in conjuction with module naming. 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a>  </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DontNameClassesObjectManagerHandlerOrData">WikiWiki:DontNameClassesObjectManagerHandlerOrData</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=SystemOfNames">WikiWiki:SystemOfNames</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=SameThingSameName">WikiWiki:SameThingSameName</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=ClassName.htm">ObjectArts:ClassName.htm</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=SchwernWiki&amp;word=ModuleNaming">SchwernWiki:ModuleNaming</a> </li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="#NoSexUntilMarriage"><b>No Sex Until Marriage</b></a> </li><li> <a href="#LayeringPattern"><b>Layering Pattern</b></a> </li><li> <a href="#AbstractionInversion"><b>Abstraction Inversion</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a> </li><li> <a href="#SingletonPattern"><b>Singleton Pattern</b></a> </li><li> Command Processing Chain Of Responsbility<a href="http://www.perldesignpatterns.com/?CommandProcessingChainOfResponsbility">+</a> </li><li> <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a> </li><li> <a href="#CommandObject"><b>Command Object</b></a> </li><li> <a href="http://www.objectmentor.com/resources/articles/naming.htm">http://www.objectmentor.com/resources/articles/naming.htm</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=ClassName.htm">ObjectArts:ClassName.htm</a> </li><li> <a href="http://www.ondotnet.com/pub/a/dotnet/2003/04/28/strongnaming.html">http://www.ondotnet.com/pub/a/dotnet/2003/04/28/strongnaming.html</a> 
<br><br>

<br><br>
 <br><br> <a name="ReferencesMeta"></a><h2><a href="#ReferencesMeta"><b>References Meta</b></a></h2><br> 
<br><br>

<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> - this page should be automatically generated from references to things in <a href="#CategoryBook"><b>Category Book</b></a>. Ie, if a page mentions <a href="http://www.perldesignpatterns.com/?StructureAndInterpretationOfComputerPrograms">Structure And Interpretation Of Computer Programs</a>, a parser for a paper-destined copy should replaces this with a citation, and <a href="http://www.perldesignpatterns.com/?StructureAndInterpretationOfComputerPrograms">Structure And Interpretation Of Computer Programs</a> should be added to the list of references - kind of like how footnotes work. 
<br><br>

<br><br>
 <pre>   [1] Notes on Synthesis of Form - Christopher Alexander, Ale 1964
   [2] A Pattern Language - Christopher Alexander,  Ale, 1977 <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200-19-501919-9">ISBN ISBN 0-19-501919-9</a>
   [3] Design <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Patterns&amp;word=%20Elements">Patterns: Elements</a> of Reusable Object Oriented Code, Gang of Four, XXX
       C2 <a href="http://www.perldesignpatterns.com/?DesignPatternsElementsOfReusableObjectOrientedSoftware">Design Patterns Elements Of Reusable Object Oriented Software</a> 
       <a href="http://www.perldesignpatterns.com/?DesignPatternsBook">Design Patterns Book</a> by the <a href="http://www.perldesignpatterns.com/?GangOfFour">Gang Of Four</a>
   [4] <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Refactoring&amp;word=%20Improving">Refactoring: Improving</a> the Design of Existing Code, XXX <a href="http://www.perldesignpatterns.com/?MartinFowler">Martin Fowler</a>'s book, <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200201485672">ISBN ISBN 0201485672</a> .
       C2 <a href="http://www.perldesignpatterns.com/?RefactoringImprovingtheDesignofExistingCode">Refactoring Improvingthe Designof Existing Code</a>
   [5] Ward et el. <a href="http://c2.com/cgi/wiki/">http://c2.com/cgi/wiki/</a>
        C2 <a href="http://www.perldesignpatterns.com/?FunctionalPatternSystemForObjectOrientedDesign">Functional Pattern System For Object Oriented Design</a>
   [6] Bitter Java <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%201-930110-43-X">ISBN ISBN 1-930110-43-X</a> (not my favorite)
   [7] Applied Java Patterns <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200-13-093538-7">ISBN ISBN 0-13-093538-7</a> (very good)
   [8] Java Threads, O'Reilly (very good)
   [9] Joy of Patterns - Brandon Goldfedder - <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200-201-65759-7">ISBN ISBN 0-201-65759-7</a>  (good)
   [10] "Object Oriented Perl", Damian Conway (good)
   [11] Advanced Algorithms in Perl
   [12] Structure and Interpretation of Computer Programs by Harold Abelson, Gerald Jay Sussman and Julie Sussman (very good)
        C2 <a href="http://www.perldesignpatterns.com/?StructureAndInterpretationOfComputerPrograms">Structure And Interpretation Of Computer Programs</a>
   [13] perlmodlib
   [14] perlnewmod
   [15] <a href="http://www.cpan.org/modules/00modlist.long.html">http://www.cpan.org/modules/00modlist.long.html</a>
   [16] Anti-Patterns, <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%20471197130">ISBN ISBN 471197130</a> 
   [17] Elements of Programming with Perl, <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%201-884777-80-5">ISBN ISBN 1-884777-80-5</a>, Andrew Johnson
   [18] Practice of Programming, Brian W. Kernighan, Rob Pike, <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200-201-61586-X">ISBN ISBN 0-201-61586-X</a>
   [19] Object Oriented Design Heuristics, Arthur J. Riel, Prentice Hall, <a href="http://shop.bn.com/bookSearch/isbnInquiry.asp?isbn=ISBN%200-201-63385-X">ISBN ISBN 0-201-63385-X</a>
   [20] The Mythical Man Month, Frederick Brooks
        C2 <a href="http://www.perldesignpatterns.com/?TheMythicalManMonth">The Mythical Man Month</a> - the greatest project management book ever written
   [21] Pattern Language of Program Design 4
   [22] 6.170 Software Laboratory, MIT Open <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Courseware&amp;word=%20http://ocw.mit.edu/6/6.170/f01/lecture-notes/index.html">Courseware: http://ocw.mit.edu/6/6.170/f01/lecture-notes/index.html</a>
    <a href="http://mitpress.mit.edu/sicp/full-text/book/book.html">http://mitpress.mit.edu/sicp/full-text/book/book.html</a> - available online
   [23] Zen and the Art of Motorcycle Maintenance
        C2 <a href="http://www.perldesignpatterns.com/?ZenAndTheArtOfMotorcycleMaintenance">Zen And The Art Of Motorcycle Maintenance</a> - ideas on quality as the essense of existance
   [24] <a href="http://www.perldesignpatterns.com/?StructuredProgramming">Structured Programming</a>, Dahl, Dijkstra, <a href="http://www.perldesignpatterns.com/?TonyHoare">Tony Hoare</a>, Academic Press, 1972</pre>
<br><br>
 $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Id&amp;word=%20ReferencesMeta,v">Id: ReferencesMeta,v</a> 1.12 2003/03/04 09:32:50 phaedrus Exp $ 
<br><br>

<br><br>
 <br><br> <a name="CreatingCPANModules"></a><h2><a href="#CreatingCPANModules"><b>Creating CPANModules</b></a></h2><br> 
<br><br>

<br><br>
 <i>Module authors must be educated to localize $_ before
changing it, and any advance that depends on the education of module
authors is probably doomed.</i> - <a href="http://www.perldesignpatterns.com/?MarkJasonDominus">Mark Jason Dominus</a> 
<br><br>
 <font size="+2"><b>Start with h2xs</b></font><br><br>Originally a utility to convert C header files into XS modules, <i>h2xs</i>
has become a useful utility for churning out skeletons for Perl-only
modules as well. If you don't want to use the Autoloader which splits
up big modules into smaller subroutine-sized chunks, you'll say
something like this: <br><br>
 <pre>    h2xs -AX -n Net::Acme</pre>
<br><br>
 The -A omits the Autoloader code, -X omits XS elements, and -n specifies the name of the module 
<br><br>
 h2xs -x -A -n Foo::Bar -v 0.1 
<br><br>
 </li><li>  -x means "no XS", for when your module is pure Perl and contains no C </li><li>  -A means "no autoload", for when your module defines no keywords that cause it to load without requiring "use" [eh?] </li><li>  -n is used to name your module </li><li>  -v specifies the version number 
<br><br>
 <font size="+2"><b>Program as a Module</b></font><br><br>A
program should be a few lines of code that uses several modules,
perhaps builds an initial object structure. [What peice of
documentation recommended this? Due credit...] This wrapper .pl file
should up a basic object structure, passing references of objects to
constructors of other objects. See <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a>
for advice on setting up the object structure. Many modules may need
access to common resources. To mitigate the negitive impact of
splitting the code up, make it easy to set up a common envirnment - see
<a href="#WrapperModule"><b>Wrapper Module</b></a>. Contrary to <a href="#SingletonPattern"><b>Singleton Pattern</b></a>,  Like in inheritance hierachies, discussed in <a href="http://www.perldesignpatterns.com/?FunctionalityIsToBeShared">Functionality Is To Be Shared</a>, common logic and values should be moved up as high in the program as are useful: see <a href="#PassingPattern"><b>Passing Pattern</b></a>. "Global" configuration should be set up in the .pl application and passed to any interested modules. 
<br><br>
 Think of the application as a meld between a <a href="#ConfigFile"><b>Config File</b></a>,
argument processing logic, and atleast one module that represents what
the application does. An "unzip" application might use Get Opt<a href="http://www.perldesignpatterns.com/?GetOpt">+</a>::Long, follow <a href="#ConfigFile"><b>Config File</b></a>,
and finally use that information to make a single call into
Archive::ZIP. For something more complicated, perhaps a ZIP utility
with a GUI, the .pl would set up a <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a>
specific to the application, where the "Model" used Archive::ZIP
Archive::ZIP. In any case, most of the program is shuffled off to
objects. This helps avoid the <a href="#GodObject"><b>God Object</b></a> problem, and makes the various parts of the application reusable, assuming you've obeyed <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a>. 
<br><br>
 <font size="+2"><b>And</b></font><br><br><a href="http://bioperl.org/Projects/SeqAlign/proposal.html">http://bioperl.org/Projects/SeqAlign/proposal.html</a> is proposal on module naming - good example of the thought process behind a well thought out name. 
<br><br>
 Most modules go the way of the <a href="#GodObject"><b>God Object</b></a>. Know it, avoid it. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlnewmod">PerlDoc:perlnewmod</a> </li><li> <a href="#ClassNaming"><b>Class Naming</b></a> </li><li> <a href="http://bioperl.org/Projects/SeqAlign/proposal.html">http://bioperl.org/Projects/SeqAlign/proposal.html</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ObjectArts&amp;word=Application.htm">ObjectArts:Application.htm</a> </li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="#AbstractRootClasses"><b>Abstract Root Classes</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?FunctionalityIsToBeShared">Functionality Is To Be Shared</a> </li><li> <a href="http://www.perldesignpatterns.com/?ModelViewController">Model View Controller</a> </li><li> <a href="#WrapperModule"><b>Wrapper Module</b></a> </li><li> <a href="#SingletonPattern"><b>Singleton Pattern</b></a> </li><li> <a href="#ConfigFile"><b>Config File</b></a> </li><li> Ext Utils<a href="http://www.perldesignpatterns.com/?ExtUtils">+</a>::Make Make<a href="http://www.perldesignpatterns.com/?MakeMake">+</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=278327">PerlMonks:278327</a> - CPAN Module Red Flags 
<br><br>
 <br><br> <a name="PlanToThrowOneAway"></a><h2><a href="#PlanToThrowOneAway"><b>Plan To Throw One Away</b></a></h2><br> 
<br><br>
 Concept from <a href="http://www.perldesignpatterns.com/?TheMythicalManMonth">The Mythical Man Month</a>. 
<br><br>
 <i>I gave desperate warnings against the obscurity, the
complexity, and over-ambition of the new design, but my warnings went
unheeded. I conclude that there are two ways of constructing a software
design: One way is to make it so simple there are obviously no
deficiencies and the other way is to make it so complicated that there
are no obvious deficiencies</i> <a href="http://www.perldesignpatterns.com/?TonyHoare">Tony Hoare</a>, Turing Aware Lecture on Ada, 1980 
<br><br> Most programs - especially those written under deadline -
rapidly degenerate into something incomprehensiable and intolerable,
and are thrown away. One school of thought teaches that no program
should be thrown away, and aims to salvage such disasters. Another
school of though - this one - states that failure is a learning
experience that allows you to better understand the problem itself that
the program aims to solve, and a failed attempt is the best way to
understand how to do it correctly. Throwing away the prototype rights
the ghastly wrongs with a nice purging reincarnation. <br><br>
 Poor understand of the problem-domain not only leads to poor program structure, poor object design,  <a href="http://www.perldesignpatterns.com/?AccidentalComplexity">Accidental Complexity</a>, the <a href="#GodObject"><b>God Object</b></a>, the <a href="http://www.perldesignpatterns.com/?CodeJail">Code Jail</a>, and every other <a href="http://www.perldesignpatterns.com/?AntiPattern">Anti Pattern</a>, but also poor <a href="#ClassNaming"><b>Class Naming</b></a> and variable naming. Poor <a href="#ClassNaming"><b>Class Naming</b></a> leads to confusion. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CodeMomentum">Code Momentum</a>
may be very difficult to overcome - to the point that it isn't worth
it. Original shortsightedness might forever hamper an implementation. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryConcept">Category Concept</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?NeverRewriteSoftware">Never Rewrite Software</a> </li><li> <a href="http://www.perldesignpatterns.com/?AccidentalComplexity">Accidental Complexity</a> </li><li> <a href="#AboutPatterns"><b>About Patterns</b></a> </li><li> <a href="#GodObject"><b>God Object</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?CodeJail">Code Jail</a> </li><li> <a href="http://www.perldesignpatterns.com/?CodeMomentum">Code Momentum</a> </li><li> <a href="http://www.perldesignpatterns.com/?AntiPatterns">Anti Patterns</a> </li><li> <a href="#ClassNaming"><b>Class Naming</b></a> 
<br><br>

<br><br>
 <br><br> <a name="HowPerlDiffersFromC"></a><h2><a href="#HowPerlDiffersFromC"><b>How Perl Differs From C</b></a></h2><br> 
<br><br>
 Perl is a lot like C, which makes C programmers wonder where the heck <i>strlen()</i> got off to. Some of the <b>most noticable things</b> that must be overcome before Perl will accept your pseudo-C are: 
<br><br>
 <font size="+2"><b>Dollar signs in front of the scalars.</b></font><br><br>Yeah, I know. It's a <i>BASIC</i> thing that was perpetuated by <i>sh</i>. In Perl, they are called <i>sigils</i>.
It does serve a purpose: by allowing you to create functions, I/O
handles, arrays, hashes and scalars (which might contain references),
all of the same name, you can write more obscure Perl. It also allows
you to write expressions using <i>barewords</i>: 
<br><br>
 <pre>  $a = wussup;</pre>
<br><br> Barewords are unquoted strings other than function names. They
get treated as strings for lack of anything else to do with them. That
makes that expression the same as: <br><br>
 <pre>  $a = "wussup";</pre>
<br><br>
 Not quoting string literals is considered <a href="http://www.perldesignpatterns.com/?BadStyle">Bad Style</a> in all but one case: hash table indices. Other uses are dissallowed when <a href="http://www.perldesignpatterns.com/?UseStrict">Use Strict</a> is in effect. 
<br><br> Variables can be introduced at any time, including leaf nodes
on complex data structures built out of references. The sigils tell
Perl what we're working with. <i>@foo = function();</i> tells <i>perl</i> that you want a list of things, while <i>$foo = function();</i> asks for only one. The situation is similar when fetching the value from variables.  
<br><br>
 <font size="+2"><b>strlen() and sizeof()</b></font><br><br><i>#$array</i> gives the index of the last element of <i>@array</i>.  <i>scalar(@array)</i> gives the total number of elements in <i>@array</i>, which is always one more than <i>#$array</i> for arrays that have elements [Don't set <i>$[</i>, and if you see it in code, consult <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlvar">PerlDoc:perlvar</a> for help]. <i>length()</i> serves strings. See <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=perlfunc#length">PerlDoc:perlfunc#length</a> . 
<br><br>
 <font size="+2"><b>Command Line Arguments</b></font><br><br>There
is no specific function which is called when a Perl program is run.
Instead, Perl runs the code from top to bottom, executing whatever it
finds, including subroutine definitions. Therefore there is no function
to pass arguments to. <i>@ARGV</i> has been selected for this purpose. Use <i>$ARGV[0]</i> to get at the first element, <i>$ARGV[1]</i>
to get at the second, and so on. Note that the sigil in front of the
variable changes depending on what you want back from it, not how it is
actually declared. Specifically, the first element of <i>@ARGV</i> is a scalar, so we use the scalar sigil to fetch it: <i>$ARGV[0]</i>. 
<br><br>
 <font size="+2"><b>Comments</b></font><br><br>Comments begin with the hash symbol (or number sign, or pound sign, for you brits) and end at the end of the line: 
<br><br>
 <pre>  # this is a comment
  $a = 10; # and so is this</pre>
<br><br>

<br><br>
 Block quotes are attainable using the POD syntax documented in <a href="#PerlDoc"><b>Perl Doc</b></a>. Comments quoted this way will become part of the documentation of the module or program, much like how <i>javadoc</i>
processes comments into documentation. It is advisable to use this
syntax before functions, particularly publicly accessable ones, to
explain what the function does, why, and what it requires to do so. <br><br>
 For C-style comments, see Acme::Comment. 
<br><br>
 <font size="+2"><b>Environment</b></font><br><br>Perl tells
you about your environment in intimate detail. It is up to you to write
portable code. Code that is oblivious to the system it is running on is
an ideal, but is an impossible to achieve one in many cases. When
workarounds are needed, you aren't restricted from performing them. See
the perldoc for Config, but as an example: <br><br>
 <pre>  # CGI.pm does this to learn about local linefeed insanity:
  $OS = $Config::Config{'osname'};</pre>
<br><br>
 Environment variables are included, of course. They are contained in the Perl hash <i>%ENV</i>. For example: 
<br><br>
 <pre>  print "Search path: $ENV{PATH}\n";</pre>
<br><br>
 <font size="+2"><b>Functions Without Parentheses</b></font><br><br>It is typical to see expressions in Perl not unlike: 
<br><br>
 <pre>  my @files = grep { $_ !~ m/^\./ } sort readdir $fh;</pre>
<br><br> This might lead one to believe that parentheses aren't used
for function arguments and curly braces some how take their place. This
might be partially true. Many functions expect a list of things, and
many functions return lists of things. In this example, <i>readdir()</i> is returning a list to <i>sort()</i>; <i>sort()</i> is sorting that and sending it through <i>grep()</i>;
grep has a strange little block after it. This is a block of code that
will be run each item in the list as a test for inclusion. <i>sort()</i> and <i>map()</i>
are two other functions that accept such an code block. The block is
purely optional. Since all of our lists are implicitly created and
implicitly passed around, we don't ever really need to group things
using parenthesis. That doesn't mean we can't: <br><br>
 <pre>  my @files = get_file_list($ENV{'HOME'}, '.', `pwd`);</pre>
<br><br>
 Having optional parentheses does create a certain amount of confusion. People are often tempted to write expressions like: 
<br><br>
 <pre>  print (32/8)+10; # this prints "4"</pre>
<br><br>
 The space after <i>print()</i> means nothing. It still attaches itself to the single argument, 32/8. What probably meant is: 
<br><br>
 <pre>  print((32/8)+10); # this prints "14"</pre>
<br><br> The &amp;&amp; operator also causes problems when parentheses
aren't used on lists of numbers. The &amp;&amp; operating will work on
the last thing in the list, rather than the return value of the
function: <br><br>
 <pre>  sprintf "The number is: %d\n", 0 &amp;&amp; return; # this won't return</pre>
<br><br>
 The obvious thing to do is introduce parentheses, but you don't have to - Perl provides the <i>and</i> and <i>or</i> operators, which have very low precedence: 
<br><br>
 <pre>  sprintf "The number is: %d\n", 0 and return; # this will return</pre>
<br><br> Readability can suffer, but not having to match up parentheses
all of the time saves a lot of bouncing around in the code. In case of
doubt, use the parentheses. <br><br>
 <font size="+2"><b>$foo[$i] Doesn't Subscript Strings</b></font><br><br><i>$foo[$i]</i> would return the <i>$i</i>th element of <i>@foo</i>. Perl doesn't consider <i>$foo</i>
to be any sort of an array at all. When hand converting C code to Perl,
this is a real pain, because it requires so much typing and occurs so
often. The solution is: <br><br>
 <pre>  substr($foo, $i, 1); </pre>
<br><br>
 This will tell Perl that we want a string of 1 element starting at the <i>$i</i>th element of <i>$foo</i>.  Since strings aren't arrays of characters, this returns a string of one character. Use <i>ord()</i> and <i>chr()</i> to convert between ASCII values and strings of one character (or whatever your locale happens to be). 
<br><br>
 <font size="+2"><b>Global, Local, and Lexical Variables</b></font><br><br>In
C, all variables are either global, visible to the source code file but
otherwise global, visible to only the function they were defined <i>static</i> in, or else allocated on the stack as an "automatic variable".  
<br><br>
 <ul><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Global&amp;word=%20Variables">Global: Variables</a> not declared but just used also have the scope of the entire file, as do variables declared <i>our</i>
at the top of the file (unless the package is changed, which is a
special case). These values can be accessed from anywhere in the
program using special syntax.
</li><li> Private to the file: variables declared <i>my</i> at the top of the file are visible only in that file. This is similar to declaring a variable <i>static</i> outside of a function in C.
</li><li> Static variables inside functions: This isn't officially
supported as an atomic feature, but is fairly easy to do in a couple of
steps. See <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a>.
</li><li> Automatic variables: <i>my</i> variables declared inside of a
function serve the same purpose, but many others. A neat trick combines
the automatic allocation of automatic variables with the persistance of
static variables. See <a href="http://www.perldesignpatterns.com/?LexicalsMakeSense">Lexicals Make Sense</a>.
</li></ul> <font size="+2"><b>Module Library</b></font><br><br>At
compile time, a local repository for modules is established. This is
like /usr/include, except it contains both code and definitions. Perl
defaults to putting it in /usr/local/lib/perl5, but Linux distros like
to move it up to /usr/lib/perl5. Poking through there and running <i>perldoc</i>
on each item yields thrilling insights into Perl. Much of what is
apparently implemented in core is just modules that are used on demand.
For instance, the pragmas like <i>use strict</i> are implemented
mostly in terms of small modules. Downloading and installing modules
from CPAN expands this collection, though in a subdirectory:
/usr/local/lib/perl5/site_perl. You may also wish to add your own
homebrew modules under there. <br><br>
 <font size="+2"><b>No Preprocessor</b></font><br><br>There is an interface to cpp available as a <i>source filter</i>, but it's something you have to go and install. See the <i>Filter</i> module and the whole <i>Filter::// hierarchy on CPAN. </i>
<br><br> A common trick when writing modules that are used frequently
is deferring compilation of parts of code until they are first used.
See <a href="http://www.perldesignpatterns.com/?AutoSplit">Auto Split</a> for more information.  
<br><br>
 With perl 5.004 or later, constants can be created thusly: 
<br><br>
 <pre>  use constant PI =&gt; 4 * atan2(1, 1); # or
  use constant PI =&gt; 3.14159;         # I'm not a math geek</pre>
<br><br>
 If you have an older version of perl, read-only variables can be established using this little trick: 
<br><br>
 <pre>  *PI = \3.14159; # I'm not a math geek</pre>
<br><br> This uses typeglobs, an obscure feature of Perl. Typeglobs
define file-global variables by holding references to scalars, hashes,
arrays, and so forth. We're storing a reference to a number directly,
rather than a variable. This prevents accidential modification later
on. <pre>  </pre>You can also read in Perl code that defines variables using the <i>require</i> function. 
<br><br>
 <font size="+2"><b>Primitive Data Types</b></font><br><br>As
mentioned, there is no character datatype. Scalars, Arrays, Hashes,
Globs, File handles, Directory handles and References (a type of scalar
value) are the basic datatypes. Complex datatypes can be built from
these (unlike in Perl 4). References can include object references,
regular expression references, code references, references to other
primitive datatypes, and many other things. <br><br> Reference types are pass-by-value. No copies are made of the
objects they refer to when the reference is copy or passed to a
subroutine. However, Perl tracks references, and the thing being
refered to won't go away while anyone can see it. Perl objects are
polite and only sneak off when no one is looking unless asked to
garrote themselves. <br><br> Scalars are floating point values, integers, strings, or
references as needed. During the life of a scalar, it will typically
bounce back and forth between being a string and a numeric value. In
fact, Perl caches the numeric representation of strings containing
numbers. For speed, Perl can be told not to use floating point
representations: say <i>use integer;</i> at the top of your file. 
<br><br> Functions take exactly one kind of argument: an array. Each
member of the array can have its own value. In fact, a function may
receive an array of exactly one thing: an array reference. Perl creates
arrays on the fly like so: <br><br>
 <pre>  @array = (1, 2, 3, 'hi');</pre>
<br><br>
 However, arrays that aren't passed by reference get copied. That means: 
<br><br>
 <pre>  function(9, 10, @array);</pre>
<br><br>
 ...<i>function()</i> shouldn't expect to get a reference to @array. Instead, everything inside of  array will be copied onto the end of <i>function()</i>'s argument list, making it equivalent to  saying: 
<br><br>
 <pre>  function(9, 10, 1, 2, 3, 'hi');</pre>
<br><br> Since so many of Perl's built in functions work on plain old
flat lists, and it is easy to compose lists from many sources to feed
to a function, this is officially considered a feature. <br><br> While the behavior is to pass-by-value, Perl optimizes away
the duplication of the scalar values until the point that you read the
arguments, if you read them. This is a technicality, and probably won't
affect you. This clause only exists to silence technical knit-pickers. <br><br>
 <font size="+2"><b>Checking Objects For Equality</b></font><br><br>Good
luck. If you have a reference, you need intimate knowledge of it to
compare it value-for-value to a like reference. When writing your own
objects, using an <a href="http://www.perldesignpatterns.com/?EqualsInterface">Equals Interface</a> is highly recommended. 
<br><br>
 <font size="+2"><b>undef</b></font><br><br>The default value for variables is <i>undef</i>, like null. With warnings on, enabled by <i>use warnings</i> or passing perl the <i>-w</i>
switch, Perl attempts to read values from variables that have not yet
had a value assigned results in a warning. You yourself can mark a
variable as having no value: <br><br>
 <pre>  use warnings;
  my $sum = 0;
  my @prices = (10.95, 15.95, 5.95, 25.95, 45.95);
  foreach my $price (@prices) {
    $sum += $price;
  }
  print "$sum was yesterday's price. It isn't valid anymore. Sorry! Offer expired!\n";
  $sum = undef;
  print "The total for this order is: $sum\n"; # this gives a warning</pre>
<br><br>
 The text of the warning was "Use of uninitialized value in concatenation (.) or string at - line 9.". 
<br><br>
 <pre>  if(undef == 0) { print "True\n"; }

  my $a = undef;
  if($a == 0) { print "True\n"; }</pre>
<br><br>
 Logically, undef == 0. Many built in functions return a number on success and <i>undef</i> on failure: 0 is a possible success return value. So is the null string, <i><tt></tt></i><tt>. Rather than testing for truth, you must test for definedness: </tt>
<br><br>
 <pre>  if(defined(my $line = &lt;&gt;)) {
    # deal with more frivolous user demands
  }
  # user has shut up now and hit Control-D or closed the connection</pre>
<br><br>
 <i>defined()</i> returns true if its argument is defined and false if its argument is in fact not. 
<br><br>
 To restate, <i>0</i> is a defined value, as is <i>10</i>, <i>"Hello"</i>, and so forth. Only no value and <i>undef</i> itself test positive in <i>defined()</i>. 
<br><br>
 <font size="+2"><b>Perl has no Pointers... Well...</b></font><br><br>Perl does automatic array expansion, <i>autovivification</i> (creation on demand) of  elements in datastructures and variables, and lots of other fun <a href="http://www.perldesignpatterns.com/?DynamicLanguage">Dynamic Language</a> stuff. If you really want to blow a smoking hole through your footsies, there is a <a href="http://www.perldesignpatterns.com/?PeekPoke">Peek Poke</a>
module on CPAN. Perl grows arrays as needed. Attempting to access a
negitive array element addresses the array relative the end. <br><br>
 <font size="+2"><b>References</b></font><br><br>Perl
implements reference counting. Reference counting is fast, saves the
bother of manually having to allocate and free memory (and other
resources if object destructors are used). Garbage collection correctly
copes with the situation where two structures reference each other.
With reference counts, each structure has a reference on it, so it is
never freed, even when the two structure aren't visible from anywhere
else: <br><br>
 <pre>  do {
    my $a = [1, 2, 3];
    my $b = [4, 5, 6];
    $a-&gt;[4] = $b;
    $b-&gt;[4] = $a; # uh oh!
  }
  # $a and $b still live on, even though they are out of scope</pre>
<br><br> You might not notice if you accidently do a few of these
babies in code that runs only briefly then exits, like a CGI script.
This can leak memory (allocate memory never to be freed) and ultimately
expend all of the available resources on a long-running application,
like a daemon. See <a href="http://www.perldesignpatterns.com/?DaemonProcess">Daemon Process</a>. Scalar::Util defines a <i>weaken()</i> function for creating weak references - an effective way of avoiding leaks. 
<br><br>
 <font size="+2"><b>Arrays</b></font><br><br>Arrays are manipulated by value or by reference: 
<br><br>
 <pre>  int stuff[] = {1, 2, 3, 4};    /* an array in C */
  my $stuff   = [1, 2, 3, 4];     # an array reference in Perl 
  my @stuff   = (1, 2, 3, 4);     # an array in Perl</pre>
<br><br> On the second line, the [] constructs a reference to a list,
which then gets stored in $stuff. $stuff itself is not a reference, but
merely a SCALAR that has an array reference stored into it. Remember,
there is no pointer/reference type in Perl. <br><br> If manipulated by reference, only information about where to
find the array is passed around, and only one copy of the actual array
exists that is shared by everyone who knows where to find it. By value,
the entire array is duplicated every time it is passed anywhere, giving
each function (internal or external) its own private copy to play with.
One exception to that rule is the <i>foreach()</i> operator.  
<br><br>
 <i>foreach()</i> uses heavy magic to make each each element
it iterates over merely an alias into the array. This is a performance
optimization and a useful feature. These two code examples do the same
thing: <br><br>
 <pre>  @ar = map {$_ + 1} @ar;
  foreach (@ar) { $_++ } # optionally, for means the same thing as foreach</pre>
<br><br>
 For performance, Perl programmers sometimes tell Perl to pre-grow arrays, instead of letting Perl do it on demand: 
<br><br>
 <pre>  $#ar = 999; # allocate 1000 slots</pre>
<br><br> This tells perl that the last index of the @ar array is 999.
Perl infers from this fact that there must be 999 elements in front of
it so it allocates memory for all 1000 slots, thereby presizing @ar. <br><br>
 Arrays can be multidimentional. C arrays allocated thus: 
<br><br>
 <pre>  char message[10][255];    /* 10 messages of 255 characters each */</pre>
<br><br> ...are entirely preallocated, and have no lookup table: since
each message is of fixed size, C need only look for the first one at
offset 0, the next one at offset 255, the next at offset 510, and so
on. This is <b>not</b> how Perl arrays work. Arrays allocated like: 
<br><br>
 <pre>  char **message;           /* I don't know how many messages or how long it might be */</pre>
<br><br> ...is a much a much closer faximile. A pointer holds the
address that points to a row of characters in memory. In the same way,
a Perl array can list references to other arrays. The <i>-&gt;</i>
operator dereferences reference types of various type. This example
creates a reference (pointer) to an array, and starts populating it
with references to other arrays: <br><br>
 <pre>  my $arrayRef = [];
  $arrayRef-&gt;[0] = [1, 2, 3];
  $arrayRef-&gt;[1] = [4, 5, 6];
  $arrayRef-&gt;[2] = [7, 8, 9];

  print $arrayRef-&gt;[1]-&gt;[1], "\n";  # prints 5, right in the middle, just like Hollywood Squares</pre>
<br><br>
 Because it is unambiguous, Perl accepts as a short hand this syntax for indexing multidimensional arrays: 
<br><br>
 <pre>  print $arrayRef-&gt;[1][1], "\n"; # like above</pre>
<br><br>
 Note that the first <i>-&gt;</i> is still required to distinguish between the reference <i>$arrayRef</i> and the array <i>@arrayRef</i>.
In some languages, arrays are objects. Perl is not one of them. In
other languages, arrays are never objects. Perl is not one of them
either. In Perl, arrays are <i>sometimes</i> objects. When they are
objects, they do not a provide a standard, generic API for minipulating
arrays, but rather provide an API cooked up off the cuff by the creator
of the object. This means that the API is more likely to be useful but
less likely to be consistent. <br><br>
 <font size="+2"><b>Strings</b></font><br><br>Strings in Perl are <i>not</i>
null-terminated arrays of characters as they are in C, nor are they
necessarily an instance of some class, though a string-reference could
be. They also aren't references, but it is possible and useful to make
and use string references. The functions <i>substr()</i>, <i>index()</i>, <i>sprintf()</i>, and <i>length()</i>
come to mind for being useful to work on strings. There are many more
XXX. Strings in Perl, like everything else in Perl not marked
otherwise, are binary safe. Arbitrary binary data may be stored in
them, including the null byte. utf8 strings are available as well - see
<i>perldoc perluniintro</i> or (in older perls) <i>use utf8</i> at the top of your code for that, and see <i>perldoc utf8</i>. 
<br><br>
 <font size="+2"><b>Operators</b></font><br><br>Perl supports
too many operators to list in a document like this. The list of Perl
operators is listed in a much longer documented, available from <i>perldoc perlop</i>. Many of the C operators are available. Most critically, though: 
<br><br>
 <pre>   gt ge lt le eq ne cmp       # like &gt;, &gt;=, &lt;, &lt;=, ==, !=, &lt;=&gt;, but for strings: compares lexically or literally

   # this prints true - you probably want the "eq" operator:
   if("hello" == "world") { print "true\n"; }  

   -&gt;  # dereference any reference type. the exact syntax depends on the reference:

   $a-&gt;[0]      # dereference an array ref
   $a-&gt;{'hi'}   # dereference a hash ref
   $a-&gt;()       # dereference a code reference (run the code)
   $a-&gt;blurgh() # dereference an object reference (by calling the method //blurgh()// in the object)</pre>
<br><br>
 It is not uncommon to mix and match them in one statement, if you know the datatypes of everything: 
<br><br>
 <pre>   $a-&gt;[0]-&gt;{'hi'}-&gt;blurgh()-&gt;();</pre>
<br><br>
 If you have trouble with this, rethink what returns what reference types. This assumes that you have a scalar, <i>$a</i>,
that is an array reference. That array holds a list of references to
hashes (hash references). Those hashes each contain references to
objects. Actually, that is too broad of a statement - Perl is
dynamically typed, but this paragraph assumes that you've been
consistent with your datastructure. <br><br>
 <font size="+2"><b>if/elsif/else statements</b></font><br><br>In Perl, the case where an else has another if after it has its own keyword. This is due to the bracketing rules: each <i>if</i> statement must have brackets around its body. 
<br><br>
 <pre>  if($foo == 1) {
    # do something
  } elsif($foo == 2) {
    # do something else
  } else {
    # complain and do nothing
  }</pre>
<br><br>
 <font size="+2"><b>Forward References</b></font><br><br>Perl requires <i>my</i>
variables to be declared before they are used. Nothing else is subject
to this restriction. If your code calls a method, Perl holds it in good
faith that that method will be defined before it is used. <i>use</i> and <i>BEGIN { }</i>
disrupt the orderly pattern of parsing then running: Perl stops
compiling at sight of either of those, immediately compiles and
executes the module in the case of <i>use</i> or immediately  runs the code in the <i>BEGIN { }</i> block, then resumes parsing where it left off. 
<br><br>
 <font size="+2"><b>No Structures or Unions, no Typedef</b></font><br><br>Perl
does not support Structures or Unions. You can use a hash to represent
a struct in a pinch. For more features, see the core <i>Class::Struct</i> module. For maximum flexibility, write an object class. This question is well-answered in the <a href="http://perldesignpatterns.com/intermap.cgi?wiki=FAQ&amp;word=%20see">FAQ: see</a> <i>perldoc -q struct</i>. 
<br><br>
 Typedef does not exist: use  objects instead. Often an <a href="#AbstractFactory"><b>Abstract Factory</b></a> will accomplish the same thing. 
<br><br>
 <font size="+2"><b>I/O</b></font><br><br>I/O handles may be
undecorated, or they may be scalars used as references. Scalars used as
references is the prefered style for user-opened file channels. <i>STDIN</i>, <i>STDOUT</i> and <i>STDERR</i> are already opened and available, as well. 
<br><br>
 <pre>  print "Hi\n";                            # goes to STDOUT by default

  my $input = &lt;STDIN&gt;;                     # read a line of input

  use IO::Handle; STDOUT-&gt;flush();         # flush STDOUT's buffer

  open my $fh, '+&gt;', 'file.txt' or die "file.txt: $!"; # $! contains the error message from strerror(errno)

  my $input = &lt;$fh&gt;;                       # a filehandle reference may be used in place of STDIN</pre>
<br><br>
 See <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlDoc&amp;word=open">PerlDoc:open</a> for the syntax of the <i>open()</i> call and its arguments. 
<br><br>
 <font size="+2"><b>POSIX</b></font><br><br>The <i>POSIX</i> module is distributed with Perl. Typing "perldoc POSIX" at the command line should bring up documentation. <i>POSIX</i>
goes a long way towards making functions and constants available to C
programs in a POSIX environment available to Perl programmers. Most
constructs in <i>POSIX</i> have Perl equivalents - built in functions or operators, or CPAN modules - but <i>POSIX</i> radically eases the task of changing C code to work in Perl, or easing the adjustment period. 
<br><br>
 <font size="+2"><b>Changes</b></font><br><br></li><li> Added <i>use constant</i> syntax in <b>No Preprocessor</b> - jkeroes 5 Mar 2003 </li><li> Changed XXX placeholder to <i>Filter</i> in <b>No Preprocessor</b> - jkeroes 5 Mar 2003 </li><li> Minor changes to <i>map</i> and <i>foreach</i> to better compare in <b>Arrays</b> - jkeroes 5 Mar 2003 </li><li> Fixed bug in <b>Arrays</b>: @ar = 1000 does *not* presize the array, $#ar does - jkeroes 5 Mar 2003 </li><li> Tried to clarify <b>No Structures or Unions, no Typedef</b> - jkeroes 5 Mar 2003 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#HowDoesPerlStackUp"><b>How Does Perl Stack Up</b></a> 
<br><br>
 <br><br> <a name="PerlPatternsResources"></a><h2><a href="#PerlPatternsResources"><b>Perl Patterns Resources</b></a></h2><br> 
<br><br>
 <font size="+2"><b>Links Related to PerlDesignPatterns: </b></font><br><br><font size="+2"><b>Perl Design Patterns Sites</b></font><br><br></li><li> <a href="http://slowass.net/%7Ephaedrus/slides/">http://slowass.net/~phaedrus/slides/</a> - slides for a <a href="http://pheonix.pm.org/">http://pheonix.pm.org</a> talk on perl design patterns </li><li> <a href="http://patternsinperl.com/">http://patternsinperl.com/</a> - <a href="http://www.perldesignpatterns.com/?NigelWetters">Nigel Wetters</a>' less complete but more polished site </li><li> <a href="http://apprentice.perl.org/project/5.html">http://apprentice.perl.org/project/5.html</a> - curious, didn't know that was there </li><li> <a href="http://hatena.dyndns.org/%7Ejkondo/DesignPattern/">http://hatena.dyndns.org/~jkondo/DesignPattern/</a> - less talk, more code! </li><li> <a href="http://magnonel.guild.net/%7Eschwern/talks/Design_Patterns/full_slides/">http://magnonel.guild.net/~schwern/talks/Design_Patterns/full_slides/</a> </li><li> <a href="http://magnonel.guild.net/%7Eschwern/talks/Refactoring/slides/">http://magnonel.guild.net/~schwern/talks/Refactoring/slides/</a> </li><li> <a href="http://www.zanthan.com/itymbi/archives/000587.html">http://www.zanthan.com/itymbi/archives/000587.html</a> </li><li> <a href="http://sagewire.sage.org/article.pl?sid=02/07/11/187241">http://sagewire.sage.org/article.pl?sid=02/07/11/187241</a> - fluent Perl </li><li> <a href="http://www.panix.com/%7Eziggy/perl_patterns.html">http://www.panix.com/~ziggy/perl_patterns.html</a> </li><li> <a href="http://www.perl.com/pub/a/2002/08/07/proxyobject.html">http://www.perl.com/pub/a/2002/08/07/proxyobject.html</a> </li><li> <a href="http://bob.marlboro.edu/%7Emsie/2002/ipl/perl/lectures/jun29/lecture.html">http://bob.marlboro.edu/~msie/2002/ipl/perl/lectures/jun29/lecture.html</a> </li><li> <a href="http://www.samag.com/documents/s=1280/sam02010001/">http://www.samag.com/documents/s=1280/sam02010001/</a> - Program Like Ya Mean <a href="http://perldesignpatterns.com/intermap.cgi?wiki=It&amp;word=%20TPJ">It: TPJ</a> </li><li> <a href="http://perlmonks.org/?node_id=193340">http://perlmonks.org/?node_id=193340</a> - Are Design Patterns Worth It? </li><li> <a href="http://perlmonks.org/index.pl?node_id=133399">http://perlmonks.org/index.pl?node_id=133399</a> - Design Patterns Considered Harmful </li><li> <a href="http://perl.plover.com/yak/design/">http://perl.plover.com/yak/design/</a> - "Design Patterns" Aren't - Dominus </li><li> <a href="http://wgz.org/chromatic/perl/index.html">http://wgz.org/chromatic/perl/index.html</a> - <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a> - investigate this </li><li> <a href="http://www.samag.com/documents/s=1273/sam05020007/">http://www.samag.com/documents/s=1273/sam05020007/</a> - Perl Patterns </li><li> <a href="http://www.perl.com/pub/a/2003/06/13/design1.html">http://www.perl.com/pub/a/2003/06/13/design1.html</a> - Perl Design Patterns it calls itself. The gull. </li><li> <a href="http://www.oreillynet.com/pub/wlg/2341">http://www.oreillynet.com/pub/wlg/2341</a> - Design Patterns - Hype and Snobbery </li><li> <a href="http://www.doc.ic.ac.uk/%7Enp2/patterns/scripting/">http://www.doc.ic.ac.uk/~np2/patterns/scripting/</a> - XXX integrate </li><li> <a href="http://www.cs.wustl.edu/%7Eschmidt/patterns-info.html">http://www.cs.wustl.edu/~schmidt/patterns-info.html</a> - XXX integate 
<br><br>
 <font size="+2"><b>Perl Object Manpages</b></font><br><br></li><li> <a href="http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perlbot.pod">http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perlbot.pod</a> </li><li> <a href="http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perlmod.pod">http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perlmod.pod</a> </li><li> <a href="http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perltootc.pod">http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perltootc.pod</a> </li><li> <a href="http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perltoot.pod">http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perltoot.pod</a> </li><li> <a href="http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perlobj.pod">http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perlobj.pod</a> </li><li> <a href="http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perlmodlib.pod">http://search.cpan.org/author/GSAR/perl-5.6.1/pod/perlmodlib.pod</a> 
<br><br>
 <font size="+2"><b>Misc</b></font><br><br></li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=References&amp;word=%20ReferencesMeta">References: ReferencesMeta</a> (Moving away from this format towards automation) </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Books&amp;word=%20This">Books: This</a> has moved to <a href="#CategoryBook"><b>Category Book</b></a> and <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PhoenixPerlMongers&amp;word=PerlBooks">PhoenixPerlMongers:PerlBooks</a> </li><li> <a href="http://perlmonks.org/index.pl?node_id=216602">http://perlmonks.org/index.pl?node_id=216602</a> - Perl quickref for newbies </li><li> <a href="http://www.catb.org/%7Eesr/faqs/hacker-howto.html">http://www.catb.org/~esr/faqs/hacker-howto.html</a> 
<br><br>
 <font size="+2"><b>Other DesignPatterns Stuff</b></font><br><br></li><li> <a href="http://ask.slashdot.org/article.pl?sid=02/10/15/2352256&amp;mode=thread&amp;tid=156">http://ask.slashdot.org/article.pl?sid=02/10/15/2352256&amp;mode=thread&amp;tid=156</a> - UI Design Patterns </li><li> <a href="http://www.norvig.com/design-patterns/">http://www.norvig.com/design-patterns/</a> - Design Patterns in Dynamic Languages </li><li> <a href="http://www.laputan.org/foote/papers.html">http://www.laputan.org/foote/papers.html</a> - <a href="http://www.perldesignpatterns.com/?BrainFoote">Brain Foote</a>, author of <a href="#BigBallOfMud"><b>Big Ball Of Mud</b></a> pattern </li><li> <a href="http://industriallogic.com/papers/learning.html">http://industriallogic.com/papers/learning.html</a> - a learning guide to the GoF book </li><li> <a href="http://www.clickblocks.org/patterns1/pattern_synopses.htm">http://www.clickblocks.org/patterns1/pattern_synopses.htm</a> </li><li> <a href="http://exciton.cs.oberlin.edu/javaresources/DesignPatterns/default.htm">http://exciton.cs.oberlin.edu/javaresources/DesignPatterns/default.htm</a> </li><li> <a href="http://citeseer.nj.nec.com/riehle97composite.html">http://citeseer.nj.nec.com/riehle97composite.html</a> </li><li> <a href="http://www.dmst.aueb.gr/dds/pubs/jrnl/2000-JSS-DSLPatterns/html/dslpat.html">http://www.dmst.aueb.gr/dds/pubs/jrnl/2000-JSS-DSLPatterns/html/dslpat.html</a> - Patterns for Domain Specific Languages </li><li> <a href="http://www.martinfowler.com/eaaCatalog/">http://www.martinfowler.com/eaaCatalog/</a> - <a href="http://www.perldesignpatterns.com/?MartinFowler">Martin Fowler</a>'s Enterprise Patterns </li><li> <a href="http://www.mcs.csuhayward.edu/%7Ebillard/6140.html">http://www.mcs.csuhayward.edu/~billard/6140.html</a> - CSI 6140's index of patterns sites </li><li> <a href="http://www.objectarchitects.de/ObjectArchitects/orpatterns/index.htm?Appendices/web_ressources.htm">http://www.objectarchitects.de/ObjectArchitects/orpatterns/index.htm?Appendices/web_ressources.htm</a> </li><li> <a href="http://www.devdaily.com/Dir/General_Programming/Design_Patterns/">http://www.devdaily.com/Dir/General_Programming/Design_Patterns/</a> </li><li> <a href="http://gee.cs.oswego.edu/dl/pd-FAQ/pd-FAQ.html">http://gee.cs.oswego.edu/dl/pd-FAQ/pd-FAQ.html</a> - Patterns FAQ </li><li> <a href="http://c2.com/cgi/wiki?TipsForWritingPatternLanguages">http://c2.com/cgi/wiki?TipsForWritingPatternLanguages</a> </li><li> <a href="http://www.patterndepot.com/pages/">http://www.patterndepot.com/pages/</a>   </li><li> <a href="http://www.hillside.net/patterns/">http://www.hillside.net/patterns/</a> <pre> </pre><font size="+2"><b>ObjectOriented Stuff</b></font><br><br></li><li> <a href="http://www.objectarchitects.de/ObjectArchitects/orpatterns/index.htm">http://www.objectarchitects.de/ObjectArchitects/orpatterns/index.htm</a> - Object-Relational patterns </li><li> <a href="http://www.stanford.edu/%7Eengler/p401-xie.pdf">http://www.stanford.edu/~engler/p401-xie.pdf</a> - Redundant code sign of larger problems </li><li> <a href="http://www.advogato.org/article/575.html">http://www.advogato.org/article/575.html</a> - Framework Building Rules of Thumb </li><li> <a href="http://java.sun.com/features/2003/01/lanier_qa1.html">http://java.sun.com/features/2003/01/lanier_qa1.html</a> - Programs beyond 10 million lines </li><li> <a href="http://www.iarchitect.com/mshame.htm">http://www.iarchitect.com/mshame.htm</a> - Interface Hall of Shame </li><li> <a href="http://mpt.phrasewise.com/stories/storyReader$374">http://mpt.phrasewise.com/stories/storyReader$374</a> - When good interfaces go crufty </li><li> <a href="http://linux.oreillynet.com/pub/a/linux/2001/05/04/xp_intro.html">http://linux.oreillynet.com/pub/a/linux/2001/05/04/xp_intro.html</a> - <a href="http://www.perldesignpatterns.com/?ExtremeProgramming">Extreme Programming</a> intro </li><li> <a href="http://www.construx.com/seminars/onsite/topic-intro-oo.htm">http://www.construx.com/seminars/onsite/topic-intro-oo.htm</a> -- Good OO outline </li><li> <a href="http://java.sun.com/people/jag/Presentations/TheStoryOfJava/img20.htm">http://java.sun.com/people/jag/Presentations/TheStoryOfJava/img20.htm</a> - Java's Design Principles </li><li> <a href="http://www.advogato.org/article/635.html">http://www.advogato.org/article/635.html</a> - Why UML and Open Source<a href="http://www.perldesignpatterns.com/?OpenSource">+</a> don't mix - <a href="http://www.perldesignpatterns.com/?UnifiedMarkupLanguage">Unified Markup Language</a> </li><li> <a href="http://martinfowler.com/books.html">http://martinfowler.com/books.html</a> - <a href="http://www.perldesignpatterns.com/?MartinFowler">Martin Fowler</a>, <a href="http://martinfowler.com/">http://martinfowler.com/</a> </li><li> <a href="http://www.ambysoft.com/">http://www.ambysoft.com/</a> - Agile books, and lots of database stuff 
<br><br>
 <font size="+2"><b>Random Perl Links</b></font><br><br></li><li> <a href="http://www.perlmonks.org/">http://www.perlmonks.org</a> - Perl Monks </li><li> <a href="http://grinder.perlmonk.org/pmsi/title.html">http://grinder.perlmonk.org/pmsi/title.html</a> - All snippets, indexed! </li><li> <a href="http://www.perldoc.com/">http://www.perldoc.com/</a> </li><li> <a href="http://www.sysarch.com/perl/sort_paper.html">http://www.sysarch.com/perl/sort_paper.html</a> - Very, very good - XXX </li><li> <a href="http://www.perldoc.com/perl5.8.0/pod.html">http://www.perldoc.com/perl5.8.0/pod.html</a> - all sorts of documentation for Perl </li><li> <a href="http://conferences.oreillynet.com/pub/w/15/presentations.html">http://conferences.oreillynet.com/pub/w/15/presentations.html</a> - Perl Presentations </li><li> <a href="http://perl.about.com/cs/intermediateperl/">http://perl.about.com/cs/intermediateperl/</a> - <a href="http://about.com/">http://about.com</a> 's Intermediate Perl Area </li><li> <a href="http://perl.about.com/cs/advancedperl/">http://perl.about.com/cs/advancedperl/</a> - <a href="http://about.com/">http://about.com</a> 's Advanced Perl Area </li><li> <a href="http://perl.about.com/library/glossary/blglossary.htm">http://perl.about.com/library/glossary/blglossary.htm</a> - <a href="http://about.com/">http://about.com</a> 's Perl Glossary </li><li> <a href="http://www.pobox.com/%7Eschwern/talks/">http://www.pobox.com/~schwern/talks/</a> </li><li> <a href="http://www.pobox.com/%7Eschwern/cgi-bin/perl-qa-wiki.cgi">http://www.pobox.com/~schwern/cgi-bin/perl-qa-wiki.cgi</a> - <a href="http://www.perldesignpatterns.com/?MichaelSchwern">Michael Schwern</a>'s Perl Wiki! </li><li> <a href="http://www.perl.com/pub/a/language/versus/perl.html">http://www.perl.com/pub/a/language/versus/perl.html</a> - Perl Gotchas </li><li> <a href="http://www.perl.com/language/style/slide-index.html">http://www.perl.com/language/style/slide-index.html</a> - Perl Style </li><li> <a href="http://www.perl.com/tchrist/defop/defconfaq.html">http://www.perl.com/tchrist/defop/defconfaq.html</a> - Truth vs Definedness </li><li> <a href="http://www.perl.com/language/style/slide-index.html">http://www.perl.com/language/style/slide-index.html</a> - Perl Style </li><li> <a href="http://perl.plover.com/IAQ/IAQlist.html">http://perl.plover.com/IAQ/IAQlist.html</a> - Infrequently Asked Questions </li><li> <a href="http://www.perl.com/doc/FMTEYEWTK/index.html">http://www.perl.com/doc/FMTEYEWTK/index.html</a> - Far More Than You Ever Wanted To Know - 1996 =) </li><li> <a href="http://builder.com.com/article.jhtml?id=u00320021008BR101.htm&amp;fromtm=e601-2">http://builder.com.com/article.jhtml?id=u00320021008BR101.htm&amp;fromtm=e601-2</a> - Soap article </li><li> <a href="http://www.perl.com/pub/a/2002/11/14/exception.html">http://www.perl.com/pub/a/2002/11/14/exception.html</a> - OO style exception handling    </li><li> <a href="http://perl.plover.com/FAQs/Namespaces.html">http://perl.plover.com/FAQs/Namespaces.html</a> - Coping with Scoping </li><li> <a href="http://www.oreillynet.com/pub/a/oreilly/perl/2002/11/04/perlsuccess.html">http://www.oreillynet.com/pub/a/oreilly/perl/2002/11/04/perlsuccess.html</a> - Perl Success Stories </li><li> <a href="http://www.onlamp.com/pub/a/onlamp/2002/01/17/slash_plugin.html">http://www.onlamp.com/pub/a/onlamp/2002/01/17/slash_plugin.html</a> - slash wiki plugin </li><li> <a href="http://milwaukee.pm.org/pub/Milwpm/PerlAquarium/raindrop.tar.gz">http://milwaukee.pm.org/pub/Milwpm/PerlAquarium/raindrop.tar.gz</a> - Perl Fishtank </li><li> <a href="http://www-106.ibm.com/developerworks/linux/library/l-genperl/?t=gr,lnxw01=PerlGenetics">http://www-106.ibm.com/developerworks/linux/library/l-genperl/?t=gr,lnxw01=PerlGenetics</a> Genetic Algorithms in Perl </li><li> <a href="http://www.riehle.org/vuw-mirror/CS-TR-02-9.pdf">http://www.riehle.org/vuw-mirror/CS-TR-02-9.pdf</a> - Postmodern Programming </li><li> <a href="http://www.devx.com/dotnet/articles/ym81502/ym81502-1.asp">http://www.devx.com/dotnet/articles/ym81502/ym81502-1.asp</a> - Perl &amp; .NET Interop via Interfaces </li><li> <a href="http://documentation.perl.org/">http://documentation.perl.org/</a> - Perl Documentation Project </li><li> <a href="http://perlmonks.org/index.pl?node=The%20St.%20Larry%20Wall%20Shrine">http://perlmonks.org/index.pl?node=The%20St.%20Larry%20Wall%20Shrine</a> - Larry Wall shrine </li><li> <a href="http://www.perlmonth.com/">http://www.perlmonth.com/</a> - Defunct, odd Perl magazine </li><li> <a href="http://www.perl.com/pub/a/1999/11/sins.html">http://www.perl.com/pub/a/1999/11/sins.html</a> - 11 sins of perl </li><li> <a href="http://www.perl.com/pub/a/language/versus/perl.html">http://www.perl.com/pub/a/language/versus/perl.html</a> - 7 deadly sins of Perl 4  </li><li> <a href="http://cvs.simon-cozens.org/viewcvs.cgi/rubyisms/README?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">http://cvs.simon-cozens.org/viewcvs.cgi/rubyisms/README?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup</a> </li><li> <a href="http://history.perl.org/">http://history.perl.org</a> </li><li> <a href="http://www.perlarchive.com/">http://www.perlarchive.com/</a> </li><li> <a href="http://www.cs.hut.fi/%7Ejtjuslin/">http://www.cs.hut.fi/~jtjuslin/</a> - Fuzzy Intrusion Detection </li><li> <a href="http://japhy.perlmonk.org/articles/pm/2000-02.html">http://japhy.perlmonk.org/articles/pm/2000-02.html</a> - Perl with Style </li><li> <a href="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/117226">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/117226</a> - LZ77 in pure Python </li><li> <a href="http://perl.plover.com/">http://perl.plover.com/</a> - loads of great stuff </li><li> <a href="http://www.simonflack.com/articles/perl5to6ref">http://www.simonflack.com/articles/perl5to6ref</a> </li><li> <a href="http://gisle.aas.no/perl/illguts/">http://gisle.aas.no/perl/illguts/</a> - Perl Guts Illustrated </li><li> <a href="http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/WebHome">http://twiki.med.yale.edu/twiki2/bin/view/CGIapp/WebHome</a> 
<br><br>
 <font size="+2"><b>Perl XS, assembly, internals</b></font><br><br></li><li> <a href="http://www.swig.org/">http://www.swig.org</a> </li><li> <a href="http://www.perlmonth.com/perlmonth/issue6/modules.html">http://www.perlmonth.com/perlmonth/issue6/modules.html</a> </li><li> <a href="http://www.perlmonth.com/perlmonth/issue7/modules.html">http://www.perlmonth.com/perlmonth/issue7/modules.html</a> </li><li> <a href="http://www.perlmonth.com/perlmonth/issue8/modules.html">http://www.perlmonth.com/perlmonth/issue8/modules.html</a> </li><li> <a href="http://www.perlmonth.com/perlmonth/issue9/modules.html">http://www.perlmonth.com/perlmonth/issue9/modules.html</a> </li><li> <a href="http://www.perlmonth.com/perlmonth/issue10/modules.html">http://www.perlmonth.com/perlmonth/issue10/modules.html</a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlAssembly">Perl Assembly</a> </li><li> <a href="http://larsen.perlmonk.org/perl/scaling_cgi.html">http://larsen.perlmonk.org/perl/scaling_cgi.html</a> - writing scalable CGI scripts 
<br><br>
 <font size="+2"><b>Background and cool CSy information</b></font><br><br></li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=GreatProgramsToRead">WikiWiki:GreatProgramsToRead</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=WhenToUseInnerClasses">WikiWiki:WhenToUseInnerClasses</a> - alternative to multiple inherits, too many interfaces </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DontNameClassesObjectManagerHandlerOrData">WikiWiki:DontNameClassesObjectManagerHandlerOrData</a> - touches on many design ideas in conjuction </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=DualityBetweenStateAndClass">WikiWiki:DualityBetweenStateAndClass</a> - given kinds of things, at which point to make subclasses? </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=WikiWiki&amp;word=BizarreLoveTriangleInJava">WikiWiki:BizarreLoveTriangleInJava</a> - solution looks like multiple inheritance, tho the <a href="http://www.perldesignpatterns.com/?InfocomZork">Infocom Zork</a> parser certainly cuts it </li><li> <a href="http://www.cs.rit.edu/%7Eafb/20013/plc/slides/procedures-07.html">http://www.cs.rit.edu/~afb/20013/plc/slides/procedures-07.html</a> - Jensen's Machine - local value pools </li><li> <a href="http://www.cs.rit.edu/%7Eafb/20013/plc/slides/procedures.html">http://www.cs.rit.edu/~afb/20013/plc/slides/procedures.html</a> - Wow - Language Cencepts </li><li> <a href="http://java.sun.com/people/jag/pathfinder.html">http://java.sun.com/people/jag/pathfinder.html</a> - Prioty Inversion with Thread Deadlocks </li><li> <a href="http://www.htdp.org/2002-05-09/Book/curriculum-Z-H-1.html">http://www.htdp.org/2002-05-09/Book/curriculum-Z-H-1.html</a> - How to Design Programs </li><li> <a href="http://www.cs.indiana.edu/eopl/">http://www.cs.indiana.edu/eopl/</a> - Essentials of Programming Languages </li><li> <a href="http://slashdot.org/article.pl?sid=02/08/28/1655207">http://slashdot.org/article.pl?sid=02/08/28/1655207</a> - Literate programming </li><li> <a href="http://www.cs.uu.nl/people/franka/ref">http://www.cs.uu.nl/people/franka/ref</a> - Programming Language Theory Texts - Excellent! </li><li> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=29">http://www.slowass.net/phaedrus/todospool.pl?mesgid=29</a> - <a href="http://www.perldesignpatterns.com/?NeverRewriteSoftware">Never Rewrite Software</a> </li><li> <a href="http://www.bagley.org/%7Edoug/shootout/">http://www.bagley.org/~doug/shootout/</a> - Language Shootout - Awesome! </li><li> <a href="http://icfpcontest.cse.ogi.edu/">http://icfpcontest.cse.ogi.edu/</a> - Functional Programming Competition - all languages welcome! </li><li> <a href="http://www.gnu.org/prep/standards_toc.html">http://www.gnu.org/prep/standards_toc.html</a> - GNU Coding Standards </li><li> <a href="http://www.advogato.org/article/539.html">http://www.advogato.org/article/539.html</a> - Long term programming techniques </li><li> <a href="http://www.csd.uwo.ca/gradstudents/chicha/aa.html">http://www.csd.uwo.ca/gradstudents/chicha/aa.html</a> - Algorithm Animations </li><li> <a href="http://www.owasp.org/guide/">http://www.owasp.org/guide/</a> - Web Applications Security Paper </li><li> <a href="http://www.osnews.com/story.php?news_id=1901&amp;page=1">http://www.osnews.com/story.php?news_id=1901&amp;page=1</a> - Fred Brooks references </li><li> <a href="http://ask.slashdot.org/askslashdot/02/10/26/2223230.shtml?tid=156">http://ask.slashdot.org/askslashdot/02/10/26/2223230.shtml?tid=156</a> - Programming Disasters </li><li> <a href="http://ocw.mit.edu/6/6.170/f01/index.html">http://ocw.mit.edu/6/6.170/f01/index.html</a> - MIT Open Courseware - Software Engineering Lab </li><li> <a href="http://www.assembly.org/">http://www.assembly.org/</a> - Demo coding! Yay! </li><li> <a href="http://www.joelonsoftware.com/index.html">http://www.joelonsoftware.com/index.html</a> - <a href="http://www.perldesignpatterns.com/?JoelOnSoftware">Joel On Software</a> - insights, usability </li><li> <a href="http://www.atarimagazines.com/">http://www.atarimagazines.com/</a> - Lots of great old magazine articles with code </li><li> <a href="http://www.atariarchives.org/c1bag/">http://www.atariarchives.org/c1bag/</a> - lots of old Atari books! Woo! </li><li> <a href="http://java.sun.com/features/2002/11/gabriel_qa.html">http://java.sun.com/features/2002/11/gabriel_qa.html</a> - The Poetry of Programming </li><li> <a href="http://www.creativecommons.org/">http://www.creativecommons.org/</a> </li><li> <a href="http://grotto11.com/blog/slash.html?+1039831658">http://grotto11.com/blog/slash.html?+1039831658</a> </li><li> <a href="http://theory.whirlycott.com/%7Ephil/antispam/rbl-bad/rbl-bad.html">http://theory.whirlycott.com/~phil/antispam/rbl-bad/rbl-bad.html</a> - The Spam <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Problem&amp;word=%20Moving">Problem: Moving</a> Beyond RBLs </li><li> <a href="http://www.oreillynet.com/pub/a/network/2002/10/21/community.html">http://www.oreillynet.com/pub/a/network/2002/10/21/community.html</a> - online communities </li><li> <a href="http://martinfowler.com/articles/evodb.html">http://martinfowler.com/articles/evodb.html</a> - Evolving Databases </li><li> <a href="http://www.wired.com/wired/archive/11.02/code.html">http://www.wired.com/wired/archive/11.02/code.html</a> - Immortal Code </li><li> <a href="http://developer.kde.org/%7Esewardj/">http://developer.kde.org/~sewardj/</a> - <a href="http://www.perldesignpatterns.com/?ValGrind">Val Grind</a> </li><li> <a href="http://www.rubycentral.com/book/">http://www.rubycentral.com/book/</a> - Programming Ruby - The Pragmatic Programmer's Guide </li><li> <a href="http://levine.sscnet.ucla.edu/">http://levine.sscnet.ucla.edu/</a> - Game Theory &amp; Economics </li><li> <a href="http://www.perldesignpatterns.com/?JoelOnSoftware">Joel On Software</a> </li><li> <a href="http://www.amk.ca/python/writing/warts.html">http://www.amk.ca/python/writing/warts.html</a> </li><li> <a href="http://web.mit.edu/nathanw/www/usenix/freenix-sa/freenix-sa.html">http://web.mit.edu/nathanw/www/usenix/freenix-sa/freenix-sa.html</a> </li><li> <a href="http://www.bell-labs.com/cgi-user/OrgPatterns/OrgPatterns?WebIndex">http://www.bell-labs.com/cgi-user/OrgPatterns/OrgPatterns?WebIndex</a> - Organisational (people) Patterns Wiki </li><li> <a href="http://www.cs.utexas.edu/users/EWD/">http://www.cs.utexas.edu/users/EWD/</a> - Edsger W. Dijkstra's manuscripts 
<br><br>
 <font size="+2"><b>Blogs</b></font><br><br></li><li> <a href="http://www.wall.org/%7Elarry/perl.html">http://www.wall.org/~larry/perl.html</a> - <a href="http://www.perldesignpatterns.com/?LarryWall">Larry Wall</a> 's Perl page </li><li> <a href="http://www.perl.com/pub/a/language/admin/whats_new.html">http://www.perl.com/pub/a/language/admin/whats_new.html</a> - <a href="http://www.perldesignpatterns.com/?TomChristiansen">Tom Christiansen</a> 's blog </li><li> <a href="http://use.perl.org/%7Ebrian_d_foy/journal/">http://use.perl.org/~brian_d_foy/journal/</a> - brian d foy's blog </li><li> <a href="http://www.oreillynet.com/pub/au/176">http://www.oreillynet.com/pub/au/176</a> - chromatic </li><li> <a href="http://perl.plover.com/">http://perl.plover.com/</a> - <a href="http://www.perldesignpatterns.com/?MarkJasonDominus">Mark Jason Dominus</a> 
<br><br>
 <font size="+2"><b>Related email to/from me</b></font><br><br></li><li> My initial post to <a href="http://www.perldesignpatterns.com/?PheonixPerlMongers">Pheonix Perl Mongers</a> list: <pre> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=104">http://www.slowass.net/phaedrus/todospool.pl?mesgid=104</a></pre></li><li> Perl with Meta-Lists a la Lisp: <pre> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=42">http://www.slowass.net/phaedrus/todospool.pl?mesgid=42</a></pre></li><li> Conversation with JB: <pre> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=75">http://www.slowass.net/phaedrus/todospool.pl?mesgid=75</a>
 <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=76">http://www.slowass.net/phaedrus/todospool.pl?mesgid=76</a>
 <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=77">http://www.slowass.net/phaedrus/todospool.pl?mesgid=77</a></pre></li><li> <a href="http://www.perldesignpatterns.com/?SecondSystemSyndrome">Second System Syndrome</a> care of <a href="http://www.perldesignpatterns.com/?PerlSixInternals">Perl Six Internals</a>: <pre> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=63">http://www.slowass.net/phaedrus/todospool.pl?mesgid=63</a>  </pre></li><li> Many assorted thoughts on things: <pre> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=41">http://www.slowass.net/phaedrus/todospool.pl?mesgid=41</a></pre></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> considered failure: <pre> <a href="http://www.advogato.org/article/579.html">http://www.advogato.org/article/579.html</a></pre>
<br><br>
 <font size="+2"><b>Other cookbooks and lexicons of note</b></font><br><br></li><li> <a href="http://www.lileks.com/institute/gallery/spec.html">http://www.lileks.com/institute/gallery/spec.html</a> - Regretable Food </li><li> New Anarchy Cookbook<a href="http://www.perldesignpatterns.com/?NewAnarchyCookbook">+</a> </li><li> <a href="http://sunsite.berkeley.edu/Literature/Bierce/DevilsDictionary/">http://sunsite.berkeley.edu/Literature/Bierce/DevilsDictionary/</a> </li><li> <a href="http://wombat.doc.ic.ac.uk/foldoc/">http://wombat.doc.ic.ac.uk/foldoc/</a> </li><li> Inline::C-Cookbook 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="http://www.perldesignpatterns.com/?JavaResources">Java Resources</a> </li><li> <a href="http://www.perldesignpatterns.com/?ForthResources">Forth Resources</a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlNewbie">Perl Newbie</a> </li><li> and of course, <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> 
<br><br>
 $<a href="http://perldesignpatterns.com/intermap.cgi?wiki=Id&amp;word=%20PerlPatternsResources,v">Id: PerlPatternsResources,v</a> 1.123 2003/08/25 08:05:40 httpd Exp $ 
<br><br>

<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.perldesignpatterns.com/">http://www.perldesignpatterns.com</a> 
<br><br>
 <br><br> <a name="AboutPerlPatternsProject"></a><h2><a href="#AboutPerlPatternsProject"><b>About Perl Patterns Project</b></a></h2><br> 
<br><br>
 This book is about Perl. It's about <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a>, Refactoring, and <a href="http://www.perldesignpatterns.com/?AntiPatterns">Anti Patterns</a>, oh, and Perl. <a href="http://perldesignpatterns.com/perldesignpatterns.html">http://perldesignpatterns.com/perldesignpatterns.html</a> - click there to get it, or see <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> for more information. 
<br><br> Exploring, and writing about Design Patterns as they apply to
Perl. Yes, thats right, Perl. Everyone knows that Perl programmers lack
discipline and bondage. Perl does offer many <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a>
features, as long as you aren't looking for compile time checking.
Don't get me wrong - Java is great. I highly recommend Java for large
or collaborative development efforts. Java addresses most shortcomings
of C++, and creates a consistent, likeable language. Perl won't go
away, despite many people's sincere desires, so I'm attempting to
retrofit the bondage beating stick with a carrot. If Design Patterns
can exploit the Perl programmer's natural love of fun and neat tricks,
we may be able to convert some of the unwashed masses - right? Having
OO, lambdas, lexical scoping, tied data, operator overloading, symbol
table manipulation, runtime inheritance tree manipulation, multiple
inheritance, weak typing, and access to the bytecode tree certainly
makes for adventures to be had. I apologize - I know that adventuring
can be fun, rescuing people who got themselves up a creek isn't.
Documenting useful interaction between these diverse ideas is uncharted
territory, perhaps akin to a polar region, waiting to be explored. <br><br>
 Your feedback is strongly encouraged. I want to know: 
<br><br>
 </li><li> What you like </li><li> What you dislike </li><li> What you don't understand </li><li> What you do understand </li><li> What I forgot to explain </li><li> What I've explained too many times </li><li> Which explaination you liked better of the lot ;) 
<br><br>
 The goal is to produce a book under the GNU Free Documentation License<a href="http://www.perldesignpatterns.com/?FreeDocumentationLicense">+</a>. Most GNU FDL books are never printed, and I don't expect that this will be any different, but you never know ;) 
<br><br> Because this work is GNU FDL, it cannot be taken away from
you. The copyright (or "copyleft") gives you the right to copy, modify,
and distribute it under fair and reasonable terms - as close as the
true spirit of "free" as I can manage. If the work is published, I'll
give due credit. Please make a <a href="http://www.perldesignpatterns.com/?PersonalPage">Personal Page</a>
and link to it from changes you make to "sign" those changes. I'm more
than happy to give credit where it is due. If you do as much work as I
do, I'll put your name first - or if your writing style sucks less. <br><br> You are encouraged to use the Wiki. Go ahead and add your
comment or critisism right into the text. I'll see the changes in the <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=recent.cgi">TinyCGI:recent.cgi</a>
log and make any cosmetic changes or tweaks needed to fit it into the
site, or very rarely veto if needed. I do like having opposing view
points and good discussion, though. See <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> for more infromation. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?PerlPatternsToDo">Perl Patterns To Do</a>, <a href="http://www.perldesignpatterns.com/?CategoryToDo">Category To Do</a>
- lists of things that need to be done - some of them, I have very
specific designs on what should be done, but I haven't gotten to it
yet. <br><br>
 At this point, almost everything is the result of me reading and writing in binges. 
<br><br>
 These documents started in <a href="http://www.perldesignpatterns.com/?AbiWord">Abi Word</a>
and were converted by a script to individual pages. There are some
artifacts of that conversion left. I've also thrashed around trying to
solve questions of style, and will probably continue to do so. <br><br>
 There are three tiers of documents here: 
<br><br>
 </li><li> Tier 1: The <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> page and documents that it directly links to.  </li><li> Tier 2: On-topic (according to <a href="#HomePage"><b>Home Page</b></a>) pages that support the first tier may eventually join the first tier </li><li> Tier 3: Personal pages, pages about Wiki and <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a>, the <a href="#GuestLog"><b>Guest Log</b></a>, and off-topic stuff like <a href="http://www.perldesignpatterns.com/?CopyThisBook">Copy This Book</a> 
<br><br>
 Tier 1: Those are compiled by <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=assemble.cgi?PerlDesignPatterns">TinyCGI:assemble.cgi?PerlDesignPatterns</a> to output the HTML "book" and by the podparser.pl script for the <a href="#PerlDoc"><b>Perl Doc</b></a>
version. These should look reasonably nice, be somewhat complete.
Disucssions in them will quickly be integrated into the document or
shuffled off elsewhere. <br><br> Tier 2: Not finished, or no decision has been made as to
whether they should be standard reading for the distributed "book"
version. The final output should be concise, relavent, and interesting
rather than thorough. As ideas are incubating here, discussions will be
molested less. <br><br> Tier 3: Pages not of interest to the project will be left
intact or nuked as appropriate. People creating pages randomly and
posting rants doesn't bother me, but at a certain point I would be
forced to play cop, in theory. <br><br>
 The project has lots of goals - too many perhaps.  
<br><br>
 </li><li> Cookbook - quick how-to guide for doing common and
uncommon-but-cool things relating somehow to the topic. For example,
Perl Cook Book<a href="http://www.perldesignpatterns.com/?PerlCookBook">+</a> </li><li> Free replacement for commercial books on the same topic - scalable, clean code. For example, <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a> </li><li> Style guide for writing large Perl programs. For example, <a href="http://www.perldesignpatterns.com/?EffectivePerlProgramming">Effective Perl Programming</a> </li><li> Introduction to <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming in Perl for practicioners of other languages. </li><li> Introduction to <a href="http://www.perldesignpatterns.com/?ObjectOriented">Object Oriented</a> programming in Perl for Perlers not familiar with OO. 
<br><br>
 <a href="http://www.slowass.net/%7Ephaedrus/slides">http://www.slowass.net/~phaedrus/slides</a> - a version of this done as a <a href="http://www.perldesignpatterns.com/?PerlMongers">Perl Mongers</a> presentation. 
<br><br>
 <a href="#HomePage"><b>Home Page</b></a> has some more basic meta-information about the project. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> is the forum software. Perhaps you've noticed it's rather spartan. Many of the features of <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> were created just for my use here - <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=orphans.cgi">TinyCGI:orphans.cgi</a> generates a list of pages that are referenced but not defined. The <a href="http://www.perldesignpatterns.com/?RateThisPage">Rate This Page</a> feature will hopefully give me some idea of what parts people enjoy and which parts are just painful to read. <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a>
automates back-linking to anyone kind enough to link here, and provides
background and further reading on different topics. It has the
side-effect of telling me what things people search for using Google to
find pages here, and the side-side effect of implementing a "similar
pages" type functionality by recording those and linking to those
searches. Bizarre, interesting - <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a>.  For an introduction to <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a>, including the markup syntax and features, see the <a href="http://www.perldesignpatterns.com/?TinyWiki">Tiny Wiki</a> page. Duh! 
<br><br>
 <font size="+2"><b>Things Others Have Written</b></font><br><br></li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=265913">PerlMonks:265913</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=PerlMonks&amp;word=285065">PerlMonks:285065</a> 
<br><br>
 <font size="+2"><b>See Also</b></font><br><br></li><li> <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> </li><li> <a href="#YetAnotherIntroduction"><b>Yet Another Introduction</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlPatternsToDo">Perl Patterns To Do</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=reverse?CategoryToDo">TinyCGI:reverse?CategoryToDo</a> </li><li> <a href="#HomePage"><b>Home Page</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?HowToWrite">How To Write</a> </li><li> <a href="http://www.perldesignpatterns.com/?PatternTemplate">Pattern Template</a> </li><li> <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=orphans.cgi">TinyCGI:orphans.cgi</a> 
<br><br>

<br><br>
 <br><br> <a name="YetAnotherIntroduction"></a><h2><a href="#YetAnotherIntroduction"><b>Yet Another Introduction</b></a></h2><br> 
<br><br> The introduction exists to sell you this book. To do this, it
tries to convince you there is a problem, and that this book contains
the solution. Any publishers book proposal form revolves around this.
After submitting a few dozen of those, answering the numerous questions
with intricate detail, you get the distinct impression that the only
part of the book that matters is the introduction. Take for instance
the proposals at: <br><br>
 </li><li> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=105">http://www.slowass.net/phaedrus/todospool.pl?mesgid=105</a>  </li><li> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=57">http://www.slowass.net/phaedrus/todospool.pl?mesgid=57</a>  </li><li> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=58">http://www.slowass.net/phaedrus/todospool.pl?mesgid=58</a>  </li><li> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=59">http://www.slowass.net/phaedrus/todospool.pl?mesgid=59</a>  </li><li> <a href="http://www.xray.mpe.mpg.de/mailing-lists/modules/2003-03/msg00079.html">http://www.xray.mpe.mpg.de/mailing-lists/modules/2003-03/msg00079.html</a> </li><li> <a href="http://www.slowass.net/phaedrus/todospool.pl?mesgid=186">http://www.slowass.net/phaedrus/todospool.pl?mesgid=186</a> 
<br><br>
 These also serve as exmaples of book proposals that are sure to be completely ignored. 
<br><br> I've read more than a few new books recently with great
introductions and lackluster content. You wouldn't be holding this on
your hands or screen unless you had an inkling what a <a href="http://www.perldesignpatterns.com/?DesignPattern">Design Pattern</a>
is, or already felt the need, so my advise is skip it. In a book about
Perl, I personally would want to see lots of Perl, and I bet you feel
the same way. <br><br>
 Goals: 
<br><br>
 </li><li> Lexicon </li><li> Cookbook style OO code </li><li> Hardcore OOD/A text </li><li> API documentation 
<br><br> To understand the larger structures, you must understand the
pressures from the larger structures as well as the semantics of the
smaller structures. Semantics and funny syntaxii cause more confusion.
Previously, those came first to get them out of the way. The patterns
came next, and are approximately on the scale of the <a href="http://www.perldesignpatterns.com/?GangOfPatterns">Gang Of Patterns</a> in scope. Then we talk about program features, each touching on  several finer-grained patterns. <a href="http://www.perldesignpatterns.com/?ApplicationTypes">Application Types</a> use collections of features - we these come next. <a href="http://www.perldesignpatterns.com/?ConceptsCrossReference">Concepts Cross Reference</a> and <a href="http://www.perldesignpatterns.com/?AntiPatterns">Anti Patterns</a> are essentially redundant, and everything beyond them is for reference. 
<br><br>
 See also <a href="http://www.perldesignpatterns.com/?HowToWrite">How To Write</a>, and <a href="http://www.perldesignpatterns.com/?PerlPatternsToDo">Perl Patterns To Do</a> has links to some publishers. 
<br><br>
 <hr><br>I can't stop writing introductions! I think I'm
still trying to rationalize this to myself, or sound it out in my head,
or gauge my writing style to see if it has improved in the past few
months. <br><br>
 Here are some more, and some other similar rants. Most of them suck, bad. Just ask <a href="http://www.perldesignpatterns.com/?JoTotland">Jo Totland</a>. 
<br><br>
 </li><li> <a href="http://www.perldesignpatterns.com/?IntroductionPattern">Introduction Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?InvariantsArentAlwaysConstants">Invariants Arent Always Constants</a> </li><li> <a href="http://www.perldesignpatterns.com/?RandomThoughts">Random Thoughts</a> </li><li> <a href="http://www.perldesignpatterns.com/?WorseIsBetter">Worse Is Better</a>  </li><li> <a href="http://www.perldesignpatterns.com/?IdiomaticProgramming">Idiomatic Programming</a> </li><li> <a href="#HowPerlDiffersFromC"><b>How Perl Differs From C</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?PrefacePattern">Preface Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlAndPatterns">Perl And Patterns</a> </li><li> <a href="http://www.perldesignpatterns.com/?PatternLanguage">Pattern Language</a> </li><li> <a href="#AboutRefactoring"><b>About Refactoring</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?RootCauses">Root Causes</a> </li><li> <a href="http://www.perldesignpatterns.com/?LivingDocumentation">Living Documentation</a> </li><li> <a href="http://www.perldesignpatterns.com/?TechnologyEnhancesOurLives">Technology Enhances Our Lives</a> </li><li> <a href="http://www.perldesignpatterns.com/?PutCodeWhereItBelongs">Put Code Where It Belongs</a> </li><li> <a href="http://www.perldesignpatterns.com/?KeepYourOptionsOpen">Keep Your Options Open</a> </li><li> <a href="http://www.perldesignpatterns.com/?PerlPaint">Perl Paint</a> </li><li> <a href="http://www.perldesignpatterns.com/?TestingCode">Testing Code</a> </li><li> <a href="http://www.perldesignpatterns.com/?CommunicationPattern">Communication Pattern</a> </li><li> <a href="http://www.perldesignpatterns.com/?AntiPatterns">Anti Patterns</a> </li><li> <a href="http://www.perldesignpatterns.com/?ArtAndScience">Art And Science</a> </li><li> <a href="http://www.perldesignpatterns.com/?DiverseInterfaces">Diverse Interfaces</a> </li><li> <a href="#BlindFaith"><b>Blind Faith</b></a> </li><li> <a href="http://www.perldesignpatterns.com/?StupidBosses">Stupid Bosses</a> </li><li> <a href="http://www.perldesignpatterns.com/?SkipTheIntroduction">Skip The Introduction</a> </li><li> <a href="http://www.perldesignpatterns.com/?WhyPerlDesignPatterns">Why Perl Design Patterns</a> 
<br><br>
 <hr><br>Speaking of unable to stop writing, there are more than a few rants kicking around: 
<br><br>
 </li><li> <a href="http://www.perldesignpatterns.com/?MonoSoliumGlutamate">Mono Solium Glutamate</a> </li><li> <a href="http://www.perldesignpatterns.com/?CopyThisBook">Copy This Book</a> </li><li> <a href="http://www.perldesignpatterns.com/?RootTheUniverse">Root The Universe</a> </li><li> <a href="http://www.perldesignpatterns.com/?CarsAndSecurity">Cars And Security</a> </li><li> <a href="http://www.perldesignpatterns.com/?StupidBosses">Stupid Bosses</a> </li><li> <a href="http://www.perldesignpatterns.com/?IbmRant">Ibm Rant</a> 
<br><br>

<br><br>
 <hr><br>See <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Also&amp;word=%20AboutPerlPatternsProject,">Also: AboutPerlPatternsProject,</a> <a href="http://www.perldesignpatterns.com/?AlternateTitles">Alternate Titles</a>, <a href="#PerlDesignPatterns"><b>Perl Design Patterns</b></a> 
<br><br>
 External Pages Linking to This Page: 
<br><br>
 <!-- cut here - do not remove this comment - added by <a href="#PagesLinkingHere"><b>Pages Linking Here</b></a> --> </li><li> <a href="http://www.overture.com/d/search/p/juno/?type=topbar&amp;mkt=us&amp;lang=en_US&amp;Keywords=perlpaint">http://www.overture.com/d/search/p/juno/?type=topbar&amp;mkt=us&#9001;=en_US&amp;Keywords=perlpaint</a> 
<br><br>
 <br><br> <a name="AboutTheAuthor"></a><h2><a href="#AboutTheAuthor"><b>About The Author</b></a></h2><br> 
<br><br>

<br><br> Scott Walters is just another Perl hacker who had to rescue
one too many doomed projects and got to thinking about why some code is
really truly awful. Most of this awful code masquerade as Object
Oriented. I can remember the exact moment - I was working on some Java
that did nothing like what the comments said or the code suggested,
when I realized that it was accepting arguments and storing them back
into the same global variables, unmodified, that they were passed from.
I thought back to a certain Perl program that kept its entire state in
a hash, joined repeatedly with multiple separators, and saved it to
disc to pass it between functions. Then, I said to myself, "This world
needs whistle blowers to stop the damage bad code does". Actually, I
said to myself, "I wonder in which ways my code is truly awful, beyond
the ways in which I already know it to be truly awful?" <br><br> Thats a complete lie. Perhaps it goes back to 1997, when I
was living in Sedona, Arizona, working for a little startup company.
One of the people involved in the project, Robert Rhodes (a book of
whose I still need to return), made a clear effort to make sure that OO
methods were to be used for the work I did there. Normally in this
situation, glazing over at the eyes is all I need do. In this case, a
clear expectation was being set for me, and I had to unset it. I
formulated a defense: Object Oriented programming is just one paradigm.
New paradigms come about because of shortcomings of earlier paradigms,
not because earlier ones are fundamentally invalid. Slavish adherance
to a paradigm is no substitute for knowledge, skill, or artistry.
Further, there were plenty of other paradigms: <a href="http://www.perldesignpatterns.com/?LambdaProgramming">Lambda Programming</a>, <a href="#FunctionalProgramming"><b>Functional Programming</b></a>, <a href="#LiterateProgramming"><b>Literate Programming</b></a>,
and their ideas: goal-directed evaluation, systems of constraints, and
lots of other very powerful concepts. I'd like to tell you that I've
been made an OO convert. If that were true, my bank account would
nothing resemble its current state. Instead, I decided the only way
anyone would mistakenly download a text by me is if I smeared "Object
Oriented" all over it. Actually, that isn't true. I decided to
incorporate other ideas into the Object Oriented paradigm. <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a> was my chance. <a href="http://www.perldesignpatterns.com/?DesignPatterns">Design Patterns</a> have been adopted by OO programming, but otherwise have no loyalty to OO.  
<br><br>
 Evil people always tell you their evil plans. I sure hope no one reads this sections. 
<br><br> When you've hired a hundred trained chimpanzes to write all of
your code, the first and last rule is: do not let the chimps have any
fun or they will get no work done. Object Oriented programming has
traditionally done exactly that. Taking away every option to exercise
creativity including even minor design work assures that no fun will be
had by the chimps. I'm here to score one for the chimps. If a job isn't
engaging and challenging, the chimps loose interest, and you loose the
best chimps. Unless you have bananas. <br><br>

<br><br>
 <br><br> <a name="GnuFreeDocumentationLicense"></a><h2><a href="#GnuFreeDocumentationLicense"><b>Gnu Free Documentation License</b></a></h2><br> 
<br><br>
 GNU Free Documentation License 		   Version 1.1, March 2000 
<br><br>
 <pre> Copyright (C) 2000  Free Software Foundation, Inc.
     59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.</pre>
<br><br>

<br><br>
 0. PREAMBLE 
<br><br> The purpose of this License is to make a manual, textbook, or
other written document "free" in the sense of freedom: to assure
everyone the effective freedom to copy and redistribute it, with or
without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others. <br><br> This License is a kind of "copyleft", which means that
derivative works of the document must themselves be free in the same
sense. It complements the GNU General Public License, which is a
copyleft license designed for free software. <br><br> We have designed this License in order to use it for manuals
for free software, because free software needs free documentation: a
free program should come with manuals providing the same freedoms that
the software does. But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book. We recommend this License
principally for works whose purpose is instruction or reference. <br><br>

<br><br>
 1. APPLICABILITY AND DEFINITIONS 
<br><br> This License applies to any manual or other work that contains
a notice placed by the copyright holder saying it can be distributed
under the terms of this License. The "Document", below, refers to any
such manual or work. Any member of the public is a licensee, and is
addressed as "you". <br><br> A "Modified Version" of the Document means any work
containing the Document or a portion of it, either copied verbatim, or
with modifications and/or translated into another language. <br><br> A "Secondary Section" is a named appendix or a front-matter
section of the Document that deals exclusively with the relationship of
the publishers or authors of the Document to the Document's overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject. (For example, if the Document is
in part a textbook of mathematics, a Secondary Section may not explain
any mathematics.) The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them. <br><br> The "Invariant Sections" are certain Secondary Sections
whose titles are designated, as being those of Invariant Sections, in
the notice that says that the Document is released under this License. <br><br> The "Cover Texts" are certain short passages of text that
are listed, as Front-Cover Texts or Back-Cover Texts, in the notice
that says that the Document is released under this License. <br><br> A "Transparent" copy of the Document means a
machine-readable copy, represented in a format whose specification is
available to the general public, whose contents can be viewed and
edited directly and straightforwardly with generic text editors or (for
images composed of pixels) generic paint programs or (for drawings)
some widely available drawing editor, and that is suitable for input to
text formatters or for automatic translation to a variety of formats
suitable for input to text formatters. A copy made in an otherwise
Transparent file format whose markup has been designed to thwart or
discourage subsequent modification by readers is not Transparent. A
copy that is not "Transparent" is called "Opaque". <br><br>
 Examples of suitable formats for Transparent copies include plain ASCII without markup, Texinfo input format, <a href="http://www.perldesignpatterns.com/?LaTeX">La Te X</a>
input format, SGML or XML using a publicly available DTD, and
standard-conforming simple HTML designed for human modification. Opaque
formats include <a href="http://www.perldesignpatterns.com/?PostScript">Post Script</a>,
PDF, proprietary formats that can be read and edited only by
proprietary word processors, SGML or XML for which the DTD and/or
processing tools are not generally available, and the machine-generated
HTML produced by some word processors for output purposes only. <br><br> The "Title Page" means, for a printed book, the title page
itself, plus such following pages as are needed to hold, legibly, the
material this License requires to appear in the title page. For works
in formats which do not have any title page as such, "Title Page" means
the text near the most prominent appearance of the work's title,
preceding the beginning of the body of the text. <br><br>

<br><br>
 2. VERBATIM COPYING 
<br><br> You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License. You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute. However, you may accept
compensation in exchange for copies. If you distribute a large enough
number of copies you must also follow the conditions in section 3. <br><br>
 You may also lend copies, under the same conditions stated above, and you may publicly display copies. 
<br><br>

<br><br>
 3. COPYING IN QUANTITY 
<br><br> If you publish printed copies of the Document numbering more
than 100, and the Document's license notice requires Cover Texts, you
must enclose the copies in covers that carry, clearly and legibly, all
these Cover <a href="http://perldesignpatterns.com/intermap.cgi?wiki=Texts&amp;word=%20Front-Cover">Texts: Front-Cover</a>
Texts on the front cover, and Back-Cover Texts on the back cover. Both
covers must also clearly and legibly identify you as the publisher of
these copies. The front cover must present the full title with all
words of the title equally prominent and visible. You may add other
material on the covers in addition. Copying with changes limited to the
covers, as long as they preserve the title of the Document and satisfy
these conditions, can be treated as verbatim copying in other respects.
<br><br> If the required texts for either cover are too voluminous to
fit legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages. <br><br> If you publish or distribute Opaque copies of the Document
numbering more than 100, you must either include a machine-readable
Transparent copy along with each Opaque copy, or state in or with each
Opaque copy a publicly-accessible computer-network location containing
a complete Transparent copy of the Document, free of added material,
which the general network-using public has access to download
anonymously at no charge using public-standard network protocols. If
you use the latter option, you must take reasonably prudent steps, when
you begin distribution of Opaque copies in quantity, to ensure that
this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public. <br><br> It is requested, but not required, that you contact the
authors of the Document well before redistributing any large number of
copies, to give them a chance to provide you with an updated version of
the Document. <br><br>

<br><br>
 4. MODIFICATIONS 
<br><br> You may copy and distribute a Modified Version of the Document
under the conditions of sections 2 and 3 above, provided that you
release the Modified Version under precisely this License, with the
Modified Version filling the role of the Document, thus licensing
distribution and modification of the Modified Version to whoever
possesses a copy of it. In addition, you must do these things in the
Modified Version: <br><br>
 A. Use in the Title Page (and on the covers, if any) a title distinct <pre>   from that of the Document, and from those of previous versions
   (which should, if there were any, be listed in the History section
   of the Document).  You may use the same title as a previous version
   if the original publisher of that version gives permission.</pre>B. List on the Title Page, as authors, one or more persons or entities <pre>   responsible for authorship of the modifications in the Modified
   Version, together with at least five of the principal authors of the
   Document (all of its principal authors, if it has less than five).</pre>C. State on the Title page the name of the publisher of the <pre>   Modified Version, as the publisher.</pre>D. Preserve all the copyright notices of the Document. E. Add an appropriate copyright notice for your modifications <pre>   adjacent to the other copyright notices.</pre>F. Include, immediately after the copyright notices, a license notice <pre>   giving the public permission to use the Modified Version under the
   terms of this License, in the form shown in the Addendum below.</pre>G. Preserve in that license notice the full lists of Invariant Sections <pre>   and required Cover Texts given in the Document's license notice.</pre>H. Include an unaltered copy of this License. I. Preserve the section entitled "History", and its title, and add to <pre>   it an item stating at least the title, year, new authors, and
   publisher of the Modified Version as given on the Title Page.  If
   there is no section entitled "History" in the Document, create one
   stating the title, year, authors, and publisher of the Document as
   given on its Title Page, then add an item describing the Modified
   Version as stated in the previous sentence.</pre>J. Preserve the network location, if any, given in the Document for <pre>   public access to a Transparent copy of the Document, and likewise
   the network locations given in the Document for previous versions
   it was based on.  These may be placed in the "History" section.
   You may omit a network location for a work that was published at
   least four years before the Document itself, or if the original
   publisher of the version it refers to gives permission.</pre>K. In any section entitled "Acknowledgements" or "Dedications", <pre>   preserve the section's title, and preserve in the section all the
   substance and tone of each of the contributor acknowledgements
   and/or dedications given therein.</pre>L. Preserve all the Invariant Sections of the Document, <pre>   unaltered in their text and in their titles.  Section numbers
   or the equivalent are not considered part of the section titles.</pre>M. Delete any section entitled "Endorsements".  Such a section <pre>   may not be included in the Modified Version.</pre>N. Do not retitle any existing section as "Endorsements" <pre>   or to conflict in title with any Invariant Section.</pre>
<br><br> If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant. To do this, add their titles to the
list of Invariant Sections in the Modified Version's license notice.
These titles must be distinct from any other section titles. <br><br> You may add a section entitled "Endorsements", provided it
contains nothing but endorsements of your Modified Version by various
parties--for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard. <br><br> You may add a passage of up to five words as a Front-Cover
Text, and a passage of up to 25 words as a Back-Cover Text, to the end
of the list of Cover Texts in the Modified Version. Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or through
arrangements made by) any one entity. If the Document already includes
a cover text for the same cover, previously added by you or by
arrangement made by the same entity you are acting on behalf of, you
may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one. <br><br> The author(s) and publisher(s) of the Document do not by
this License give permission to use their names for publicity for or to
assert or imply endorsement of any Modified Version. <br><br>

<br><br>
 5. COMBINING DOCUMENTS 
<br><br> You may combine the Document with other documents released
under this License, under the terms defined in section 4 above for
modified versions, provided that you include in the combination all of
the Invariant Sections of all of the original documents, unmodified,
and list them all as Invariant Sections of your combined work in its
license notice. <br><br> The combined work need only contain one copy of this
License, and multiple identical Invariant Sections may be replaced with
a single copy. If there are multiple Invariant Sections with the same
name but different contents, make the title of each such section unique
by adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of Invariant
Sections in the license notice of the combined work. <br><br> In the combination, you must combine any sections entitled
"History" in the various original documents, forming one section
entitled "History"; likewise combine any sections entitled
"Acknowledgements", and any sections entitled "Dedications". You must
delete all sections entitled "Endorsements." <br><br>

<br><br>
 6. COLLECTIONS OF DOCUMENTS 
<br><br> You may make a collection consisting of the Document and other
documents released under this License, and replace the individual
copies of this License in the various documents with a single copy that
is included in the collection, provided that you follow the rules of
this License for verbatim copying of each of the documents in all other
respects. <br><br> You may extract a single document from such a collection,
and distribute it individually under this License, provided you insert
a copy of this License into the extracted document, and follow this
License in all other respects regarding verbatim copying of that
document. <br><br>

<br><br>
 7. AGGREGATION WITH INDEPENDENT WORKS 
<br><br> A compilation of the Document or its derivatives with other
separate and independent documents or works, in or on a volume of a
storage or distribution medium, does not as a whole count as a Modified
Version of the Document, provided no compilation copyright is claimed
for the compilation. Such a compilation is called an "aggregate", and
this License does not apply to the other self-contained works thus
compiled with the Document, on account of their being thus compiled, if
they are not themselves derivative works of the Document. <br><br> If the Cover Text requirement of section 3 is applicable to
these copies of the Document, then if the Document is less than one
quarter of the entire aggregate, the Document's Cover Texts may be
placed on covers that surround only the Document within the aggregate.
Otherwise they must appear on covers around the whole aggregate. <br><br>

<br><br>
 8. TRANSLATION 
<br><br> Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections. You may include a
translation of this License provided that you also include the original
English version of this License. In case of a disagreement between the
translation and the original English version of this License, the
original English version will prevail. <br><br>

<br><br>
 9. TERMINATION 
<br><br> You may not copy, modify, sublicense, or distribute the
Document except as expressly provided for under this License. Any other
attempt to copy, modify, sublicense or distribute the Document is void,
and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance. <br><br>

<br><br>
 10. FUTURE REVISIONS OF THIS LICENSE 
<br><br> The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time. Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns. See <a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>. 
<br><br> Each version of the License is given a distinguishing version
number. If the Document specifies that a particular numbered version of
this License "or any later version" applies to it, you have the option
of following the terms and conditions either of that specified version
or of any later version that has been published (not as a draft) by the
Free Software Foundation. If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation. <br><br>

<br><br>
 <a href="http://perldesignpatterns.com/intermap.cgi?wiki=ADDENDUM&amp;word=%20How">ADDENDUM: How</a> to use this License for your documents 
<br><br> To use this License in a document you have written, include a
copy of the License in the document and put the following copyright and
license notices just after the title page: <br><br>
 <pre>      Copyright (c)  YEAR   YOUR NAME.
      Permission is granted to copy, distribute and/or modify this document
      under the terms of the GNU Free Documentation License, Version 1.1
      or any later version published by the Free Software Foundation;
      with the Invariant Sections being LIST THEIR TITLES, with the
      Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.
      A copy of the license is included in the section entitled "GNU
      Free Documentation License".</pre>
<br><br> If you have no Invariant Sections, write "with no Invariant
Sections" instead of saying which ones are invariant. If you have no
Front-Cover Texts, write "no Front-Cover Texts" instead of "Front-Cover
Texts being LIST"; likewise for Back-Cover Texts. <br><br> If your document contains nontrivial examples of program
code, we recommend releasing these examples in parallel under your
choice of free software license, such as the GNU General Public
License, to permit their use in free software. <br><br>

<br><br>
 <br><br> <a name="CategoryBook"></a><h2><a href="#CategoryBook"><b>Category Book</b></a></h2><br> 
<br><br>
 Click  <a href="http://perldesignpatterns.com/intermap.cgi?wiki=TinyCGI&amp;word=reverse.cgi?CategoryBook">TinyCGI:reverse.cgi?CategoryBook</a> for an index of all pages describing a book. Any page may join this index by including the keyword '<a href="#CategoryBook"><b>Category Book</b></a>'. 
<br><br>
 See also <a href="http://phoenix.pm.org/wiki/?PerlBooks">http://phoenix.pm.org/wiki/?PerlBooks</a> for more reader reviews and suggestions. 
<br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryCategory">Category Category</a> 
<br><br>
 <br><br> <a name="PagesLinkingHere"></a><h2><a href="#PagesLinkingHere"><b>Pages Linking Here</b></a></h2><br> 
<br><br> This is a code page. It logs the HTTP Referer (sic) header if
there is one. This lets pages link back to where-ever happens to link
to them. <br><br>
 Use this page as a module. From your code, do the <a href="http://www.perldesignpatterns.com/?ActiveWikiPages">Active Wiki Pages</a> escape sequence, which is the same as the ASP escape: less-than then percent, then: 
<br><br>
 <pre>  sb_use '<a href="#PagesLinkingHere"><b>Pages Linking Here</b></a>';</pre>
<br><br>
 Then the close sequence: percent then greater-than. 
<br><br>
 Want to see the escapes yourself? Click "edit" on the bottom of the page! 
<br><br>
 This page doubles as storage for the program: <a href="http://www.perldesignpatterns.com/?ActiveWikiPages">Active Wiki Pages</a> scripts can only write to themselves. 
<br><br>
 Feel free to edit referer spam (yes, people do this) and search engine hits from the list of hits in pages. 
<br><br> Reguarding the rather terse warning about not removing a
certain comment, you can remove it if you feel like it: its purpose is
to allow this page to view the list of refers that have already been
logged, allowing it to avoid logging duplicates. <br><br>
 <a href="http://www.perldesignpatterns.com/?CategoryCodePage">Category Code Page</a> 
<br><br>
  
<br><br>
 <!-- no access log --> </li></body></html>